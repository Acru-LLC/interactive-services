(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b162368"],{"5e21":function(e,t,a){"use strict";a("8cac")},"8cac":function(e,t,a){},feaa:function(e,t,a){"use strict";a.r(t);a("99af");var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-12 text-center"},[t("div",{staticClass:"h4 mb-4 d-inline-block"},[e._v(e._s(e.$t("submodules.users.title")))])]),t("div",{staticClass:"col-xl-4"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-body"},[t("div",{staticClass:"d-flex align-items-center justify-content-between mb-4"},[t("h3",{staticClass:"card-title mb-0 org-str-title"},[e._v(e._s(e.$t("not_translated.organizational_structure")))])]),e.departments.length>0?t("ul",{staticStyle:{"list-style-type":"none"}},[e._l(e.departments,(function(a){return[t("org-str-tree-view",{key:a.id+"dep",staticClass:"item",attrs:{"without-actions":"","department-for-tree":a},on:{showRefModal:e.showRefModal,deleteDep:e.deleteDepartment,toggleActiveClass:e.toggleActiveClass}})]}))],2):[t("h5",[e._v("Ҳозирча бўлинмалар қўшилмаган")])]],2)])]),t("div",{staticClass:"col-xl-8"},[t("div",{staticClass:"card fixed-user-employee-list-card"},[t("div",{staticClass:"card-body"},[t("div",{staticClass:"row mb-2"},[t("div",{staticClass:"col-sm-4"},[t("h5",{staticClass:"mb-0"},[e._v(e._s(e.selectedDep))])]),t("div",{staticClass:"col-sm-4"},[t("div",{staticClass:"text-center"},[t("h4",[e._v(" "+e._s("employees"===e.activeTab?e.$t("submodules.employees.title"):e.$t("submodules.users.title"))+" ")])])]),t("div",{staticClass:"col-sm-4"},[t("div",{staticClass:"text-sm-end"},[t("b-btn",{staticClass:"btn btn-success btn-rounded mb-2 me-2",attrs:{type:"button",to:"employees"===e.activeTab?{name:"CreateEmployee"}:{name:"CreateUser"}}},[t("i",{staticClass:"mdi mdi-plus me-1"}),e._v(" "+e._s(e.$t("actions.add"))+" ")])],1)]),t("div",{staticClass:"col-12"},[t("b-tabs",{attrs:{justified:"","nav-class":"nav-tabs-custom","content-class":"p-3 text-muted"},model:{value:e.activeTabIndex,callback:function(t){e.activeTabIndex=t},expression:"activeTabIndex"}},[t("b-tab",{staticStyle:{"max-height":"50vh",overflow:"auto"},attrs:{active:""},on:{click:function(t){return e.fetchItemsByActiveTab("employees")}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"d-inline-block d-sm-none"},[t("i",{staticClass:"fas fa-home"})]),t("span",{staticClass:"d-none d-sm-inline-block"},[e._v(e._s(e.$t("submodules.employees.title")))])]},proxy:!0}])},[t("b-table",{staticClass:"custom-b-table max-height-40",attrs:{items:e.employees,fields:e.employeeHeaders,busy:e.loadingTableItems,"sticky-header":"sticky-header",id:"employees-table",responsive:"",striped:"",bordered:"",small:"",hover:"","show-empty":""},on:{"update:busy":function(t){e.loadingTableItems=t}},scopedSlots:e._u([{key:"cell(index)",fn:function(t){return[e._v(" "+e._s(e.util_paginate(t.index,e.searchPayloadEmployees.page,e.searchPayloadEmployees.itemsPerPage))+" ")]}},{key:"cell(fullName)",fn:function(t){return[e._v(" "+e._s(t.item.lastName)+" "+e._s(t.item.firstName)+" "+e._s(t.item.middleName?t.item.middleName:"")+" ")]}},{key:"cell(positionName)",fn:function(a){return[t("div",{staticClass:"d-flex justify-content-between"},[t("span",[e._v(" "+e._s(e.getName({nameRu:a.item.directoryPositionNameRu,nameLt:a.item.directoryPositionNameLt,nameUz:a.item.directoryPositionNameUz}))+" ")])])]}},{key:"cell(departmentName)",fn:function(a){return[t("div",{staticClass:"d-flex justify-content-between"},[t("span",[e._v(" "+e._s(e.getName({nameRu:a.item.departmentNameRu,nameLt:a.item.departmentNameLt,nameUz:a.item.departmentNameUz}))+" ")])])]}},{key:"cell(status)",fn:function(a){return[t("p",{staticClass:"mb-0",staticStyle:{"font-size":".95rem"}},[t("span",{class:["badge","ACTIVE"===a.item.statusNameEn?"bg-success":"DELETED"===a.item.statusNameEn?"bg-danger":"bg-info"]},[e._v(" "+e._s(e.getName({nameRu:a.item.statusNameRu,nameLt:a.item.statusNameLt,nameUz:a.item.statusNameUz}))+" ")])])]}},{key:"cell(actions)",fn:function(a){return[t("div",{staticClass:"general-table__actions d-flex justify-content-center"},[t("b-btn",{staticClass:"text-decoration-none p-0",staticStyle:{"font-size":"1.2rem","margin-right":"1rem"},attrs:{variant:"link"}},[t("i",{staticClass:"mdi mdi-circle-edit-outline edit",on:{click:function(t){return e.editItem(a.item.id,"employees")}}})]),t("b-btn",{staticClass:"text-decoration-none p-0 text-danger",staticStyle:{"font-size":"1.2rem"},attrs:{variant:"link"}},[t("i",{staticClass:"mdi mdi-trash-can delete",on:{click:function(t){return e.deleteItem(a.item.id,"employees")}}})])],1)]}},{key:"empty",fn:function(){return[t("h4",{staticClass:"text-center"},[e._v(e._s(e.activeDep.id?e.$t("not_found"):e.$t("choose_department")))])]},proxy:!0},{key:"table-busy",fn:function(){return[t("div",{staticClass:"text-center my-2"},[t("b-spinner",{staticClass:"align-middle",attrs:{variant:"primary"}})],1)]},proxy:!0}])}),t("b-pagination",{staticClass:"justify-content-end",attrs:{"total-rows":e.totalEmployees,"per-page":e.searchPayloadEmployees.itemsPerPage,"aria-controls":"my-table"},model:{value:e.searchPayloadEmployees.page,callback:function(t){e.$set(e.searchPayloadEmployees,"page",t)},expression:"searchPayloadEmployees.page"}})],1),t("b-tab",{staticStyle:{"max-height":"50vh",overflow:"auto"},on:{click:function(t){return e.fetchItemsByActiveTab("users")}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"d-inline-block d-sm-none"},[t("i",{staticClass:"far fa-user"})]),t("span",{staticClass:"d-none d-sm-inline-block"},[e._v(e._s(e.$t("submodules.users.title")))])]},proxy:!0}])},[t("b-table",{staticClass:"custom-b-table",attrs:{items:e.users,fields:e.userHeaders,busy:e.loadingTableItems,id:"users-table",responsive:"",striped:"",bordered:"",small:"",hover:"","show-empty":""},on:{"update:busy":function(t){e.loadingTableItems=t}},scopedSlots:e._u([{key:"cell(index)",fn:function(t){return[e._v(" "+e._s(e.util_paginate(t.index,e.searchPayloadUsers.page,e.searchPayloadUsers.itemsPerPage))+" ")]}},{key:"cell(roleNames)",fn:function(a){return[t("div",{staticClass:"d-flex justify-content-between"},e._l(a.item.roleNames,(function(a,s){return t("p",{key:"".concat(a,"-").concat(s),staticClass:"mb-0",staticStyle:{"flex-basis":"0","flex-grow":"1","font-size":".95rem"}},[t("span",{staticClass:"badge bg-primary badge-pill"},[e._v(e._s(a))])])})),0)]}},{key:"cell(status)",fn:function(a){return[t("p",{staticClass:"mb-0",staticStyle:{"font-size":".95rem"}},[t("span",{class:["badge","ACTIVE"===a.item.statusUz?"bg-success":"DELETED"===a.item.statusUz?"bg-danger":"bg-info"]},[e._v(" "+e._s(e.getName({nameRu:a.item.statusRu,nameLt:a.item.statusLt,nameUz:a.item.statusUz}))+" ")])])]}},{key:"cell(actions)",fn:function(a){return[a.item.id!==e.currentUserId?t("div",{staticClass:"general-table__actions d-flex justify-content-center"},["DELETED"!==a.item.statusUz?t("b-btn",{staticClass:"text-decoration-none p-0",staticStyle:{"font-size":"1.2rem","margin-right":"1rem"},attrs:{variant:"link"}},[t("i",{staticClass:"mdi mdi-circle-edit-outline edit",on:{click:function(t){return e.editItem(a.item.id,"users")}}})]):e._e(),"DELETED"!==a.item.statusUz?t("b-btn",{staticClass:"text-decoration-none p-0",staticStyle:{"font-size":"1.2rem","margin-right":"1rem"},attrs:{variant:"link"}},[t("i",{staticClass:"mdi mdi-office-building edit",on:{click:function(t){return e.updateDepPerms(a.item)}}})]):e._e(),"DELETED"!==a.item.statusUz?t("b-btn",{staticClass:"text-decoration-none p-0 text-danger",staticStyle:{"font-size":"1.2rem"},attrs:{variant:"link"}},[t("i",{staticClass:"mdi mdi-trash-can delete",on:{click:function(t){return e.deleteItem(a.item.id,"users")}}})]):e._e()],1):e._e()]}},{key:"empty",fn:function(){return[t("h4",{staticClass:"text-center"},[e._v(e._s(e.activeDep.id?e.$t("not_found"):e.$t("choose_department")))])]},proxy:!0},{key:"table-busy",fn:function(){return[t("div",{staticClass:"text-center my-2"},[t("b-spinner",{staticClass:"align-middle",attrs:{variant:"primary"}})],1)]},proxy:!0}])}),t("b-pagination",{staticClass:"justify-content-end",attrs:{"total-rows":e.totalUsers,"per-page":e.searchPayloadUsers.itemsPerPage,"aria-controls":"my-table"},model:{value:e.searchPayloadUsers.page,callback:function(t){e.$set(e.searchPayloadUsers,"page",t)},expression:"searchPayloadUsers.page"}})],1)],1)],1)])])])])])},n=[],i=a("b85c"),r=a("c7eb"),c=a("1da1"),l=a("5530"),o=(a("a4d3"),a("e01a"),a("14d9"),a("d3b7"),a("2f62")),d=a("7476"),u=a("c2a4"),m=a("a6fd"),p=a("03f4"),f=a("887a"),b="user",y="employee",v={page:{title:"Users and Employees",meta:[{name:"description",content:u.description}]},components:{OrgStrTreeView:m["a"]},data:function(){return{currentUserId:d["a"].getUserId(),title:"Users and Employees",selectedDep:"",activeDep:{},loadingTableItems:!1,activeTabIndex:0,departments:[],users:[],totalUsers:0,employees:[],totalEmployees:0,searchPayloadEmployees:{},searchPayloadUsers:{}}},computed:Object(l["a"])(Object(l["a"])({},Object(o["d"])("managementUsersAndEmployees",["userHeaders","employeeHeaders"])),{},{activeTab:function(){return 0===this.activeTabIndex?"employees":1===this.activeTabIndex?"users":""},userInfo:function(){return d["a"].getUserInfo()}}),methods:{getActiveTabIndexByTabName:function(e){return"employees"===e?0:"users"===e?1:0},updateDepPerms:function(e){this.$router.push({name:"UpdateUserPermissionsToDepartments",params:{id:e.id},query:{name:e.employeeFullName}})},fetchDepartments:function(){var e=this;return Object(c["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p["a"].searchList("department",e.var_default_search_payload,null,!0).then((function(t){e.departments=[],t.data.id&&e.departments.push(t.data)})).catch((function(e){console.log(e)}));case 2:case"end":return t.stop()}}),t)})))()},deleteItem:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeTab;this.$bvModal.msgBoxConfirm("Are you sure?",{okTitle:this.$t("actions.confirm"),cancelTitle:this.$t("actions.cancel")}).then((function(s){s&&("employees"===a?p["a"].deleteById(y,e).then((function(e){t.fetchItemsByActiveTab()})).catch((function(e){console.log(e)})):"users"===a&&p["a"].deleteById(b,e).then((function(a){t.userInfo.id===e&&t.$store.dispatch("auth/logout"),t.fetchItemsByActiveTab()})).catch((function(e){console.log(e)})))})).catch((function(e){}))},editItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeTab;this.$router.push("users"===t?{name:"UpdateUser",params:{id:e}}:"employees"===t?{name:"UpdateEmployee",params:{id:e}}:this.$toast("Илтимос табни қайта босинг ва яна уриниб кўринг",{type:"info"}))},fetchItemsByActiveTab:function(){var e=arguments,t=this;return Object(c["a"])(Object(r["a"])().mark((function a(){var s,n,i;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(s=e.length>0&&void 0!==e[0]?e[0]:t.activeTab,t.urlPushState({t:s}),!t.activeDep.id){a.next=19;break}if("employees"!==s){a.next=12;break}return t.loadingTableItems=!0,n=t.searchPayloadEmployees,t.employees=[],t.totalEmployees=0,a.next=10,f["a"].searchEmployeesByDep(n,t.activeDep.id).then((function(e){t.employees=e.data.list,t.totalEmployees=e.data.total})).catch((function(e){console.log(e)})).finally((function(){t.loadingTableItems=!1}));case 10:a.next=19;break;case 12:if("users"!==s){a.next=19;break}return t.loadingTableItems=!0,i={data:t.searchPayloadUsers,depId:t.activeDep.id},t.users=[],t.totalUsers=0,a.next=19,p["a"].searchByDepId(b,i).then((function(e){t.users=e.data.list,t.totalUsers=e.data.total})).catch((function(e){console.log(e)})).finally((function(){t.loadingTableItems=!1}));case 19:case"end":return a.stop()}}),a)})))()},giveActiveClassToDep:function(e,t){var a=arguments,s=this;return Object(c["a"])(Object(r["a"])().mark((function n(){var c,l,o,d,u;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:c=a.length>2&&void 0!==a[2]?a[2]:0,l=a.length>3&&void 0!==a[3]?a[3]:{},o=Object(i["a"])(e),n.prev=3,o.s();case 5:if((d=o.n()).done){n.next=17;break}if(u=d.value,u.id!==t){n.next=11;break}document.getElementById("depId-".concat(t)).classList.add("active"),n.next=15;break;case 11:if(document.getElementById("depId-".concat(u.id)).classList.remove("active"),!(u.children&&u.children.length>0)){n.next=15;break}return n.next=15,s.giveActiveClassToDep(u.children,t,c,l);case 15:n.next=5;break;case 17:n.next=22;break;case 19:n.prev=19,n.t0=n["catch"](3),o.e(n.t0);case 22:return n.prev=22,o.f(),n.finish(22);case 25:case"end":return n.stop()}}),n,null,[[3,19,22,25]])})))()},showRefModal:function(){},deleteDepartment:function(){},toggleActiveClass:function(e){var t=this;return Object(c["a"])(Object(r["a"])().mark((function a(){return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e){a.next=4;break}return a.next=3,t.findDepartmentById(t.$route.query.d,null,!0);case 3:e=a.sent;case 4:if(parseInt(t.$route.query.d)===e.id){a.next=7;break}return a.next=7,t.urlPushState({d:e.id});case 7:return t.activeDep=Object.assign({},e),a.next=10,t.giveActiveClassToDep(t.departments,e.id);case 10:t.selectedDep=e.nameUz,t.openDepartmentTreeStyle(e);case 12:case"end":return a.stop()}}),a)})))()},openDepartmentTreeStyle:function(e){var t=this;return Object(c["a"])(Object(r["a"])().mark((function a(){var s,n;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.parentId){a.next=2;break}return a.abrupt("return",!1);case 2:return a.next=4,t.findDepartmentById(e.parentId,null,!0);case 4:return s=a.sent,a.next=7,t.openDepartmentTreeStyle(s);case 7:n=document.getElementById("dep-toggle-icon-id-".concat(e.id)),n&&n.click();case 9:case"end":return a.stop()}}),a)})))()},findDepartmentById:function(e){var t=arguments,a=this;return Object(c["a"])(Object(r["a"])().mark((function s(){var n,c,l,o,d;return Object(r["a"])().wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(n=t.length>1&&void 0!==t[1]?t[1]:null,!(t.length>2&&void 0!==t[2])||t[2],a.departments){s.next=5;break}return s.next=5,a.fetchDepartments();case 5:"string"===typeof e&&(e=parseInt(e)),n||(n=a.departments),c=Object(i["a"])(n),s.prev=8,c.s();case 10:if((l=c.n()).done){s.next=22;break}if(o=l.value,o.id!==e){s.next=14;break}return s.abrupt("return",o);case 14:if(!(o.children&&o.children.length>0)){s.next=20;break}return s.next=17,a.findDepartmentById(e,o.children);case 17:if(d=s.sent,!d){s.next=20;break}return s.abrupt("return",d);case 20:s.next=10;break;case 22:s.next=27;break;case 24:s.prev=24,s.t0=s["catch"](8),c.e(s.t0);case 27:return s.prev=27,c.f(),s.finish(27);case 30:case"end":return s.stop()}}),s,null,[[8,24,27,30]])})))()}},created:function(){var e=this;return Object(c["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchDepartments();case 2:if(e.searchPayloadEmployees=Object.assign({},e.var_default_search_payload),e.searchPayloadUsers=Object.assign({},e.var_default_search_payload),!e.$route.query.d){t.next=14;break}return t.next=7,e.findDepartmentById(e.$route.query.d);case 7:return a=t.sent,t.next=10,e.toggleActiveClass(a);case 10:if(!e.$route.query.t){t.next=14;break}return e.activeTabIndex=e.getActiveTabIndexByTabName(e.$route.query.t),t.next=14,e.fetchItemsByActiveTab(e.$route.query.t);case 14:case"end":return t.stop()}}),t)})))()},watch:{activeDep:{deep:!0,handler:function(){this.fetchItemsByActiveTab(this.$route.query.t)}}}},h=v,g=(a("5e21"),a("2877")),x=Object(g["a"])(h,s,n,!1,null,"412c804f",null);t["default"]=x.exports}}]);