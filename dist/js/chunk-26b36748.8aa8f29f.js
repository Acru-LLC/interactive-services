(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26b36748"],{"37a0":function(e,t,r){},5444:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("base-create-or-update-wrapper",{attrs:{"has-save-suspend":"","custom-title":e.isModeCreate?e.$t("actions.create"):e.$t("actions.update")},on:{save:e.save}},[t("CreateApplicationByDirector",{ref:"formApplicationByDirector"})],1)},i=[],a=r("c7eb"),o=r("1da1"),s=(r("b0c0"),r("d3b7"),r("d81d"),r("3ca3"),r("ddb0"),r("6d89")),c=r("03f4"),p="before-commission/application",u={name:"CreateOrUpdateDirector",components:{CreateApplicationByDirector:s["default"]},data:function(){return{}},computed:{isModeCreate:function(){return"CreateApplicationByDirector"===this.$route.name},computedObserver:function(){return this.$refs.formApplicationByDirector.$refs.observer}},methods:{hasProjectOwner:function(){if(this.$refs.formApplicationByDirector.editingItem.assignments){var e=!1;e:for(var t=0;t<this.$refs.formApplicationByDirector.editingItem.assignments.length;t++)for(var r=0;r<this.$refs.formApplicationByDirector.editingItem.assignments[t].toEmployees.length;r++)if(this.$refs.formApplicationByDirector.editingItem.assignments[t].toEmployees[r].isProjectOwner){e=!0;break e}return e}return!1},treeClosed:function(e){this.computedObserver.refs[e].validate()},normalizer:function(e){return e.children&&0!==e.children.length?{id:e.id,label:e.name,children:e.children&&e.children.length>0?e.children:[]}:(delete e.children,{id:e.id,label:e.name})},getBase64:function(e){return new Promise((function(t,r){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return r(e)}}))},returnBase64FilePromises:function(){var e=this;return Object(o["a"])(Object(a["a"])().mark((function t(){return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.formApplicationByDirector.editingItem.applicationFiles){t.next=4;break}return t.next=3,e.$refs.formApplicationByDirector.editingItem.applicationFiles.map(function(){var t=Object(o["a"])(Object(a["a"])().mark((function t(r){return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r.file.dataURL){t.next=4;break}return t.abrupt("return",{name:r.file.name,base64:r.file.dataURL});case 4:return t.t0=r.file.name,t.next=7,e.getBase64(r.file);case 7:return t.t1=t.sent,t.abrupt("return",{name:t.t0,base64:t.t1});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 4:return t.abrupt("return",[]);case 5:case"end":return t.stop()}}),t)})))()},save:function(){var e=this;return Object(o["a"])(Object(a["a"])().mark((function t(){return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.computedObserver.validate().then(function(){var t=Object(o["a"])(Object(a["a"])().mark((function t(r){var n;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r||!e.hasProjectOwner()){t.next=12;break}if(e.$refs.formApplicationByDirector.editingItem.type="BY_DIRECTOR",!e.$refs.formApplicationByDirector.editingItem.id){t.next=6;break}c["a"].update(p,e.$refs.formApplicationByDirector.editingItem).then((function(t){e.computedObserver.reset(),e.$refs.formApplicationByDirector.editingItem=Object.assign({},{}),e.$router.go(-1),e.$toast(e.$t("messages.saved_successfully"),{type:"success"})})),t.next=10;break;case 6:return t.next=8,e.returnBase64FilePromises();case 8:n=t.sent,Promise.all(n).then((function(t){if(e.$refs.formApplicationByDirector.editingItem.applicationFiles=t,e.$refs.formApplicationByDirector.editingItem.assignments){var r=e.$refs.formApplicationByDirector.editingItem.assignments;e.$refs.formApplicationByDirector.editingItem.assignmentParticipantList=r.map((function(e){return{dateOfCreated:e.dateOfCreated,fromDepartmentId:e.fromEmployee.departmentId,fromEmployeeId:e.fromEmployee.employeeId,fromPositionId:e.fromEmployee.positionId,fromUserId:e.fromEmployee.id,resolution:"",sendingAssignmentParticipantList:e.toEmployees.map((function(t){return{mailingPurposeId:t.mailingPurposeId,processId:e.processId,toDepartmentId:t.toEmployee.departmentId,toEmployeeId:t.toEmployee.employeeId,toPositionId:t.toEmployee.positionId,toUserId:t.toEmployee.id,isProjectOwner:t.isProjectOwner}}))}}))}c["a"].create(p,e.$refs.formApplicationByDirector.editingItem,null,!0).then((function(t){e.computedObserver.reset(),e.$refs.formApplicationByDirector.editingItem=Object.assign({},{}),e.$router.go(-1),e.$toast(e.$t("messages.saved_successfully"),{type:"success"})}))}));case 10:t.next=13;break;case 12:e.$toast(e.$t("messages.fill_required_fields"),{type:"error"});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()}},created:function(){return Object(o["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},f=u,m=(r("a36e"),r("2877")),l=Object(m["a"])(f,n,i,!1,null,"be89552c",null);t["default"]=l.exports},a36e:function(e,t,r){"use strict";r("37a0")}}]);