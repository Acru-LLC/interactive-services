(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f8af40c2"],{"11b5":function(t,e,a){"use strict";a("846d")},3227:function(t,e,a){"use strict";a.r(e);var n=a("8468"),s=(a("d81d"),a("99af"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12 text-center"},[e("div",{staticClass:"h4 mb-4 d-inline-block"},[t._v(t._s(t.$t("submodules.organisation_structure.title")))])]),e("div",{staticClass:"col-xl-5"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"d-flex align-items-center justify-content-between mb-4"},[e("h3",{staticClass:"card-title mb-0 org-str-title"},[t._v(t._s(t.$t("not_translated.organizational_structure")))])]),t.departments.length>0?e("ul",{staticStyle:{"list-style-type":"none","padding-left":"0"}},[t._l(t.departments,(function(a){return[e("org-str-tree-view",{key:a.id+"dep",staticClass:"item",attrs:{"department-for-tree":a},on:{addClicked:function(e){return t.toggleDepTypeModalAndSetCurrentDep(e,!0)},editClicked:t.editItem,deleteClicked:t.deleteItem,toggleActiveClass:t.toggleActiveClass}})]}))],2):[e("h5",[t._v(t._s(t.$t("not_translated.not_added_sections")))]),e("p",[t._v(t._s(t.$t("not_translated.added_button")))])]],2)])]),e("div",{staticClass:"col-xl-7"},[e("div",{staticClass:"card fixed-dep-info-card"},[e("div",{staticClass:"card-body"},[e("h3",{staticClass:"card-title mb-4 org-str-title"},[t._v(" "+t._s(t.activeDep.departmentDto.id?t.getName({nameUz:t.activeDep.departmentDto.nameUz,nameLt:t.activeDep.departmentDto.nameLt,namaRu:t.activeDep.departmentDto.nameRu}):t.$t("not_translated.selected_divide_info")))]),t.activeDep.departmentDto.id?e("b-table-simple",{attrs:{hover:"",small:"","caption-top":"",responsive:""}},[e("b-tbody",[e("b-tr",[e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.code"))+":")]),e("b-td",[t._v(t._s(t.activeDep.departmentDto.code))]),e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.parent_department"))+":")]),e("b-td",[t._v(t._s(t.activeDep.departmentDto.parentNameUz))])],1),e("b-tr",[e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.full_name"))+":")]),e("b-td",[t._v(t._s(t.activeDep.departmentDto.nameUz))]),e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.short_name"))+":")]),e("b-td",[t._v(t._s(t.activeDep.departmentDto.shortName))])],1),e("b-tr",[e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.curator"))+":")]),e("b-td",[t._v(t._s(t.getName({nameRu:t.activeDep.departmentDto.curatorNameRu,nameLt:t.activeDep.departmentDto.curatorNameLt,nameUz:t.activeDep.departmentDto.curatorNameUz}))+" ")]),e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.status"))+":")]),e("b-td",[t._v(t._s(t.getName({nameRu:t.activeDep.departmentDto.statusNameRu,nameLt:t.activeDep.departmentDto.statusNameLt,nameUz:t.activeDep.departmentDto.statusNameUz}))+" ")])],1),e("b-tr",[e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("submodules.department_types.title"))+":")]),e("b-td",[t._v(t._s(t.getName({nameRu:t.activeDep.departmentDto.typeNameRu,nameLt:t.activeDep.departmentDto.typeNameLt,nameUz:t.activeDep.departmentDto.typeNameUz}))+" ")]),t.isLegal?e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.inn"))+": ")]):t._e(),t.isLegal?e("b-td",[t._v(t._s(t.activeDep.contractorDto.inn))]):t._e()],1),t.isLegal?e("b-tr",[e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.director"))+":")]),e("b-td",[t._v(t._s(t.activeDep.contractorDto.director))]),e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.accounter"))+":")]),e("b-td",[t._v(t._s(t.activeDep.contractorDto.accounter))])],1):t._e(),t.isLegal?e("b-tr",[e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.oked"))+":")]),e("b-td",[t._v(t._s(t.activeDep.contractorDto.oked))]),e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.vat_code"))+":")]),e("b-td",[t._v(t._s(t.activeDep.contractorDto.vatCode))])],1):t._e(),t.isLegal?e("b-tr",[e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.region"))+":")]),e("b-td",[t._v(t._s(t.getName({nameRu:t.activeDep.contractorDto.addressDto.regionNameRu,nameLt:t.activeDep.contractorDto.addressDto.regionNameLt,nameUz:t.activeDep.contractorDto.addressDto.regionNameUz}))+" ")]),e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.district"))+":")]),e("b-td",[t._v(t._s(t.getName({nameRu:t.activeDep.contractorDto.addressDto.districtNameRu,nameLt:t.activeDep.contractorDto.addressDto.districtNameLt,nameUz:t.activeDep.contractorDto.addressDto.districtNameUz}))+" ")])],1):t._e(),t.isLegal?e("b-tr",[e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.address"))+":")]),e("b-td",[t._v(t._s(t.activeDep.contractorDto.address))]),e("b-th",{attrs:{scope:"row"}},[t._v(t._s(t.$t("column.mobile_number"))+":")]),e("b-td",[t._v(t._s(t.activeDep.contractorDto.mobileNumber))])],1):t._e()],1)],1):e("h5",[t._v(" "+t._s(t.$t("not_translated.selected_section"))+" ")])],1)])]),e("b-modal",{attrs:{id:"create-update-modal-id",size:"lg",title:"Қандай бўлинма яратишни ҳоҳлайсиз","hide-header":"","title-class":"font-18","ok-only":"","ok-variant":"success","ok-title":t.$t("actions.continue"),"no-stacking":""},on:{ok:t.createDepByDepType},model:{value:t.depTypeModal,callback:function(e){t.depTypeModal=e},expression:"depTypeModal"}},[e("b-row",[e("b-col",{attrs:{xs:"12",cols:"6"}},[e("b-card",{staticClass:"text-center w-100 mb-0",staticStyle:{cursor:"pointer","font-size":"1rem"},attrs:{id:"legalDepartmentCard","bg-variant":"legal"==t.selectedDepType?"primary":"light","text-variant":"legal"==t.selectedDepType?"white":"",header:t.$t("column.is_legal_org")},on:{click:function(e){t.selectedDepType="legal"}}},[e("b-card-text",{staticStyle:{"font-size":"1rem"}},[e("i",{staticClass:"mdi mdi-domain-plus",staticStyle:{"font-size":"1.5rem"}}),t._v(" "+t._s(t.$t("not_translated.created_legal_department"))+" ")])],1)],1),e("b-col",{attrs:{xs:"12",cols:"6"}},[e("b-card",{staticClass:"text-center w-100 mb-0",staticStyle:{cursor:"pointer","font-size":"1rem"},attrs:{id:"simpleDepartmentCard","bg-variant":"simple"==t.selectedDepType?"primary":"light","text-variant":"simple"==t.selectedDepType?"white":"",header:t.$t("column.department")},on:{click:function(e){t.selectedDepType="simple"}}},[e("b-card-text",{staticStyle:{"font-size":"1rem"}},[e("i",{staticClass:"mdi mdi-file-tree",staticStyle:{"font-size":"1.5rem"}}),t._v(" "+t._s(t.$t("not_translated.created_divide"))+" ")])],1)],1)],1)],1),e("b-modal",{attrs:{id:"create-update-modal-id",size:"lg",title:t.$t("not_translated.created_divide"),"title-class":"font-18","ok-title":t.$t("actions.save"),"ok-variant":"success","cancel-title":t.$t("actions.cancel"),"cancel-variant":"danger","no-close-on-backdrop":"","no-close-on-esc":""},on:{ok:t.saveSimpleDepartment},model:{value:t.createOrUpdateModal,callback:function(e){t.createOrUpdateModal=e},expression:"createOrUpdateModal"}},[t.loadingSimpleDepInfo?[e("b-card",[e("b-skeleton",{attrs:{width:"85%"}}),e("b-skeleton",{attrs:{width:"55%"}}),e("b-skeleton",{attrs:{width:"70%"}}),e("b-skeleton",{attrs:{width:"70%"}})],1),e("b-card",[e("b-skeleton",{attrs:{width:"85%"}}),e("b-skeleton",{attrs:{width:"55%"}}),e("b-skeleton",{attrs:{width:"70%"}}),e("b-skeleton",{attrs:{width:"70%"}})],1)]:e("ValidationObserver",{ref:"department-form-observer",scopedSlots:t._u([{key:"default",fn:function(a){return Object(n["a"])(a),[e("b-row",[e("b-col",{staticClass:"mb-3",attrs:{sm:"12"}},[e("BaseMultiselectWithValidation",{staticClass:"required",attrs:{rules:"required",options:t.departmentNames.map((function(t){return t.id})),label:t.$t("column.department"),"custom-label":t.customLabelDepartmentNames,placeholder:t.$t("column.department"),"open-direction":"bottom","max-height":600,"show-labels":!1},model:{value:t.editingItem.departmentNameId,callback:function(e){t.$set(t.editingItem,"departmentNameId",e)},expression:"editingItem.departmentNameId"}})],1),e("b-col",{staticClass:"mb-3",attrs:{sm:"12"}},[e("BaseTreeselectWithValidation",{ref:"parentDep",staticClass:"required",attrs:{rules:"required",placeholder:t.$t("column.parent_department"),label:"nameUz","form-label":t.$t("column.parent_department"),value:t.editingItem.parentId,disabled:"",options:t.departments,"show-count":!0,"default-expand-level":1,normalizer:t.normalizer,name:"parentDep"},on:{close:function(e){return t.treeClosed("parentDepVeeName")}}})],1)],1),e("b-row",[e("b-col",{staticClass:"mb-3",attrs:{sm:"12"}},[e("BaseMultiselectWithValidation",{attrs:{"not-required":"",options:t.curators.map((function(t){return t.id})),label:t.$t("column.curator"),"custom-label":t.customLabelCurators,placeholder:t.$t("column.curator"),"open-direction":"bottom","max-height":600,"show-labels":!1},model:{value:t.editingItem.curatorId,callback:function(e){t.$set(t.editingItem,"curatorId",e)},expression:"editingItem.curatorId"}})],1),e("b-col",{staticClass:"mb-3",attrs:{sm:"12"}},[e("BaseSelectWithValidation",{staticClass:"required",attrs:{rules:"required",label:t.$t("column.status"),"value-field":"id"},scopedSlots:t._u([{key:"first",fn:function(){return[e("b-form-select-option",{attrs:{value:null,disabled:""}},[t._v(t._s(t.$t("column.status"))+" ")]),t._l(t.statuses,(function(a,n){return e("b-form-select-option",{key:"".concat(a,"-").concat(n),attrs:{value:a.id}},[t._v(t._s(t.getName({nameRu:a.nameRu,nameLt:a.nameLt,nameUz:a.nameUz}))+" ")])}))]},proxy:!0}],null,!0),model:{value:t.editingItem.statusId,callback:function(e){t.$set(t.editingItem,"statusId",e)},expression:"editingItem.statusId"}})],1)],1),e("b-row",[e("b-col",{staticClass:"mb-3",attrs:{sm:"12"}},[e("BaseMultiselectWithValidation",{staticClass:"required",attrs:{rules:"required",options:t.types.map((function(t){return t.id})),label:t.$t("submodules.department_types.title"),"custom-label":t.customLabelDepType,placeholder:t.$t("submodules.department_types.title"),"open-direction":"bottom","max-height":600,"show-labels":!1},model:{value:t.editingItem.typeId,callback:function(e){t.$set(t.editingItem,"typeId",e)},expression:"editingItem.typeId"}})],1),e("b-col",{attrs:{sm:"12",md:"6"}})],1)]}}])})],2)],1)}),r=[],i=a("b85c"),o=a("c7eb"),c=a("1da1"),d=(a("a4d3"),a("e01a"),a("7db0"),a("d3b7"),a("14d9"),a("c2a4")),l=a("a6fd"),m=a("03f4"),p=a("887a"),u="department",b={page:{title:"Departments",meta:[{name:"description",content:d.description}]},components:{OrgStrTreeView:l["a"]},data:function(){return{loadingSimpleDepInfo:!1,selectedDepType:"simple",types:[],departments:[],departmentNames:[],curators:[],regions:[],districts:[],statuses:[],editingItem:{},createOrUpdateModal:!1,depTypeModal:!1,title:"Departments",activeDep:{departmentDto:{},contractorDto:{}}}},computed:{isLegal:function(){return!!this.activeDep.departmentDto.id&&!!this.activeDep.departmentDto.inn},departmentFormObserver:function(){return this.$refs["department-form-observer"]}},methods:{saveSimpleDepartment:function(t){var e=this;t.preventDefault(),this.departmentFormObserver.validate().then((function(t){t&&(e.editingItem.id?m["a"].update("department",e.editingItem,"by-department-name/".concat(e.editingItem.id)).then((function(t){e.createOrUpdateModal=!1,e.fetchItems(),e.departmentFormObserver.reset(),e.editingItem=Object.assign({},{}),e.$toast(e.$t("messages.saved_successfully"),{type:"success"})})).catch((function(t){return console.log(t)})):m["a"].create("department",e.editingItem,"by-department-name").then((function(t){e.createOrUpdateModal=!1,e.fetchItems(),e.departmentFormObserver.reset(),e.editingItem=Object.assign({},{}),e.$toast(e.$t("messages.saved_successfully"),{type:"success"})})).catch((function(t){return console.log(t)})))})).catch((function(t){return console.log(t)}))},customLabelDepartmentNames:function(t){var e=this.departmentNames.find((function(e){return e.id==t}));return e?"".concat(this.getName({nameRu:e.nameRu,nameLt:e.nameLt,nameUz:e.nameUz})):""},customLabelDepType:function(t){var e=this.types.find((function(e){return e.id==t}));return e?"".concat(this.getName({nameRu:e.nameRu,nameLt:e.nameLt,nameUz:e.nameUz})):""},customLabelCurators:function(t){var e=this.curators.find((function(e){return e.id==t}));return e?"".concat(this.getName({nameRu:e.nameRu,nameLt:e.nameLt,nameUz:e.nameUz})):""},treeClosed:function(t){this.departmentFormObserver.refs[t].validate()},normalizer:function(t){return t.children&&0!==t.children.length?{id:t.id,label:this.getName({nameRu:t.nameRu,nameLt:t.nameLt,nameUz:t.nameUz}),children:t.children&&t.children.length>0?t.children:[]}:(delete t.children,{id:t.id,label:this.getName({nameRu:t.nameRu,nameLt:t.nameLt,nameUz:t.nameUz})})},getSimpleDepInfo:function(){var t=this;return Object(c["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.var_default_search_payload.itemsPerPage=500,e.next=3,m["a"].searchList("directory/department-name",t.var_default_search_payload).then((function(e){t.departmentNames=e.data.list})).catch((function(t){console.log(t)}));case 3:return e.next=5,p["a"].getCuratorsForDepartment().then((function(e){t.curators=e.data})).catch((function(t){console.log(t)}));case 5:return e.next=7,m["a"].searchList("directory/department-type",t.var_default_search_payload).then((function(e){t.types=e.data.list})).catch((function(t){console.log(t)}));case 7:return e.next=9,p["a"].getRefByCode("status").then((function(e){t.statuses=e.data.children;var a=t.statuses.find((function(t){return"ACTIVE"==t.code}));a&&!t.editingItem.id&&(t.editingItem.statusId=a.id)})).catch((function(t){console.log(t)}));case 9:case"end":return e.stop()}}),e)})))()},editSimpleDep:function(t){var e=this;return Object(c["a"])(Object(o["a"])().mark((function a(){return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.selectedDepType="simple",e.editingItem=Object.assign({},t),e.createOrUpdateModal=!0,e.loadingSimpleDepInfo=!0,a.next=6,e.getSimpleDepInfo();case 6:e.loadingSimpleDepInfo=!1;case 7:case"end":return a.stop()}}),a)})))()},createDepByDepType:function(){var t=this;return Object(c["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.currentDep.inn){e.next=14;break}if("simple"!=t.selectedDepType){e.next=11;break}return t.editingItem=Object.assign({},{}),t.editingItem.parentId=t.currentDep.id,t.createOrUpdateModal=!0,t.loadingSimpleDepInfo=!0,e.next=8,t.getSimpleDepInfo();case 8:t.loadingSimpleDepInfo=!1,e.next=12;break;case 11:"legal"==t.selectedDepType&&t.$router.push({name:"CreateDepartment",params:{parentDepId:t.currentDep.id}});case 12:e.next=22;break;case 14:return t.selectedDepType="simple",t.editingItem=Object.assign({},{}),t.editingItem.parentId=t.currentDep.id,t.createOrUpdateModal=!0,t.loadingSimpleDepInfo=!0,e.next=21,t.getSimpleDepInfo();case 21:t.loadingSimpleDepInfo=!1;case 22:case"end":return e.stop()}}),e)})))()},deleteItem:function(t){var e=this,a=this.$createElement;t.id&&this.$bvModal.msgBoxConfirm(a("h5",[this.$t("messages.delete_title")," ",a("b",["(",t.shortName,")"])]),{okTitle:this.$t("actions.confirm"),cancelTitle:this.$t("actions.cancel")}).then((function(a){a&&m["a"].deleteById(u,t.id).then((function(a){e.fetchItems(),t.id==e.activeDep.departmentDto.id&&(e.activeDep=Object.assign({},{departmentDto:{},contractorDto:{}}))})).catch((function(t){console.log(t)}))})).catch((function(t){}))},editItem:function(t){t.id&&(t.inn?this.$router.push({name:"UpdateDepartment",params:{id:t.id}}):this.editSimpleDep(t))},fetchItems:function(){var t=this;m["a"].searchList("department",this.var_default_search_payload,null,!0).then((function(e){t.departments=[],e.data.id&&t.departments.push(e.data)})).catch((function(t){console.log(t)}))},giveActiveClassToDep:function(t,e){var a,n=Object(i["a"])(t);try{for(n.s();!(a=n.n()).done;){var s=a.value;s.id==e?document.getElementById("depId-".concat(e)).classList.add("active"):document.getElementById("depId-".concat(s.id)).classList.remove("active"),s.children&&s.children.length>0&&this.giveActiveClassToDep(s.children,e)}}catch(r){n.e(r)}finally{n.f()}},toggleDepTypeModalAndSetCurrentDep:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.currentDep=e?Object.assign({},t):Object.assign({},{}),t.inn?this.depTypeModal=e:e&&(this.selectedDepType="simple",this.createDepByDepType())},deleteDepartment:function(){},toggleActiveClass:function(t){var e=this;t.inn?m["a"].getById("department",t.id).then((function(a){e.activeDep=Object.assign({},a.data),e.giveActiveClassToDep(e.departments,t.id)})).catch((function(t){console.log(t)})):(this.activeDep.departmentDto=Object.assign({},t),this.giveActiveClassToDep(this.departments,t.id))}},created:function(){var t=this;return Object(c["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.fetchItems();case 2:case"end":return e.stop()}}),e)})))()}},v=b,h=(a("11b5"),a("2877")),f=Object(h["a"])(v,s,r,!1,null,"f6df4a12",null);e["default"]=f.exports},"7db0":function(t,e,a){"use strict";var n=a("23e7"),s=a("b727").find,r=a("44d2"),i="find",o=!0;i in[]&&Array(1)[i]((function(){o=!1})),n({target:"Array",proto:!0,forced:o},{find:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),r(i)},8468:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("d9e2");function n(t){if(null==t)throw new TypeError("Cannot destructure "+t)}},"846d":function(t,e,a){}}]);