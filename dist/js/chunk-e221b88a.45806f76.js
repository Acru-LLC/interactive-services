(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e221b88a"],{"0b8d":function(e,t,s){"use strict";s("f885")},"74bd":function(e,t,s){"use strict";s.r(t);s("99af");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-12 text-center"},[t("div",{staticClass:"h4 mb-4 d-inline-block"},[e._v(e._s(e.$t("submodules.users.outer_users_title")))])]),t("div",{staticClass:"col-xl-4"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-body"},[t("div",{staticClass:"d-flex align-items-center justify-content-between mb-4"},[t("h3",{staticClass:"card-title mb-0 org-str-title"},[e._v(e._s(e.$t("not_translated.organizational_structure")))])]),e.departments.length>0?t("ul",{staticStyle:{"list-style-type":"none"}},[e._l(e.departments,(function(s){return[t("org-str-tree-view",{key:s.id+"dep",staticClass:"item",attrs:{"without-add-action":"","without-edit-action":"","department-for-tree":s},on:{deleteClicked:e.deleteOuterDepartment,toggleActiveClass:e.toggleActiveClass}})]}))],2):[t("h5",[e._v("Ҳозирча бўлинмалар қўшилмаган")])]],2)])]),t("div",{staticClass:"col-xl-8"},[t("div",{staticClass:"card fixed-user-employee-list-card"},[t("div",{staticClass:"card-body"},[t("div",{staticClass:"row mb-2"},[t("div",{staticClass:"col-sm-4"}),t("div",{staticClass:"col-sm-4"},[t("div",{staticClass:"text-center"},[t("h4",[e._v(e._s("employees"==e.activeTab?e.$t("submodules.employees.personal_info"):e.$t("submodules.users.outer_users_title")))])])]),e._m(0),t("div",{staticClass:"col-12"},[t("b-tabs",{attrs:{justified:"","nav-class":"nav-tabs-custom","content-class":"p-3 text-muted"},model:{value:e.activeTabIndex,callback:function(t){e.activeTabIndex=t},expression:"activeTabIndex"}},[t("b-tab",{staticStyle:{"max-height":"50vh",overflow:"auto"},attrs:{active:""},on:{click:function(t){return e.fetchItemsByActiveTab("employees")}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"d-inline-block d-sm-none"},[t("i",{staticClass:"fas fa-home"})]),t("span",{staticClass:"d-none d-sm-inline-block"},[e._v(e._s(e.$t("submodules.employees.personal_info")))])]},proxy:!0}])},[t("b-table",{staticClass:"custom-b-table max-height-40",attrs:{items:e.employees,fields:e.employeeHeaders,busy:e.loadingTableItems,"sticky-header":"sticky-header",id:"employees-table",responsive:"",striped:"",bordered:"",small:"",hover:"","show-empty":""},on:{"update:busy":function(t){e.loadingTableItems=t}},scopedSlots:e._u([{key:"cell(index)",fn:function(t){return[e._v(" "+e._s(e.util_paginate(t.index,e.searchPayloadEmployees.page,e.searchPayloadEmployees.itemsPerPage))+" ")]}},{key:"cell(fullName)",fn:function(t){return[e._v(" "+e._s(t.item.firstName)+" "+e._s(t.item.lastName)+" "+e._s(t.item.middleName?t.item.middleName:"")+" ")]}},{key:"cell(status)",fn:function(t){return[e._v(" "+e._s(t.item.statusNameUz)+" ")]}},{key:"cell(actions)",fn:function(s){return[t("div",{staticClass:"general-table__actions d-flex justify-content-center"},[t("b-btn",{staticClass:"text-decoration-none p-0",staticStyle:{"font-size":"1.2rem","margin-right":"1rem"},attrs:{variant:"link"}},[t("i",{staticClass:"mdi mdi-circle-edit-outline edit",on:{click:function(t){return e.editItem(s.item.id,"employees")}}})]),t("b-btn",{staticClass:"text-decoration-none p-0 text-danger",staticStyle:{"font-size":"1.2rem"},attrs:{variant:"link"}},[t("i",{staticClass:"mdi mdi-trash-can delete",on:{click:function(t){return e.deleteItem(s.item.id,"employees")}}})])],1)]}},{key:"empty",fn:function(){return[t("h4",{staticClass:"text-center"},[e._v(e._s(e.activeDep.id?e.$t("not_found"):e.$t("choose_department")))])]},proxy:!0},{key:"table-busy",fn:function(){return[t("div",{staticClass:"text-center my-2"},[t("b-spinner",{staticClass:"align-middle",attrs:{variant:"primary"}})],1)]},proxy:!0}])}),t("b-pagination",{staticClass:"justify-content-end",attrs:{"total-rows":e.totalEmployees,"per-page":e.searchPayloadEmployees.itemsPerPage,"aria-controls":"my-table"},model:{value:e.searchPayloadEmployees.page,callback:function(t){e.$set(e.searchPayloadEmployees,"page",t)},expression:"searchPayloadEmployees.page"}})],1),t("b-tab",{staticStyle:{"max-height":"50vh",overflow:"auto"},on:{click:function(t){return e.fetchItemsByActiveTab("users")}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"d-inline-block d-sm-none"},[t("i",{staticClass:"far fa-user"})]),t("span",{staticClass:"d-none d-sm-inline-block"},[e._v(e._s(e.$t("submodules.users.outer_users_title")))])]},proxy:!0}])},[t("b-table",{staticClass:"custom-b-table",attrs:{items:e.users,fields:e.userHeaders,busy:e.loadingTableItems,id:"users-table",responsive:"",striped:"",bordered:"",small:"",hover:"","show-empty":""},on:{"update:busy":function(t){e.loadingTableItems=t}},scopedSlots:e._u([{key:"cell(index)",fn:function(t){return[e._v(" "+e._s(e.util_paginate(t.index,e.searchPayloadUsers.page,e.searchPayloadUsers.itemsPerPage))+" ")]}},{key:"cell(roleNames)",fn:function(s){return[t("div",{staticClass:"d-flex justify-content-between"},e._l(s.item.roleNames,(function(s,a){return t("p",{key:"".concat(s,"-").concat(a),staticClass:"mb-0",staticStyle:{"flex-basis":"0","flex-grow":"1","font-size":".95rem"}},[t("span",{staticClass:"badge bg-primary badge-pill"},[e._v(e._s(s))])])})),0)]}},{key:"cell(status)",fn:function(s){return[t("p",{staticClass:"mb-0",staticStyle:{"font-size":".95rem"}},[t("span",{class:["badge","ACTIVE"==s.item.statusUz?"bg-success":"DELETED"==s.item.statusUz?"bg-danger":"bg-info"]},[e._v(e._s(s.item.statusUz))])])]}},{key:"cell(actions)",fn:function(s){return[t("div",{staticClass:"general-table__actions d-flex justify-content-center"},["DELETED"!=s.item.statusUz?t("b-btn",{staticClass:"text-decoration-none p-0",staticStyle:{"font-size":"1.2rem","margin-right":"1rem"},attrs:{variant:"link"}},[t("i",{staticClass:"mdi mdi-circle-edit-outline edit",on:{click:function(t){return e.editItem(s.item.id,"users")}}})]):e._e(),"DELETED"!=s.item.statusUz?t("b-btn",{staticClass:"text-decoration-none p-0 text-danger",staticStyle:{"font-size":"1.2rem"},attrs:{variant:"link"}},[t("i",{staticClass:"mdi mdi-trash-can delete",on:{click:function(t){return e.deleteItem(s.item.id,"users")}}})]):e._e()],1)]}},{key:"empty",fn:function(){return[t("h4",{staticClass:"text-center"},[e._v(e._s(e.activeDep.id?e.$t("not_found"):e.$t("choose_department")))])]},proxy:!0},{key:"table-busy",fn:function(){return[t("div",{staticClass:"text-center my-2"},[t("b-spinner",{staticClass:"align-middle",attrs:{variant:"primary"}})],1)]},proxy:!0}])}),t("b-pagination",{staticClass:"justify-content-end",attrs:{"total-rows":e.totalUsers,"per-page":e.searchPayloadUsers.itemsPerPage,"aria-controls":"my-table"},model:{value:e.searchPayloadUsers.page,callback:function(t){e.$set(e.searchPayloadUsers,"page",t)},expression:"searchPayloadUsers.page"}})],1)],1)],1)])])])])])},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"col-sm-4"},[t("div",{staticClass:"text-sm-end"})])}],n=s("c7eb"),c=s("1da1"),l=s("b85c"),o=s("5530"),r=(s("a4d3"),s("e01a"),s("14d9"),s("d3b7"),s("2f62")),d=s("7476"),u=s("c2a4"),m=s("a6fd"),p=s("03f4"),f=s("887a"),h="user",y="employee",b={page:{title:"Users and Employees",meta:[{name:"description",content:u.description}]},components:{OrgStrTreeView:m["a"]},data:function(){return{title:"Users and Employees",activeDep:{},loadingTableItems:!1,activeTabIndex:0,departments:[],users:[],totalUsers:0,employees:[],totalEmployees:0,searchPayloadEmployees:{},searchPayloadUsers:{}}},computed:Object(o["a"])(Object(o["a"])({},Object(r["d"])("managementUsersAndEmployees",["userHeaders","employeeHeaders"])),{},{activeTab:function(){return 0==this.activeTabIndex?"employees":1==this.activeTabIndex?"users":""},userInfo:function(){return d["a"].getUserInfo()}}),methods:{fetchDepartments:function(){var e=this;p["a"].searchList("department",this.var_default_search_payload,"by-contractor",!0).then((function(t){e.departments=t.data})).catch((function(e){console.log(e)}))},deleteOuterDepartment:function(e){var t=this,s=this.$createElement;e.id&&this.$bvModal.msgBoxConfirm(s("h5",[this.$t("messages.delete_title")," ",s("b",["(",e.shortName,")"])]),{okTitle:this.$t("actions.confirm"),cancelTitle:this.$t("actions.cancel")}).then((function(s){s&&p["a"].deleteById("department",e.id).then((function(s){t.fetchDepartments(),e.id==t.activeDep.id&&(t.activeDep=Object.assign({},{}))})).catch((function(e){console.log(e)}))})).catch((function(e){}))},deleteItem:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeTab;this.$bvModal.msgBoxConfirm("Are you sure?",{okTitle:this.$t("actions.confirm"),cancelTitle:this.$t("actions.cancel")}).then((function(a){a&&("employees"==s?p["a"].deleteById(y,e).then((function(e){t.fetchItemsByActiveTab()})).catch((function(e){console.log(e)})):"users"==s&&p["a"].deleteById(h,e).then((function(s){t.userInfo.id==e&&t.$store.dispatch("auth/logout"),t.fetchItemsByActiveTab()})).catch((function(e){console.log(e)})))})).catch((function(e){}))},editItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeTab;this.$router.push("users"==t?{name:"UpdateOuterUser",params:{id:e}}:"employees"==t?{name:"UpdateOuterEmployee",params:{id:e}}:this.$toast("Илтимос табни қайта босинг ва яна уриниб кўринг",{type:"info"}))},fetchItemsByActiveTab:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeTab;if(this.activeDep.id)if("employees"==t){this.loadingTableItems=!0;var s=this.searchPayloadEmployees;this.employees=[],this.totalEmployees=0,f["a"].searchEmployeesByDep(s,this.activeDep.id).then((function(t){e.employees=t.data.list,e.totalEmployees=t.data.total})).catch((function(e){console.log(e)})).finally((function(){e.loadingTableItems=!1}))}else if("users"==t){this.loadingTableItems=!0;var a={data:this.searchPayloadUsers,depId:this.activeDep.id};this.users=[],this.totalUsers=0,p["a"].searchByDepId(h,a).then((function(t){e.users=t.data.list,e.totalUsers=t.data.total})).catch((function(e){console.log(e)})).finally((function(){e.loadingTableItems=!1}))}},giveActiveClassToDep:function(e,t){var s,a=Object(l["a"])(e);try{for(a.s();!(s=a.n()).done;){var i=s.value;i.id==t?document.getElementById("depId-".concat(t)).classList.add("active"):document.getElementById("depId-".concat(i.id)).classList.remove("active"),i.children&&i.children.length>0&&this.giveActiveClassToDep(i.children,t)}}catch(n){a.e(n)}finally{a.f()}},showRefModal:function(){},toggleActiveClass:function(e){this.activeDep=Object.assign({},e),this.giveActiveClassToDep(this.departments,e.id)}},created:function(){var e=this;return Object(c["a"])(Object(n["a"])().mark((function t(){return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchItemsByActiveTab();case 2:return t.next=4,e.fetchDepartments();case 4:e.searchPayloadEmployees=Object.assign({},e.var_default_search_payload),e.searchPayloadUsers=Object.assign({},e.var_default_search_payload);case 6:case"end":return t.stop()}}),t)})))()},watch:{activeDep:{deep:!0,handler:function(){this.fetchItemsByActiveTab()}}}},v=b,g=(s("0b8d"),s("2877")),_=Object(g["a"])(v,a,i,!1,null,"7e934a0f",null);t["default"]=_.exports},f885:function(e,t,s){}}]);