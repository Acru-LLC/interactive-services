(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a3bf30c"],{"555c":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("base-create-or-update-wrapper",{attrs:{"has-save-suspend":"","custom-title":e.isModeCreate?e.$t("actions.create"):e.$t("actions.update")},on:{save:e.save}},[t("CreateApplicationByPhysical",{ref:"formApplicationByPhysical"})],1)},i=[],a=n("c7eb"),s=n("1da1"),o=(n("b0c0"),n("d3b7"),n("d81d"),n("3ca3"),n("ddb0"),n("328c")),c=n("03f4"),p="before-commission/application",l={name:"CreateOrUpdatePhysical",components:{CreateApplicationByPhysical:o["default"]},data:function(){return{}},computed:{isModeCreate:function(){return"CreateApplicationByLegal"===this.$route.name},computedObserver:function(){return this.$refs.formApplicationByPhysical.$refs.observer}},methods:{hasProjectOwner:function(){if(this.$refs.formApplicationByPhysical.editingItem.assignments){var e=!1;e:for(var t=0;t<this.$refs.formApplicationByPhysical.editingItem.assignments.length;t++)for(var n=0;n<this.$refs.formApplicationByPhysical.editingItem.assignments[t].toEmployees.length;n++)if(this.$refs.formApplicationByPhysical.editingItem.assignments[t].toEmployees[n].isProjectOwner){e=!0;break e}return e}return!1},treeClosed:function(e){this.computedObserver.refs[e].validate()},normalizer:function(e){return e.children&&0!==e.children.length?{id:e.id,label:e.name,children:e.children&&e.children.length>0?e.children:[]}:(delete e.children,{id:e.id,label:e.name})},getBase64:function(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))},returnBase64FilePromises:function(){var e=this;return Object(s["a"])(Object(a["a"])().mark((function t(){return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.formApplicationByPhysical.editingItem.applicationFiles){t.next=4;break}return t.next=3,e.$refs.formApplicationByPhysical.editingItem.applicationFiles.map(function(){var t=Object(s["a"])(Object(a["a"])().mark((function t(n){return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.file.dataURL){t.next=4;break}return t.abrupt("return",{name:n.file.name,base64:n.file.dataURL});case 4:return t.t0=n.file.name,t.next=7,e.getBase64(n.file);case 7:return t.t1=t.sent,t.abrupt("return",{name:t.t0,base64:t.t1});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:return t.abrupt("return",t.sent);case 4:return t.abrupt("return",[]);case 5:case"end":return t.stop()}}),t)})))()},save:function(){var e=this;return Object(s["a"])(Object(a["a"])().mark((function t(){return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.computedObserver.validate().then(function(){var t=Object(s["a"])(Object(a["a"])().mark((function t(n){var r;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n||!e.hasProjectOwner()){t.next=12;break}if(e.$refs.formApplicationByPhysical.editingItem.type="PHYSICAL",!e.$refs.formApplicationByPhysical.editingItem.id){t.next=6;break}c["a"].update(p,e.$refs.formApplicationByPhysical.editingItem).then((function(t){e.computedObserver.reset(),e.$refs.formApplicationByPhysical.editingItem=Object.assign({},{}),e.$router.go(-1),e.$toast(e.$t("messages.saved_successfully"),{type:"success"})})),t.next=10;break;case 6:return t.next=8,e.returnBase64FilePromises();case 8:r=t.sent,Promise.all(r).then((function(t){if(e.$refs.formApplicationByPhysical.editingItem.applicationFiles=t,e.$refs.formApplicationByPhysical.editingItem.assignments){var n=e.$refs.formApplicationByPhysical.editingItem.assignments;e.$refs.formApplicationByPhysical.editingItem.assignmentParticipantList=n.map((function(e){return{dateOfCreated:e.dateOfCreated,fromDepartmentId:e.fromEmployee.departmentId,fromEmployeeId:e.fromEmployee.employeeId,fromPositionId:e.fromEmployee.positionId,fromUserId:e.fromEmployee.id,resolution:"",sendingAssignmentParticipantList:e.toEmployees.map((function(t){return{mailingPurposeId:t.mailingPurposeId,processId:e.processId,toDepartmentId:t.toEmployee.departmentId,toEmployeeId:t.toEmployee.employeeId,toPositionId:t.toEmployee.positionId,toUserId:t.toEmployee.id,isProjectOwner:t.isProjectOwner}}))}})),e.$refs.formApplicationByPhysical.editingItem.assignments=null}c["a"].create(p,e.$refs.formApplicationByPhysical.editingItem,null,!0).then((function(t){e.computedObserver.reset(),e.$refs.formApplicationByPhysical.editingItem=Object.assign({},{}),e.$router.go(-1),e.$toast(e.$t("messages.saved_successfully"),{type:"success"})}))}));case 10:t.next=13;break;case 12:e.$toast(e.$t("messages.fill_required_fields"),{type:"error"});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()}},created:function(){return Object(s["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},u=l,f=(n("b91b"),n("2877")),m=Object(f["a"])(u,r,i,!1,null,"d2482a2e",null);t["default"]=m.exports},"9ab3":function(e,t,n){},b91b:function(e,t,n){"use strict";n("9ab3")}}]);