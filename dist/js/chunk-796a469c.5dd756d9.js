(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-796a469c"],{"4c9d":function(t,e,a){t.exports=a.p+"img/map-marker-red.bdd6639c.png"},"690e":function(t,e,a){},9326:function(t,e,a){t.exports=a.p+"img/map-marker-green.e21de593.png"},a54a:function(t,e,a){"use strict";a("690e")},bea1:function(t,e,a){"use strict";a.r(e);a("b0c0"),a("d81d"),a("ac1f"),a("841c"),a("a4d3"),a("e01a");var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"col-md-12 text-center"},[e("div",{staticClass:"h4 mb-4 d-inline-block"},[t._v(t._s(t.$t("submodules.ad_monitoring.title")))])]),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body p-0"},[e("div",{staticClass:"row p-4"},[e("div",{staticClass:"col-12 col-sm-6 col-md-4 col-lg-2 d-flex align-items-end"},[e("BaseInputWithValidation",{attrs:{"not-required":"","validation-provider-custom-style":"width: 100%;","label-on-top":"",label:t.$t("column.name")},model:{value:t.filterPayload.name,callback:function(e){t.$set(t.filterPayload,"name",e)},expression:"filterPayload.name"}})],1),e("div",{staticClass:"col-12 col-sm-6 col-md-5 col-lg-3 d-flex align-items-end"},[e("BaseMultiselectWithValidation",{staticStyle:{width:"100%"},attrs:{"not-required":"",multiple:"","has-next-page":t.hasNextPageContractors,searchable:!0,"preserve-search":"","clear-on-select":!1,"close-on-select":!1,loading:t.isLoadingContractors,"internal-search":!1,options:t.contractors.map((function(t){return t.id})),"hide-selected":!0,label:t.$t("submodules.contractor.title"),"label-on-top":"",placeholder:"","custom-label":t.customLabelContractor,"open-direction":"bottom","max-height":600,"show-labels":!1},on:{reachedEndOfList:t.contractorReachedEndOfList,"search-change":t.debounceSearchContractors},model:{value:t.filterPayload.contractorIds,callback:function(e){t.$set(t.filterPayload,"contractorIds",e)},expression:"filterPayload.contractorIds"}})],1),e("div",{staticClass:"col-12 col-sm-6 col-md-4 col-lg-3 d-flex align-items-end"},[e("BaseMultiselectWithValidation",{staticStyle:{width:"100%"},attrs:{"not-required":"",multiple:"",options:t.regions.map((function(t){return t.regionId})),"hide-selected":!0,"close-on-select":!1,label:t.$t("column.region"),"label-on-top":"",placeholder:"","custom-label":t.customLabelRegion,"open-direction":"bottom","max-height":600,"show-labels":!1},model:{value:t.filterPayload.regionIds,callback:function(e){t.$set(t.filterPayload,"regionIds",e)},expression:"filterPayload.regionIds"}})],1),e("div",{staticClass:"col-12 col-sm-6 col-md-4 col-lg-2 d-flex align-items-end"},[e("BaseMultiselectWithValidation",{staticStyle:{width:"100%"},attrs:{"not-required":"",multiple:"",options:t.districts.map((function(t){return t.id})),"hide-selected":!0,"close-on-select":!1,label:t.$t("column.district"),"label-on-top":"",placeholder:"","custom-label":t.customLabelDistrict,"open-direction":"bottom","max-height":600,"show-labels":!1},model:{value:t.filterPayload.districtIds,callback:function(e){t.$set(t.filterPayload,"districtIds",e)},expression:"filterPayload.districtIds"}})],1),e("div",{staticClass:"col-12 col-sm-6 col-md-4 col-lg-2 d-flex align-items-end"},[e("b-button",{staticClass:"me-2",attrs:{variant:"primary",size:"sm"},on:{click:t.search}},[e("i",{staticClass:"mdi mdi-magnify font-size-20 align-middle"})]),e("b-button",{attrs:{variant:"warning",size:"sm"},on:{click:t.resetFilter}},[e("i",{staticClass:"mdi mdi-refresh font-size-20 align-middle"})])],1)]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("v-map",{ref:"leafletMap",staticClass:"leaflet-map-container",attrs:{zoom:t.zoom,center:t.center}},[e("v-tilelayer",{attrs:{url:t.url,attribution:t.attribution}}),e("v-locatecontrol"),t.geoJsonLoaded?e("v-marker-cluster",{attrs:{options:t.clusterOptions}},t._l(t.adMarkers,(function(a,r){return e("v-marker",{key:a.id,ref:"marker-".concat(r),refInFor:!0,attrs:{"lat-lng":a.latlng,icon:a.icon},on:{click:function(e){return t.getAdDetails(a,r)}}},[e("v-popup",{ref:"ad-details-popup-".concat(a.id),refInFor:!0},[a.details?[e("div",{staticClass:"ad-details-wrapper"},[e("h4",{staticClass:"m-0 mb-1"},[t._v(" "+t._s(t.$t("submodules.flour_stations.name"))+" - "),e("strong",[e("i",[t._v(t._s(t.currentAdDetails.name))])])]),e("b-row",[e("b-col",{staticClass:"p-0 d-md-block",attrs:{cols:"12"}},[e("table",{staticClass:"ad-details"},[e("tbody",[e("tr",[e("th",{attrs:{rowspan:"8",width:"10%"}},[t._v(t._s(t.$t("submodules.flour_stations.name"))+" ")])]),e("tr",[e("th",{attrs:{scope:"row",width:"10%"}},[t._v(t._s(t.$t("column.construction.owner"))+" ")]),e("td",{attrs:{colspan:"2"}},[t._v(t._s(t.currentAdDetails.contractorName))])]),e("tr",[e("th",{attrs:{scope:"row",width:"10%"}},[t._v(t._s(t.$t("column.construction.owner_inn"))+" ")]),e("td",{attrs:{colspan:"2"}},[t._v(t._s(t.currentAdDetails.inn))])]),e("tr",[e("th",{attrs:{scope:"row",width:"10%"}},[t._v(t._s(t.$t("column.construction.phone_number"))+" ")]),e("td",{attrs:{colspan:"2"}},[t._v(t._s(t.currentAdDetails.contractorPhoneNumber))])]),e("tr",[e("th",{attrs:{scope:"row",width:"10%"}},[t._v(t._s(t.$t("column.construction.owner_address"))+" ")]),e("td",{attrs:{colspan:"2"}},[t._v(t._s(t.currentAdDetails.contractorAddressRegionNameUz)+", "+t._s(t.currentAdDetails.contractorAddressDistrictNameUz)+" "+t._s(t.currentAdDetails.contractorAdditionalAddress?" ,"+t.currentAdDetails.contractorAdditionalAddress:"")+" ")])]),e("tr",[e("th",{attrs:{scope:"row",width:"10%"}},[t._v(t._s(t.$t("column.address"))+" ")]),e("td",{attrs:{colspan:"2"}},[t._v(" "+t._s(t.getName({nameRu:t.currentAdDetails.addressDto.regionNameRu,nameLt:t.currentAdDetails.addressDto.regionNameLt,nameUz:t.currentAdDetails.addressDto.regionNameUz}))+", "+t._s(t.getName({nameRu:t.currentAdDetails.addressDto.districtNameRu,nameLt:t.currentAdDetails.addressDto.districtNameLt,nameUz:t.currentAdDetails.addressDto.districtNameUz}))),t.currentAdDetails.addressDto.quarterNameUz||t.currentAdDetails.addressDto.additional?e("span",[t._v(",")]):t._e(),t._v(" "+t._s(t.currentAdDetails.addressDto.quarterNameUz?t.getName({nameRu:t.currentAdDetails.addressDto.quarterNameRu,nameLt:t.currentAdDetails.addressDto.quarterNameLt,nameUz:t.currentAdDetails.addressDto.quarterNameUz}):"")+" ")])]),e("tr",[e("th",{attrs:{scope:"row",width:"10%"}},[t._v(t._s(t.$t("column.orienter"))+" ")]),e("td",{attrs:{colspan:"2"}},[t._v(" "+t._s(t.currentAdDetails.addressDto.additional?t.currentAdDetails.addressDto.additional:"")+" ")])]),e("tr",[e("th",{attrs:{scope:"row",width:"10%"}},[t._v(t._s(t.$t("column.comment"))+" ")]),e("td",{attrs:{colspan:"2"}},[t._v(" "+t._s(t.currentAdDetails.description)+" ")])]),e("tr",[e("th",{attrs:{colspan:"4"}})]),e("tr",[e("th",{attrs:{scope:"row",width:"10%"}},[t._v(t._s(t.$t("column.created_by"))+" ")]),e("td",{attrs:{colspan:"2"}},[e("p",{staticClass:"p-0 m-0"},[t._v(" "+t._s(t.currentAdDetails.createdByEmployeeFullName?t.currentAdDetails.createdByEmployeeFullName+" "+(t.currentAdDetails.createdByDirectoryPositionNameUz?"("+t.currentAdDetails.createdByDirectoryPositionNameUz+", "+t.$t("auth.username")+" - "+t.currentAdDetails.createdByUserName+")":""):t.$t("auth.username")+" - "+t.currentAdDetails.createdByUserName)+" "),e("br"),e("i",[t._v(t._s(t.currentAdDetails.createdDate))])])])]),e("tr",[e("th",{attrs:{scope:"row",width:"10%"}},[t._v(t._s(t.$t("column.last_modified_by"))+" ")]),e("td",{attrs:{colspan:"2"}},[e("p",{staticClass:"p-0 m-0"},[t._v(t._s(t.currentAdDetails.updatedByEmployeeFullName?t.currentAdDetails.updatedByEmployeeFullName+" "+(t.currentAdDetails.updatedByDirectoryPositionNameUz?"("+t.currentAdDetails.updatedByDirectoryPositionNameUz+", "+t.$t("auth.username")+" - "+t.currentAdDetails.updatedByUserName+")":""):t.$t("auth.username")+" - "+t.currentAdDetails.updatedByUserName)+" "),e("br"),t._v(" "),e("i",[t._v(t._s(t.currentAdDetails.updatedDate))])])])])])])])],1)],1)]:[e("h4",{staticClass:"m-0"},[e("strong",[t._v(t._s(t.$t("submodules.flour_stations.name")))])]),e("div",{staticClass:"ad-details-wrapper"},[e("b-row",[e("b-col",{staticClass:"p-0 d-none d-lg-block",attrs:{cols:"12"}},[e("b-skeleton-table",{attrs:{rows:7,columns:4,"table-props":{bordered:!0}}})],1),e("b-col",{staticClass:"p-0 d-none d-md-block d-lg-none",attrs:{cols:"12"}},[e("b-skeleton-table",{attrs:{rows:10,columns:4,"table-props":{bordered:!0}}})],1),e("b-col",{staticClass:"p-0 d-sm-block d-md-none",attrs:{cols:"12"}},[e("b-skeleton-table",{attrs:{rows:11,columns:4,"table-props":{bordered:!0}}})],1)],1)],1)]],2)],1)})),1):t._e()],1)],1)])])])])])},n=[],s=a("2909"),o=a("c7eb"),i=a("1da1"),c=(a("d3b7"),a("159b"),a("14d9"),a("7db0"),a("03f4")),l=a("887a"),d=a("2699"),u=a("a40a"),m=a("4e2b"),p=a("f60f"),h=a("ca9f"),f=a.n(h),b=a("e977"),g=a.n(b),v=a("e11e"),y=a.n(v),_=a("33d1"),w="flour",D=y.a.Icon.extend({options:{shadowUrl:null,iconAnchor:new y.a.Point(19,12),iconSize:new y.a.Point(40,37),iconUrl:a("4c9d")}}),A=(y.a.Icon.extend({options:{shadowUrl:null,iconAnchor:new y.a.Point(19,12),iconSize:new y.a.Point(24,30),iconUrl:a("9326")}}),y.a.Icon.extend({options:{shadowUrl:null,iconAnchor:new y.a.Point(12,12),iconSize:new y.a.Point(24,30),iconUrl:a("4fad0")}})),k={name:"MonitoringAdvertisementConstructions",components:{"v-map":d["a"],"v-tilelayer":u["a"],"v-marker-cluster":f.a,"v-marker":m["a"],"v-popup":p["a"],"v-locatecontrol":g.a},created:function(){var t=this;this.contractorSearchPayload=Object.assign({},this.var_default_search_payload),this.var_default_search_payload.itemsPerPage=500,this.geoJsonLoaded=!0,this.search(),this.fetchContractors(),l["a"].fetchRegionsForFlourByCurrentUserId().then((function(e){t.regions=e.data})).catch((function(t){console.log(t)}))},mounted:function(){var t=this;this.$nextTick((function(){t.map=t.$refs.leafletMap.mapObject;var e=new _["geosearch"]({providers:[_["arcgisOnlineProvider"]({apikey:"AAPK9acf37860a924037b15132e490ddc20eOLJx7XB1eMCSpCz9GHsYDLeibbVI0Fzzh31h1N9b_cN7OIAYryLzBxkJ5NBwI03l"})],useMapBounds:!1,placeholder:t.$t("column.search")}).addTo(t.map),a=t;e.on("results",(function(t){t.results[0]&&a.addSearchResultMarker(t.results[0])}))}))},data:function(){return{searchResultMarker:null,slide:0,sliding:null,currentAdDetails:{},currentAdImgs:[],strForImgs:"",publicPath:"/",adDesignTypes:[],districts:[],regions:[],contractorSearchPayload:{},hasNextPageContractors:!1,contractors:[],debounce:null,isLoadingContractors:!1,initialFilterPayload:{name:"",contractorIds:[],regionIds:[],districtIds:[]},filterPayload:{name:"",contractorIds:[],regionIds:[],districtIds:[]},adMarkers:[],map:null,zoom:6,center:y.a.latLng(41.381166,64.5735819),url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',clusterOptions:{disableClusteringAtZoom:18,chunkedLoading:!0},geoJsonLoaded:!1}},methods:{addSearchResultMarker:function(t){this.searchResultMarker&&this.map.removeLayer(this.searchResultMarker);var e=this;this.searchResultMarker=new y.a.Marker(t.latlng,{icon:new A}).addTo(this.map).on("click",(function(t){e.map.removeLayer(e.searchResultMarker)}))},onSlideStart:function(t){this.sliding=!0},onSlideEnd:function(t){this.sliding=!1},getAdDetails:function(t,e){var a=this;t.details?this.currentAdDetails=Object.assign({},this.adMarkers[e].details):c["a"].getById(w,t.id).then((function(t){a.currentAdImgs=null,a.$set(a.adMarkers[e],"details",t.data),a.currentAdDetails=Object.assign({},a.adMarkers[e].details)})).catch((function(t){a.$set(a.adMarkers[e],"details",res.data),a.currentAdDetails=Object.assign({},a.adMarkers[e].details),console.log(t)}))},resetFilter:function(){this.filterPayload=Object.assign({},this.initialFilterPayload),this.search(),this.map.setView(this.center,this.zoom)},search:function(){var t=this;l["a"].getFlourStationsForMap(this.filterPayload,!0).then((function(e){t.adMarkers=[],e.data.forEach((function(e){t.adMarkers.push({id:e.id,latlng:y.a.latLng(e.latNumber,e.lngNumber),text:"<h1><u><font color='red'>"+e.pointTypeKey+"</h1></u></font><h2>Address: "+e.address+"</h2><p>feature.properties.Description</p><p> Website:feature.properties.URL</p><br><center><img src='"+a("d6f9")+"' style='width:200px;height:300x;'>",icon:new D})}))})).catch((function(t){console.log(t)}))},customLabelAdDesignType:function(t){var e=this.adDesignTypes.find((function(e){return e.id==(t.id?t.id:t)}));return e?"".concat(this.getName({nameRu:e.nameRu,nameLt:e.nameLt,nameUz:e.nameUz})):""},customLabelDistrict:function(t){var e=this.districts.find((function(e){return e.id==t}));return e?"".concat(this.getName({nameRu:e.nameRu,nameLt:e.nameLt,nameUz:e.nameUz})):""},customLabelRegion:function(t){var e=this.regions.find((function(e){return e.regionId==(t.regionId?t.regionId:t)}));return e?"".concat(this.getName({nameRu:e.regionNameRu,nameLt:e.regionNameLt,nameUz:e.regionNameUz})):""},regionSelected:function(t){var e=arguments,a=this;return Object(i["a"])(Object(o["a"])().mark((function r(){var n;return Object(o["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=e.length>1&&void 0!==e[1]&&e[1],n||(a.filterPayload.districtIds=[]),!t||!t.length){r.next=5;break}return r.next=5,l["a"].getGeoLocationsByMultipleParentIds(t).then((function(t){a.districts=t.data})).catch((function(t){console.log(t)}));case 5:case"end":return r.stop()}}),r)})))()},customLabelContractor:function(t){var e=this.contractors.find((function(e){return e.id==t}));return e?"".concat(e.fullName):""},debounceSearchContractors:function(t){var e=arguments,a=this;return Object(i["a"])(Object(o["a"])().mark((function r(){var n;return Object(o["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=e.length>1&&void 0!==e[1]?e[1]:"",clearTimeout(a.debounce),a.debounce=setTimeout(Object(i["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.fetchContractorsWithKeyword(t,n);case 2:case"end":return e.stop()}}),e)}))),1e3);case 3:case"end":return r.stop()}}),r)})))()},fetchContractorsWithKeyword:function(t,e){this.contractors=[],this.contractorSearchPayload.page=1,this.contractorSearchPayload.keyword=t||"","contractor"==e&&this.fetchContractors()},fetchContractors:function(){var t=this;return Object(i["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoadingContractors=!0,e.next=3,c["a"].searchListWithKeyword("contractor",t.contractorSearchPayload,"by-contractor").then((function(e){var a;(a=t.contractors).push.apply(a,Object(s["a"])(e.data.list)),t.hasNextPageContractors=e.data.total/t.contractorSearchPayload.itemsPerPage>t.contractorSearchPayload.page,t.contractorSearchPayload.page+=1})).catch((function(e){console.log(e),t.contractors=[]})).finally((function(){t.isLoadingContractors=!1}));case 3:case"end":return e.stop()}}),e)})))()},contractorReachedEndOfList:function(t){t&&this.fetchContractors()}},watch:{"filterPayload.regionIds":{handler:function(t,e){this.regionSelected(t)}}}},x=k,C=(a("a54a"),a("2877")),P=Object(C["a"])(x,r,n,!1,null,"59122727",null);e["default"]=P.exports},ca9f:function(t,e,a){(function(e,r){t.exports=r(a("e11e"),a("2573"),a("bb3f"))})(0,(function(t,e,r){return function(t){function e(r){if(a[r])return a[r].exports;var n=a[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var a={};return e.m=t,e.c=a,e.i=function(t){return t},e.d=function(t,a,r){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=7)}([function(t,e,a){var r=a(2)(a(1),a(3),null,null);t.exports=r.exports},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(5),n=a(6),s=a(4),o={options:{type:Object,default:function(){return{}}}};e.default={props:o,data:function(){return{ready:!1}},mounted:function(){var t=this;this.mapObject=new r.MarkerClusterGroup(this.options),s.DomEvent.on(this.mapObject,this.$listeners),(0,n.propsBinder)(this,this.mapObject,o),this.ready=!0,this.parentContainer=(0,n.findRealParent)(this.$parent),this.parentContainer.addLayer(this),this.$nextTick((function(){t.$emit("ready",t.mapObject)}))},beforeDestroy:function(){this.parentContainer.removeLayer(this)},methods:{addLayer:function(t,e){e||this.mapObject.addLayer(t.mapObject)},removeLayer:function(t,e){e||this.mapObject.removeLayer(t.mapObject)}}}},function(t,e){t.exports=function(t,e,a,r){var n,s=t=t||{},o=typeof t.default;"object"!==o&&"function"!==o||(n=t,s=t.default);var i="function"==typeof s?s.options:s;if(e&&(i.render=e.render,i.staticRenderFns=e.staticRenderFns),a&&(i._scopeId=a),r){var c=i.computed||(i.computed={});Object.keys(r).forEach((function(t){var e=r[t];c[t]=function(){return e}}))}return{esModule:n,exports:s,options:i}}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticStyle:{display:"none"}},[t.ready?t._t("default"):t._e()],2)},staticRenderFns:[]}},function(t,e){t.exports=a("e11e")},function(t,e){t.exports=a("2573")},function(t,e){t.exports=a("bb3f")},function(t,e,a){t.exports=a(0)}])}))},d6f9:function(t,e,a){t.exports=a.p+"img/maintenance.2ab0d119.png"}}]);