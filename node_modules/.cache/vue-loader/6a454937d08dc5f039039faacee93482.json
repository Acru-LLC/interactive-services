{"remainingRequest":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\references\\modules\\price-stock\\region-name\\CreateOrUpdate.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\references\\modules\\price-stock\\region-name\\CreateOrUpdate.vue","mtime":1675054786282},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1675061970665},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1675061970715}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgY3J1ZEFuZExpc3RTZXJ2aWNlIGZyb20gIkAvc2hhcmVkL3NlcnZpY2VzL2NydWRfYW5kX2xpc3Quc2VydmljZSI7DQoNCmNvbnN0IE1BSU5fQVBJX1VSTCA9ICdwcmljZS9zdG9jay9yZWdpb24tbmFtZScNCi8qKiBZT1UgTVVTVCBTRU5EIHt7IE1BSU5fQVBJX1VSTCB9fSBUTyBDUlVEX1NFUlZJQ0UgKi8NCmltcG9ydCBjcnVkQW5kTGlzdHNTZXJ2aWNlIGZyb20gIkAvc2hhcmVkL3NlcnZpY2VzL2NydWRfYW5kX2xpc3Quc2VydmljZSINCmltcG9ydCBoZWxwZXJTZXJ2aWNlIGZyb20gIkAvc2hhcmVkL3NlcnZpY2VzL2hlbHBlci5zZXJ2aWNlIg0KDQpleHBvcnQgZGVmYXVsdCB7DQogIC8qKiBEQVRBICovDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGVtcHR5OiB7fSwNCiAgICAgIGl0ZW1zOiBbXSwNCiAgICAgIHJlZ2lvbkxpc3Q6IFtdDQogICAgfQ0KICB9LA0KICAvKiogQ09NUFVURUQgKi8NCiAgY29tcHV0ZWQ6IHsNCiAgICBpc01vZGVDcmVhdGUoKSB7DQogICAgICByZXR1cm4gdGhpcy4kcm91dGUubmFtZSA9PT0gJ1JlZmVyZW5jZXNQcmljZVN0b2NrUmVnaW9uTmFtZUNyZWF0ZScNCiAgICB9LA0KICAgIGNvbXB1dGVkT2JzZXJ2ZXIoKSB7DQogICAgICByZXR1cm4gdGhpcy4kcmVmcy5vYnNlcnZlcg0KICAgIH0NCiAgfSwNCiAgLyoqIE1FVEhPRFMgKi8NCiAgbWV0aG9kczogew0KICAgIHRyZWVDbG9zZWQodmVlTmFtZSkgew0KICAgICAgdGhpcy5jb21wdXRlZE9ic2VydmVyLnJlZnNbdmVlTmFtZV0udmFsaWRhdGUoKTsNCiAgICB9LA0KICAgIGN1c3RvbUxhYmVsUmVnaW9uTGlzdCAob3B0KSB7DQogICAgICBsZXQgc2VsZWN0ZWQgPSB0aGlzLnJlZ2lvbkxpc3QuZmluZChlID0+IGUuaWQgPT09IChvcHQuaWQgPyBvcHQuaWQgOiBvcHQpKTsNCiAgICAgIGlmIChzZWxlY3RlZCkgew0KICAgICAgICByZXR1cm4gdGhpcy5nZXROYW1lKHsNCiAgICAgICAgICBuYW1lUnU6IHNlbGVjdGVkLm5hbWVSdSwNCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwNCiAgICAgICAgICBuYW1lVXo6IHNlbGVjdGVkLm5hbWVVeiwNCiAgICAgICAgfSkNCiAgICAgIH0NCiAgICAgIHJldHVybiAnJzsNCiAgICB9LA0KICAgIHNhdmUoKSB7DQogICAgICB0aGlzLmNvbXB1dGVkT2JzZXJ2ZXIudmFsaWRhdGUoKS50aGVuKCBhc3luYyB2YWxpZCA9PiB7DQogICAgICAgIGlmICh2YWxpZCkgew0KICAgICAgICAgIGlmICh0aGlzLml0ZW1zLmlkKSB7DQogICAgICAgICAgICB0aGlzLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgICAgIGNydWRBbmRMaXN0c1NlcnZpY2UudXBkYXRlKE1BSU5fQVBJX1VSTCwgaXRlbSwgJycsIHRydWUpLnRoZW4ocmVzID0+IHt9KQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICAgICAgICBjcnVkQW5kTGlzdHNTZXJ2aWNlLmNyZWF0ZShNQUlOX0FQSV9VUkwsIGl0ZW0sICcnLCB0cnVlKS50aGVuKHJlcyA9PiB7fSkNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMuY29tcHV0ZWRPYnNlcnZlci5yZXNldCgpDQogICAgICAgICAgdGhpcy5pdGVtcyA9IFtdOw0KICAgICAgICAgIHRoaXMuJHJvdXRlci5nbygtMSkNCiAgICAgICAgICB0aGlzLiR0b2FzdCh0aGlzLiR0KCdtZXNzYWdlcy5zYXZlZF9zdWNjZXNzZnVsbHknKSwgeyB0eXBlOiAnc3VjY2VzcycgfSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy4kdG9hc3QodGhpcy4kdCgnbWVzc2FnZXMuZmlsbF9yZXF1aXJlZF9maWVsZHMnKSwgeyB0eXBlOiAnZXJyb3InIH0pOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KICAgIGFkZE5ld0xpbmUoKXsNCiAgICAgIHRoaXMuaXRlbXMucHVzaCh7IC4uLnRoaXMuZW1wdHkgfSkNCiAgICB9LA0KICAgIHJlbW92ZUxpbmUoaW5kZXgpew0KICAgICAgdGhpcy5pdGVtcy5zcGxpY2UoaW5kZXgsIDEpDQogICAgfSwNCiAgICBmZXRjaFJlZ2lvbnMoc2VhcmNoID0gJycpew0KICAgICAgaGVscGVyU2VydmljZS5mZXRjaFJlZ2lvbnModHJ1ZSkNCiAgICAgICAgICAudGhlbigoeyBkYXRhIH0pID0+IHsNCiAgICAgICAgICAgIHRoaXMucmVnaW9uTGlzdCA9IGRhdGENCiAgICAgICAgICB9KQ0KICAgICAgICAgIC5jYXRjaChlID0+IHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpDQogICAgICAgICAgfSkNCiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7DQogICAgICAgICAgICB0aGlzLmxvYWRpbmdUYWJsZUl0ZW1zID0gZmFsc2UNCiAgICAgICAgICB9KQ0KICAgIH0sDQogICAgaGFuZGxlU2VhcmNoUmVnaW9uKGEsYixjKXsNCiAgICAgIGNvbnNvbGUubG9nKGEsYixjKQ0KICAgIH0sDQogIH0sDQogIC8qKiBDUkVBVEVEICovDQogIGFzeW5jIGNyZWF0ZWQoKSB7DQogICAgdGhpcy52YXJfZGVmYXVsdF9zZWFyY2hfcGF5bG9hZC5pdGVtc1BlclBhZ2UgPSA1MDANCiAgICBhd2FpdCBjcnVkQW5kTGlzdHNTZXJ2aWNlLmdldEVtcHR5KE1BSU5fQVBJX1VSTCkNCiAgICAgICAgLnRoZW4oKHsgZGF0YSB9KSA9PiB7DQogICAgICAgICAgdGhpcy5lbXB0eSA9IGRhdGENCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKGUgPT4gew0KICAgICAgICAgIGNvbnNvbGUubG9nKGUpDQogICAgICAgIH0pDQogICAgaWYgKHRoaXMuaXNNb2RlQ3JlYXRlKSB7DQogICAgICB0aGlzLmFkZE5ld0xpbmUoKQ0KICAgIH0gZWxzZSB7DQogICAgICBhd2FpdCBjcnVkQW5kTGlzdHNTZXJ2aWNlLmdldEJ5SWQoTUFJTl9BUElfVVJMLCB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQsIGZhbHNlKQ0KICAgICAgICAgIC50aGVuKCh7IGRhdGEgfSkgPT4gew0KICAgICAgICAgICAgdGhpcy5pdGVtcyA9IFtkYXRhXQ0KICAgICAgICAgICAgY29uc3QgZXhpc3QgPSB0aGlzLnJlZ2lvbkxpc3QuZmluZChlID0+IGUuaWQgPT09IGRhdGEucmVnaW9uSWQpDQogICAgICAgICAgICBpZiAoIWV4aXN0KSB7DQogICAgICAgICAgICAgIGNydWRBbmRMaXN0U2VydmljZS5nZXRCeUlkKCdnZW9ncmFwaGljYWwtcmVnaW9uJywgZGF0YS5yZWdpb25JZCkudGhlbigoeyBkYXRhIH0pID0+IHsNCiAgICAgICAgICAgICAgICB0aGlzLnJlZ2lvbkxpc3QucHVzaChkYXRhKQ0KICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pDQogICAgICAgICAgLmNhdGNoKGUgPT4gew0KICAgICAgICAgICAgY29uc29sZS5sb2coZSkNCiAgICAgICAgICB9KQ0KICAgIH0NCiAgICB0aGlzLmZldGNoUmVnaW9ucygpDQogIH0NCn0NCg=="},{"version":3,"sources":["CreateOrUpdate.vue"],"names":[],"mappings":";AA2DA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CreateOrUpdate.vue","sourceRoot":"src/modules/references/modules/price-stock/region-name","sourcesContent":["<template>\r\n  <base-create-or-update-wrapper\r\n      @save=\"save\"\r\n      has-save-suspend\r\n      :custom-title=\"isModeCreate ? $t('actions.create') : $t('actions.update')\"\r\n  >\r\n    <ValidationObserver ref=\"observer\" v-slot=\"{}\">\r\n      <b-row class=\"mb-1\">\r\n        <b-col sm=\"11\">\r\n          <b-row class=\"mb-1\">\r\n            <b-col sm=\"4\">{{ $t('column.connected_region') }}</b-col>\r\n            <b-col sm=\"8\">{{ $t('submodules.integration.price_stock.region_name') }}</b-col>\r\n          </b-row>\r\n        </b-col>\r\n        <b-col sm=\"1\">\r\n          <b-btn v-if=\"isModeCreate\" variant=\"success\" @click=\"addNewLine\">\r\n            <i class=\"fa fa-plus\"></i>\r\n          </b-btn>\r\n        </b-col>\r\n      </b-row>\r\n      <b-row class=\"mb-1\" v-for=\"(item, key) in items\" :key=\"key\">\r\n        <b-col sm=\"11\">\r\n          <b-row class=\"mb-1\">\r\n            <b-col sm=\"4\">\r\n              <BaseInputWithValidation\r\n                  rules=\"required\"\r\n                  v-model=\"item.spRegionName\"\r\n                  label-on-top\r\n                  label=\"\"\r\n                  :placeholder=\"''\"\r\n              />\r\n            </b-col>\r\n            <b-col sm=\"8\">\r\n              <BaseMultiselectWithValidation\r\n                  v-model=\"item.regionId\"\r\n                  rules=\"required\"\r\n                  placeholder=\"\"\r\n                  label-on-top\r\n                  open-direction=\"bottom\"\r\n                  :label=\"''\"\r\n                  :options=\"regionList.map(el => el.id)\"\r\n                  :searchable=\"true\"\r\n                  :show-labels=\"false\"\r\n                  :custom-label=\"customLabelRegionList\"\r\n                  @search-change=\"handleSearchRegion\"\r\n              />\r\n            </b-col>\r\n          </b-row>\r\n        </b-col>\r\n        <b-col sm=\"1\">\r\n          <b-btn v-if=\"isModeCreate\" variant=\"danger\" @click=\"removeLine(key)\">\r\n            <i class=\"fa fa-times\"></i>\r\n          </b-btn>\r\n        </b-col>\r\n      </b-row>\r\n    </ValidationObserver>\r\n  </base-create-or-update-wrapper>\r\n</template>\r\n<script>\r\nimport crudAndListService from \"@/shared/services/crud_and_list.service\";\r\n\r\nconst MAIN_API_URL = 'price/stock/region-name'\r\n/** YOU MUST SEND {{ MAIN_API_URL }} TO CRUD_SERVICE */\r\nimport crudAndListsService from \"@/shared/services/crud_and_list.service\"\r\nimport helperService from \"@/shared/services/helper.service\"\r\n\r\nexport default {\r\n  /** DATA */\r\n  data() {\r\n    return {\r\n      empty: {},\r\n      items: [],\r\n      regionList: []\r\n    }\r\n  },\r\n  /** COMPUTED */\r\n  computed: {\r\n    isModeCreate() {\r\n      return this.$route.name === 'ReferencesPriceStockRegionNameCreate'\r\n    },\r\n    computedObserver() {\r\n      return this.$refs.observer\r\n    }\r\n  },\r\n  /** METHODS */\r\n  methods: {\r\n    treeClosed(veeName) {\r\n      this.computedObserver.refs[veeName].validate();\r\n    },\r\n    customLabelRegionList (opt) {\r\n      let selected = this.regionList.find(e => e.id === (opt.id ? opt.id : opt));\r\n      if (selected) {\r\n        return this.getName({\r\n          nameRu: selected.nameRu,\r\n          nameLt: selected.nameLt,\r\n          nameUz: selected.nameUz,\r\n        })\r\n      }\r\n      return '';\r\n    },\r\n    save() {\r\n      this.computedObserver.validate().then( async valid => {\r\n        if (valid) {\r\n          if (this.items.id) {\r\n            this.items.forEach(item => {\r\n              crudAndListsService.update(MAIN_API_URL, item, '', true).then(res => {})\r\n            })\r\n          } else {\r\n            this.items.forEach(item => {\r\n              crudAndListsService.create(MAIN_API_URL, item, '', true).then(res => {})\r\n            })\r\n          }\r\n          this.computedObserver.reset()\r\n          this.items = [];\r\n          this.$router.go(-1)\r\n          this.$toast(this.$t('messages.saved_successfully'), { type: 'success' });\r\n        } else {\r\n          this.$toast(this.$t('messages.fill_required_fields'), { type: 'error' });\r\n        }\r\n      });\r\n    },\r\n    addNewLine(){\r\n      this.items.push({ ...this.empty })\r\n    },\r\n    removeLine(index){\r\n      this.items.splice(index, 1)\r\n    },\r\n    fetchRegions(search = ''){\r\n      helperService.fetchRegions(true)\r\n          .then(({ data }) => {\r\n            this.regionList = data\r\n          })\r\n          .catch(e => {\r\n            console.log(e)\r\n          })\r\n          .finally(() => {\r\n            this.loadingTableItems = false\r\n          })\r\n    },\r\n    handleSearchRegion(a,b,c){\r\n      console.log(a,b,c)\r\n    },\r\n  },\r\n  /** CREATED */\r\n  async created() {\r\n    this.var_default_search_payload.itemsPerPage = 500\r\n    await crudAndListsService.getEmpty(MAIN_API_URL)\r\n        .then(({ data }) => {\r\n          this.empty = data\r\n        })\r\n        .catch(e => {\r\n          console.log(e)\r\n        })\r\n    if (this.isModeCreate) {\r\n      this.addNewLine()\r\n    } else {\r\n      await crudAndListsService.getById(MAIN_API_URL, this.$route.params.id, false)\r\n          .then(({ data }) => {\r\n            this.items = [data]\r\n            const exist = this.regionList.find(e => e.id === data.regionId)\r\n            if (!exist) {\r\n              crudAndListService.getById('geographical-region', data.regionId).then(({ data }) => {\r\n                this.regionList.push(data)\r\n              })\r\n            }\r\n          })\r\n          .catch(e => {\r\n            console.log(e)\r\n          })\r\n    }\r\n    this.fetchRegions()\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.col-form-label {\r\n  padding-top: 0;\r\n}\r\n\r\nul {\r\n  list-style-type: none;\r\n}\r\n</style>"]}]}