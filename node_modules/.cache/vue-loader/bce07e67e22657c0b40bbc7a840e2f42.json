{"remainingRequest":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\advertisement\\modules\\ad_monitoring\\VanillaLeaflet.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\advertisement\\modules\\ad_monitoring\\VanillaLeaflet.vue","mtime":1675054786254},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1675061970665},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1675061970715}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBMTWFwIH0gZnJvbSAidnVlMi1sZWFmbGV0IjsNCmltcG9ydCBoZWxwZXJTZXJ2aWNlIGZyb20gJ0Avc2hhcmVkL3NlcnZpY2VzL2hlbHBlci5zZXJ2aWNlJw0KaW1wb3J0IEwgZnJvbSAibGVhZmxldCI7DQppbXBvcnQgTGVhZmxldE1hcmtlcmNsdXN0ZXIgZnJvbSAibGVhZmxldC5tYXJrZXJjbHVzdGVyIjsNCmltcG9ydCBzdG9yZSBmcm9tICJAL3N0YXRlL3N0b3JlIjsNCg0KaW1wb3J0ICJsZWFmbGV0L2Rpc3QvbGVhZmxldC5jc3MiOw0KaW1wb3J0ICJsZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvZGlzdC9NYXJrZXJDbHVzdGVyLmNzcyI7DQppbXBvcnQgImxlYWZsZXQubWFya2VyY2x1c3Rlci9kaXN0L01hcmtlckNsdXN0ZXIuRGVmYXVsdC5jc3MiOw0KaW1wb3J0IE1hcmtlckljb24gZnJvbSAibGVhZmxldC9kaXN0L2ltYWdlcy9tYXJrZXItaWNvbi5wbmciOw0KaW1wb3J0IFBvcHVwIGZyb20gIi4vUG9wdXAiOw0KaW1wb3J0IGNydWRBbmRMaXN0c1NlcnZpY2UgZnJvbSAiQC9zaGFyZWQvc2VydmljZXMvY3J1ZF9hbmRfbGlzdC5zZXJ2aWNlIjsNCmltcG9ydCB7IFRva2VuU2VydmljZSB9IGZyb20gIkAvc2hhcmVkL3NlcnZpY2VzL3N0b3JhZ2Uuc2VydmljZSI7DQoNCmNvbnN0IE1BSU5fQVBJX1VSTCA9ICdjb250cmFjdG9yLWFkdmVydGlzaW5nLWNvbnN0cnVjdGlvbicNCmV4cG9ydCBkZWZhdWx0IHsNCiAgY29tcG9uZW50czogew0KICAgICJ2LW1hcCI6IExNYXAsDQogICAgUG9wdXANCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLmluaXRNYXAoKTsNCiAgICBMZWFmbGV0TWFya2VyY2x1c3RlcjsNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZmlsdGVyUGF5bG9hZDogew0KICAgICAgICBwYXNzcG9ydE51bWJlcjogJycsDQogICAgICAgIGRlc2lnblR5cGVJZHM6ICcnLA0KICAgICAgICBjb250cmFjdG9ySWRzOiAnJywNCiAgICAgICAgZGlzdHJpY3RJZHM6ICcnLA0KICAgICAgICByZWdpb25JZHM6ICcnLA0KICAgICAgfSwNCiAgICAgIG1hcDogew0KICAgICAgICBzZWxmOiBudWxsLA0KICAgICAgICBtYXhab29tOiAxOSwNCiAgICAgICAgbWluWm9vbTogNiwNCiAgICAgICAgaW5pdFpvb206IDYsDQogICAgICAgIHZpZXc6IFs0MS41LCA2NC41XSwNCiAgICAgICAgYXR0cmlidXRpb246IFs0MS41LCA2NC41XSwNCiAgICAgICAgbWF4Qm91bmRzOiBbWzM3LCA1NV0sIFs0NiwgNzRdXSwNCiAgICAgICAgbWFya2VyczogbnVsbCwNCiAgICAgIH0sDQogICAgICBhZE1hcmtlcnM6IFtdLA0KICAgICAgYWRNYXJrZXJPYmplY3RzOiBbXSwNCiAgICAgIGFkRGVzaWduVHlwZXM6IFtdLA0KICAgICAgc2VhcmNoUmVzdWx0TWFya2VyOiBudWxsLA0KICAgICAgc2xpZGU6IDAsDQogICAgICBzbGlkaW5nOiBudWxsLA0KICAgICAgY3VycmVudEFkRGV0YWlsczoge30sDQogICAgICBjdXJyZW50QWRJbWdzOiBbXSwNCiAgICAgIHN0ckZvckltZ3M6ICcnLA0KICAgICAgcHVibGljUGF0aDogcHJvY2Vzcy5lbnYuQkFTRV9VUkwsDQogICAgICBkaXN0cmljdHM6IFtdLA0KICAgICAgcmVnaW9uczogW10sDQogICAgICBjb250cmFjdG9yU2VhcmNoUGF5bG9hZDoge30sDQogICAgICBoYXNOZXh0UGFnZUNvbnRyYWN0b3JzOiBmYWxzZSwNCiAgICAgIGNvbnRyYWN0b3JzOiBbXSwNCiAgICAgIGRlYm91bmNlOiBudWxsLA0KICAgICAgaXNMb2FkaW5nQ29udHJhY3RvcnM6IGZhbHNlLA0KICAgICAgaW5pdGlhbEZpbHRlclBheWxvYWQ6IHsNCiAgICAgICAgcGFzc3BvcnROdW1iZXI6ICcnLA0KICAgICAgICBjb250cmFjdG9ySWRzOiBbXSwNCiAgICAgICAgcmVnaW9uSWRzOiBbXSwNCiAgICAgICAgZGlzdHJpY3RJZHM6IFtdLA0KICAgICAgICBkZXNpZ25UeXBlSWRzOiBbXQ0KICAgICAgfSwNCiAgICAgIG1hcFBvcHVwOiB7DQogICAgICAgIGlkOiAnbWFwLXBvcHVwJywNCiAgICAgICAgc2hvdzogZmFsc2UsDQogICAgICAgIGVsZW1lbnQ6IHt9LA0KICAgICAgfSwNCiAgICB9Ow0KICB9LA0KICBhc3luYyBjcmVhdGVkKCkgew0KICAgIHN0b3JlLmNvbW1pdCgiU0VUX0dMT0JBTF9MT0FESU5HIiwgdHJ1ZSk7DQogICAgdGhpcy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZCA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMudmFyX2RlZmF1bHRfc2VhcmNoX3BheWxvYWQpDQogICAgdGhpcy52YXJfZGVmYXVsdF9zZWFyY2hfcGF5bG9hZC5pdGVtc1BlclBhZ2UgPSA1MDA7DQogICAgdGhpcy5zZWFyY2goKQ0KICAgIHN0b3JlLmNvbW1pdCgiU0VUX0dMT0JBTF9MT0FESU5HIiwgdHJ1ZSk7DQogICAgdGhpcy5mZXRjaENvbnRyYWN0b3JzKCkNCiAgICBzdG9yZS5jb21taXQoIlNFVF9HTE9CQUxfTE9BRElORyIsIHRydWUpOw0KICAgIHRoaXMuZmV0Y2hBZERlc2lnblR5cGVzKCkNCiAgICBzdG9yZS5jb21taXQoIlNFVF9HTE9CQUxfTE9BRElORyIsIHRydWUpOw0KICAgIHRoaXMuZmV0Y2hSZWdpb25zRm9yQWR2ZXJ0aXNlbWVudEJ5Q3VycmVudFVzZXJJZCgpDQogICAgc3RvcmUuY29tbWl0KCJTRVRfR0xPQkFMX0xPQURJTkciLCBmYWxzZSk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBpbml0TWFwKCkgew0KICAgICAgY29uc3QgeyBtYXBPYmplY3QgfSA9IHRoaXMuJHJlZnMubWFwOw0KICAgICAgdGhpcy5tYXAuc2VsZiA9IG1hcE9iamVjdA0KICAgICAgY29uc3QgeyBzZWxmLCBtYXhab29tLCBtaW5ab29tLCBhdHRyaWJ1dGlvbiwgdmlldywgaW5pdFpvb20sIG1heEJvdW5kcyB9ID0gdGhpcy5tYXA7DQogICAgICBMLnRpbGVMYXllcignaHR0cHM6Ly97c30udGlsZS5vcGVuc3RyZWV0bWFwLm9yZy97en0ve3h9L3t5fS5wbmcnLCB7DQogICAgICAgIG1heFpvb206IG1heFpvb20sDQogICAgICAgIG1pblpvb206IG1pblpvb20sDQogICAgICAgIGF0dHJpYnV0aW9uOiBhdHRyaWJ1dGlvbiwNCiAgICAgIH0pLmFkZFRvKHNlbGYpOw0KICAgICAgc2VsZi5zZXRWaWV3KHZpZXcsIGluaXRab29tKTsNCiAgICAgIHNlbGYuc2V0TWF4Qm91bmRzKG1heEJvdW5kcyk7DQogICAgICB0aGlzLmhhbmRsZUFkZExheWVycygpOw0KICAgIH0sDQogICAgYXN5bmMgaGFuZGxlQWRkTGF5ZXJzKCkgew0KICAgICAgY29uc3QgeyBzZWxmIH0gPSB0aGlzLm1hcDsNCiAgICAgIGlmICh0aGlzLm1hcC5tYXJrZXJzKSB7DQogICAgICAgIHNlbGYucmVtb3ZlTGF5ZXIodGhpcy5tYXAubWFya2Vycyk7DQogICAgICB9DQogICAgICB0aGlzLm1hcC5tYXJrZXJzID0gTC5tYXJrZXJDbHVzdGVyR3JvdXAoew0KICAgICAgICBpY29uQ3JlYXRlRnVuY3Rpb246IChjbHVzdGVyKSA9PiB7DQogICAgICAgICAgcmV0dXJuIEwuZGl2SWNvbih7DQogICAgICAgICAgICBodG1sOiBjbHVzdGVyLmdldEFsbENoaWxkTWFya2VycygpLmxlbmd0aCwNCiAgICAgICAgICAgIGNsYXNzTmFtZTogJ2NsdXN0ZXItYmFyJywNCiAgICAgICAgICAgIGljb25TaXplOiBMLnBvaW50KDQwLCAzMCkNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSwNCiAgICAgIH0pOw0KICAgICAgdGhpcy5tYXAubWFya2Vycy5hZGRMYXllcnModGhpcy5hZE1hcmtlck9iamVjdHMpOw0KICAgICAgc2VsZi5hZGRMYXllcih0aGlzLm1hcC5tYXJrZXJzKTsNCiAgICB9LA0KICAgIGFzeW5jIGZldGNoUmVnaW9uc0ZvckFkdmVydGlzZW1lbnRCeUN1cnJlbnRVc2VySWQoKSB7DQogICAgICBpZiAodGhpcy5jdXJyZW50VXNlcklzT3V0ZXIpIHsNCiAgICAgICAgcmV0dXJuIFtdOw0KICAgICAgfQ0KICAgICAgYXdhaXQgaGVscGVyU2VydmljZS5mZXRjaFJlZ2lvbnNGb3JBZHZlcnRpc2VtZW50QnlDdXJyZW50VXNlcklkKCkNCiAgICAgICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgdGhpcy5yZWdpb25zID0gcmVzLmRhdGENCiAgICAgICAgICB9KQ0KICAgICAgICAgIC5jYXRjaChlID0+IHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpDQogICAgICAgICAgfSkNCiAgICB9LA0KICAgIGFzeW5jIGZldGNoQWREZXNpZ25UeXBlcygpIHsNCiAgICAgIGlmICghdGhpcy4kY2FuKCdsaXN0JywgJ2RpcmVjdG9yeSBhZHZlcnRpc2VtZW50IGRlc2lnbiB0eXBlIGJ5IGFjdGl2ZSBzdGF0dXMnKSkgew0KICAgICAgICByZXR1cm4gW107DQogICAgICB9DQogICAgICBhd2FpdCBoZWxwZXJTZXJ2aWNlDQogICAgICAgICAgLmdldEFkRGVzaWduVHlwZXNCeUFjdGl2ZVN0YXR1cygpDQogICAgICAgICAgLnRoZW4oKHJlcykgPT4gew0KICAgICAgICAgICAgdGhpcy5hZERlc2lnblR5cGVzID0gcmVzLmRhdGE7DQogICAgICAgICAgfSkNCiAgICAgICAgICAuY2F0Y2goZSA9PiB7DQogICAgICAgICAgICBjb25zb2xlLmxvZyhlKQ0KICAgICAgICAgIH0pDQogICAgfSwNCiAgICBjdXN0b21MYWJlbEFkRGVzaWduVHlwZShpZCkgew0KICAgICAgbGV0IHNlbGVjdGVkID0gdGhpcy5hZERlc2lnblR5cGVzLmZpbmQoZSA9PiBlLmlkID09PSBpZCk7DQogICAgICBpZiAoc2VsZWN0ZWQpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TmFtZShzZWxlY3RlZCkNCiAgICAgIH0NCiAgICAgIHJldHVybiAnJzsNCiAgICB9LA0KICAgIHJlc2V0RmlsdGVyKCkgew0KICAgICAgdGhpcy5maWx0ZXJQYXlsb2FkID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5pbml0aWFsRmlsdGVyUGF5bG9hZCkNCiAgICAgIHRoaXMuc2VhcmNoKCkNCiAgICAgIHRoaXMubWFwLnNlbGYuc2V0Vmlldyh0aGlzLm1hcC52aWV3LCB0aGlzLm1hcC56b29tKTsNCiAgICB9LA0KICAgIHNlYXJjaCgpIHsNCiAgICAgIGhlbHBlclNlcnZpY2UuZ2V0QWRDb25zdHJ1Y3Rpb25zRm9yTWFwKHRoaXMuZmlsdGVyUGF5bG9hZCwgdHJ1ZSkNCiAgICAgICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgdGhpcy5hZE1hcmtlcnMgPSByZXMuZGF0YQ0KICAgICAgICAgICAgdGhpcy5hZE1hcmtlck9iamVjdHMgPSBbXQ0KICAgICAgICAgICAgbGV0IGxpc3QgPSBbXTsNCiAgICAgICAgICAgIHJlcy5kYXRhLmZvckVhY2goKGVsZW1lbnQsIGluZGV4KSA9PiB7DQogICAgICAgICAgICAgIGlmIChlbGVtZW50LmxhdE51bWJlciAmJiBlbGVtZW50LmxuZ051bWJlcikgew0KICAgICAgICAgICAgICAgIGxpc3QucHVzaChuZXcgTC5tYXJrZXIoW2VsZW1lbnQubGF0TnVtYmVyLCBlbGVtZW50LmxuZ051bWJlcl0sIHsNCiAgICAgICAgICAgICAgICAgIGljb246IEwuaWNvbih7DQogICAgICAgICAgICAgICAgICAgIGljb25Vcmw6IE1hcmtlckljb24sDQogICAgICAgICAgICAgICAgICAgIGljb25BbmNob3I6IG5ldyBMLlBvaW50KDEyLjUsIDQwKSwNCiAgICAgICAgICAgICAgICAgICAgaWNvblNpemU6IG5ldyBMLlBvaW50KDI1LCA0MSksDQogICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIH0pLm9uKCdjbGljaycsICgpID0+IHRoaXMuZ2V0QWREZXRhaWxzKHRoaXMuYWRNYXJrZXJzW2luZGV4XSwgaW5kZXgpKSkNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB0aGlzLmFkTWFya2VyT2JqZWN0cyA9IGxpc3Q7DQogICAgICAgICAgfSkNCiAgICAgICAgICAuY2F0Y2goZSA9PiB7DQogICAgICAgICAgICBjb25zb2xlLmxvZyhlKQ0KICAgICAgICAgIH0pDQogICAgfSwNCiAgICBhZGRTZWFyY2hSZXN1bHRNYXJrZXIoZSkgew0KICAgICAgaWYgKHRoaXMuc2VhcmNoUmVzdWx0TWFya2VyKSB7DQogICAgICAgIHRoaXMubWFwLnJlbW92ZUxheWVyKHRoaXMuc2VhcmNoUmVzdWx0TWFya2VyKQ0KICAgICAgfQ0KICAgICAgbGV0IHZtID0gdGhpcw0KICAgICAgdGhpcy5zZWFyY2hSZXN1bHRNYXJrZXIgPSBuZXcgTC5NYXJrZXIoZS5sYXRsbmcsIHsgaWNvbjogbmV3IE15Q3VzdG9tTWFya2VyRm9yU2VhcmNoKCkgfSkNCiAgICAgICAgICAuYWRkVG8odGhpcy5tYXApDQogICAgICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgICB2bS5tYXAucmVtb3ZlTGF5ZXIodm0uc2VhcmNoUmVzdWx0TWFya2VyKQ0KICAgICAgICAgIH0pOw0KICAgIH0sDQogICAgb25TbGlkZVN0YXJ0KHNsaWRlKSB7DQogICAgICB0aGlzLnNsaWRpbmcgPSB0cnVlDQogICAgfSwNCiAgICBvblNsaWRlRW5kKHNsaWRlKSB7DQogICAgICB0aGlzLnNsaWRpbmcgPSBmYWxzZQ0KICAgIH0sDQogICAgZ2V0QWREZXRhaWxzKGFkSW5mbywgaW5kZXgpIHsNCiAgICAgIC8vIGNvbnNvbGUubG9nKGFkSW5mbywgaW5kZXgpDQogICAgICAvLyBpZiAoIWFkSW5mby5kZXRhaWxzKSB7DQogICAgICB0aGlzLm1hcFBvcHVwLnNob3cgPSB0cnVlDQogICAgICBjcnVkQW5kTGlzdHNTZXJ2aWNlLmdldEJ5SWQoJ2NvbnRyYWN0b3ItYWR2ZXJ0aXNpbmctY29uc3RydWN0aW9uJywgYWRJbmZvLmlkKQ0KICAgICAgICAgIC50aGVuKHJlcyA9PiB7DQogICAgICAgICAgICB0aGlzLmN1cnJlbnRBZEltZ3MgPSBudWxsDQogICAgICAgICAgICBjcnVkQW5kTGlzdHNTZXJ2aWNlLmdldEJ5SWQoJ2NvbnRyYWN0b3ItYWR2ZXJ0aXNpbmctY29uc3RydWN0aW9uJywgYWRJbmZvLmlkLCBmYWxzZSwgbnVsbCwgJ3NlY29uZC1hZ2VudC1maWxlcycpDQogICAgICAgICAgICAgICAgLnRoZW4ocmVzRm9yRmlsZXMgPT4gew0KICAgICAgICAgICAgICAgICAgdGhpcy5tYXBQb3B1cC5lbGVtZW50ID0gYWRJbmZvDQogICAgICAgICAgICAgICAgICB0aGlzLm1hcFBvcHVwLmN1cnJlbnRBZERldGFpbHMgPSBhZEluZm8NCiAgICAgICAgICAgICAgICAgIHRoaXMuJGJ2TW9kYWwuc2hvdyh0aGlzLm1hcFBvcHVwLmlkKTsNCiAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEFkSW1ncyA9IHJlc0ZvckZpbGVzLmRhdGEub2JqZWN0UGhvdG9MaXN0DQogICAgICAgICAgICAgICAgICBpZiAocmVzRm9yRmlsZXMuZGF0YS5wYXNzcG9ydFBob3RvVXJsICYmIHJlc0ZvckZpbGVzLmRhdGEucGFzc3BvcnRQaG90b1VybC51cmwpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50QWRJbWdzLnB1c2gocmVzRm9yRmlsZXMuZGF0YS5wYXNzcG9ydFBob3RvVXJsKQ0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgdGhpcy4kc2V0KHRoaXMuYWRNYXJrZXJzW2luZGV4XSwgJ2RldGFpbHMnLCByZXMuZGF0YS5jb250cmFjdG9yQWR2ZXJ0aXNpbmdDb25zdHJ1Y3Rpb25Gb3JTZWNvbmRBZ2VudER0bykNCiAgICAgICAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmFkTWFya2Vyc1tpbmRleF0sICdpbWdzJywgdGhpcy5jdXJyZW50QWRJbWdzKQ0KICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50QWREZXRhaWxzID0gdGhpcy5hZE1hcmtlcnNbaW5kZXhdLmRldGFpbHMNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIC5jYXRjaChlID0+IHsNCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpDQogICAgICAgICAgICAgICAgICB0aGlzLiRzZXQodGhpcy5hZE1hcmtlcnNbaW5kZXhdLCAnZGV0YWlscycsIHJlcy5kYXRhLmNvbnRyYWN0b3JBZHZlcnRpc2luZ0NvbnN0cnVjdGlvbkZvclNlY29uZEFnZW50RHRvKQ0KICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50QWREZXRhaWxzID0gdGhpcy5hZE1hcmtlcnNbaW5kZXhdLmRldGFpbHMNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgIH0pDQogICAgICAgICAgLmNhdGNoKGUgPT4gew0KICAgICAgICAgICAgY29uc29sZS5sb2coZSkNCiAgICAgICAgICB9KQ0KICAgICAgLy8gfSBlbHNlIHsNCiAgICAgIC8vICAgdGhpcy4kYnZNb2RhbC5zaG93KHRoaXMubWFwUG9wdXAuaWQpOw0KICAgICAgLy8gICB0aGlzLmN1cnJlbnRBZEltZ3MgPSBhZEluZm8uaW1ncw0KICAgICAgLy8gICB0aGlzLm1hcFBvcHVwLmVsZW1lbnQgPSBhZEluZm8NCiAgICAgIC8vICAgdGhpcy5tYXBQb3B1cC5jdXJyZW50QWREZXRhaWxzID0gYWRJbmZvDQogICAgICAvLyAgIHRoaXMuY3VycmVudEFkRGV0YWlscyA9IHRoaXMuYWRNYXJrZXJzW2luZGV4XS5kZXRhaWxzDQogICAgICAvLyB9DQogICAgfSwNCiAgICBjdXN0b21MYWJlbERpc3RyaWN0KG9wdCkgew0KICAgICAgbGV0IHNlbGVjdGVkID0gdGhpcy5kaXN0cmljdHMuZmluZChlID0+IGUuaWQgPT09IG9wdCk7DQogICAgICBpZiAoc2VsZWN0ZWQpIHsNCiAgICAgICAgcmV0dXJuIGAke3RoaXMuZ2V0TmFtZSh7DQogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsDQogICAgICAgICAgbmFtZUx0OiBzZWxlY3RlZC5uYW1lTHQsDQogICAgICAgICAgbmFtZVV6OiBzZWxlY3RlZC5uYW1lVXosDQogICAgICAgIH0pDQogICAgICAgIH1gDQogICAgICB9DQogICAgICByZXR1cm4gYGA7DQogICAgfSwNCiAgICBjdXN0b21MYWJlbFJlZ2lvbihvcHQpIHsNCiAgICAgIGxldCBzZWxlY3RlZCA9IHRoaXMucmVnaW9ucy5maW5kKGUgPT4gZS5yZWdpb25JZCA9PT0gKG9wdC5yZWdpb25JZCA/IG9wdC5yZWdpb25JZCA6IG9wdCkpOw0KICAgICAgaWYgKHNlbGVjdGVkKSB7DQogICAgICAgIHJldHVybiBgJHt0aGlzLmdldE5hbWUoew0KICAgICAgICAgIG5hbWVSdTogc2VsZWN0ZWQucmVnaW9uTmFtZVJ1LA0KICAgICAgICAgIG5hbWVMdDogc2VsZWN0ZWQucmVnaW9uTmFtZUx0LA0KICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQucmVnaW9uTmFtZVV6LA0KICAgICAgICB9KQ0KICAgICAgICB9YA0KICAgICAgfQ0KICAgICAgcmV0dXJuIGBgOw0KICAgIH0sDQogICAgYXN5bmMgcmVnaW9uU2VsZWN0ZWQoJGV2ZW50LCBkb250UmVzZXREaXN0cmljdCA9IGZhbHNlKSB7DQogICAgICBpZiAoIWRvbnRSZXNldERpc3RyaWN0KSB7DQogICAgICAgIHRoaXMuZmlsdGVyUGF5bG9hZC5kaXN0cmljdElkcyA9IFtdDQogICAgICB9DQogICAgICBpZiAoJGV2ZW50ICYmICRldmVudC5sZW5ndGgpIHsNCiAgICAgICAgLy8gR0VUIERJU1RSSUNUUw0KICAgICAgICBhd2FpdCBoZWxwZXJTZXJ2aWNlLmdldEdlb0xvY2F0aW9uc0J5TXVsdGlwbGVQYXJlbnRJZHMoJGV2ZW50KQ0KICAgICAgICAgICAgLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICAgICAgdGhpcy5kaXN0cmljdHMgPSByZXMuZGF0YQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC5jYXRjaChlID0+IHsNCiAgICAgICAgICAgICAgY29uc29sZS5sb2coZSkNCiAgICAgICAgICAgIH0pDQogICAgICB9DQogICAgfSwNCiAgICBjdXN0b21MYWJlbENvbnRyYWN0b3Iob3B0KSB7DQogICAgICBsZXQgc2VsZWN0ZWQgPSB0aGlzLmNvbnRyYWN0b3JzLmZpbmQoZSA9PiBlLmlkID09PSBvcHQpOw0KICAgICAgaWYgKHNlbGVjdGVkKSB7DQogICAgICAgIHJldHVybiBgJHtzZWxlY3RlZC5mdWxsTmFtZX1gDQogICAgICB9DQogICAgICByZXR1cm4gYGA7DQogICAgfSwNCiAgICBhc3luYyBkZWJvdW5jZVNlYXJjaENvbnRyYWN0b3JzKHNlYXJjaFRleHQsIHNlbGVjdE5hbWUgPSAnJykgew0KICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuZGVib3VuY2UpOw0KICAgICAgdGhpcy5kZWJvdW5jZSA9IHNldFRpbWVvdXQoYXN5bmMgKCkgPT4gew0KICAgICAgICBhd2FpdCB0aGlzLmZldGNoQ29udHJhY3RvcnNXaXRoS2V5d29yZChzZWFyY2hUZXh0LCBzZWxlY3ROYW1lKTsNCiAgICAgIH0sIDEwMDApOw0KICAgIH0sDQogICAgZmV0Y2hDb250cmFjdG9yc1dpdGhLZXl3b3JkKGtleXdvcmQsIHNlbGVjdE5hbWUpIHsNCiAgICAgIHRoaXMuY29udHJhY3RvcnMgPSBbXQ0KICAgICAgdGhpcy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5wYWdlID0gMQ0KICAgICAgdGhpcy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5rZXl3b3JkID0ga2V5d29yZCA/IGtleXdvcmQgOiAnJw0KICAgICAgaWYgKHNlbGVjdE5hbWUgPT09ICdjb250cmFjdG9yJykgew0KICAgICAgICB0aGlzLmZldGNoQ29udHJhY3RvcnMoKQ0KICAgICAgfQ0KICAgIH0sDQogICAgYXN5bmMgZmV0Y2hDb250cmFjdG9ycygpIHsNCiAgICAgIGlmICghdGhpcy4kY2FuKCdsaXN0JywnY29udHJhY3RvcicpKSB7DQogICAgICAgIHJldHVybiBbXTsNCiAgICAgIH0NCiAgICAgIHRoaXMuaXNMb2FkaW5nQ29udHJhY3RvcnMgPSB0cnVlDQogICAgICBhd2FpdCBjcnVkQW5kTGlzdHNTZXJ2aWNlLnNlYXJjaExpc3RXaXRoS2V5d29yZCgnY29udHJhY3RvcicsIHRoaXMuY29udHJhY3RvclNlYXJjaFBheWxvYWQsICdieS1jb250cmFjdG9yJykNCiAgICAgICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgdGhpcy5jb250cmFjdG9ycy5wdXNoKC4uLnJlcy5kYXRhLmxpc3QpDQogICAgICAgICAgICB0aGlzLmhhc05leHRQYWdlQ29udHJhY3RvcnMgPSByZXMuZGF0YS50b3RhbCAvIHRoaXMuY29udHJhY3RvclNlYXJjaFBheWxvYWQuaXRlbXNQZXJQYWdlID4gdGhpcy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5wYWdlDQogICAgICAgICAgICB0aGlzLmNvbnRyYWN0b3JTZWFyY2hQYXlsb2FkLnBhZ2UgKz0gMQ0KICAgICAgICAgIH0pDQogICAgICAgICAgLmNhdGNoKGUgPT4gew0KICAgICAgICAgICAgY29uc29sZS5sb2coZSkNCiAgICAgICAgICAgIHRoaXMuY29udHJhY3RvcnMgPSBbXQ0KICAgICAgICAgIH0pDQogICAgICAgICAgLmZpbmFsbHkoKCkgPT4gew0KICAgICAgICAgICAgdGhpcy5pc0xvYWRpbmdDb250cmFjdG9ycyA9IGZhbHNlDQogICAgICAgICAgfSkNCiAgICB9LA0KICAgIGNvbnRyYWN0b3JSZWFjaGVkRW5kT2ZMaXN0KGUsIHNlbGVjdE5hbWUgPSAnJykgew0KICAgICAgaWYgKGUpIHsNCiAgICAgICAgdGhpcy5mZXRjaENvbnRyYWN0b3JzKCkNCiAgICAgIH0NCiAgICB9LA0KICB9LA0KICB3YXRjaDogew0KICAgICdmaWx0ZXJQYXlsb2FkLnJlZ2lvbklkcyc6IHsNCiAgICAgIGhhbmRsZXIobmV3VmFsLCBvbGRWYWwpIHsNCiAgICAgICAgdGhpcy5yZWdpb25TZWxlY3RlZChuZXdWYWwpOw0KICAgICAgfSwNCiAgICB9LA0KICAgIGFkTWFya2VyT2JqZWN0cygpIHsNCiAgICAgIHRoaXMuaGFuZGxlQWRkTGF5ZXJzKCk7DQogICAgfSwNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBjdXJyZW50VXNlcklzT3V0ZXIoKSB7DQogICAgICByZXR1cm4gVG9rZW5TZXJ2aWNlLmdldElzT3V0ZXIoKTsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["VanillaLeaflet.vue"],"names":[],"mappings":";AAoJA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"VanillaLeaflet.vue","sourceRoot":"src/modules/advertisement/modules/ad_monitoring","sourcesContent":["<template>\r\n  <div class=\"row\">\r\n    <div class=\"col-12\">\r\n      <div class=\"col-md-12 text-center\">\r\n        <div class=\"h4 mb-4 d-inline-block\">{{ $t('submodules.ad_monitoring.title') }}</div>\r\n      </div>\r\n      <div class=\"card\">\r\n        <div class=\"card-body p-0\">\r\n          <div class=\"row p-4\">\r\n            <div class=\"col-12 col-sm-6 col-md-4 col-lg-2 d-flex align-items-end\">\r\n              <BaseInputWithValidation\r\n                  not-required\r\n                  label-on-top\r\n                  v-model=\"filterPayload.passportNumber\"\r\n                  :label=\"$t('column.ad_construction_passport_number')\"\r\n              />\r\n            </div>\r\n            <div v-if=\"!currentUserIsOuter\" class=\"col-12 col-sm-6 col-md-4 col-lg-2 d-flex align-items-end\">\r\n              <BaseMultiselectWithValidation\r\n                  not-required\r\n                  v-model=\"filterPayload.contractorIds\"\r\n                  multiple\r\n                  :has-next-page=\"hasNextPageContractors\"\r\n                  @reachedEndOfList=\"contractorReachedEndOfList\"\r\n                  @search-change=\"debounceSearchContractors\"\r\n                  :searchable=\"true\"\r\n                  preserve-search\r\n                  :clear-on-select=\"false\"\r\n                  :close-on-select=\"false\"\r\n                  :loading=\"isLoadingContractors\"\r\n                  :internal-search=\"false\"\r\n                  :options=\"contractors.map(e => e.id)\"\r\n                  :hide-selected=\"true\"\r\n                  :label=\"$t('submodules.contractor.title')\"\r\n                  label-on-top\r\n                  style=\"width: 100%;\"\r\n                  placeholder=\"\"\r\n                  :custom-label=\"customLabelContractor\"\r\n                  open-direction=\"bottom\"\r\n                  :max-height=\"600\"\r\n                  :show-labels=\"false\"\r\n              />\r\n            </div>\r\n            <div v-if=\"!currentUserIsOuter\" class=\"col-12 col-sm-6 col-md-4 col-lg-2 d-flex align-items-end\">\r\n              <BaseMultiselectWithValidation\r\n                  not-required\r\n                  multiple\r\n                  v-model=\"filterPayload.regionIds\"\r\n                  :options=\"regions.map(e => e.regionId)\"\r\n                  :hide-selected=\"true\"\r\n                  :close-on-select=\"false\"\r\n                  :label=\"$t('column.region')\"\r\n                  label-on-top\r\n                  placeholder=\"\"\r\n                  :custom-label=\"customLabelRegion\"\r\n                  open-direction=\"bottom\"\r\n                  style=\"width: 100%;\"\r\n                  :max-height=\"600\"\r\n                  :show-labels=\"false\"\r\n              />\r\n            </div>\r\n            <div v-if=\"!currentUserIsOuter\" class=\"col-12 col-sm-6 col-md-4 col-lg-2 d-flex align-items-end\">\r\n              <BaseMultiselectWithValidation\r\n                  not-required\r\n                  multiple\r\n                  v-model=\"filterPayload.districtIds\"\r\n                  :options=\"districts.map(e => e.id)\"\r\n                  :hide-selected=\"true\"\r\n                  :close-on-select=\"false\"\r\n                  :label=\"$t('column.district')\"\r\n                  label-on-top\r\n                  placeholder=\"\"\r\n                  :custom-label=\"customLabelDistrict\"\r\n                  open-direction=\"bottom\"\r\n                  style=\"width: 100%;\"\r\n                  :max-height=\"600\"\r\n                  :show-labels=\"false\"\r\n              />\r\n            </div>\r\n            <div v-if=\"!currentUserIsOuter\" class=\"col-12 col-sm-6 col-md-4 col-lg-2 col-xl-3 d-flex align-items-end\">\r\n              <BaseMultiselectWithValidation\r\n                  not-required\r\n                  multiple\r\n                  v-model=\"filterPayload.designTypeIds\"\r\n                  :options=\"adDesignTypes.map(({id}) => id)\"\r\n                  :hide-selected=\"true\"\r\n                  :close-on-select=\"false\"\r\n                  :label=\"$t('column.ad_design_type')\"\r\n                  placeholder=\"\"\r\n                  label-on-top\r\n                  :custom-label=\"customLabelAdDesignType\"\r\n                  open-direction=\"bottom\"\r\n                  style=\"width: 100%;\"\r\n                  :max-height=\"600\"\r\n                  :show-labels=\"false\"\r\n              />\r\n            </div>\r\n            <div class=\"col-12 col-sm-6 col-md-4 col-lg-2 col-xl-1 d-flex align-items-end\">\r\n              <b-button\r\n                  variant=\"primary\"\r\n                  size=\"sm\"\r\n                  class=\"me-2\"\r\n                  @click=\"search\"\r\n              >\r\n                <i class=\"mdi mdi-magnify font-size-20 align-middle\"></i>\r\n              </b-button>\r\n              <b-button\r\n                  variant=\"warning\"\r\n                  size=\"sm\"\r\n                  @click=\"resetFilter\"\r\n              >\r\n                <i class=\"mdi mdi-refresh font-size-20 align-middle\"></i>\r\n              </b-button>\r\n            </div>\r\n          </div>\r\n          <div class=\"row\">\r\n            <div class=\"col-12\">\r\n              <v-map id=\"map\" ref=\"map\"></v-map>\r\n            </div>\r\n          </div>\r\n          <b-modal :id=\"mapPopup.id\" size=\"xl\" v-model=\"mapPopup.show\">\r\n            <template #modal-header v-if=\"!mapPopup.element.details\">\r\n              <h4 class=\"m-0\"><strong>{{ $t('submodules.ad_monitoring.ad_passport_details_title') }}</strong></h4>\r\n            </template>\r\n            <template #modal-title v-else>\r\n              <h4 class=\"m-0 mb-1 d-flex justify-content-between\">\r\n                <strong>{{ $t('submodules.ad_monitoring.ad_passport_details_title') }}</strong>\r\n                <strong v-if=\"currentAdDetails.isUzAvtoYul\" style=\"color: green;\">{{ $t('column.uzavtoyul') }}</strong>\r\n                <strong>{{ $t('column.number_sign') }}: {{ currentAdDetails.passportNumber }}</strong>\r\n              </h4>\r\n            </template>\r\n            <template #modal-footer>&nbsp;</template>\r\n            <popup v-if=\"mapPopup.show\"\r\n                   :currentAdDetails=\"currentAdDetails\"\r\n                   :element=\"mapPopup.element\"\r\n                   :publicPath=\"publicPath\"\r\n                   :currentAdImgs=\"currentAdImgs\"\r\n                   :onSlideStart=\"onSlideStart\"\r\n                   :onSlideEnd=\"onSlideEnd\"\r\n            ></popup>\r\n          </b-modal>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { LMap } from \"vue2-leaflet\";\r\nimport helperService from '@/shared/services/helper.service'\r\nimport L from \"leaflet\";\r\nimport LeafletMarkercluster from \"leaflet.markercluster\";\r\nimport store from \"@/state/store\";\r\n\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport \"leaflet.markercluster/dist/MarkerCluster.css\";\r\nimport \"leaflet.markercluster/dist/MarkerCluster.Default.css\";\r\nimport MarkerIcon from \"leaflet/dist/images/marker-icon.png\";\r\nimport Popup from \"./Popup\";\r\nimport crudAndListsService from \"@/shared/services/crud_and_list.service\";\r\nimport { TokenService } from \"@/shared/services/storage.service\";\r\n\r\nconst MAIN_API_URL = 'contractor-advertising-construction'\r\nexport default {\r\n  components: {\r\n    \"v-map\": LMap,\r\n    Popup\r\n  },\r\n  mounted() {\r\n    this.initMap();\r\n    LeafletMarkercluster;\r\n  },\r\n  data() {\r\n    return {\r\n      filterPayload: {\r\n        passportNumber: '',\r\n        designTypeIds: '',\r\n        contractorIds: '',\r\n        districtIds: '',\r\n        regionIds: '',\r\n      },\r\n      map: {\r\n        self: null,\r\n        maxZoom: 19,\r\n        minZoom: 6,\r\n        initZoom: 6,\r\n        view: [41.5, 64.5],\r\n        attribution: [41.5, 64.5],\r\n        maxBounds: [[37, 55], [46, 74]],\r\n        markers: null,\r\n      },\r\n      adMarkers: [],\r\n      adMarkerObjects: [],\r\n      adDesignTypes: [],\r\n      searchResultMarker: null,\r\n      slide: 0,\r\n      sliding: null,\r\n      currentAdDetails: {},\r\n      currentAdImgs: [],\r\n      strForImgs: '',\r\n      publicPath: process.env.BASE_URL,\r\n      districts: [],\r\n      regions: [],\r\n      contractorSearchPayload: {},\r\n      hasNextPageContractors: false,\r\n      contractors: [],\r\n      debounce: null,\r\n      isLoadingContractors: false,\r\n      initialFilterPayload: {\r\n        passportNumber: '',\r\n        contractorIds: [],\r\n        regionIds: [],\r\n        districtIds: [],\r\n        designTypeIds: []\r\n      },\r\n      mapPopup: {\r\n        id: 'map-popup',\r\n        show: false,\r\n        element: {},\r\n      },\r\n    };\r\n  },\r\n  async created() {\r\n    store.commit(\"SET_GLOBAL_LOADING\", true);\r\n    this.contractorSearchPayload = Object.assign({}, this.var_default_search_payload)\r\n    this.var_default_search_payload.itemsPerPage = 500;\r\n    this.search()\r\n    store.commit(\"SET_GLOBAL_LOADING\", true);\r\n    this.fetchContractors()\r\n    store.commit(\"SET_GLOBAL_LOADING\", true);\r\n    this.fetchAdDesignTypes()\r\n    store.commit(\"SET_GLOBAL_LOADING\", true);\r\n    this.fetchRegionsForAdvertisementByCurrentUserId()\r\n    store.commit(\"SET_GLOBAL_LOADING\", false);\r\n  },\r\n  methods: {\r\n    initMap() {\r\n      const { mapObject } = this.$refs.map;\r\n      this.map.self = mapObject\r\n      const { self, maxZoom, minZoom, attribution, view, initZoom, maxBounds } = this.map;\r\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n        maxZoom: maxZoom,\r\n        minZoom: minZoom,\r\n        attribution: attribution,\r\n      }).addTo(self);\r\n      self.setView(view, initZoom);\r\n      self.setMaxBounds(maxBounds);\r\n      this.handleAddLayers();\r\n    },\r\n    async handleAddLayers() {\r\n      const { self } = this.map;\r\n      if (this.map.markers) {\r\n        self.removeLayer(this.map.markers);\r\n      }\r\n      this.map.markers = L.markerClusterGroup({\r\n        iconCreateFunction: (cluster) => {\r\n          return L.divIcon({\r\n            html: cluster.getAllChildMarkers().length,\r\n            className: 'cluster-bar',\r\n            iconSize: L.point(40, 30)\r\n          });\r\n        },\r\n      });\r\n      this.map.markers.addLayers(this.adMarkerObjects);\r\n      self.addLayer(this.map.markers);\r\n    },\r\n    async fetchRegionsForAdvertisementByCurrentUserId() {\r\n      if (this.currentUserIsOuter) {\r\n        return [];\r\n      }\r\n      await helperService.fetchRegionsForAdvertisementByCurrentUserId()\r\n          .then(res => {\r\n            this.regions = res.data\r\n          })\r\n          .catch(e => {\r\n            console.log(e)\r\n          })\r\n    },\r\n    async fetchAdDesignTypes() {\r\n      if (!this.$can('list', 'directory advertisement design type by active status')) {\r\n        return [];\r\n      }\r\n      await helperService\r\n          .getAdDesignTypesByActiveStatus()\r\n          .then((res) => {\r\n            this.adDesignTypes = res.data;\r\n          })\r\n          .catch(e => {\r\n            console.log(e)\r\n          })\r\n    },\r\n    customLabelAdDesignType(id) {\r\n      let selected = this.adDesignTypes.find(e => e.id === id);\r\n      if (selected) {\r\n        return this.getName(selected)\r\n      }\r\n      return '';\r\n    },\r\n    resetFilter() {\r\n      this.filterPayload = Object.assign({}, this.initialFilterPayload)\r\n      this.search()\r\n      this.map.self.setView(this.map.view, this.map.zoom);\r\n    },\r\n    search() {\r\n      helperService.getAdConstructionsForMap(this.filterPayload, true)\r\n          .then(res => {\r\n            this.adMarkers = res.data\r\n            this.adMarkerObjects = []\r\n            let list = [];\r\n            res.data.forEach((element, index) => {\r\n              if (element.latNumber && element.lngNumber) {\r\n                list.push(new L.marker([element.latNumber, element.lngNumber], {\r\n                  icon: L.icon({\r\n                    iconUrl: MarkerIcon,\r\n                    iconAnchor: new L.Point(12.5, 40),\r\n                    iconSize: new L.Point(25, 41),\r\n                  })\r\n                }).on('click', () => this.getAdDetails(this.adMarkers[index], index)))\r\n              }\r\n            });\r\n            this.adMarkerObjects = list;\r\n          })\r\n          .catch(e => {\r\n            console.log(e)\r\n          })\r\n    },\r\n    addSearchResultMarker(e) {\r\n      if (this.searchResultMarker) {\r\n        this.map.removeLayer(this.searchResultMarker)\r\n      }\r\n      let vm = this\r\n      this.searchResultMarker = new L.Marker(e.latlng, { icon: new MyCustomMarkerForSearch() })\r\n          .addTo(this.map)\r\n          .on('click', function (e) {\r\n            vm.map.removeLayer(vm.searchResultMarker)\r\n          });\r\n    },\r\n    onSlideStart(slide) {\r\n      this.sliding = true\r\n    },\r\n    onSlideEnd(slide) {\r\n      this.sliding = false\r\n    },\r\n    getAdDetails(adInfo, index) {\r\n      // console.log(adInfo, index)\r\n      // if (!adInfo.details) {\r\n      this.mapPopup.show = true\r\n      crudAndListsService.getById('contractor-advertising-construction', adInfo.id)\r\n          .then(res => {\r\n            this.currentAdImgs = null\r\n            crudAndListsService.getById('contractor-advertising-construction', adInfo.id, false, null, 'second-agent-files')\r\n                .then(resForFiles => {\r\n                  this.mapPopup.element = adInfo\r\n                  this.mapPopup.currentAdDetails = adInfo\r\n                  this.$bvModal.show(this.mapPopup.id);\r\n                  this.currentAdImgs = resForFiles.data.objectPhotoList\r\n                  if (resForFiles.data.passportPhotoUrl && resForFiles.data.passportPhotoUrl.url) {\r\n                    this.currentAdImgs.push(resForFiles.data.passportPhotoUrl)\r\n                  }\r\n                  this.$set(this.adMarkers[index], 'details', res.data.contractorAdvertisingConstructionForSecondAgentDto)\r\n                  this.$set(this.adMarkers[index], 'imgs', this.currentAdImgs)\r\n                  this.currentAdDetails = this.adMarkers[index].details\r\n                })\r\n                .catch(e => {\r\n                  console.log(e)\r\n                  this.$set(this.adMarkers[index], 'details', res.data.contractorAdvertisingConstructionForSecondAgentDto)\r\n                  this.currentAdDetails = this.adMarkers[index].details\r\n                })\r\n          })\r\n          .catch(e => {\r\n            console.log(e)\r\n          })\r\n      // } else {\r\n      //   this.$bvModal.show(this.mapPopup.id);\r\n      //   this.currentAdImgs = adInfo.imgs\r\n      //   this.mapPopup.element = adInfo\r\n      //   this.mapPopup.currentAdDetails = adInfo\r\n      //   this.currentAdDetails = this.adMarkers[index].details\r\n      // }\r\n    },\r\n    customLabelDistrict(opt) {\r\n      let selected = this.districts.find(e => e.id === opt);\r\n      if (selected) {\r\n        return `${this.getName({\r\n          nameRu: selected.nameRu,\r\n          nameLt: selected.nameLt,\r\n          nameUz: selected.nameUz,\r\n        })\r\n        }`\r\n      }\r\n      return ``;\r\n    },\r\n    customLabelRegion(opt) {\r\n      let selected = this.regions.find(e => e.regionId === (opt.regionId ? opt.regionId : opt));\r\n      if (selected) {\r\n        return `${this.getName({\r\n          nameRu: selected.regionNameRu,\r\n          nameLt: selected.regionNameLt,\r\n          nameUz: selected.regionNameUz,\r\n        })\r\n        }`\r\n      }\r\n      return ``;\r\n    },\r\n    async regionSelected($event, dontResetDistrict = false) {\r\n      if (!dontResetDistrict) {\r\n        this.filterPayload.districtIds = []\r\n      }\r\n      if ($event && $event.length) {\r\n        // GET DISTRICTS\r\n        await helperService.getGeoLocationsByMultipleParentIds($event)\r\n            .then(res => {\r\n              this.districts = res.data\r\n            })\r\n            .catch(e => {\r\n              console.log(e)\r\n            })\r\n      }\r\n    },\r\n    customLabelContractor(opt) {\r\n      let selected = this.contractors.find(e => e.id === opt);\r\n      if (selected) {\r\n        return `${selected.fullName}`\r\n      }\r\n      return ``;\r\n    },\r\n    async debounceSearchContractors(searchText, selectName = '') {\r\n      clearTimeout(this.debounce);\r\n      this.debounce = setTimeout(async () => {\r\n        await this.fetchContractorsWithKeyword(searchText, selectName);\r\n      }, 1000);\r\n    },\r\n    fetchContractorsWithKeyword(keyword, selectName) {\r\n      this.contractors = []\r\n      this.contractorSearchPayload.page = 1\r\n      this.contractorSearchPayload.keyword = keyword ? keyword : ''\r\n      if (selectName === 'contractor') {\r\n        this.fetchContractors()\r\n      }\r\n    },\r\n    async fetchContractors() {\r\n      if (!this.$can('list','contractor')) {\r\n        return [];\r\n      }\r\n      this.isLoadingContractors = true\r\n      await crudAndListsService.searchListWithKeyword('contractor', this.contractorSearchPayload, 'by-contractor')\r\n          .then(res => {\r\n            this.contractors.push(...res.data.list)\r\n            this.hasNextPageContractors = res.data.total / this.contractorSearchPayload.itemsPerPage > this.contractorSearchPayload.page\r\n            this.contractorSearchPayload.page += 1\r\n          })\r\n          .catch(e => {\r\n            console.log(e)\r\n            this.contractors = []\r\n          })\r\n          .finally(() => {\r\n            this.isLoadingContractors = false\r\n          })\r\n    },\r\n    contractorReachedEndOfList(e, selectName = '') {\r\n      if (e) {\r\n        this.fetchContractors()\r\n      }\r\n    },\r\n  },\r\n  watch: {\r\n    'filterPayload.regionIds': {\r\n      handler(newVal, oldVal) {\r\n        this.regionSelected(newVal);\r\n      },\r\n    },\r\n    adMarkerObjects() {\r\n      this.handleAddLayers();\r\n    },\r\n  },\r\n  computed: {\r\n    currentUserIsOuter() {\r\n      return TokenService.getIsOuter();\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n#map {\r\n  height: calc(100vh - 300px);\r\n  z-index: 1;\r\n}\r\n</style>\r\n<style>\r\n.cluster-bar {\r\n  background: #efecec;\r\n  color: #283593;\r\n  border-radius: 10px;\r\n  outline: 1px solid #7d8acf;\r\n  text-align: center;\r\n  line-height: 30px;\r\n  box-shadow: 0 3px 5px #a5aac9;\r\n}\r\n\r\n.multiselect__content-wrapper {\r\n  z-index: 500 !important;\r\n}\r\n</style>"]}]}