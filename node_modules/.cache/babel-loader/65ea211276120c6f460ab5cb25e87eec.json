{"remainingRequest":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\reestr-contractors\\modules\\natural\\CreateOrUpdate.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\reestr-contractors\\modules\\natural\\CreateOrUpdate.vue","mtime":1674799496519},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\babel.config.js","mtime":1667352074157},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1675061970665},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1675061970715}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJDOi9BQ1JVIFBST0pFQ1QvRmFpciBUZWNoL2FjcnUtZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5LmpzIjsKaW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiQzovQUNSVSBQUk9KRUNUL0ZhaXIgVGVjaC9hY3J1LWZyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovQUNSVSBQUk9KRUNUL0ZhaXIgVGVjaC9hY3J1LWZyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuanNvbi5zdHJpbmdpZnkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKdmFyIE1BSU5fQVBJX1VSTCA9ICdyZWVzdHIvY29udHJhY3Rvci1yZWVzdHItZG9jdW1lbnRzJzsKdmFyIEFQUEVORF9BUElfVVJMX05BVFVSQUwgPSAnZXN0ZXN0dmVuaXknOwp2YXIgQVBQRU5EX0FQSV9VUkxfRE9NSU5BTlQgPSAnZGFtaW5pcml1c2hpeSc7CnZhciBPS0VEX0FQSV9VUkwgPSAncmVlc3RyL2luZm8tb2tlZCc7CnZhciBTS1BfQVBJX1VSTCA9ICdyZWVzdHIvaW5mby1za3AnOwp2YXIgVE5WRURfQVBJX1VSTCA9ICdyZWVzdHIvaW5mby10bnZlZCc7CnZhciBQUklDRV9BUFBST1ZBTF9BUElfVVJMID0gJ3JlZXN0ci9jb250cmFjdG9yLXJlZXN0ci1kb2N1bWVudHMvZ2V0L3ByaWNlLWFwcHJvdmFsJzsKdmFyIEFOTk9VTkNFRF9NRURJQV9BUElfVVJMID0gJ3JlZXN0ci9jb250cmFjdG9yLXJlZXN0ci1kb2N1bWVudHMvZ2V0L2Fubm91bmNlZC1tZWRpYSc7CnZhciBDT01NSVNTSU9OX0FQUExJQ0FUSU9OX0FQSV9VUkwgPSAncmVlc3RyL2NvbnRyYWN0b3ItcmVlc3RyLWRvY3VtZW50cy9nZXQvY29tbWlzc2lvbi1hcHBsaWNhdGlvbic7Ci8qDQoqIFlPVSBNVVNUIFNFTkQge3sgTUFJTl9BUElfVVJMIH19IFRPIENSVURfU0VSVklDRSAqLwppbXBvcnQgY3J1ZEFuZExpc3RzU2VydmljZSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9jcnVkX2FuZF9saXN0LnNlcnZpY2UiOwppbXBvcnQgaGVscGVyU2VydmljZSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9oZWxwZXIuc2VydmljZSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQ3JlYXRlT3JVcGRhdGUiLAogIC8qDQogICogQ09NUE9ORU5UUyAqLwogIGNvbXBvbmVudHM6IHt9LAogIC8qDQogICogREFUQSAqLwogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBlZGl0aW5nSXRlbToge30sCiAgICAgIHB1YmxpY1BhdGg6IHByb2Nlc3MuZW52LkJBU0VfVVJMLAogICAgICBkZWZhdWx0Q29tbWlzc2lvbkFwcGxpY2F0aW9uRHRvOiB7fSwKICAgICAgZGVmYXVsdEFubm91bmNlZE1lZGlhRHRvOiB7fSwKICAgICAgZGVmYXVsdFByaWNlQXBwcm92YWxEdG86IHt9LAogICAgICByZWdpb25zOiBbXSwKICAgICAgZGlzdHJpY3RzOiBbXSwKICAgICAgaGFzTmV4dFBhZ2VDb250cmFjdG9yczogZmFsc2UsCiAgICAgIGhhc05leHRQYWdlUHJvZHVjdE9yU2VydmljZXM6IGZhbHNlLAogICAgICBjb250cmFjdG9yczogW10sCiAgICAgIGRlYm91bmNlOiBudWxsLAogICAgICBpc0xvYWRpbmdDb250cmFjdG9yczogZmFsc2UsCiAgICAgIGlzTG9hZGluZ1Byb2R1Y3RPclNlcnZpY2VzOiBmYWxzZSwKICAgICAgY29udHJhY3RvclNlYXJjaFBheWxvYWQ6IHt9LAogICAgICBwcm9kdWN0T3JTZXJ2aWNlc1NlYXJjaFBheWxvYWQ6IHt9LAogICAgICBwcm9kdWN0VHlwZXM6IFtdLAogICAgICBwcm9kdWN0czogW10sCiAgICAgIHVuaXRzOiBbXSwKICAgICAgLy8gT0tFRCBWQVJJQUJMRVMKICAgICAgb2tlZHM6IFtdLAogICAgICBoYXNOZXh0UGFnZU9rZWQ6IGZhbHNlLAogICAgICBpc0xvYWRpbmdPa2VkOiBmYWxzZSwKICAgICAgb2tlZFNlYXJjaFBheWxvYWQ6IHt9LAogICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tCiAgICAgIC8vIFNLUCBWQVJJQUJMRVMKICAgICAgc2twczogW10sCiAgICAgIGhhc05leHRQYWdlU2twOiBmYWxzZSwKICAgICAgaXNMb2FkaW5nU2twOiBmYWxzZSwKICAgICAgc2twU2VhcmNoUGF5bG9hZDoge30sCiAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0KICAgICAgLy8gVE5WRUQgVkFSSUFCTEVTCiAgICAgIHRudmVkczogW10sCiAgICAgIGhhc05leHRQYWdlVG52ZWQ6IGZhbHNlLAogICAgICBpc0xvYWRpbmdUbnZlZDogZmFsc2UsCiAgICAgIHRudmVkU2VhcmNoUGF5bG9hZDoge30sCiAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0KICAgICAgY29udHJhY3RvckNyZWF0ZU1vZGFsOiBmYWxzZSwKICAgICAgZ3JvdXBPZkluZGl2aWR1YWxzOiBbXQogICAgfTsKICB9LAogIC8qDQogICogQ09NUFVURUQgKi8KICBjb21wdXRlZDogewogICAgY29tcHV0ZWRPYnNlcnZlcjogZnVuY3Rpb24gY29tcHV0ZWRPYnNlcnZlcigpIHsKICAgICAgcmV0dXJuIHRoaXMuJHJlZnMub2JzZXJ2ZXI7CiAgICB9LAogICAgaXNNb2RlQ3JlYXRlOiBmdW5jdGlvbiBpc01vZGVDcmVhdGUoKSB7CiAgICAgIHJldHVybiB0aGlzLiRyb3V0ZS5uYW1lID09PSAnQ3JlYXRlTmF0dXJhbENvbnRyYWN0b3JSZWVzdHInIHx8IHRoaXMuJHJvdXRlLm5hbWUgPT09ICdDcmVhdGVEb21pbmFudENvbnRyYWN0b3JSZWVzdHInOwogICAgfSwKICAgIGlzRG9taW5hbnQ6IGZ1bmN0aW9uIGlzRG9taW5hbnQoKSB7CiAgICAgIHJldHVybiB0aGlzLiRyb3V0ZS5uYW1lID09PSAnQ3JlYXRlRG9taW5hbnRDb250cmFjdG9yUmVlc3RyJyB8fCB0aGlzLiRyb3V0ZS5uYW1lID09PSAnVXBkYXRlRG9taW5hbnRDb250cmFjdG9yUmVlc3RyJzsKICAgIH0sCiAgICBpc05hdHVyYWw6IGZ1bmN0aW9uIGlzTmF0dXJhbCgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHJvdXRlLm5hbWUgPT09ICdDcmVhdGVOYXR1cmFsQ29udHJhY3RvclJlZXN0cicgfHwgdGhpcy4kcm91dGUubmFtZSA9PT0gJ1VwZGF0ZU5hdHVyYWxDb250cmFjdG9yUmVlc3RyJzsKICAgIH0sCiAgICBjb250cmFjdG9ySGFzUGFyZW50OiBmdW5jdGlvbiBjb250cmFjdG9ySGFzUGFyZW50KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgY29udHJhY3RvciA9IHRoaXMuY29udHJhY3RvcnMuZmluZChmdW5jdGlvbiAoZWwpIHsKICAgICAgICByZXR1cm4gZWwuaWQgPT0gX3RoaXMuZWRpdGluZ0l0ZW0uY29udHJhY3RvcklkOwogICAgICB9KTsKICAgICAgaWYgKGNvbnRyYWN0b3IpIHsKICAgICAgICByZXR1cm4gY29udHJhY3Rvci5wYXJlbnQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfSwKICAvKg0KICAqIE1FVEhPRFMgKi8KICBtZXRob2RzOiB7CiAgICBzYXZlOiBmdW5jdGlvbiBzYXZlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgdGhpcy5jb21wdXRlZE9ic2VydmVyLnZhbGlkYXRlKCkudGhlbiggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh2YWxpZCkgewogICAgICAgICAgdmFyIHRtcFByaWNlQXBwcm92YWxGaWxlcywgdG1wUHJvZHVjdE9yU2VydmljZXMsIHRtcEFubm91bmNlZE1lZGlhLCB0bXBQcmljZUFwcHJvdmFsRHRvcywgdG1wQ29tbWlzc2lvbnMsIHBheWxvYWQsIF9wYXlsb2FkOwogICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCF2YWxpZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKCEoX3RoaXMyLmlzRG9taW5hbnQgJiYgIV90aGlzMi5lZGl0aW5nSXRlbS5va2VkSWQgJiYgIV90aGlzMi5lZGl0aW5nSXRlbS5za3BJZCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX3RoaXMyLiR0b2FzdChfdGhpczIuJHQoJ21lc3NhZ2VzLm9rZWRfb3Jfc2twX2lzX3JlcXVpcmVkJyksIHsKICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBpZiAoIV90aGlzMi5pc0RvbWluYW50IHx8ICFfdGhpczIuZWRpdGluZ0l0ZW0uaXNSZXB1YmxpYyAmJiBfdGhpczIuY29udHJhY3Rvckhhc1BhcmVudCkgewogICAgICAgICAgICAgICAgICBfdGhpczIuZWRpdGluZ0l0ZW0uaXNHcm91cCA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdG1wUHJpY2VBcHByb3ZhbEZpbGVzID0gX3RoaXMyLmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxGaWxlcyAmJiBfdGhpczIuZWRpdGluZ0l0ZW0ucHJpY2VBcHByb3ZhbEZpbGVzLmxlbmd0aCA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoX3RoaXMyLmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxGaWxlcykpIDogW107CiAgICAgICAgICAgICAgICB0bXBQcm9kdWN0T3JTZXJ2aWNlcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoX3RoaXMyLmVkaXRpbmdJdGVtLmRpcmVjdG9yeVByb2R1Y3RPclNlcnZpY2VJZCkpOwogICAgICAgICAgICAgICAgdG1wQW5ub3VuY2VkTWVkaWEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KF90aGlzMi5lZGl0aW5nSXRlbS5hbm5vdW5jZWRNZWRpYUR0b3MpKTsKICAgICAgICAgICAgICAgIHRtcFByaWNlQXBwcm92YWxEdG9zID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShfdGhpczIuZWRpdGluZ0l0ZW0ucHJpY2VBcHByb3ZhbER0b3MpKTsKICAgICAgICAgICAgICAgIHRtcENvbW1pc3Npb25zID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShfdGhpczIuZWRpdGluZ0l0ZW0uY29tbWlzc2lvbkFwcGxpY2F0aW9uRHRvcykpOwogICAgICAgICAgICAgICAgaWYgKCFfdGhpczIuZWRpdGluZ0l0ZW0uaWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIubWFrZUFuZFJldHVybkZvcm1EYXRhRm9yQmFzZTY0KCk7CiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIHBheWxvYWQgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgaGVscGVyU2VydmljZS51cGRhdGVSZWVzdHIoTUFJTl9BUElfVVJMLCBwYXlsb2FkLCAiZm9yLWFjY2VwdGFuY2UtIi5jb25jYXQoX3RoaXMyLmlzRG9taW5hbnQgPyBBUFBFTkRfQVBJX1VSTF9ET01JTkFOVCA6IF90aGlzMi5pc05hdHVyYWwgPyBBUFBFTkRfQVBJX1VSTF9OQVRVUkFMIDogJycsICIvIikuY29uY2F0KF90aGlzMi5lZGl0aW5nSXRlbS5pZCksIHRydWUpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICBfdGhpczIuY29tcHV0ZWRPYnNlcnZlci5yZXNldCgpOwogICAgICAgICAgICAgICAgICBfdGhpczIuZWRpdGluZ0l0ZW0gPSBPYmplY3QuYXNzaWduKHt9LCB7fSk7CiAgICAgICAgICAgICAgICAgIF90aGlzMi4kcm91dGVyLmdvKC0xKTsKICAgICAgICAgICAgICAgICAgX3RoaXMyLiR0b2FzdChfdGhpczIuJHQoJ21lc3NhZ2VzLnNhdmVkX3N1Y2Nlc3NmdWxseScpLCB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE5OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5tYWtlQW5kUmV0dXJuRm9ybURhdGFGb3JCYXNlNjQoKTsKICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgICAgX3BheWxvYWQgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgY3J1ZEFuZExpc3RzU2VydmljZS5jcmVhdGUoTUFJTl9BUElfVVJMLCBfcGF5bG9hZCwgImZvci1hY2NlcHRhbmNlLSIuY29uY2F0KF90aGlzMi5pc0RvbWluYW50ID8gQVBQRU5EX0FQSV9VUkxfRE9NSU5BTlQgOiBfdGhpczIuaXNOYXR1cmFsID8gQVBQRU5EX0FQSV9VUkxfTkFUVVJBTCA6ICcnKSwgdHJ1ZSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMi5jb21wdXRlZE9ic2VydmVyLnJlc2V0KCk7CiAgICAgICAgICAgICAgICAgIF90aGlzMi5lZGl0aW5nSXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIHt9KTsKICAgICAgICAgICAgICAgICAgX3RoaXMyLiRyb3V0ZXIuZ28oLTEpOwogICAgICAgICAgICAgICAgICBfdGhpczIuJHRvYXN0KF90aGlzMi4kdCgnbWVzc2FnZXMuc2F2ZWRfc3VjY2Vzc2Z1bGx5JyksIHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICBfdGhpczIuZWRpdGluZ0l0ZW0uZGlyZWN0b3J5UHJvZHVjdE9yU2VydmljZUlkID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0bXBQcm9kdWN0T3JTZXJ2aWNlcykpOwogICAgICAgICAgICAgICAgICBfdGhpczIuZWRpdGluZ0l0ZW0uY29tbWlzc2lvbkFwcGxpY2F0aW9uRHRvcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodG1wQ29tbWlzc2lvbnMpKTsKICAgICAgICAgICAgICAgICAgX3RoaXMyLmVkaXRpbmdJdGVtLmFubm91bmNlZE1lZGlhRHRvcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodG1wQW5ub3VuY2VkTWVkaWEpKTsKICAgICAgICAgICAgICAgICAgX3RoaXMyLmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxEdG9zID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0bXBQcmljZUFwcHJvdmFsRHRvcykpOwogICAgICAgICAgICAgICAgICBfdGhpczIuZWRpdGluZ0l0ZW0ucHJpY2VBcHByb3ZhbEZpbGVzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0bXBQcmljZUFwcHJvdmFsRmlsZXMpKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICAgICAgX3RoaXMyLiR0b2FzdChfdGhpczIuJHQoJ21lc3NhZ2VzLmZpbGxfcmVxdWlyZWRfZmllbGRzJyksIHsKICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgICAgfSkpOwogICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfSgpKTsKICAgIH0sCiAgICBzZXRGaWxlc0Zyb21TZXJ2ZXI6IGZ1bmN0aW9uIHNldEZpbGVzRnJvbVNlcnZlcigpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAvLyBJTE9WQQogICAgICAgICAgICAgIGZldGNoKF90aGlzMy5wdWJsaWNQYXRoICsgX3RoaXMzLmVkaXRpbmdJdGVtLmZpbGVVcmwpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5ibG9iKCk7CiAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAobXlCbG9iKSB7CiAgICAgICAgICAgICAgICBteUJsb2IubmFtZSA9IGYubmFtZTsKICAgICAgICAgICAgICAgIG15QmxvYi5sYXN0TW9kaWZpZWQgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgICAgICAgdmFyIG15RmlsZSA9IG5ldyBGaWxlKFtteUJsb2JdLCBmLm5hbWUsIHsKICAgICAgICAgICAgICAgICAgdHlwZTogbXlCbG9iLnR5cGUKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdmFyIHVybCA9IF90aGlzMy5wdWJsaWNQYXRoICsgZi51cmw7CiAgICAgICAgICAgICAgICBfdGhpczMuJHJlZnMuc3VwcGxlbWVudERvY1VwbG9hZGVyLiRyZWZzLmRyb3B6b25lLm1hbnVhbGx5QWRkRmlsZShteUZpbGUsIHVybCk7CiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgLy8gdGhpcy5lZGl0aW5nSXRlbS5vYmplY3RQaG90b0xpc3QuZm9yRWFjaChmID0+IHsKICAgICAgICAgICAgICAvLyAgICAgZmV0Y2godGhpcy5wdWJsaWNQYXRoICsgZi51cmwpCiAgICAgICAgICAgICAgLy8gICAgICAgICAudGhlbigocmVzKSA9PiByZXMuYmxvYigpKQogICAgICAgICAgICAgIC8vICAgICAgICAgLnRoZW4oKG15QmxvYikgPT4gewogICAgICAgICAgICAgIC8vICAgICAgICAgICAgIG15QmxvYi5uYW1lID0gZi5uYW1lOwogICAgICAgICAgICAgIC8vICAgICAgICAgICAgIG15QmxvYi5sYXN0TW9kaWZpZWQgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGNvbnN0IG15RmlsZSA9IG5ldyBGaWxlKFtteUJsb2JdLCBmLm5hbWUsIHsKICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgdHlwZTogbXlCbG9iLnR5cGUsCiAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGxldCB1cmwgPSB0aGlzLnB1YmxpY1BhdGggKyBmLnVybDsKICAgICAgICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLiRyZWZzLnBob3Rvc1VwbG9hZGVyLiRyZWZzLmRyb3B6b25lLm1hbnVhbGx5QWRkRmlsZShteUZpbGUsIHVybCk7CiAgICAgICAgICAgICAgLy8gICAgICAgICB9KQogICAgICAgICAgICAgIC8vICAgICAgICAgLmNhdGNoKGUgPT4gY29uc29sZS5sb2coZSkpOwogICAgICAgICAgICAgIC8vIH0pCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHJlZ2lvblNlbGVjdGVkOiBmdW5jdGlvbiByZWdpb25TZWxlY3RlZCgkZXZlbnQpIHsKICAgICAgdmFyIF9hcmd1bWVudHMgPSBhcmd1bWVudHMsCiAgICAgICAgX3RoaXM0ID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIGRvbnRSZXNldERpc3RyaWN0OwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBkb250UmVzZXREaXN0cmljdCA9IF9hcmd1bWVudHMubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgICAgICAgICAgaWYgKCFkb250UmVzZXREaXN0cmljdCkgewogICAgICAgICAgICAgICAgX3RoaXM0LmVkaXRpbmdJdGVtLmRpc3RyaWN0SWRzID0gW107CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIEdFVCBESVNUUklDVFMKICAgICAgICAgICAgICBpZiAoISRldmVudCkgewogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgICByZXR1cm4gaGVscGVyU2VydmljZS5nZXRHZW9Mb2NhdGlvbnNCeVBhcmVudElkKCRldmVudCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICBfdGhpczQuZGlzdHJpY3RzID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBhZGRDb21taXNzaW9uQXBwbGljYXRpb25EdG86IGZ1bmN0aW9uIGFkZENvbW1pc3Npb25BcHBsaWNhdGlvbkR0bygpIHsKICAgICAgdmFyIHRtcCA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdENvbW1pc3Npb25BcHBsaWNhdGlvbkR0byk7CiAgICAgIHRoaXMuZWRpdGluZ0l0ZW0uY29tbWlzc2lvbkFwcGxpY2F0aW9uRHRvcy5wdXNoKHRtcCk7CiAgICB9LAogICAgYWRkQW5ub3VuY2VkTWVkaWFEdG86IGZ1bmN0aW9uIGFkZEFubm91bmNlZE1lZGlhRHRvKCkgewogICAgICB2YXIgdG1wID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0QW5ub3VuY2VkTWVkaWFEdG8pOwogICAgICB0aGlzLmVkaXRpbmdJdGVtLmFubm91bmNlZE1lZGlhRHRvcy5wdXNoKHRtcCk7CiAgICB9LAogICAgYWRkUHJpY2VBcHByb3ZhbER0bzogZnVuY3Rpb24gYWRkUHJpY2VBcHByb3ZhbER0bygpIHsKICAgICAgdmFyIHRtcCA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdFByaWNlQXBwcm92YWxEdG8pOwogICAgICB0aGlzLmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxEdG9zLnB1c2godG1wKTsKICAgIH0sCiAgICBuZXdSZWZDcmVhdGVkOiBmdW5jdGlvbiBuZXdSZWZDcmVhdGVkKGZvcm1OYW1lKSB7CiAgICAgIGlmIChmb3JtTmFtZSA9PSAnQ3JlYXRlRm9ybUNvbnRyYWN0b3InKSB7CiAgICAgICAgdGhpcy5mZXRjaENvbnRyYWN0b3JzV2l0aEtleXdvcmQoJycsIHRydWUpOwogICAgICB9CiAgICB9LAogICAgLyogbWFrZUFuZFJldHVyblF1ZXJ5UGFyYW1zICgpIHsNCiAgICAgICAgbGV0IHF1ZXJ5U3RyaW5nID0gYGNvbnRyYWN0b3JJZD0ke3RoaXMuZWRpdGluZ0l0ZW0uY29udHJhY3RvcklkfQ0KICAgICAgICAgICAgICAgICAgICAgJmRpcmVjdG9yeVByb2R1Y3RPclNlcnZpY2VUeXBlSWQ9JHt0aGlzLmVkaXRpbmdJdGVtLmRpcmVjdG9yeVByb2R1Y3RPclNlcnZpY2VUeXBlSWR9DQogICAgICAgICAgICAgICAgICAgICAmZ292ZXJubWVudFBlcmNlbnRhZ2U9JHt0aGlzLmVkaXRpbmdJdGVtLmdvdmVybm1lbnRQZXJjZW50YWdlfQ0KICAgICAgICAgICAgICAgICAgICAgJm9yZGVyTnVtYmVyPSR7dGhpcy5lZGl0aW5nSXRlbS5vcmRlck51bWJlcn0NCiAgICAgICAgICAgICAgICAgICAgICZyZWVzdHJBY2NlcHRlZERhdGU9JHt0aGlzLmVkaXRpbmdJdGVtLnJlZXN0ckFjY2VwdGVkRGF0ZX1gDQogICAgICAgIHRoaXMuZWRpdGluZ0l0ZW0uZGlyZWN0b3J5UHJvZHVjdE9yU2VydmljZUlkLmZvckVhY2goaWQgPT4gew0KICAgICAgICAgICAgcXVlcnlTdHJpbmcgKz0gYCZkaXJlY3RvcnlQcm9kdWN0T3JTZXJ2aWNlSWQ9JHtpZH1gDQogICAgICAgIH0pDQogICAgICAgIHJldHVybiBxdWVyeVN0cmluZw0KICAgIH0sICovCiAgICBnZXRCYXNlNjQ6IGZ1bmN0aW9uIGdldEJhc2U2NChmaWxlKSB7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7CiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiByZXNvbHZlKHJlYWRlci5yZXN1bHQpOwogICAgICAgIH07CiAgICAgICAgcmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIHJldHVybiByZWplY3QoZXJyb3IpOwogICAgICAgIH07CiAgICAgIH0pOwogICAgfSwKICAgIG1ha2VBbmRSZXR1cm5Gb3JtRGF0YUZvckJhc2U2NDogZnVuY3Rpb24gbWFrZUFuZFJldHVybkZvcm1EYXRhRm9yQmFzZTY0KCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgdmFyIHZtLCByZXM7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIC8vIHRoaXMuZWRpdGluZ0l0ZW0uc3VwcGxlbWVudERvY3MgPSB0aGlzLmVkaXRpbmdJdGVtLnN1cHBsZW1lbnREb2NzLm1hcChmID0+IGYuZmlsZS5kYXRhVVJMKQogICAgICAgICAgICAgIHZtID0gX3RoaXM1OwogICAgICAgICAgICAgIC8qIGlmICh0aGlzLmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxGaWxlcyAmJiB0aGlzLmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxGaWxlcy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxGaWxlc1swXS5maWxlLmRhdGFVUkwpIHsNCiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxGaWxlcyA9IHRoaXMuZWRpdGluZ0l0ZW0ucHJpY2VBcHByb3ZhbEZpbGVzWzBdLmZpbGUuZGF0YVVSTA0KICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy5nZXRCYXNlNjQodGhpcy5lZGl0aW5nSXRlbS5wcmljZUFwcHJvdmFsRmlsZXNbMF0uZmlsZSkNCiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxGaWxlcyA9IHJlcw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9ICovCiAgICAgICAgICAgICAgLyogbGV0IGJhc2U2NFByaWNlRmlsZXMgPSBbXQ0KICAgICAgICAgICAgICBpZiAodGhpcy5lZGl0aW5nSXRlbS5wcmljZUFwcHJvdmFsRmlsZXMpIHsNCiAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdGluZ0l0ZW0ucHJpY2VBcHByb3ZhbEZpbGVzLmZvckVhY2goYXN5bmMgZiA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGYuZmlsZS5kYXRhVVJMKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U2NFByaWNlRmlsZXMucHVzaChmLmZpbGUuZGF0YVVSTCkNCiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy5nZXRCYXNlNjQoZi5maWxlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlNjRQcmljZUZpbGVzLnB1c2gocmVzKQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgdGhpcy5lZGl0aW5nSXRlbS5wcmljZUFwcHJvdmFsRmlsZXMgPSBiYXNlNjRQcmljZUZpbGVzICovCiAgICAgICAgICAgICAgLyogdGhpcy5lZGl0aW5nSXRlbS5wcmljZUFwcHJvdmFsRmlsZXMgPSB0aGlzLmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxGaWxlcyA/IHRoaXMuZWRpdGluZ0l0ZW0ucHJpY2VBcHByb3ZhbEZpbGVzLm1hcChhc3luYyBmdW5jdGlvbiAoZikgew0KICAgICAgICAgICAgICAgICAgbGV0IHVybCA9IG51bGwNCiAgICAgICAgICAgICAgICAgIGlmIChmLmZpbGUuZGF0YVVSTCkgew0KICAgICAgICAgICAgICAgICAgICAgIHVybCA9IGYuZmlsZS5kYXRhVVJMDQogICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCB2bS5nZXRCYXNlNjQoZi5maWxlKQ0KICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHJlcw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybA0KICAgICAgICAgICAgICB9KSA6IFtdICovCiAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBfdGhpczUuZWRpdGluZ0l0ZW0uYW5ub3VuY2VkTWVkaWFEdG9zLmZpbHRlcihmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgIGlmIChlbC5hbm5vdW5jZWRNZWRpYU5hbWUpIHsKICAgICAgICAgICAgICAgICAgdmFyIGJhc2U2NEFubm91bmNlbWVudEZpbGVzID0gW107CiAgICAgICAgICAgICAgICAgIGlmIChlbC5hbm5vdW5jZWRNZWRpYUZpbGVzKSB7CiAgICAgICAgICAgICAgICAgICAgZWwuYW5ub3VuY2VkTWVkaWFGaWxlcy5mb3JFYWNoKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNChmKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXM7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWYuZmlsZS5kYXRhVVJMKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U2NEFubm91bmNlbWVudEZpbGVzLnB1c2goZi5maWxlLmRhdGFVUkwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczUuZ2V0QmFzZTY0KGYuZmlsZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlNjRBbm5vdW5jZW1lbnRGaWxlcy5wdXNoKHJlcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWU0KTsKICAgICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB9KCkpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGVsLmFubm91bmNlZE1lZGlhRmlsZXMgPSBiYXNlNjRBbm5vdW5jZW1lbnRGaWxlczsKICAgICAgICAgICAgICAgICAgLyogZWwuYW5ub3VuY2VkTWVkaWFGaWxlcyA9IGVsLmFubm91bmNlZE1lZGlhRmlsZXMgPyBlbC5hbm5vdW5jZWRNZWRpYUZpbGVzLm1hcChhc3luYyBmdW5jdGlvbiAoZikgew0KICAgICAgICAgICAgICAgICAgICAgIGxldCB1cmwgPSBudWxsDQogICAgICAgICAgICAgICAgICAgICAgaWYgKGYuZmlsZS5kYXRhVVJMKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IGYuZmlsZS5kYXRhVVJMDQogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IHZtLmdldEJhc2U2NChmLmZpbGUpDQogICAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHJlcw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXJsDQogICAgICAgICAgICAgICAgICB9KSA6IFtdICovCiAgICAgICAgICAgICAgICAgIHJldHVybiBlbDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIF90aGlzNS5lZGl0aW5nSXRlbS5hbm5vdW5jZWRNZWRpYUR0b3MgPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDY7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNS5lZGl0aW5nSXRlbS5wcmljZUFwcHJvdmFsRHRvcy5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICBpZiAoZWwucHJpY2VBcHByb3ZhbE51bWJlcikgewogICAgICAgICAgICAgICAgICB2YXIgYmFzZTY0UHJpY2VBcHByb3ZhbEZpbGVzID0gW107CiAgICAgICAgICAgICAgICAgIGlmIChlbC5wcmljZUFwcHJvdmFsRmlsZXMpIHsKICAgICAgICAgICAgICAgICAgICBlbC5wcmljZUFwcHJvdmFsRmlsZXMuZm9yRWFjaCggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVmMyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoZikgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmLmZpbGUuZGF0YVVSTCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlNjRQcmljZUFwcHJvdmFsRmlsZXMucHVzaChmLmZpbGUuZGF0YVVSTCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNS5nZXRCYXNlNjQoZi5maWxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2U2NFByaWNlQXBwcm92YWxGaWxlcy5wdXNoKHJlcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB9KCkpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGVsLnByaWNlQXBwcm92YWxGaWxlcyA9IGJhc2U2NFByaWNlQXBwcm92YWxGaWxlczsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgX3RoaXM1LmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxEdG9zID0gX2NvbnRleHQ2LnNlbnQ7CiAgICAgICAgICAgICAgX3RoaXM1LmVkaXRpbmdJdGVtLmNvbW1pc3Npb25BcHBsaWNhdGlvbkR0b3MgPSBfdGhpczUuZWRpdGluZ0l0ZW0uY29tbWlzc2lvbkFwcGxpY2F0aW9uRHRvcy5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICBpZiAoZWwuY29tbWVuY2VtZW50TnVtYmVyICYmIGVsLmluaXRpYXRvck5hbWUpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIC8vIHRoaXMuZWRpdGluZ0l0ZW0ub2tlZElkcyA9IFtdCiAgICAgICAgICAgICAgLy8gdGhpcy5lZGl0aW5nSXRlbS5kaXJlY3RvcnlQcm9kdWN0T3JTZXJ2aWNlSWQgPSB0aGlzLmVkaXRpbmdJdGVtLmRpcmVjdG9yeVByb2R1Y3RPclNlcnZpY2VJZC5tYXAoZWwgPT4gewogICAgICAgICAgICAgIC8vICAgICB0aGlzLmVkaXRpbmdJdGVtLm9rZWRJZHMucHVzaChlbC5va2VkSWQpCiAgICAgICAgICAgICAgLy8gICAgIHJldHVybiBlbC5pZAogICAgICAgICAgICAgIC8vIH0pCiAgICAgICAgICAgICAgaWYgKCEoX3RoaXM1LmVkaXRpbmdJdGVtLnN1cHBsZW1lbnREb2NzICYmIF90aGlzNS5lZGl0aW5nSXRlbS5zdXBwbGVtZW50RG9jc1swXS5maWxlLmRhdGFVUkwpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDEzOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF90aGlzNS5lZGl0aW5nSXRlbS5maWxlID0gX3RoaXM1LmVkaXRpbmdJdGVtLnN1cHBsZW1lbnREb2NzWzBdLmZpbGUuZGF0YVVSTDsKICAgICAgICAgICAgICAvLyBkZWxldGUgdGhpcy5lZGl0aW5nSXRlbS5zdXBwbGVtZW50RG9jcwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iLCBfdGhpczUuZWRpdGluZ0l0ZW0pOwogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIGlmICghX3RoaXM1LmVkaXRpbmdJdGVtLnN1cHBsZW1lbnREb2NzKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNS5nZXRCYXNlNjQoX3RoaXM1LmVkaXRpbmdJdGVtLnN1cHBsZW1lbnREb2NzWzBdLmZpbGUpOwogICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgIF90aGlzNS5lZGl0aW5nSXRlbS5maWxlID0gcmVzOwogICAgICAgICAgICAgIC8vIGRlbGV0ZSB0aGlzLmVkaXRpbmdJdGVtLnN1cHBsZW1lbnREb2NzCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIF90aGlzNS5lZGl0aW5nSXRlbSk7CiAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIF90aGlzNS5lZGl0aW5nSXRlbSk7CiAgICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBjdXN0b21MYWJlbFJlZ2lvbjogZnVuY3Rpb24gY3VzdG9tTGFiZWxSZWdpb24ob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMucmVnaW9ucy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUucmVnaW9uSWQgPT0gKG9wdC5yZWdpb25JZCA/IG9wdC5yZWdpb25JZCA6IG9wdCk7CiAgICAgIH0pOwogICAgICBpZiAoc2VsZWN0ZWQpIHsKICAgICAgICByZXR1cm4gIiIuY29uY2F0KHRoaXMuZ2V0TmFtZSh7CiAgICAgICAgICBuYW1lUnU6IHNlbGVjdGVkLnJlZ2lvbk5hbWVSdSwKICAgICAgICAgIG5hbWVMdDogc2VsZWN0ZWQucmVnaW9uTmFtZUx0LAogICAgICAgICAgbmFtZVV6OiBzZWxlY3RlZC5yZWdpb25OYW1lVXoKICAgICAgICB9KSk7CiAgICAgIH0KICAgICAgcmV0dXJuICIiOwogICAgfSwKICAgIGN1c3RvbUxhYmVsRGlzdHJpY3Q6IGZ1bmN0aW9uIGN1c3RvbUxhYmVsRGlzdHJpY3Qob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZERpc3RyaWN0ID0gdGhpcy5kaXN0cmljdHMuZmluZChmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLmlkID09IG9wdDsKICAgICAgfSk7CiAgICAgIGlmIChzZWxlY3RlZERpc3RyaWN0KSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZERpc3RyaWN0Lm5hbWVSdSwKICAgICAgICAgIG5hbWVMdDogc2VsZWN0ZWREaXN0cmljdC5uYW1lTHQsCiAgICAgICAgICBuYW1lVXo6IHNlbGVjdGVkRGlzdHJpY3QubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbFByb2R1Y3Q6IGZ1bmN0aW9uIGN1c3RvbUxhYmVsUHJvZHVjdChvcHQpIHsKICAgICAgdmFyIHNlbGVjdGVkID0gdGhpcy5wcm9kdWN0cy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbFVuaXQ6IGZ1bmN0aW9uIGN1c3RvbUxhYmVsVW5pdChvcHQpIHsKICAgICAgdmFyIHNlbGVjdGVkID0gdGhpcy51bml0cy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbEdyb3VwT2ZJbmRpdmlkdWFsczogZnVuY3Rpb24gY3VzdG9tTGFiZWxHcm91cE9mSW5kaXZpZHVhbHMob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuZ3JvdXBPZkluZGl2aWR1YWxzLmZpbmQoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZS5pZCA9PSBvcHQ7CiAgICAgIH0pOwogICAgICBpZiAoc2VsZWN0ZWQpIHsKICAgICAgICByZXR1cm4gIiIuY29uY2F0KHNlbGVjdGVkLm5hbWUpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbFByb2R1Y3RUeXBlOiBmdW5jdGlvbiBjdXN0b21MYWJlbFByb2R1Y3RUeXBlKG9wdCkgewogICAgICB2YXIgc2VsZWN0ZWQgPSB0aGlzLnByb2R1Y3RUeXBlcy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBwcm9kdWN0VHlwZVNlbGVjdGVkOiBmdW5jdGlvbiBwcm9kdWN0VHlwZVNlbGVjdGVkKCRldmVudCkgewogICAgICB2YXIgX2FyZ3VtZW50czIgPSBhcmd1bWVudHMsCiAgICAgICAgX3RoaXM2ID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgdmFyIGRvbnRSZXNldERpc3RyaWN0OwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBkb250UmVzZXREaXN0cmljdCA9IF9hcmd1bWVudHMyLmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50czJbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHMyWzFdIDogZmFsc2U7CiAgICAgICAgICAgICAgaWYgKCFkb250UmVzZXREaXN0cmljdCkgewogICAgICAgICAgICAgICAgX3RoaXM2LnByb2R1Y3RzID0gW107CiAgICAgICAgICAgICAgICBfdGhpczYuZWRpdGluZ0l0ZW0uZGlyZWN0b3J5UHJvZHVjdE9yU2VydmljZUlkID0gbnVsbDsKICAgICAgICAgICAgICAgIF90aGlzNi5wcm9kdWN0T3JTZXJ2aWNlc1NlYXJjaFBheWxvYWQucGFnZSA9IDE7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghJGV2ZW50KSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA1OwogICAgICAgICAgICAgIHJldHVybiBfdGhpczYuZmV0Y2hQcm9kdWN0T3JTZXJ2aWNlcygkZXZlbnQpOwogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTcpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBjb250cmFjdG9yUmVhY2hlZEVuZE9mTGlzdDogZnVuY3Rpb24gY29udHJhY3RvclJlYWNoZWRFbmRPZkxpc3QoZSkgewogICAgICBpZiAoZSAmJiAhdGhpcy5pc0xvYWRpbmdDb250cmFjdG9ycykgewogICAgICAgIHRoaXMuZmV0Y2hDb250cmFjdG9ycygpOwogICAgICB9CiAgICB9LAogICAgcHJvZHVjdE9yU2VydmljZXNSZWFjaGVkRW5kT2ZMaXN0OiBmdW5jdGlvbiBwcm9kdWN0T3JTZXJ2aWNlc1JlYWNoZWRFbmRPZkxpc3QoZSkgewogICAgICBpZiAoZSkgewogICAgICAgIHRoaXMuZmV0Y2hQcm9kdWN0T3JTZXJ2aWNlcyh0aGlzLmVkaXRpbmdJdGVtLmRpcmVjdG9yeVByb2R1Y3RPclNlcnZpY2VUeXBlSWQpOwogICAgICB9CiAgICB9LAogICAgY3VzdG9tTGFiZWxDb250cmFjdG9yOiBmdW5jdGlvbiBjdXN0b21MYWJlbENvbnRyYWN0b3Iob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuY29udHJhY3RvcnMuZmluZChmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLmlkID09IG9wdDsKICAgICAgfSk7CiAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgIHJldHVybiAiIi5jb25jYXQoc2VsZWN0ZWQuZnVsbE5hbWUpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBkZWJvdW5jZVNlYXJjaFByb2R1Y3RPclNlcnZpY2VzOiBmdW5jdGlvbiBkZWJvdW5jZVNlYXJjaFByb2R1Y3RPclNlcnZpY2VzKHNlYXJjaFRleHQpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoX3RoaXM3LmRlYm91bmNlKTsKICAgICAgICAgICAgICBfdGhpczcuZGVib3VuY2UgPSBzZXRUaW1lb3V0KCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM3LmZldGNoUHJvZHVjdE9yU2VydmljZXNXaXRoS2V5d29yZChzZWFyY2hUZXh0KTsKICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBfY2FsbGVlOCk7CiAgICAgICAgICAgICAgfSkpLCAxMDAwKTsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU5KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZGVib3VuY2VTZWFyY2hDb250cmFjdG9yczogZnVuY3Rpb24gZGVib3VuY2VTZWFyY2hDb250cmFjdG9ycyhzZWFyY2hUZXh0KSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTEoKSB7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoX3RoaXM4LmRlYm91bmNlKTsKICAgICAgICAgICAgICBfdGhpczguZGVib3VuY2UgPSBzZXRUaW1lb3V0KCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEwJChfY29udGV4dDEwKSB7CiAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MTAucHJldiA9IF9jb250ZXh0MTAubmV4dCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM4LmZldGNoQ29udHJhY3RvcnNXaXRoS2V5d29yZChzZWFyY2hUZXh0KTsKICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgX2NhbGxlZTEwKTsKICAgICAgICAgICAgICB9KSksIDEwMDApOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGZldGNoUHJvZHVjdE9yU2VydmljZXNXaXRoS2V5d29yZDogZnVuY3Rpb24gZmV0Y2hQcm9kdWN0T3JTZXJ2aWNlc1dpdGhLZXl3b3JkKGtleXdvcmQpIHsKICAgICAgdGhpcy5wcm9kdWN0cyA9IFtdOwogICAgICB0aGlzLnByb2R1Y3RPclNlcnZpY2VzU2VhcmNoUGF5bG9hZC5wYWdlID0gMTsKICAgICAgdGhpcy5wcm9kdWN0T3JTZXJ2aWNlc1NlYXJjaFBheWxvYWQua2V5d29yZCA9IGtleXdvcmQgPyBrZXl3b3JkIDogJyc7CiAgICAgIHRoaXMuZmV0Y2hQcm9kdWN0T3JTZXJ2aWNlcyh0aGlzLmVkaXRpbmdJdGVtLmRpcmVjdG9yeVByb2R1Y3RPclNlcnZpY2VUeXBlSWQpOwogICAgfSwKICAgIC8vIE9LRUQgTUVUSE9EUwogICAgb2tlZFJlYWNoZWRFbmRPZkxpc3Q6IGZ1bmN0aW9uIG9rZWRSZWFjaGVkRW5kT2ZMaXN0KGUpIHsKICAgICAgaWYgKGUpIHsKICAgICAgICB0aGlzLmZldGNoT2tlZHMoKTsKICAgICAgfQogICAgfSwKICAgIGRlYm91bmNlU2VhcmNoT2tlZDogZnVuY3Rpb24gZGVib3VuY2VTZWFyY2hPa2VkKHNlYXJjaFRleHQpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMygpIHsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNsZWFyVGltZW91dChfdGhpczkuZGVib3VuY2UpOwogICAgICAgICAgICAgIF90aGlzOS5kZWJvdW5jZSA9IHNldFRpbWVvdXQoIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMigpIHsKICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTIkKF9jb250ZXh0MTIpIHsKICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQxMi5wcmV2ID0gX2NvbnRleHQxMi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczkuZmV0Y2hPa2Vkc1dpdGhLZXl3b3JkKHNlYXJjaFRleHQpOwogICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTIpOwogICAgICAgICAgICAgIH0pKSwgMTAwMCk7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEzKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZmV0Y2hPa2Vkc1dpdGhLZXl3b3JkOiBmdW5jdGlvbiBmZXRjaE9rZWRzV2l0aEtleXdvcmQoa2V5d29yZCkgewogICAgICB0aGlzLm9rZWRzID0gW107CiAgICAgIHRoaXMub2tlZFNlYXJjaFBheWxvYWQucGFnZSA9IDE7CiAgICAgIHRoaXMub2tlZFNlYXJjaFBheWxvYWQua2V5d29yZCA9IGtleXdvcmQgPyBrZXl3b3JkIDogJyc7CiAgICAgIHRoaXMuZmV0Y2hPa2VkcygpOwogICAgfSwKICAgIGZldGNoT2tlZHM6IGZ1bmN0aW9uIGZldGNoT2tlZHMoKSB7CiAgICAgIHZhciBfdGhpczEwID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE0KCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTQkKF9jb250ZXh0MTQpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MTQucHJldiA9IF9jb250ZXh0MTQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3RoaXMxMC5pc0xvYWRpbmdPa2VkID0gdHJ1ZTsKICAgICAgICAgICAgICBfY29udGV4dDE0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBjcnVkQW5kTGlzdHNTZXJ2aWNlLnNlYXJjaExpc3RXaXRoS2V5d29yZChPS0VEX0FQSV9VUkwsIF90aGlzMTAub2tlZFNlYXJjaFBheWxvYWQpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgdmFyIF90aGlzMTAkb2tlZHM7CiAgICAgICAgICAgICAgICAoX3RoaXMxMCRva2VkcyA9IF90aGlzMTAub2tlZHMpLnB1c2guYXBwbHkoX3RoaXMxMCRva2VkcywgX3RvQ29uc3VtYWJsZUFycmF5KHJlcy5kYXRhLmxpc3QpKTsKICAgICAgICAgICAgICAgIF90aGlzMTAuaGFzTmV4dFBhZ2VPa2VkID0gcmVzLmRhdGEudG90YWwgLyBfdGhpczEwLm9rZWRTZWFyY2hQYXlsb2FkLml0ZW1zUGVyUGFnZSA+IF90aGlzMTAub2tlZFNlYXJjaFBheWxvYWQucGFnZTsKICAgICAgICAgICAgICAgIF90aGlzMTAub2tlZFNlYXJjaFBheWxvYWQucGFnZSArPSAxOwogICAgICAgICAgICAgICAgaWYgKCFfdGhpczEwLmlzTW9kZUNyZWF0ZSAmJiBfdGhpczEwLmVkaXRpbmdJdGVtLm9rZWRJZCkgewogICAgICAgICAgICAgICAgICB2YXIgZm91bmRJdG0gPSBfdGhpczEwLm9rZWRzLmZpbmQoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmlkID09IF90aGlzMTAuZWRpdGluZ0l0ZW0ub2tlZElkOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgaWYgKCFmb3VuZEl0bSAmJiBfdGhpczEwLmVkaXRpbmdJdGVtLmluZm9Pa2VkRHRvKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMC5va2Vkcy5wdXNoKF90aGlzMTAuZWRpdGluZ0l0ZW0uaW5mb09rZWREdG8pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgICAgX3RoaXMxMC5va2VkcyA9IFtdOwogICAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgX3RoaXMxMC5pc0xvYWRpbmdPa2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE0KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY3VzdG9tTGFiZWxPa2VkOiBmdW5jdGlvbiBjdXN0b21MYWJlbE9rZWQob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMub2tlZHMuZmluZChmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLmlkID09IG9wdDsKICAgICAgfSk7CiAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgIHJldHVybiAiIi5jb25jYXQoc2VsZWN0ZWQuY29kZSwgIiAtICIpLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gU0tQIE1FVEhPRFMKICAgIHNrcFJlYWNoZWRFbmRPZkxpc3Q6IGZ1bmN0aW9uIHNrcFJlYWNoZWRFbmRPZkxpc3QoZSkgewogICAgICBpZiAoZSkgewogICAgICAgIHRoaXMuZmV0Y2hTa3BzKCk7CiAgICAgIH0KICAgIH0sCiAgICBkZWJvdW5jZVNlYXJjaFNrcDogZnVuY3Rpb24gZGVib3VuY2VTZWFyY2hTa3Aoc2VhcmNoVGV4dCkgewogICAgICB2YXIgX3RoaXMxMSA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNigpIHsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE2JChfY29udGV4dDE2KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDE2LnByZXYgPSBfY29udGV4dDE2Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNsZWFyVGltZW91dChfdGhpczExLmRlYm91bmNlKTsKICAgICAgICAgICAgICBfdGhpczExLmRlYm91bmNlID0gc2V0VGltZW91dCggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE1KCkgewogICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNSQoX2NvbnRleHQxNSkgewogICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDE1LnByZXYgPSBfY29udGV4dDE1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDE1Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMTEuZmV0Y2hTa3BzV2l0aEtleXdvcmQoc2VhcmNoVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNS5zdG9wKCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxNSk7CiAgICAgICAgICAgICAgfSkpLCAxMDAwKTsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE2LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTYpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBmZXRjaFNrcHNXaXRoS2V5d29yZDogZnVuY3Rpb24gZmV0Y2hTa3BzV2l0aEtleXdvcmQoa2V5d29yZCkgewogICAgICB0aGlzLnNrcHMgPSBbXTsKICAgICAgdGhpcy5za3BTZWFyY2hQYXlsb2FkLnBhZ2UgPSAxOwogICAgICB0aGlzLnNrcFNlYXJjaFBheWxvYWQua2V5d29yZCA9IGtleXdvcmQgPyBrZXl3b3JkIDogJyc7CiAgICAgIHRoaXMuZmV0Y2hTa3BzKCk7CiAgICB9LAogICAgZmV0Y2hTa3BzOiBmdW5jdGlvbiBmZXRjaFNrcHMoKSB7CiAgICAgIHZhciBfdGhpczEyID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE3KCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTckKF9jb250ZXh0MTcpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MTcucHJldiA9IF9jb250ZXh0MTcubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3RoaXMxMi5pc0xvYWRpbmdTa3AgPSB0cnVlOwogICAgICAgICAgICAgIF9jb250ZXh0MTcubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNydWRBbmRMaXN0c1NlcnZpY2Uuc2VhcmNoTGlzdFdpdGhLZXl3b3JkKFNLUF9BUElfVVJMLCBfdGhpczEyLnNrcFNlYXJjaFBheWxvYWQpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgdmFyIF90aGlzMTIkc2twczsKICAgICAgICAgICAgICAgIChfdGhpczEyJHNrcHMgPSBfdGhpczEyLnNrcHMpLnB1c2guYXBwbHkoX3RoaXMxMiRza3BzLCBfdG9Db25zdW1hYmxlQXJyYXkocmVzLmRhdGEubGlzdCkpOwogICAgICAgICAgICAgICAgX3RoaXMxMi5oYXNOZXh0UGFnZVNrcCA9IHJlcy5kYXRhLnRvdGFsIC8gX3RoaXMxMi5za3BTZWFyY2hQYXlsb2FkLml0ZW1zUGVyUGFnZSA+IF90aGlzMTIuc2twU2VhcmNoUGF5bG9hZC5wYWdlOwogICAgICAgICAgICAgICAgX3RoaXMxMi5za3BTZWFyY2hQYXlsb2FkLnBhZ2UgKz0gMTsKICAgICAgICAgICAgICAgIGlmICghX3RoaXMxMi5pc01vZGVDcmVhdGUgJiYgX3RoaXMxMi5lZGl0aW5nSXRlbS5za3BJZCkgewogICAgICAgICAgICAgICAgICB2YXIgZm91bmRJdG0gPSBfdGhpczEyLnNrcHMuZmluZChmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWwuaWQgPT0gX3RoaXMxMi5lZGl0aW5nSXRlbS5za3BJZDsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGlmICghZm91bmRJdG0gJiYgX3RoaXMxMi5lZGl0aW5nSXRlbS5pbmZvU0tQRHRvKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMi5za3BzLnB1c2goX3RoaXMxMi5lZGl0aW5nSXRlbS5pbmZvU0tQRHRvKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgIF90aGlzMTIuc2twcyA9IFtdOwogICAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgX3RoaXMxMi5pc0xvYWRpbmdTa3AgPSBmYWxzZTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE3LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTcpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBjdXN0b21MYWJlbFNrcDogZnVuY3Rpb24gY3VzdG9tTGFiZWxTa3Aob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuc2twcy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdChzZWxlY3RlZC5jb2RlLCAiIC0gIikuY29uY2F0KHRoaXMuZ2V0TmFtZSh7CiAgICAgICAgICBuYW1lUnU6IHNlbGVjdGVkLm5hbWVSdSwKICAgICAgICAgIG5hbWVMdDogc2VsZWN0ZWQubmFtZUx0LAogICAgICAgICAgbmFtZVV6OiBzZWxlY3RlZC5uYW1lVXoKICAgICAgICB9KSk7CiAgICAgIH0KICAgICAgcmV0dXJuICIiOwogICAgfSwKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyBUTlZFRCBNRVRIT0RTCiAgICB0bnZlZFJlYWNoZWRFbmRPZkxpc3Q6IGZ1bmN0aW9uIHRudmVkUmVhY2hlZEVuZE9mTGlzdChlKSB7CiAgICAgIGlmIChlKSB7CiAgICAgICAgdGhpcy5mZXRjaFRudmVkcygpOwogICAgICB9CiAgICB9LAogICAgZGVib3VuY2VTZWFyY2hUbnZlZDogZnVuY3Rpb24gZGVib3VuY2VTZWFyY2hUbnZlZChzZWFyY2hUZXh0KSB7CiAgICAgIHZhciBfdGhpczEzID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE5KCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTkkKF9jb250ZXh0MTkpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MTkucHJldiA9IF9jb250ZXh0MTkubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KF90aGlzMTMuZGVib3VuY2UpOwogICAgICAgICAgICAgIF90aGlzMTMuZGVib3VuY2UgPSBzZXRUaW1lb3V0KCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTgoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE4JChfY29udGV4dDE4KSB7CiAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MTgucHJldiA9IF9jb250ZXh0MTgubmV4dCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTgubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxMy5mZXRjaFRudmVkc1dpdGhLZXl3b3JkKHNlYXJjaFRleHQpOwogICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTguc3RvcCgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTgpOwogICAgICAgICAgICAgIH0pKSwgMTAwMCk7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOS5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE5KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZmV0Y2hUbnZlZHNXaXRoS2V5d29yZDogZnVuY3Rpb24gZmV0Y2hUbnZlZHNXaXRoS2V5d29yZChrZXl3b3JkKSB7CiAgICAgIHRoaXMudG52ZWRzID0gW107CiAgICAgIHRoaXMudG52ZWRTZWFyY2hQYXlsb2FkLnBhZ2UgPSAxOwogICAgICB0aGlzLnRudmVkU2VhcmNoUGF5bG9hZC5rZXl3b3JkID0ga2V5d29yZCA/IGtleXdvcmQgOiAnJzsKICAgICAgdGhpcy5mZXRjaFRudmVkcygpOwogICAgfSwKICAgIGZldGNoVG52ZWRzOiBmdW5jdGlvbiBmZXRjaFRudmVkcygpIHsKICAgICAgdmFyIF90aGlzMTQgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMjAoKSB7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMCQoX2NvbnRleHQyMCkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQyMC5wcmV2ID0gX2NvbnRleHQyMC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfdGhpczE0LmlzTG9hZGluZ1RudmVkID0gdHJ1ZTsKICAgICAgICAgICAgICBfY29udGV4dDIwLm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBjcnVkQW5kTGlzdHNTZXJ2aWNlLnNlYXJjaExpc3RXaXRoS2V5d29yZChUTlZFRF9BUElfVVJMLCBfdGhpczE0LnRudmVkU2VhcmNoUGF5bG9hZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICB2YXIgX3RoaXMxNCR0bnZlZHM7CiAgICAgICAgICAgICAgICAoX3RoaXMxNCR0bnZlZHMgPSBfdGhpczE0LnRudmVkcykucHVzaC5hcHBseShfdGhpczE0JHRudmVkcywgX3RvQ29uc3VtYWJsZUFycmF5KHJlcy5kYXRhLmxpc3QpKTsKICAgICAgICAgICAgICAgIF90aGlzMTQuaGFzTmV4dFBhZ2VUbnZlZCA9IHJlcy5kYXRhLnRvdGFsIC8gX3RoaXMxNC50bnZlZFNlYXJjaFBheWxvYWQuaXRlbXNQZXJQYWdlID4gX3RoaXMxNC50bnZlZFNlYXJjaFBheWxvYWQucGFnZTsKICAgICAgICAgICAgICAgIF90aGlzMTQudG52ZWRTZWFyY2hQYXlsb2FkLnBhZ2UgKz0gMTsKICAgICAgICAgICAgICAgIGlmICghX3RoaXMxNC5pc01vZGVDcmVhdGUgJiYgX3RoaXMxNC5lZGl0aW5nSXRlbS50bnZlZElkKSB7CiAgICAgICAgICAgICAgICAgIHZhciBmb3VuZEl0bSA9IF90aGlzMTQudG52ZWRzLmZpbmQoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmlkID09IF90aGlzMTQuZWRpdGluZ0l0ZW0udG52ZWRJZDsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGlmICghZm91bmRJdG0gJiYgX3RoaXMxNC5lZGl0aW5nSXRlbS5pbmZvVE5WRUREdG8pIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczE0LnRudmVkcy5wdXNoKF90aGlzMTQuZWRpdGluZ0l0ZW0uaW5mb1ROVkVERHRvKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgIF90aGlzMTQudG52ZWRzID0gW107CiAgICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBfdGhpczE0LmlzTG9hZGluZ1RudmVkID0gZmFsc2U7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIwKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY3VzdG9tTGFiZWxUbnZlZDogZnVuY3Rpb24gY3VzdG9tTGFiZWxUbnZlZChvcHQpIHsKICAgICAgdmFyIHNlbGVjdGVkID0gdGhpcy50bnZlZHMuZmluZChmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLmlkID09IG9wdDsKICAgICAgfSk7CiAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgIHJldHVybiAiIi5jb25jYXQoc2VsZWN0ZWQuY29kZSwgIiAtICIpLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgZmV0Y2hQcm9kdWN0T3JTZXJ2aWNlczogZnVuY3Rpb24gZmV0Y2hQcm9kdWN0T3JTZXJ2aWNlcyh0eXBlSWQpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMjEoKSB7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMSQoX2NvbnRleHQyMSkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQyMS5wcmV2ID0gX2NvbnRleHQyMS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfdGhpczE1LmlzTG9hZGluZ1Byb2R1Y3RPclNlcnZpY2VzID0gdHJ1ZTsKICAgICAgICAgICAgICBfY29udGV4dDIxLm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBoZWxwZXJTZXJ2aWNlLmdldFByb2R1Y3RPclNlcnZpY2VzQnlUeXBlSWQodHlwZUlkLCBfdGhpczE1LnByb2R1Y3RPclNlcnZpY2VzU2VhcmNoUGF5bG9hZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICB2YXIgX3RoaXMxNSRwcm9kdWN0czsKICAgICAgICAgICAgICAgIChfdGhpczE1JHByb2R1Y3RzID0gX3RoaXMxNS5wcm9kdWN0cykucHVzaC5hcHBseShfdGhpczE1JHByb2R1Y3RzLCBfdG9Db25zdW1hYmxlQXJyYXkocmVzLmRhdGEubGlzdCkpOwogICAgICAgICAgICAgICAgX3RoaXMxNS5oYXNOZXh0UGFnZVByb2R1Y3RPclNlcnZpY2VzID0gcmVzLmRhdGEudG90YWwgLyBfdGhpczE1LnByb2R1Y3RPclNlcnZpY2VzU2VhcmNoUGF5bG9hZC5pdGVtc1BlclBhZ2UgPiBfdGhpczE1LnByb2R1Y3RPclNlcnZpY2VzU2VhcmNoUGF5bG9hZC5wYWdlOwogICAgICAgICAgICAgICAgX3RoaXMxNS5wcm9kdWN0T3JTZXJ2aWNlc1NlYXJjaFBheWxvYWQucGFnZSArPSAxOwogICAgICAgICAgICAgICAgaWYgKCFfdGhpczE1LmlzTW9kZUNyZWF0ZSAmJiBfdGhpczE1LmVkaXRpbmdJdGVtLmRpcmVjdG9yeVByb2R1Y3RPclNlcnZpY2VJZCkgewogICAgICAgICAgICAgICAgICB2YXIgZm91bmRJdG0gPSBfdGhpczE1LnByb2R1Y3RzLmZpbmQoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmlkID09IF90aGlzMTUuZWRpdGluZ0l0ZW0uZGlyZWN0b3J5UHJvZHVjdE9yU2VydmljZUlkOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgaWYgKCFmb3VuZEl0bSAmJiBfdGhpczE1LmVkaXRpbmdJdGVtLmRpcmVjdG9yeVByb2R1Y3RPclNlcnZpY2VEdG8pIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczE1LnByb2R1Y3RzLnB1c2goX3RoaXMxNS5lZGl0aW5nSXRlbS5kaXJlY3RvcnlQcm9kdWN0T3JTZXJ2aWNlRHRvKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgIF90aGlzMTUucHJvZHVjdHMgPSBbXTsKICAgICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIF90aGlzMTUuaXNMb2FkaW5nUHJvZHVjdE9yU2VydmljZXMgPSBmYWxzZTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIxLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMjEpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBmZXRjaENvbnRyYWN0b3JzV2l0aEtleXdvcmQ6IGZ1bmN0aW9uIGZldGNoQ29udHJhY3RvcnNXaXRoS2V5d29yZChrZXl3b3JkKSB7CiAgICAgIHZhciBtYWtlRmlyc3RTZWxlY3RlZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIHRoaXMuY29udHJhY3RvcnMgPSBbXTsKICAgICAgdGhpcy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5wYWdlID0gMTsKICAgICAgdGhpcy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5rZXl3b3JkID0ga2V5d29yZCA/IGtleXdvcmQgOiAnJzsKICAgICAgLy8gdGhpcy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5zb3J0QnkgPSBbXQogICAgICAvLyB0aGlzLmNvbnRyYWN0b3JTZWFyY2hQYXlsb2FkLnNvcnRCeS5wdXNoKCdjcmVhdGVkJykKICAgICAgLy8gdGhpcy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5zb3J0RGVzYyA9IFtdCiAgICAgIC8vIHRoaXMuY29udHJhY3RvclNlYXJjaFBheWxvYWQuc29ydERlc2MucHVzaChmYWxzZSkKICAgICAgdGhpcy5mZXRjaENvbnRyYWN0b3JzKG1ha2VGaXJzdFNlbGVjdGVkKTsKICAgIH0sCiAgICBmZXRjaENvbnRyYWN0b3JzOiBmdW5jdGlvbiBmZXRjaENvbnRyYWN0b3JzKG1ha2VGaXJzdFNlbGVjdGVkKSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIyKCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMjIkKF9jb250ZXh0MjIpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MjIucHJldiA9IF9jb250ZXh0MjIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3RoaXMxNi5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5zb3J0QnkgPSBbXTsKICAgICAgICAgICAgICBfdGhpczE2LmNvbnRyYWN0b3JTZWFyY2hQYXlsb2FkLnNvcnRCeS5wdXNoKCdjcmVhdGVkJyk7CiAgICAgICAgICAgICAgX3RoaXMxNi5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5zb3J0RGVzYyA9IFtdOwogICAgICAgICAgICAgIF90aGlzMTYuY29udHJhY3RvclNlYXJjaFBheWxvYWQuc29ydERlc2MucHVzaCh0cnVlKTsKICAgICAgICAgICAgICBfdGhpczE2LmlzTG9hZGluZ0NvbnRyYWN0b3JzID0gdHJ1ZTsKICAgICAgICAgICAgICBfY29udGV4dDIyLm5leHQgPSA3OwogICAgICAgICAgICAgIHJldHVybiBjcnVkQW5kTGlzdHNTZXJ2aWNlLnNlYXJjaExpc3RXaXRoS2V5d29yZCgnY29udHJhY3RvcicsIF90aGlzMTYuY29udHJhY3RvclNlYXJjaFBheWxvYWQsICdieS1jb250cmFjdG9yJykudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICB2YXIgX3RoaXMxNiRjb250cmFjdG9yczsKICAgICAgICAgICAgICAgIChfdGhpczE2JGNvbnRyYWN0b3JzID0gX3RoaXMxNi5jb250cmFjdG9ycykucHVzaC5hcHBseShfdGhpczE2JGNvbnRyYWN0b3JzLCBfdG9Db25zdW1hYmxlQXJyYXkocmVzLmRhdGEubGlzdCkpOwogICAgICAgICAgICAgICAgX3RoaXMxNi5oYXNOZXh0UGFnZUNvbnRyYWN0b3JzID0gcmVzLmRhdGEudG90YWwgLyBfdGhpczE2LmNvbnRyYWN0b3JTZWFyY2hQYXlsb2FkLml0ZW1zUGVyUGFnZSA+IF90aGlzMTYuY29udHJhY3RvclNlYXJjaFBheWxvYWQucGFnZTsKICAgICAgICAgICAgICAgIF90aGlzMTYuY29udHJhY3RvclNlYXJjaFBheWxvYWQucGFnZSArPSAxOwogICAgICAgICAgICAgICAgaWYgKG1ha2VGaXJzdFNlbGVjdGVkKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTYuZWRpdGluZ0l0ZW0uY29udHJhY3RvcklkID0gX3RoaXMxNi5jb250cmFjdG9ycy5sZW5ndGggPyBfdGhpczE2LmNvbnRyYWN0b3JzWzBdLmlkIDogbnVsbDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICghX3RoaXMxNi5pc01vZGVDcmVhdGUgJiYgX3RoaXMxNi5lZGl0aW5nSXRlbS5jb250cmFjdG9ySWQpIHsKICAgICAgICAgICAgICAgICAgdmFyIGNvbnRyYWN0b3JGb3VuZCA9IF90aGlzMTYuY29udHJhY3RvcnMuZmluZChmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWwuaWQgPT0gX3RoaXMxNi5lZGl0aW5nSXRlbS5jb250cmFjdG9ySWQ7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBpZiAoIWNvbnRyYWN0b3JGb3VuZCAmJiBfdGhpczE2LmVkaXRpbmdJdGVtLmNvbnRyYWN0b3JEdG8pIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczE2LmNvbnRyYWN0b3JzLnB1c2goX3RoaXMxNi5lZGl0aW5nSXRlbS5jb250cmFjdG9yRHRvKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgIF90aGlzMTYuY29udHJhY3RvcnMgPSBbXTsKICAgICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIF90aGlzMTYuaXNMb2FkaW5nQ29udHJhY3RvcnMgPSBmYWxzZTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMjIpOwogICAgICB9KSkoKTsKICAgIH0KICB9LAogIC8qDQogICogQ1JFQVRFRCAqLwogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMxNyA9IHRoaXM7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMjMoKSB7CiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMjMkKF9jb250ZXh0MjMpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDIzLnByZXYgPSBfY29udGV4dDIzLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX3RoaXMxNy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZCA9IE9iamVjdC5hc3NpZ24oe30sIF90aGlzMTcudmFyX2RlZmF1bHRfc2VhcmNoX3BheWxvYWQpOwogICAgICAgICAgICBfdGhpczE3LnByb2R1Y3RPclNlcnZpY2VzU2VhcmNoUGF5bG9hZCA9IE9iamVjdC5hc3NpZ24oe30sIF90aGlzMTcudmFyX2RlZmF1bHRfc2VhcmNoX3BheWxvYWQpOwogICAgICAgICAgICBfdGhpczE3Lm9rZWRTZWFyY2hQYXlsb2FkID0gT2JqZWN0LmFzc2lnbih7fSwgX3RoaXMxNy52YXJfZGVmYXVsdF9zZWFyY2hfcGF5bG9hZCk7CiAgICAgICAgICAgIF90aGlzMTcuc2twU2VhcmNoUGF5bG9hZCA9IE9iamVjdC5hc3NpZ24oe30sIF90aGlzMTcudmFyX2RlZmF1bHRfc2VhcmNoX3BheWxvYWQpOwogICAgICAgICAgICBfdGhpczE3LnRudmVkU2VhcmNoUGF5bG9hZCA9IE9iamVjdC5hc3NpZ24oe30sIF90aGlzMTcudmFyX2RlZmF1bHRfc2VhcmNoX3BheWxvYWQpOwogICAgICAgICAgICBfdGhpczE3LnZhcl9kZWZhdWx0X3NlYXJjaF9wYXlsb2FkLml0ZW1zUGVyUGFnZSA9IDUwMDsKICAgICAgICAgICAgaWYgKCFfdGhpczE3LmlzTW9kZUNyZWF0ZSkgewogICAgICAgICAgICAgIF9jb250ZXh0MjMubmV4dCA9IDExOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9jb250ZXh0MjMubmV4dCA9IDk7CiAgICAgICAgICAgIHJldHVybiBjcnVkQW5kTGlzdHNTZXJ2aWNlLmdldEVtcHR5KE1BSU5fQVBJX1VSTCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgX3RoaXMxNy5lZGl0aW5nSXRlbSA9IHJlcy5kYXRhOwogICAgICAgICAgICAgIGNydWRBbmRMaXN0c1NlcnZpY2UuZ2V0RW1wdHlDdXN0b21VcmwoIiIuY29uY2F0KEFOTk9VTkNFRF9NRURJQV9BUElfVVJMLCAiL2VtcHR5IikpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgX3RoaXMxNy5kZWZhdWx0QW5ub3VuY2VkTWVkaWFEdG8gPSByZXMuZGF0YTsKICAgICAgICAgICAgICAgIGlmICghX3RoaXMxNy5lZGl0aW5nSXRlbS5hbm5vdW5jZWRNZWRpYUR0b3MgfHwgIV90aGlzMTcuZWRpdGluZ0l0ZW0uYW5ub3VuY2VkTWVkaWFEdG9zLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICBfdGhpczE3LmVkaXRpbmdJdGVtLmFubm91bmNlZE1lZGlhRHRvcyA9IFtdOwogICAgICAgICAgICAgICAgICB2YXIgdG1wID0gT2JqZWN0LmFzc2lnbih7fSwgX3RoaXMxNy5kZWZhdWx0QW5ub3VuY2VkTWVkaWFEdG8pOwogICAgICAgICAgICAgICAgICBfdGhpczE3LmVkaXRpbmdJdGVtLmFubm91bmNlZE1lZGlhRHRvcy5wdXNoKHRtcCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGNydWRBbmRMaXN0c1NlcnZpY2UuZ2V0RW1wdHlDdXN0b21VcmwoIiIuY29uY2F0KFBSSUNFX0FQUFJPVkFMX0FQSV9VUkwsICIvZW1wdHkiKSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICBfdGhpczE3LmRlZmF1bHRQcmljZUFwcHJvdmFsRHRvID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgICBpZiAoIV90aGlzMTcuZWRpdGluZ0l0ZW0ucHJpY2VBcHByb3ZhbER0b3MgfHwgIV90aGlzMTcuZWRpdGluZ0l0ZW0ucHJpY2VBcHByb3ZhbER0b3MubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTcuZWRpdGluZ0l0ZW0ucHJpY2VBcHByb3ZhbER0b3MgPSBbXTsKICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9IE9iamVjdC5hc3NpZ24oe30sIF90aGlzMTcuZGVmYXVsdFByaWNlQXBwcm92YWxEdG8pOwogICAgICAgICAgICAgICAgICBfdGhpczE3LmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxEdG9zLnB1c2godG1wKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgY3J1ZEFuZExpc3RzU2VydmljZS5nZXRFbXB0eUN1c3RvbVVybCgiIi5jb25jYXQoQ09NTUlTU0lPTl9BUFBMSUNBVElPTl9BUElfVVJMLCAiL2VtcHR5IikpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgX3RoaXMxNy5kZWZhdWx0Q29tbWlzc2lvbkFwcGxpY2F0aW9uRHRvID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgICBpZiAoIV90aGlzMTcuZWRpdGluZ0l0ZW0uY29tbWlzc2lvbkFwcGxpY2F0aW9uRHRvcyB8fCAhX3RoaXMxNy5lZGl0aW5nSXRlbS5jb21taXNzaW9uQXBwbGljYXRpb25EdG9zLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICBfdGhpczE3LmVkaXRpbmdJdGVtLmNvbW1pc3Npb25BcHBsaWNhdGlvbkR0b3MgPSBbXTsKICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9IE9iamVjdC5hc3NpZ24oe30sIF90aGlzMTcuZGVmYXVsdENvbW1pc3Npb25BcHBsaWNhdGlvbkR0byk7CiAgICAgICAgICAgICAgICAgIF90aGlzMTcuZWRpdGluZ0l0ZW0uY29tbWlzc2lvbkFwcGxpY2F0aW9uRHRvcy5wdXNoKHRtcCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgX2NvbnRleHQyMy5uZXh0ID0gMTM7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgX2NvbnRleHQyMy5uZXh0ID0gMTM7CiAgICAgICAgICAgIHJldHVybiBjcnVkQW5kTGlzdHNTZXJ2aWNlLmdldEJ5SWQoTUFJTl9BUElfVVJMLCBfdGhpczE3LiRyb3V0ZS5wYXJhbXMuaWQsIHRydWUpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5kb2N1bWVudFN0YXR1c0NvZGUgIT0gJ1BFTkRJTkcnKSB7CiAgICAgICAgICAgICAgICBfdGhpczE3LiRyb3V0ZXIuZ28oLTEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBfdGhpczE3LmVkaXRpbmdJdGVtID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgLy8gdGhpcy5zZXRGaWxlc0Zyb21TZXJ2ZXIoKQoKICAgICAgICAgICAgICBpZiAoIV90aGlzMTcuZWRpdGluZ0l0ZW0uYW5ub3VuY2VkTWVkaWFEdG9zIHx8ICFfdGhpczE3LmVkaXRpbmdJdGVtLmFubm91bmNlZE1lZGlhRHRvcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIGNydWRBbmRMaXN0c1NlcnZpY2UuZ2V0RW1wdHlDdXN0b21VcmwoIiIuY29uY2F0KEFOTk9VTkNFRF9NRURJQV9BUElfVVJMLCAiL2VtcHR5IikpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICBfdGhpczE3LmRlZmF1bHRBbm5vdW5jZWRNZWRpYUR0byA9IHJlcy5kYXRhOwogICAgICAgICAgICAgICAgICBpZiAoIV90aGlzMTcuZWRpdGluZ0l0ZW0uYW5ub3VuY2VkTWVkaWFEdG9zIHx8ICFfdGhpczE3LmVkaXRpbmdJdGVtLmFubm91bmNlZE1lZGlhRHRvcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczE3LmVkaXRpbmdJdGVtLmFubm91bmNlZE1lZGlhRHRvcyA9IFtdOwogICAgICAgICAgICAgICAgICAgIHZhciB0bXAgPSBPYmplY3QuYXNzaWduKHt9LCBfdGhpczE3LmRlZmF1bHRBbm5vdW5jZWRNZWRpYUR0byk7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMxNy5lZGl0aW5nSXRlbS5hbm5vdW5jZWRNZWRpYUR0b3MucHVzaCh0bXApOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoIV90aGlzMTcuZWRpdGluZ0l0ZW0ucHJpY2VBcHByb3ZhbER0b3MgfHwgIV90aGlzMTcuZWRpdGluZ0l0ZW0ucHJpY2VBcHByb3ZhbER0b3MubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBjcnVkQW5kTGlzdHNTZXJ2aWNlLmdldEVtcHR5Q3VzdG9tVXJsKCIiLmNvbmNhdChQUklDRV9BUFBST1ZBTF9BUElfVVJMLCAiL2VtcHR5IikpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICBfdGhpczE3LmRlZmF1bHRQcmljZUFwcHJvdmFsRHRvID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgICAgIGlmICghX3RoaXMxNy5lZGl0aW5nSXRlbS5wcmljZUFwcHJvdmFsRHRvcyB8fCAhX3RoaXMxNy5lZGl0aW5nSXRlbS5wcmljZUFwcHJvdmFsRHRvcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczE3LmVkaXRpbmdJdGVtLnByaWNlQXBwcm92YWxEdG9zID0gW107CiAgICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9IE9iamVjdC5hc3NpZ24oe30sIF90aGlzMTcuZGVmYXVsdFByaWNlQXBwcm92YWxEdG8pOwogICAgICAgICAgICAgICAgICAgIF90aGlzMTcuZWRpdGluZ0l0ZW0ucHJpY2VBcHByb3ZhbER0b3MucHVzaCh0bXApOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoIV90aGlzMTcuZWRpdGluZ0l0ZW0uY29tbWlzc2lvbkFwcGxpY2F0aW9uRHRvcyB8fCAhX3RoaXMxNy5lZGl0aW5nSXRlbS5jb21taXNzaW9uQXBwbGljYXRpb25EdG9zLmxlbmd0aCkgewogICAgICAgICAgICAgICAgY3J1ZEFuZExpc3RzU2VydmljZS5nZXRFbXB0eUN1c3RvbVVybCgiIi5jb25jYXQoQ09NTUlTU0lPTl9BUFBMSUNBVElPTl9BUElfVVJMLCAiL2VtcHR5IikpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICBfdGhpczE3LmRlZmF1bHRDb21taXNzaW9uQXBwbGljYXRpb25EdG8gPSByZXMuZGF0YTsKICAgICAgICAgICAgICAgICAgaWYgKCFfdGhpczE3LmVkaXRpbmdJdGVtLmNvbW1pc3Npb25BcHBsaWNhdGlvbkR0b3MgfHwgIV90aGlzMTcuZWRpdGluZ0l0ZW0uY29tbWlzc2lvbkFwcGxpY2F0aW9uRHRvcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczE3LmVkaXRpbmdJdGVtLmNvbW1pc3Npb25BcHBsaWNhdGlvbkR0b3MgPSBbXTsKICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gT2JqZWN0LmFzc2lnbih7fSwgX3RoaXMxNy5kZWZhdWx0Q29tbWlzc2lvbkFwcGxpY2F0aW9uRHRvKTsKICAgICAgICAgICAgICAgICAgICBfdGhpczE3LmVkaXRpbmdJdGVtLmNvbW1pc3Npb25BcHBsaWNhdGlvbkR0b3MucHVzaCh0bXApOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICBfY29udGV4dDIzLm5leHQgPSAxNTsKICAgICAgICAgICAgcmV0dXJuIF90aGlzMTcuZmV0Y2hDb250cmFjdG9ycygpOwogICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgX2NvbnRleHQyMy5uZXh0ID0gMTc7CiAgICAgICAgICAgIHJldHVybiBfdGhpczE3LmZldGNoT2tlZHMoKTsKICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgIGlmICghX3RoaXMxNy5pc0RvbWluYW50KSB7CiAgICAgICAgICAgICAgX2NvbnRleHQyMy5uZXh0ID0gMjM7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX2NvbnRleHQyMy5uZXh0ID0gMjA7CiAgICAgICAgICAgIHJldHVybiBfdGhpczE3LmZldGNoU2twcygpOwogICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgX2NvbnRleHQyMy5uZXh0ID0gMjI7CiAgICAgICAgICAgIHJldHVybiBfdGhpczE3LmZldGNoVG52ZWRzKCk7CiAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAvLyBHRVQgR1JPVVBfT0ZfSU5ESVZJRFVBTFMKICAgICAgICAgICAgY3J1ZEFuZExpc3RzU2VydmljZS5zZWFyY2hMaXN0KCdyZWVzdHIvZ3JvdXAtb2YtaW5kaXZpZHVhbHMnLCBfdGhpczE3LnZhcl9kZWZhdWx0X3NlYXJjaF9wYXlsb2FkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczE3Lmdyb3VwT2ZJbmRpdmlkdWFscyA9IHJlcy5kYXRhLmxpc3Q7CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgX2NvbnRleHQyMy5uZXh0ID0gMjU7CiAgICAgICAgICAgIHJldHVybiBoZWxwZXJTZXJ2aWNlLmZldGNoUmVnaW9uc0ZvckNvbnRyYWN0b3JSZWVzdHJCeUN1cnJlbnRVc2VySWQoKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczE3LnJlZ2lvbnMgPSByZXMuZGF0YTsKICAgICAgICAgICAgICBfdGhpczE3LnJlZ2lvblNlbGVjdGVkKF90aGlzMTcuZWRpdGluZ0l0ZW0ucmVnaW9uSWQsIHRydWUpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgIGlmIChfdGhpczE3LiRyb3V0ZS5uYW1lLmluY2x1ZGVzKCdDcmVhdGUnKSB8fCBfdGhpczE3LiRyb3V0ZS5uYW1lLmluY2x1ZGVzKCdVcGRhdGUnKSkgewogICAgICAgICAgICAgIC8vIEdFVCBQUk9EVUNUX09SX1NFUlZJQ0VfVFlQRVMKICAgICAgICAgICAgICBjcnVkQW5kTGlzdHNTZXJ2aWNlLnNlYXJjaExpc3QoJ2RpcmVjdG9yeS9wcm9kdWN0LW9yLXNlcnZpY2UtdHlwZXMnLCBfdGhpczE3LnZhcl9kZWZhdWx0X3NlYXJjaF9wYXlsb2FkLCBfdGhpczE3LmlzRG9taW5hbnQgPyBBUFBFTkRfQVBJX1VSTF9ET01JTkFOVCA6IF90aGlzMTcuaXNOYXR1cmFsID8gQVBQRU5EX0FQSV9VUkxfTkFUVVJBTCA6ICcnKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgIF90aGlzMTcucHJvZHVjdFR5cGVzID0gcmVzLmRhdGEubGlzdDsKICAgICAgICAgICAgICAgIF90aGlzMTcucHJvZHVjdFR5cGVTZWxlY3RlZChfdGhpczE3LmVkaXRpbmdJdGVtLmRpcmVjdG9yeVByb2R1Y3RPclNlcnZpY2VUeXBlSWQsIHRydWUpOwogICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gR0VUIFVOSVRTCiAgICAgICAgICAgIGNydWRBbmRMaXN0c1NlcnZpY2Uuc2VhcmNoTGlzdFdpdGhLZXl3b3JkKCdkaXJlY3RvcnkvdW5pdHMnLCBfdGhpczE3LnZhcl9kZWZhdWx0X3NlYXJjaF9wYXlsb2FkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczE3LnVuaXRzID0gcmVzLmRhdGEubGlzdDsKICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICBjYXNlIDI3OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjMuc3RvcCgpOwogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTIzKTsKICAgIH0pKSgpOwogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;AAs6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;EACAA;EACA;AACA;EACAC;EACA;AACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACA;MACA;MACAC;MACAC;MACAC;MACAC;MACA;MACA;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;MACAC;IACA;EACA;EACA;AACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MAAA;MACA;QAAA;MAAA;MACA;QACA;MACA;QACA;MACA;IACA;EACA;EACA;AACA;EACAC;IACAC;MAAA;MACA;QAAA;UAAA;UAAA;YAAA;cAAA;gBAAA,KACAC;kBAAA;kBAAA;gBAAA;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBACA;kBAAAC;gBAAA;gBAAA;cAAA;gBAGA;kBACA;gBACA;gBACAC;gBACAC;gBACAC;gBACAC;gBACAC;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACA;cAAA;gBAAAC;gBACAC;kBACA;kBACA;kBACA;kBACA;oBAAAP;kBAAA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA,OAEA;cAAA;gBAAAM;gBACAE,4EACA;kBACA;kBACA;kBACA;kBACA;oBAAAR;kBAAA;gBACA,GACAS;kBACA;kBACA;kBACA;kBACA;kBACA;gBACA;cAAA;gBAAA;gBAAA;cAAA;gBAGA;kBAAAT;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA,CAEA;QAAA;UAAA;QAAA;MAAA;IACA;IACAU;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cACAC,sDACAC;gBAAA;cAAA,GACAA;gBACAC;gBACAA;gBACA;kBACAb;gBACA;gBAEA;gBACA;cACA,GACAS;gBAAA;cAAA;;cAEA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;;cAEA;cACA;cACA;cACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAK;MAAA;QAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAAC;cACA;gBACA;cACA;cACA;cAAA,KACAC;gBAAA;gBAAA;cAAA;cAAA;cAAA,OACAT,gDACAK;gBACA;cACA,GACAH;gBACAQ;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACAC;MACA;QACA;QACAC;QACAA;UAAA;QAAA;QACAA;UAAA;QAAA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cACA;cACAC;cACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;cACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;cACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;cATA;cAAA,OAUA;gBACA;kBACA;kBACA;oBACAC;sBAAA;wBAAA;wBAAA;0BAAA;4BAAA;8BAAA,KACAC;gCAAA;gCAAA;8BAAA;8BACAC;8BAAA;8BAAA;4BAAA;8BAAA;8BAAA,OAEA;4BAAA;8BAAAC;8BACAD;4BAAA;4BAAA;8BAAA;0BAAA;wBAAA;sBAAA,CAEA;sBAAA;wBAAA;sBAAA;oBAAA;kBACA;kBACAF;kBACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;kBACA;gBACA;cACA;YAAA;cA1BA;cAAA;cAAA,OA4BA;gBACA;kBACA;kBACA;oBACAA;sBAAA;wBAAA;wBAAA;0BAAA;4BAAA;8BAAA,KACAC;gCAAA;gCAAA;8BAAA;8BACAG;8BAAA;8BAAA;4BAAA;8BAAA;8BAAA,OAEA;4BAAA;8BAAAD;8BACAC;4BAAA;4BAAA;8BAAA;0BAAA;wBAAA;sBAAA,CAEA;sBAAA;wBAAA;sBAAA;oBAAA;kBACA;kBACAJ;kBACA;gBACA;cACA;YAAA;cAhBA;cAkBA;gBACA;kBACA;gBACA;cACA;cACA;cACA;cACA;cACA;cACA;cAAA,MACA;gBAAA;gBAAA;cAAA;cACA;cACA;cAAA,kCACA;YAAA;cAAA,KACA;gBAAA;gBAAA;cAAA;cAAA;cAAA,OACA;YAAA;cAAAG;cACA;cACA;cAAA,kCACA;YAAA;cAAA,kCAKA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAGA;IACAE;MACA;QAAA;MAAA;MACA;QACA;UACAC;UACAC;UACAC;QACA;MACA;MACA;IACA;IACAC;MACA;QAAA;MAAA;MACA;QACA;UACAH;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAE;MACA;QAAA;MAAA;MACA;QACA;UACAJ;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAG;MACA;QAAA;MAAA;MACA;QACA;UACAL;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAI;MACA;QAAA;MAAA;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;QAAA;MAAA;MACA;QACA;UACAP;UACAC;UACAC;QACA;MAEA;MACA;IACA;IACAM;MAAA;QAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAAzB;cACA;gBACA;gBACA;gBACA;cACA;cAAA,KACAC;gBAAA;gBAAA;cAAA;cAAA;cAAA,OAEA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAUA;IACAyB;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QAAA;MAAA;MACA;QACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACAC;cACA;gBAAA;kBAAA;oBAAA;sBAAA;sBAAA,OACA;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA,CACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACAD;cACA;gBAAA;kBAAA;oBAAA;sBAAA;sBAAA,OACA;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA,CACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAE;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACAJ;cACA;gBAAA;kBAAA;oBAAA;sBAAA;sBAAA,OACA;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA,CACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAK;MACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cAAA;cAAA,OACA3C,mFACAI;gBAAA;gBACA;gBACA;gBACA;gBACA;kBACA;oBAAA;kBAAA;kBACA;oBACA;kBACA;gBACA;cACA,GACAH;gBACAQ;gBACA;cACA,GACAmC;gBACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAC;MACA;QAAA;MAAA;MACA;QACA;UACArB;UACAC;UACAC;QACA;MACA;MACA;IACA;IACA;IAEA;IACAoB;MACA;QACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACAV;cACA;gBAAA;kBAAA;oBAAA;sBAAA;sBAAA,OACA;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA,CACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAW;MACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cAAA;cAAA,OACAjD,iFACAI;gBAAA;gBACA;gBACA;gBACA;gBACA;kBACA;oBAAA;kBAAA;kBACA;oBACA;kBACA;gBACA;cACA,GACAH;gBACAQ;gBACA;cACA,GACAmC;gBACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAM;MACA;QAAA;MAAA;MACA;QACA;UACA1B;UACAC;UACAC;QACA;MACA;MACA;IACA;IACA;IAEA;IACAyB;MACA;QACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACAf;cACA;gBAAA;kBAAA;oBAAA;sBAAA;sBAAA,OACA;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA,CACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAgB;MACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cAAA;cAAA,OACAtD,qFACAI;gBAAA;gBACA;gBACA;gBACA;gBACA;kBACA;oBAAA;kBAAA;kBACA;oBACA;kBACA;gBACA;cACA,GACAH;gBACAQ;gBACA;cACA,GACAmC;gBACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAW;MACA;QAAA;MAAA;MACA;QACA;UACA/B;UACAC;UACAC;QACA;MACA;MACA;IACA;IACA;IACA8B;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cAAA;cAAA,OACAzD,2FACAK;gBAAA;gBACA;gBACA;gBACA;gBACA;kBACA;oBAAA;kBAAA;kBACA;oBACA;kBACA;gBACA;cACA,GACAH;gBACAQ;gBACA;cACA,GACAmC;gBACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAa;MAAA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cACA;cACA;cACA;cACA;cAAA;cAAA,OACA1D,0GACAI;gBAAA;gBACA;gBACA;gBACA;gBACA;kBACA;gBACA;gBACA;kBACA;oBAAA;kBAAA;kBACA;oBACA;kBACA;gBACA;cACA,GACAH;gBACAQ;gBACA;cACA,GACAmC;gBACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;EACA;EACA;AACA;EACAe;IAAA;IAAA;MAAA;QAAA;UAAA;YACA;YACA;YACA;YACA;YACA;YACA;YAAA,KACA;cAAA;cAAA;YAAA;YAAA;YAAA,OACA3D,2CACAI;cACA;cACAJ,oFACAI;gBACA;gBACA;kBACA;kBACA;kBACA;gBACA;cACA,GACAH;gBACAQ;cACA;cAEAT,mFACAI;gBACA;gBACA;kBACA;kBACA;kBACA;gBACA;cACA,GACAH;gBACAQ;cACA;cAEAT,2FACAI;gBACA;gBACA;kBACA;kBACA;kBACA;gBACA;cACA,GACAH;gBACAQ;cACA;YACA,GACAR;cACAQ;YACA;UAAA;YAAA;YAAA;UAAA;YAAA;YAAA,OAGAT,0EACAI;cACA;gBACA;cACA;cACA;cACA;;cAEA;gBACAJ,oFACAI;kBACA;kBACA;oBACA;oBACA;oBACA;kBACA;gBACA,GACAH;kBACAQ;gBACA;cACA;cAEA;gBACAT,mFACAI;kBACA;kBACA;oBACA;oBACA;oBACA;kBACA;gBACA,GACAH;kBACAQ;gBACA;cACA;cAEA;gBACAT,2FACAI;kBACA;kBACA;oBACA;oBACA;oBACA;kBACA;gBACA,GACAH;kBACAQ;gBACA;cACA;YACA,GACAR;cACAQ;YACA;UAAA;YAAA;YAAA,OAGA;UAAA;YAAA;YAAA,OAGA;UAAA;YAAA,KAEA;cAAA;cAAA;YAAA;YAAA;YAAA,OAEA;UAAA;YAAA;YAAA,OAGA;UAAA;YAEA;YACAT,oBACA4D,8EACAxD;cACA;YACA,GACAH;cACAQ;YACA;UAAA;YAAA;YAAA,OAIAV,+DACAK;cACA;cACA;YACA,GACAH;cACAQ;YACA;UAAA;YAEA;cACA;cACAT,oBACA4D,qLACAxD;gBACA;gBACA;cACA,GACAH;gBACAQ;cACA;YACA;;YAEA;YACAT,oBACA6D,6EACAzD;cACA;YACA,GACAH;cACAQ;YACA;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EACA;AACA","names":["name","components","data","editingItem","publicPath","defaultCommissionApplicationDto","defaultAnnouncedMediaDto","defaultPriceApprovalDto","regions","districts","hasNextPageContractors","hasNextPageProductOrServices","contractors","debounce","isLoadingContractors","isLoadingProductOrServices","contractorSearchPayload","productOrServicesSearchPayload","productTypes","products","units","okeds","hasNextPageOked","isLoadingOked","okedSearchPayload","skps","hasNextPageSkp","isLoadingSkp","skpSearchPayload","tnveds","hasNextPageTnved","isLoadingTnved","tnvedSearchPayload","contractorCreateModal","groupOfIndividuals","computed","computedObserver","isModeCreate","isDominant","isNatural","contractorHasParent","methods","save","valid","type","tmpPriceApprovalFiles","tmpProductOrServices","tmpAnnouncedMedia","tmpPriceApprovalDtos","tmpCommissions","payload","helperService","crudAndListsService","catch","setFilesFromServer","fetch","then","myBlob","regionSelected","dontResetDistrict","$event","console","addCommissionApplicationDto","addAnnouncedMediaDto","addPriceApprovalDto","newRefCreated","getBase64","reader","makeAndReturnFormDataForBase64","vm","el","f","base64AnnouncementFiles","res","base64PriceApprovalFiles","customLabelRegion","nameRu","nameLt","nameUz","customLabelDistrict","customLabelProduct","customLabelUnit","customLabelGroupOfIndividuals","customLabelProductType","productTypeSelected","contractorReachedEndOfList","productOrServicesReachedEndOfList","customLabelContractor","debounceSearchProductOrServices","clearTimeout","debounceSearchContractors","fetchProductOrServicesWithKeyword","okedReachedEndOfList","debounceSearchOked","fetchOkedsWithKeyword","fetchOkeds","finally","customLabelOked","skpReachedEndOfList","debounceSearchSkp","fetchSkpsWithKeyword","fetchSkps","customLabelSkp","tnvedReachedEndOfList","debounceSearchTnved","fetchTnvedsWithKeyword","fetchTnveds","customLabelTnved","fetchProductOrServices","fetchContractorsWithKeyword","fetchContractors","created","searchList","searchListWithKeyword"],"sourceRoot":"src/modules/reestr-contractors/modules/natural","sources":["CreateOrUpdate.vue"],"sourcesContent":["<template>\r\n    <base-create-or-update-wrapper\r\n        @save=\"save\"\r\n        has-save-suspend\r\n        :custom-title=\"$t('actions.add_to_reestr')\"\r\n    >\r\n        <ValidationObserver\r\n            ref=\"observer\"\r\n            v-slot=\"{}\"\r\n        >\r\n            <b-row class=\"mb-3\">\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseInputWithValidation\r\n                        rules=\"required\"\r\n                        class=\"required\"\r\n                        v-model=\"editingItem.orderNumber\"\r\n                        :label=\"$t('column.order_number')\"\r\n                        :placeholder=\"$t('column.order_number')\"\r\n                    />\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseDatePickerWithValidation\r\n                        rules=\"required\"\r\n                        class=\"required\"\r\n                        :label=\"$t('column.added_date_to_reestr')\"\r\n                        :placeholder=\"$t('column.added_date_to_reestr')\"\r\n                        disable-after\r\n                        v-model=\"editingItem.reestrAcceptedDate\"\r\n                        lang=\"ru\"\r\n                    ></BaseDatePickerWithValidation>\r\n                </b-col>\r\n            </b-row>\r\n\r\n            <b-row class=\"mb-3\">\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseMultiselectWithValidation\r\n                        rules=\"required\"\r\n                        class=\"required\"\r\n                        v-model=\"editingItem.contractorId\"\r\n                        :has-next-page=\"hasNextPageContractors\"\r\n                        @reachedEndOfList=\"contractorReachedEndOfList\"\r\n                        @search-change=\"debounceSearchContractors\"\r\n                        :searchable=\"true\"\r\n                        :allow-empty=\"false\"\r\n                        preserve-search\r\n                        :clear-on-select=\"false\"\r\n                        :loading=\"isLoadingContractors\"\r\n                        :internal-search=\"false\"\r\n                        :options=\"contractors.map(e => e.id)\"\r\n                        :label=\"$t('column.business_entity')\"\r\n                        placeholder=\"\"\r\n                        :custom-label=\"customLabelContractor\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                        with-create-addition\r\n                    >\r\n                        <template v-slot:append-slot>\r\n                            <b-button\r\n                                @click=\"contractorCreateModal = true\"\r\n                                variant=\"outline-primary\"\r\n                                style=\"padding: 2.5px 10px; font-size: 1.2rem;\"\r\n                            >\r\n                                <i class=\"mdi mdi-plus-circle\"></i>\r\n                            </b-button>\r\n                        </template>\r\n                    </BaseMultiselectWithValidation>\r\n                    <BaseModalForCreate\r\n                        v-model=\"contractorCreateModal\"\r\n                        without-list-search\r\n                        use-component-save-fn\r\n                        mainApiUrl=\"contractor\"\r\n                        createFormName=\"CreateFormContractor\"\r\n                        @new-ref-created-without-list-search=\"newRefCreated\"\r\n                    />\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseMultiselectWithValidation\r\n                        rules=\"required\"\r\n                        class=\"required\"\r\n                        v-model=\"editingItem.directoryProductOrServiceTypeId\"\r\n                        @select=\"productTypeSelected\"\r\n                        :options=\"productTypes.map(e => e.id)\"\r\n                        :label=\"$t('column.product_or_service_type')\"\r\n                        placeholder=\"\"\r\n                        :custom-label=\"customLabelProductType\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                    />\r\n                </b-col>\r\n            </b-row>\r\n            <b-row class=\"mb-3\">\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <!-- $can('republic', 'for reestr') -->\r\n                    <b-row>\r\n                        <b-col :cols=\"$can('republic', 'for reestr') ? 8 : 12\">\r\n                            <BaseMultiselectWithValidation\r\n                                v-if=\"editingItem.isRepublic && !editingItem.contractorId\"\r\n                                rules=\"required\"\r\n                                class=\"required\"\r\n                                disabled\r\n                                :custom-styles=\"$can('republic', 'for reestr') ? `grid-template-columns: 38% 62%;` : ''\"\r\n                                :options=\"regions.map(e => e.regionId)\"\r\n                                :value=\"null\"\r\n                                :label=\"$t('column.region')\"\r\n                                :placeholder=\"$t('messages.please_select_business_entity')\"\r\n                                :custom-label=\"customLabelRegion\"\r\n                                open-direction=\"bottom\"\r\n                                :max-height=\"600\"\r\n                                :show-labels=\"false\"\r\n                            />\r\n                            <BaseMultiselectWithValidation\r\n                                v-else-if=\"editingItem.isRepublic && !contractorHasParent\"\r\n                                rules=\"required\"\r\n                                class=\"required\"\r\n                                multiple\r\n                                :hide-selected=\"true\"\r\n                                :close-on-select=\"false\"\r\n                                :custom-styles=\"$can('republic', 'for reestr') ? `grid-template-columns: 38% 62%;` : ''\"\r\n                                v-model=\"editingItem.regionIds\"\r\n                                :options=\"regions.map(e => e.regionId)\"\r\n                                @select=\"regionSelected\"\r\n                                :label=\"$t('column.region')\"\r\n                                placeholder=\"\"\r\n                                :custom-label=\"customLabelRegion\"\r\n                                open-direction=\"bottom\"\r\n                                :max-height=\"600\"\r\n                                :show-labels=\"false\"\r\n                            />\r\n                            <BaseMultiselectWithValidation\r\n                                v-else\r\n                                rules=\"required\"\r\n                                class=\"required\"\r\n                                :custom-styles=\"$can('republic', 'for reestr') ? `grid-template-columns: 38% 62%;` : ''\"\r\n                                v-model=\"editingItem.regionId\"\r\n                                :options=\"regions.map(e => e.regionId)\"\r\n                                @select=\"regionSelected\"\r\n                                :label=\"$t('column.region')\"\r\n                                placeholder=\"\"\r\n                                :custom-label=\"customLabelRegion\"\r\n                                open-direction=\"bottom\"\r\n                                :max-height=\"600\"\r\n                                :show-labels=\"false\"\r\n                            />\r\n                        </b-col>\r\n                        <b-col\r\n                            cols=\"4\"\r\n                            v-if=\"$can('republic', 'for reestr')\"\r\n                        >\r\n                            <div class=\"form-check form-check-right\">\r\n                                <input\r\n                                    v-model=\"editingItem.isRepublic\"\r\n                                    class=\"form-check-input\"\r\n                                    type=\"checkbox\"\r\n                                    id=\"formCheckIsLegal\"\r\n                                />\r\n                                <label\r\n                                    class=\"form-check-label font-weight-normal\"\r\n                                    for=\"formCheckIsLegal\"\r\n                                >\r\n                                    {{ $t('column.is_republic') }}\r\n                                </label>\r\n                            </div>\r\n                        </b-col>\r\n                    </b-row>\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseMultiselectWithValidation\r\n                        rules=\"required\"\r\n                        class=\"required\"\r\n                        v-model=\"editingItem.directoryProductOrServiceId\"\r\n                        :options=\"products.map(el => el.id)\"\r\n                        :label=\"$t('submodules.product_or_services.title')\"\r\n                        placeholder=\"\"\r\n                        :custom-label=\"customLabelProduct\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                        :has-next-page=\"hasNextPageProductOrServices\"\r\n                        @reachedEndOfList=\"productOrServicesReachedEndOfList\"\r\n                        @search-change=\"debounceSearchProductOrServices\"\r\n                        :searchable=\"true\"\r\n                        :allow-empty=\"false\"\r\n                        preserve-search\r\n                        :clear-on-select=\"false\"\r\n                        :loading=\"isLoadingProductOrServices\"\r\n                        :internal-search=\"false\"\r\n                    />\r\n                </b-col>\r\n            </b-row>\r\n            <b-row\r\n                v-if=\"isDominant && editingItem.isRepublic && !contractorHasParent\"\r\n                class=\"mb-3\"\r\n            >\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <b-row>\r\n                        <b-col cols=\"8\">\r\n                            <BaseMultiselectWithValidation\r\n                                v-if=\"editingItem.isGroup\"\r\n                                rules=\"required\"\r\n                                class=\"required\"\r\n                                custom-styles=\"grid-template-columns: 38% 62%;\"\r\n                                v-model=\"editingItem.groupOfIndividualsId\"\r\n                                :options=\"groupOfIndividuals.map(e => e.id)\"\r\n                                :label=\"$t('column.group_of_individuals')\"\r\n                                placeholder=\"\"\r\n                                :custom-label=\"customLabelGroupOfIndividuals\"\r\n                                open-direction=\"bottom\"\r\n                                :max-height=\"600\"\r\n                                :show-labels=\"false\"\r\n                            />\r\n                        </b-col>\r\n                        <b-col cols=\"4\">\r\n                            <div class=\"form-check form-check-right\">\r\n                                <input\r\n                                    v-model=\"editingItem.isGroup\"\r\n                                    class=\"form-check-input\"\r\n                                    type=\"checkbox\"\r\n                                    id=\"formCheckIsGroup\"\r\n                                />\r\n                                <label\r\n                                    class=\"form-check-label font-weight-normal\"\r\n                                    for=\"formCheckIsGroup\"\r\n                                >\r\n                                    {{ $t('column.is_group') }}\r\n                                </label>\r\n                            </div>\r\n                        </b-col>\r\n                    </b-row>\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n\r\n                </b-col>\r\n            </b-row>\r\n            <b-row class=\"mb-3\">\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseMultiselectWithValidation\r\n                        v-if=\"!editingItem.isRepublic\"\r\n                        not-required\r\n                        v-model=\"editingItem.districtIds\"\r\n                        multiple\r\n                        :close-on-select=\"false\"\r\n                        :hide-selected=\"true\"\r\n                        :options=\"districts.map(e => e.id)\"\r\n                        :label=\"$t('column.district')\"\r\n                        :custom-label=\"customLabelDistrict\"\r\n                        placeholder=\"\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                    />\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseMultiselectWithValidation\r\n                        v-if=\"isDominant\"\r\n                        not-required\r\n                        v-model=\"editingItem.okedId\"\r\n                        :options=\"okeds.map(e => e.id)\"\r\n                        :label=\"$t('column.oked')\"\r\n                        placeholder=\"\"\r\n                        :custom-label=\"customLabelOked\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                        :has-next-page=\"hasNextPageOked\"\r\n                        @reachedEndOfList=\"okedReachedEndOfList\"\r\n                        @search-change=\"debounceSearchOked\"\r\n                        :searchable=\"true\"\r\n                        preserve-search\r\n                        :clear-on-select=\"false\"\r\n                        :loading=\"isLoadingOked\"\r\n                        :internal-search=\"false\"\r\n                    />\r\n                    <BaseMultiselectWithValidation\r\n                        v-else\r\n                        rules=\"required\"\r\n                        class=\"required\"\r\n                        :allow-empty=\"false\"\r\n                        v-model=\"editingItem.okedId\"\r\n                        :options=\"okeds.map(e => e.id)\"\r\n                        :label=\"$t('column.oked')\"\r\n                        placeholder=\"\"\r\n                        :custom-label=\"customLabelOked\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                        :has-next-page=\"hasNextPageOked\"\r\n                        @reachedEndOfList=\"okedReachedEndOfList\"\r\n                        @search-change=\"debounceSearchOked\"\r\n                        :searchable=\"true\"\r\n                        preserve-search\r\n                        :clear-on-select=\"false\"\r\n                        :loading=\"isLoadingOked\"\r\n                        :internal-search=\"false\"\r\n                    />\r\n                </b-col>\r\n            </b-row>\r\n            <b-row\r\n                v-if=\"isDominant\"\r\n                class=\"mb-3\"\r\n            >\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseMultiselectWithValidation\r\n                        not-required\r\n                        v-model=\"editingItem.tnvedId\"\r\n                        :options=\"tnveds.map(e => e.id)\"\r\n                        :label=\"$t('column.tnved_code')\"\r\n                        placeholder=\"\"\r\n                        :custom-label=\"customLabelTnved\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                        :has-next-page=\"hasNextPageTnved\"\r\n                        @reachedEndOfList=\"tnvedReachedEndOfList\"\r\n                        @search-change=\"debounceSearchTnved\"\r\n                        :searchable=\"true\"\r\n                        preserve-search\r\n                        :clear-on-select=\"false\"\r\n                        :loading=\"isLoadingTnved\"\r\n                        :internal-search=\"false\"\r\n                    />\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseMultiselectWithValidation\r\n                        not-required\r\n                        v-model=\"editingItem.skpId\"\r\n                        :options=\"skps.map(e => e.id)\"\r\n                        :label=\"$t('column.skp_code')\"\r\n                        placeholder=\"\"\r\n                        :custom-label=\"customLabelSkp\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                        :has-next-page=\"hasNextPageSkp\"\r\n                        @reachedEndOfList=\"skpReachedEndOfList\"\r\n                        @search-change=\"debounceSearchSkp\"\r\n                        :searchable=\"true\"\r\n                        preserve-search\r\n                        :clear-on-select=\"false\"\r\n                        :loading=\"isLoadingSkp\"\r\n                        :internal-search=\"false\"\r\n                    />\r\n                </b-col>\r\n            </b-row>\r\n            <b-row class=\"mb-3\">\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseInputWithValidation\r\n                        rules=\"required|positive\"\r\n                        class=\"required\"\r\n                        v-model=\"editingItem.governmentPercentage\"\r\n                        :label=\"$t('column.government_percentage')\"\r\n                        :placeholder=\"$t('column.government_percentage')\"\r\n                    />\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseMultiselectWithValidation\r\n                        rules=\"required\"\r\n                        class=\"required\"\r\n                        v-model=\"editingItem.unitId\"\r\n                        :options=\"units.map(el => el.id)\"\r\n                        :label=\"$t('column.unit')\"\r\n                        placeholder=\"\"\r\n                        :custom-label=\"customLabelUnit\"\r\n                        open-direction=\"bottom\"\r\n                        :max-height=\"600\"\r\n                        :show-labels=\"false\"\r\n                    />\r\n                </b-col>\r\n            </b-row>\r\n            <b-row class=\"mb-3\">\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <ValidationProvider\r\n                        v-if=\"isModeCreate\"\r\n                        name=\"supplementDoc\"\r\n                        rules=\"required\"\r\n                        mode=\"passive\"\r\n                    >\r\n                        <template v-slot:default=\"\">\r\n                            <BaseFileUploaderWithValidation\r\n                                class=\"required\"\r\n                                ref=\"supplementDocUploader\"\r\n                                v-model=\"editingItem.supplementDocs\"\r\n                                data-vv-name=\"supplementDocFile\"\r\n                                data-vv-as=\"SupplementDocFile\"\r\n                                :max-files=\"1\"\r\n                                :label-on-top=\"false\"\r\n                                :label=\"$t('column.ilova')\"\r\n                            ></BaseFileUploaderWithValidation>\r\n                        </template>\r\n                    </ValidationProvider>\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseTextareaWithValidation\r\n                        not-required\r\n                        v-model=\"editingItem.comment\"\r\n                        max-rows=\"8\"\r\n                        :label=\"$t('column.comment')\"\r\n                        :placeholder=\"$t('column.comment')\"\r\n                    />\r\n                </b-col>\r\n            </b-row>\r\n\r\n            <!-- PRICE_APPROVAL_BASIS -->\r\n            <b-row\r\n                v-if=\"isNatural\"\r\n                class=\"mb-3\"\r\n            >\r\n                <b-col cols=\"12\">\r\n                    <h5 class=\"m-0 text-center\">\r\n                        {{ $t('column.price_approval_basis') }}\r\n                    </h5>\r\n                    <hr class=\"my-2\">\r\n                </b-col>\r\n                <b-col\r\n                    v-for=\"(el, index) in editingItem.priceApprovalDtos\"\r\n                    :key=\"`price-approval-dto-${index}`\"\r\n                    cols=\"12\"\r\n                >\r\n                    <b-row class=\"mb-3\">\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <b-row>\r\n                                <b-col\r\n                                    sm=\"12\"\r\n                                    md=\"6\"\r\n                                >\r\n                                    <BaseDatePickerWithValidation\r\n                                        not-required\r\n                                        custom-styles=\"grid-template-columns: 40% 60%;\"\r\n                                        :label=\"$t('column.date')\"\r\n                                        disable-after\r\n                                        v-model=\"el.priceApprovalDate\"\r\n                                        lang=\"ru\"\r\n                                    ></BaseDatePickerWithValidation>\r\n                                </b-col>\r\n                                <b-col\r\n                                    sm=\"12\"\r\n                                    md=\"6\"\r\n                                >\r\n                                    <BaseDatePickerWithValidation\r\n                                        not-required\r\n                                        custom-styles=\"grid-template-columns: 40% 60%;\"\r\n                                        :label=\"$t('column.effective_date_price')\"\r\n                                        disable-after\r\n                                        v-model=\"el.priceEffectiveDate\"\r\n                                        lang=\"ru\"\r\n                                    ></BaseDatePickerWithValidation>\r\n                                </b-col>\r\n                            </b-row>\r\n\r\n                        </b-col>\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <BaseInputWithValidation\r\n                                not-required\r\n                                v-model=\"el.priceApprovalNumber\"\r\n                                :label=\"$t('column.number')\"\r\n                            />\r\n                        </b-col>\r\n                    </b-row>\r\n                    <b-row class=\"mb-3\">\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <ValidationProvider\r\n                                v-if=\"isModeCreate\"\r\n                                name=\"priceApprovalFiles\"\r\n                                rules=\"\"\r\n                                mode=\"passive\"\r\n                            >\r\n                                <template v-slot:default=\"\">\r\n                                    <BaseFileUploaderWithValidation\r\n                                        not-required\r\n                                        v-model=\"el.priceApprovalFiles\"\r\n                                        :max-files=\"5\"\r\n                                        :label-on-top=\"false\"\r\n                                        :label=\"$t('column.file')\"\r\n                                    ></BaseFileUploaderWithValidation>\r\n                                </template>\r\n                            </ValidationProvider>\r\n                        </b-col>\r\n\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <b-row>\r\n                                <b-col\r\n                                    cols=\"12\"\r\n                                    class=\"mb-3\"\r\n                                >\r\n                                    <BaseInputWithValidation\r\n                                        rules=\"positiveNotZero\"\r\n                                        v-model=\"el.currentPriceWithDuty\"\r\n                                        :label=\"$t('column.current_price_with_duty')\"\r\n                                    />\r\n                                </b-col>\r\n                                <b-col\r\n                                    cols=\"12\"\r\n                                    class=\"mb-3\"\r\n                                >\r\n                                    <BaseInputWithValidation\r\n                                        rules=\"positiveNotZero\"\r\n                                        v-model=\"el.currentPriceWithoutDuty\"\r\n                                        :label=\"$t('column.current_price_without_duty')\"\r\n                                    />\r\n                                </b-col>\r\n                                <b-col\r\n                                    sm=\"12\"\r\n                                    md=\"10\"\r\n                                    class=\"mb-3\"\r\n                                >\r\n                                    <BaseTextareaWithValidation\r\n                                        not-required\r\n                                        v-model=\"el.additionalInformation\"\r\n                                        custom-styles=\"grid-template-columns: 30% 70%;\"\r\n                                        :label=\"$t('column.additional_info')\"\r\n                                    />\r\n                                </b-col>\r\n                                <b-col\r\n                                    sm=\"12\"\r\n                                    md=\"2\"\r\n                                    class=\"d-flex align-items-start justify-content-end\"\r\n                                >\r\n                                    <b-btn\r\n                                        v-if=\"index == editingItem.priceApprovalDtos.length - 1\"\r\n                                        variant=\"success\"\r\n                                        class=\"mr-2\"\r\n                                        size=\"sm\"\r\n                                        @click=\"addPriceApprovalDto\"\r\n                                    ><i class=\"mdi mdi-plus\"></i></b-btn>\r\n                                    <b-btn\r\n                                        v-if=\"editingItem.priceApprovalDtos.length > 1\"\r\n                                        variant=\"danger\"\r\n                                        size=\"sm\"\r\n                                        @click=\"editingItem.priceApprovalDtos.splice(index, 1)\"\r\n                                    ><i class=\"mdi mdi-trash-can\"></i></b-btn>\r\n                                </b-col>\r\n                            </b-row>\r\n                        </b-col>\r\n                    </b-row>\r\n                    <hr class=\"my-2\">\r\n                </b-col>\r\n            </b-row>\r\n            <!-- <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <b-row>\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <BaseDatePickerWithValidation\r\n                                not-required\r\n                                custom-styles=\"grid-template-columns: 40% 60%;\"\r\n                                :label=\"$t('column.date')\"\r\n                                disable-after\r\n                                v-model=\"editingItem.priceApprovalDate\"\r\n                                lang=\"ru\"\r\n                            ></BaseDatePickerWithValidation>\r\n                        </b-col>\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <BaseDatePickerWithValidation\r\n                                not-required\r\n                                custom-styles=\"grid-template-columns: 40% 60%;\"\r\n                                :label=\"$t('column.effective_date_price')\"\r\n                                disable-after\r\n                                v-model=\"editingItem.priceEffectiveDate\"\r\n                                lang=\"ru\"\r\n                            ></BaseDatePickerWithValidation>\r\n                        </b-col>\r\n                    </b-row>\r\n\r\n                </b-col>\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <BaseInputWithValidation\r\n                        not-required\r\n                        v-model=\"editingItem.priceApprovalNumber\"\r\n                        :label=\"$t('column.number')\"\r\n                    />\r\n                </b-col> -->\r\n            <!-- <b-row\r\n                v-if=\"isNatural\"\r\n                class=\"mb-3\"\r\n            >\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <ValidationProvider\r\n                        v-if=\"isModeCreate\"\r\n                        name=\"priceApprovalFiles\"\r\n                        rules=\"\"\r\n                        mode=\"passive\"\r\n                    >\r\n                        <template v-slot:default=\"\">\r\n                            <BaseFileUploaderWithValidation\r\n                                not-required\r\n                                v-model=\"editingItem.priceApprovalFiles\"\r\n                                :max-files=\"5\"\r\n                                :label-on-top=\"false\"\r\n                                :label=\"$t('column.file')\"\r\n                            ></BaseFileUploaderWithValidation>\r\n                        </template>\r\n                    </ValidationProvider>\r\n                </b-col>\r\n\r\n                <b-col\r\n                    sm=\"12\"\r\n                    md=\"6\"\r\n                >\r\n                    <b-row>\r\n                        <b-col\r\n                            cols=\"12\"\r\n                            class=\"mb-3\"\r\n                        >\r\n                            <BaseInputWithValidation\r\n                                rules=\"positiveNotZero\"\r\n                                v-model=\"editingItem.currentPriceWithDuty\"\r\n                                :label=\"$t('column.current_price_with_duty')\"\r\n                            />\r\n                        </b-col>\r\n                        <b-col\r\n                            cols=\"12\"\r\n                            class=\"mb-3\"\r\n                        >\r\n                            <BaseInputWithValidation\r\n                                rules=\"positiveNotZero\"\r\n                                v-model=\"editingItem.currentPriceWithoutDuty\"\r\n                                :label=\"$t('column.current_price_without_duty')\"\r\n                            />\r\n                        </b-col>\r\n                        <b-col\r\n                            cols=\"12\"\r\n                            class=\"mb-3\"\r\n                        >\r\n                            <BaseTextareaWithValidation\r\n                                not-required\r\n                                v-model=\"editingItem.additionalInformation\"\r\n                                :label=\"$t('column.additional_info')\"\r\n                            />\r\n                        </b-col>\r\n                    </b-row>\r\n                </b-col>\r\n                <hr class=\"my-2\">\r\n            </b-row> -->\r\n            <!-- END OF PRICE_APPROVAL_BASIS FORM -->\r\n            <!-- ANNOUNCED_MEDIA_DTO -->\r\n            <b-row\r\n                v-if=\"isNatural\"\r\n                class=\"mb-3\"\r\n            >\r\n                <b-col cols=\"12\">\r\n                    <h5 class=\"m-0 text-center\">\r\n                        {{ $t('column.announced_media') }}\r\n                    </h5>\r\n                    <hr class=\"my-2\">\r\n                </b-col>\r\n\r\n                <b-col\r\n                    v-for=\"(el, index) in editingItem.announcedMediaDtos\"\r\n                    :key=\"`announced-media-${index}`\"\r\n                    cols=\"12\"\r\n                >\r\n                    <b-row class=\"mb-3\">\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <BaseInputWithValidation\r\n                                not-required\r\n                                v-model=\"el.announcedMediaName\"\r\n                                :label=\"$t('column.name')\"\r\n                            />\r\n                        </b-col>\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <BaseInputWithValidation\r\n                                not-required\r\n                                v-model=\"el.announcedMediaLink\"\r\n                                :label=\"$t('column.link')\"\r\n                            />\r\n                        </b-col>\r\n                    </b-row>\r\n                    <b-row class=\"mb-3\">\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <ValidationProvider\r\n                                v-if=\"isModeCreate\"\r\n                                name=\"annuncedMediaFiles\"\r\n                                rules=\"\"\r\n                                mode=\"passive\"\r\n                            >\r\n                                <template v-slot:default=\"\">\r\n                                    <BaseFileUploaderWithValidation\r\n                                        not-required\r\n                                        v-model=\"el.announcedMediaFiles\"\r\n                                        :max-files=\"10\"\r\n                                        :label-on-top=\"false\"\r\n                                        :label=\"$t('column.files')\"\r\n                                    ></BaseFileUploaderWithValidation>\r\n                                </template>\r\n                            </ValidationProvider>\r\n                        </b-col>\r\n\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"5\"\r\n                        >\r\n                            <BaseDatePickerWithValidation\r\n                                not-required\r\n                                custom-styles=\"grid-template-columns: 30% 70%;\"\r\n                                :label=\"$t('column.date')\"\r\n                                disable-after\r\n                                v-model=\"el.announcedMediaDate\"\r\n                                lang=\"ru\"\r\n                            ></BaseDatePickerWithValidation>\r\n                        </b-col>\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"1\"\r\n                            class=\"d-flex align-items-start justify-content-end\"\r\n                        >\r\n                            <b-btn\r\n                                v-if=\"index == editingItem.announcedMediaDtos.length - 1\"\r\n                                variant=\"success\"\r\n                                class=\"mr-2\"\r\n                                size=\"sm\"\r\n                                @click=\"addAnnouncedMediaDto\"\r\n                            ><i class=\"mdi mdi-plus\"></i></b-btn>\r\n                            <b-btn\r\n                                v-if=\"editingItem.announcedMediaDtos.length > 1\"\r\n                                variant=\"danger\"\r\n                                size=\"sm\"\r\n                                @click=\"editingItem.announcedMediaDtos.splice(index, 1)\"\r\n                            ><i class=\"mdi mdi-trash-can\"></i></b-btn>\r\n                        </b-col>\r\n                    </b-row>\r\n                    <hr class=\"my-2\">\r\n                </b-col>\r\n            </b-row>\r\n            <!-- END OF ANNOUNCED_MEDIA_DTO FORM -->\r\n\r\n            <!-- COMMISSION_APPLICATION_DTO -->\r\n            <b-row class=\"mb-3\">\r\n                <b-col cols=\"12\">\r\n                    <h5 class=\"m-0 text-center\">\r\n                        {{ $t('column.commission_applications') }}\r\n                    </h5>\r\n                    <hr class=\"my-2\">\r\n                </b-col>\r\n\r\n                <b-col\r\n                    v-for=\"(el, index) in editingItem.commissionApplicationDtos\"\r\n                    :key=\"`commission-application-${index}`\"\r\n                    cols=\"12\"\r\n                >\r\n                    <b-row class=\"mb-3\">\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <BaseDatePickerWithValidation\r\n                                not-required\r\n                                :label=\"$t('column.date')\"\r\n                                disable-after\r\n                                v-model=\"el.commencementDate\"\r\n                                lang=\"ru\"\r\n                            ></BaseDatePickerWithValidation>\r\n                        </b-col>\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <BaseInputWithValidation\r\n                                not-required\r\n                                v-model=\"el.commencementNumber\"\r\n                                :label=\"$t('column.number')\"\r\n                            />\r\n                        </b-col>\r\n                    </b-row>\r\n                    <b-row class=\"mb-3\">\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <BaseInputWithValidation\r\n                                not-required\r\n                                v-model=\"el.initiatorName\"\r\n                                :label=\"$t('column.initiator')\"\r\n                            />\r\n                        </b-col>\r\n\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <BaseInputWithValidation\r\n                                not-required\r\n                                v-model=\"el.completionWorkType\"\r\n                                :label=\"$t('column.finishing_type')\"\r\n                            />\r\n                        </b-col>\r\n                    </b-row>\r\n                    <b-row class=\"mb-3\">\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <BaseInputWithValidation\r\n                                rules=\"positiveNotZero\"\r\n                                v-model=\"el.instructionAmount\"\r\n                                :label=\"$t('column.showcase_amount')\"\r\n                            />\r\n                        </b-col>\r\n\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"6\"\r\n                        >\r\n                            <BaseInputWithValidation\r\n                                rules=\"positiveNotZero\"\r\n                                v-model=\"el.residueAmount\"\r\n                                :label=\"$t('column.remainder_amount')\"\r\n                            />\r\n                        </b-col>\r\n                    </b-row>\r\n                    <b-row class=\"mb-3\">\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"5\"\r\n                        >\r\n                            <BaseDatePickerWithValidation\r\n                                not-required\r\n                                :label=\"$t('column.finishing_date')\"\r\n                                custom-styles=\"grid-template-columns: 30% 70%;\"\r\n                                disable-after\r\n                                v-model=\"el.completionWorkDate\"\r\n                                lang=\"ru\"\r\n                            ></BaseDatePickerWithValidation>\r\n                        </b-col>\r\n                        <b-col\r\n                            sm=\"12\"\r\n                            md=\"1\"\r\n                            class=\"d-flex align-items-start justify-content-end\"\r\n                        >\r\n                            <b-btn\r\n                                v-if=\"index == editingItem.commissionApplicationDtos.length - 1\"\r\n                                variant=\"success\"\r\n                                class=\"mr-2\"\r\n                                size=\"sm\"\r\n                                @click=\"addCommissionApplicationDto\"\r\n                            ><i class=\"mdi mdi-plus\"></i></b-btn>\r\n                            <b-btn\r\n                                v-if=\"editingItem.commissionApplicationDtos.length > 1\"\r\n                                variant=\"danger\"\r\n                                size=\"sm\"\r\n                                @click=\"editingItem.commissionApplicationDtos.splice(index, 1)\"\r\n                            ><i class=\"mdi mdi-trash-can\"></i></b-btn>\r\n                        </b-col>\r\n                    </b-row>\r\n                    <hr class=\"my-2\">\r\n                </b-col>\r\n            </b-row>\r\n            <!-- END OF COMMISSION_APPLICATION_DTO FORM -->\r\n        </ValidationObserver>\r\n    </base-create-or-update-wrapper>\r\n</template>\r\n<script>\r\nconst MAIN_API_URL = 'reestr/contractor-reestr-documents'\r\nconst APPEND_API_URL_NATURAL = 'estestveniy'\r\nconst APPEND_API_URL_DOMINANT = 'daminiriushiy'\r\nconst OKED_API_URL = 'reestr/info-oked'\r\nconst SKP_API_URL = 'reestr/info-skp'\r\nconst TNVED_API_URL = 'reestr/info-tnved'\r\nconst PRICE_APPROVAL_API_URL = 'reestr/contractor-reestr-documents/get/price-approval'\r\nconst ANNOUNCED_MEDIA_API_URL = 'reestr/contractor-reestr-documents/get/announced-media'\r\nconst COMMISSION_APPLICATION_API_URL = 'reestr/contractor-reestr-documents/get/commission-application'\r\n/*\r\n* YOU MUST SEND {{ MAIN_API_URL }} TO CRUD_SERVICE */\r\nimport crudAndListsService from \"@/shared/services/crud_and_list.service\"\r\nimport helperService from \"@/shared/services/helper.service\"\r\n\r\nexport default {\r\n    name: \"CreateOrUpdate\",\r\n    /*\r\n    * COMPONENTS */\r\n    components: {},\r\n    /*\r\n    * DATA */\r\n    data () {\r\n        return {\r\n            editingItem: {},\r\n            publicPath: process.env.BASE_URL,\r\n            defaultCommissionApplicationDto: {},\r\n            defaultAnnouncedMediaDto: {},\r\n            defaultPriceApprovalDto: {},\r\n            regions: [],\r\n            districts: [],\r\n            hasNextPageContractors: false,\r\n            hasNextPageProductOrServices: false,\r\n            contractors: [],\r\n            debounce: null,\r\n            isLoadingContractors: false,\r\n            isLoadingProductOrServices: false,\r\n            contractorSearchPayload: {},\r\n            productOrServicesSearchPayload: {},\r\n            productTypes: [],\r\n            products: [],\r\n            units: [],\r\n            // OKED VARIABLES\r\n            okeds: [],\r\n            hasNextPageOked: false,\r\n            isLoadingOked: false,\r\n            okedSearchPayload: {},\r\n            // ----------------\r\n            // SKP VARIABLES\r\n            skps: [],\r\n            hasNextPageSkp: false,\r\n            isLoadingSkp: false,\r\n            skpSearchPayload: {},\r\n            // ----------------\r\n            // TNVED VARIABLES\r\n            tnveds: [],\r\n            hasNextPageTnved: false,\r\n            isLoadingTnved: false,\r\n            tnvedSearchPayload: {},\r\n            // ----------------\r\n            contractorCreateModal: false,\r\n            groupOfIndividuals: []\r\n        }\r\n    },\r\n    /*\r\n    * COMPUTED */\r\n    computed: {\r\n        computedObserver () {\r\n            return this.$refs.observer\r\n        },\r\n        isModeCreate () {\r\n            return this.$route.name === 'CreateNaturalContractorReestr' || this.$route.name === 'CreateDominantContractorReestr'\r\n        },\r\n        isDominant () {\r\n            return this.$route.name === 'CreateDominantContractorReestr' || this.$route.name === 'UpdateDominantContractorReestr'\r\n        },\r\n        isNatural () {\r\n            return this.$route.name === 'CreateNaturalContractorReestr' || this.$route.name === 'UpdateNaturalContractorReestr'\r\n        },\r\n        contractorHasParent () {\r\n            let contractor = this.contractors.find(el => el.id == this.editingItem.contractorId)\r\n            if (contractor) {\r\n                return contractor.parent\r\n            } else {\r\n                return false\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * METHODS */\r\n    methods: {\r\n        save () {\r\n            this.computedObserver.validate().then(async valid => {\r\n                if (valid) {\r\n                    if (this.isDominant && !this.editingItem.okedId && !this.editingItem.skpId) {\r\n                        this.$toast(this.$t('messages.oked_or_skp_is_required'), { type: 'error' });\r\n                        return\r\n                    }\r\n                    if (!this.isDominant || !this.editingItem.isRepublic && this.contractorHasParent) {\r\n                        this.editingItem.isGroup = false\r\n                    }\r\n                    let tmpPriceApprovalFiles = (this.editingItem.priceApprovalFiles && this.editingItem.priceApprovalFiles.length) ? JSON.parse(JSON.stringify(this.editingItem.priceApprovalFiles)) : []\r\n                    let tmpProductOrServices = JSON.parse(JSON.stringify(this.editingItem.directoryProductOrServiceId))\r\n                    let tmpAnnouncedMedia = JSON.parse(JSON.stringify(this.editingItem.announcedMediaDtos))\r\n                    let tmpPriceApprovalDtos = JSON.parse(JSON.stringify(this.editingItem.priceApprovalDtos))\r\n                    let tmpCommissions = JSON.parse(JSON.stringify(this.editingItem.commissionApplicationDtos))\r\n                    if (this.editingItem.id) {\r\n                        let payload = await this.makeAndReturnFormDataForBase64()\r\n                        helperService.updateReestr(MAIN_API_URL, payload, `for-acceptance-${this.isDominant ? APPEND_API_URL_DOMINANT : this.isNatural ? APPEND_API_URL_NATURAL : ''}/${this.editingItem.id}`, true).then(res => {\r\n                            this.computedObserver.reset()\r\n                            this.editingItem = Object.assign({}, {});\r\n                            this.$router.go(-1)\r\n                            this.$toast(this.$t('messages.saved_successfully'), { type: 'success' });\r\n                        })\r\n                    } else {\r\n                        let payload = await this.makeAndReturnFormDataForBase64()\r\n                        crudAndListsService.create(MAIN_API_URL, payload,\r\n                            `for-acceptance-${this.isDominant ? APPEND_API_URL_DOMINANT : this.isNatural ? APPEND_API_URL_NATURAL : ''}`, true).then(res => {\r\n                                this.computedObserver.reset()\r\n                                this.editingItem = Object.assign({}, {});\r\n                                this.$router.go(-1)\r\n                                this.$toast(this.$t('messages.saved_successfully'), { type: 'success' });\r\n                            })\r\n                            .catch(e => {\r\n                                this.editingItem.directoryProductOrServiceId = JSON.parse(JSON.stringify(tmpProductOrServices))\r\n                                this.editingItem.commissionApplicationDtos = JSON.parse(JSON.stringify(tmpCommissions))\r\n                                this.editingItem.announcedMediaDtos = JSON.parse(JSON.stringify(tmpAnnouncedMedia))\r\n                                this.editingItem.priceApprovalDtos = JSON.parse(JSON.stringify(tmpPriceApprovalDtos))\r\n                                this.editingItem.priceApprovalFiles = JSON.parse(JSON.stringify(tmpPriceApprovalFiles))\r\n                            })\r\n                    }\r\n                } else {\r\n                    this.$toast(this.$t('messages.fill_required_fields'), { type: 'error' });\r\n                }\r\n            });\r\n        },\r\n        async setFilesFromServer () {\r\n            // ILOVA\r\n            fetch(this.publicPath + this.editingItem.fileUrl)\r\n                .then((res) => res.blob())\r\n                .then((myBlob) => {\r\n                    myBlob.name = f.name;\r\n                    myBlob.lastModified = new Date();\r\n                    const myFile = new File([myBlob], f.name, {\r\n                        type: myBlob.type,\r\n                    });\r\n\r\n                    let url = this.publicPath + f.url;\r\n                    this.$refs.supplementDocUploader.$refs.dropzone.manuallyAddFile(myFile, url);\r\n                })\r\n                .catch(e => console.log(e));\r\n\r\n            // this.editingItem.objectPhotoList.forEach(f => {\r\n            //     fetch(this.publicPath + f.url)\r\n            //         .then((res) => res.blob())\r\n            //         .then((myBlob) => {\r\n            //             myBlob.name = f.name;\r\n            //             myBlob.lastModified = new Date();\r\n            //             const myFile = new File([myBlob], f.name, {\r\n            //                 type: myBlob.type,\r\n            //             });\r\n\r\n            //             let url = this.publicPath + f.url;\r\n            //             this.$refs.photosUploader.$refs.dropzone.manuallyAddFile(myFile, url);\r\n            //         })\r\n            //         .catch(e => console.log(e));\r\n            // })\r\n        },\r\n        async regionSelected ($event, dontResetDistrict = false) {\r\n            if (!dontResetDistrict) {\r\n                this.editingItem.districtIds = []\r\n            }\r\n            // GET DISTRICTS\r\n            if ($event)\r\n                await helperService.getGeoLocationsByParentId($event)\r\n                    .then(res => {\r\n                        this.districts = res.data\r\n                    })\r\n                    .catch(e => {\r\n                        console.log(e)\r\n                    })\r\n        },\r\n        addCommissionApplicationDto () {\r\n            let tmp = Object.assign({}, this.defaultCommissionApplicationDto)\r\n            this.editingItem.commissionApplicationDtos.push(tmp)\r\n        },\r\n        addAnnouncedMediaDto () {\r\n            let tmp = Object.assign({}, this.defaultAnnouncedMediaDto)\r\n            this.editingItem.announcedMediaDtos.push(tmp)\r\n        },\r\n        addPriceApprovalDto () {\r\n            let tmp = Object.assign({}, this.defaultPriceApprovalDto)\r\n            this.editingItem.priceApprovalDtos.push(tmp)\r\n        },\r\n        newRefCreated (formName) {\r\n            if (formName == 'CreateFormContractor') {\r\n                this.fetchContractorsWithKeyword('', true)\r\n            }\r\n        },\r\n        /* makeAndReturnQueryParams () {\r\n            let queryString = `contractorId=${this.editingItem.contractorId}\r\n                         &directoryProductOrServiceTypeId=${this.editingItem.directoryProductOrServiceTypeId}\r\n                         &governmentPercentage=${this.editingItem.governmentPercentage}\r\n                         &orderNumber=${this.editingItem.orderNumber}\r\n                         &reestrAcceptedDate=${this.editingItem.reestrAcceptedDate}`\r\n            this.editingItem.directoryProductOrServiceId.forEach(id => {\r\n                queryString += `&directoryProductOrServiceId=${id}`\r\n            })\r\n            return queryString\r\n        }, */\r\n        getBase64 (file) {\r\n            return new Promise((resolve, reject) => {\r\n                const reader = new FileReader();\r\n                reader.readAsDataURL(file);\r\n                reader.onload = () => resolve(reader.result);\r\n                reader.onerror = error => reject(error);\r\n            });\r\n        },\r\n        async makeAndReturnFormDataForBase64 () {\r\n            // this.editingItem.supplementDocs = this.editingItem.supplementDocs.map(f => f.file.dataURL)\r\n            let vm = this\r\n            /* if (this.editingItem.priceApprovalFiles && this.editingItem.priceApprovalFiles.length) {\r\n                if (this.editingItem.priceApprovalFiles[0].file.dataURL) {\r\n                    this.editingItem.priceApprovalFiles = this.editingItem.priceApprovalFiles[0].file.dataURL\r\n                } else {\r\n                    let res = await this.getBase64(this.editingItem.priceApprovalFiles[0].file)\r\n                    this.editingItem.priceApprovalFiles = res\r\n                }\r\n            } */\r\n            /* let base64PriceFiles = []\r\n            if (this.editingItem.priceApprovalFiles) {\r\n                this.editingItem.priceApprovalFiles.forEach(async f => {\r\n                    if (f.file.dataURL) {\r\n                        base64PriceFiles.push(f.file.dataURL)\r\n                    } else {\r\n                        let res = await this.getBase64(f.file)\r\n                        base64PriceFiles.push(res)\r\n                    }\r\n                })\r\n            }\r\n            this.editingItem.priceApprovalFiles = base64PriceFiles */\r\n            /* this.editingItem.priceApprovalFiles = this.editingItem.priceApprovalFiles ? this.editingItem.priceApprovalFiles.map(async function (f) {\r\n                let url = null\r\n                if (f.file.dataURL) {\r\n                    url = f.file.dataURL\r\n                } else {\r\n                    let res = await vm.getBase64(f.file)\r\n                    url = res\r\n                }\r\n                return url\r\n            }) : [] */\r\n            this.editingItem.announcedMediaDtos = await this.editingItem.announcedMediaDtos.filter(el => {\r\n                if (el.announcedMediaName) {\r\n                    let base64AnnouncementFiles = []\r\n                    if (el.announcedMediaFiles) {\r\n                        el.announcedMediaFiles.forEach(async f => {\r\n                            if (f.file.dataURL) {\r\n                                base64AnnouncementFiles.push(f.file.dataURL)\r\n                            } else {\r\n                                let res = await this.getBase64(f.file)\r\n                                base64AnnouncementFiles.push(res)\r\n                            }\r\n                        })\r\n                    }\r\n                    el.announcedMediaFiles = base64AnnouncementFiles\r\n                    /* el.announcedMediaFiles = el.announcedMediaFiles ? el.announcedMediaFiles.map(async function (f) {\r\n                        let url = null\r\n                        if (f.file.dataURL) {\r\n                            url = f.file.dataURL\r\n                        } else {\r\n                            let res = await vm.getBase64(f.file)\r\n                            url = res\r\n                        }\r\n                        return url\r\n                    }) : [] */\r\n                    return el\r\n                }\r\n            })\r\n\r\n            this.editingItem.priceApprovalDtos = await this.editingItem.priceApprovalDtos.filter(el => {\r\n                if (el.priceApprovalNumber) {\r\n                    let base64PriceApprovalFiles = []\r\n                    if (el.priceApprovalFiles) {\r\n                        el.priceApprovalFiles.forEach(async f => {\r\n                            if (f.file.dataURL) {\r\n                                base64PriceApprovalFiles.push(f.file.dataURL)\r\n                            } else {\r\n                                let res = await this.getBase64(f.file)\r\n                                base64PriceApprovalFiles.push(res)\r\n                            }\r\n                        })\r\n                    }\r\n                    el.priceApprovalFiles = base64PriceApprovalFiles\r\n                    return el\r\n                }\r\n            })\r\n\r\n            this.editingItem.commissionApplicationDtos = this.editingItem.commissionApplicationDtos.filter(el => {\r\n                if (el.commencementNumber && el.initiatorName) {\r\n                    return el\r\n                }\r\n            })\r\n            // this.editingItem.okedIds = []\r\n            // this.editingItem.directoryProductOrServiceId = this.editingItem.directoryProductOrServiceId.map(el => {\r\n            //     this.editingItem.okedIds.push(el.okedId)\r\n            //     return el.id\r\n            // })\r\n            if (this.editingItem.supplementDocs && this.editingItem.supplementDocs[0].file.dataURL) {\r\n                this.editingItem.file = this.editingItem.supplementDocs[0].file.dataURL\r\n                // delete this.editingItem.supplementDocs\r\n                return this.editingItem\r\n            } else if (this.editingItem.supplementDocs) {\r\n                let res = await this.getBase64(this.editingItem.supplementDocs[0].file)\r\n                this.editingItem.file = res\r\n                // delete this.editingItem.supplementDocs\r\n                return this.editingItem\r\n                /* this.getBase64(this.editingItem.supplementDocs[0].file).then(data => {\r\n                    \r\n                }) */\r\n            } else {\r\n                return this.editingItem\r\n            }\r\n\r\n        },\r\n        customLabelRegion (opt) {\r\n            let selected = this.regions.find(e => e.regionId == (opt.regionId ? opt.regionId : opt));\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.regionNameRu,\r\n                    nameLt: selected.regionNameLt,\r\n                    nameUz: selected.regionNameUz,\r\n                })}`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelDistrict (opt) {\r\n            let selectedDistrict = this.districts.find(e => e.id == opt);\r\n            if (selectedDistrict) {\r\n                return `${this.getName({\r\n                    nameRu: selectedDistrict.nameRu,\r\n                    nameLt: selectedDistrict.nameLt,\r\n                    nameUz: selectedDistrict.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelProduct (opt) {\r\n            let selected = this.products.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelUnit (opt) {\r\n            let selected = this.units.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelGroupOfIndividuals (opt) {\r\n            let selected = this.groupOfIndividuals.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${selected.name}`\r\n            }\r\n            return ``;\r\n        },\r\n        customLabelProductType (opt) {\r\n            let selected = this.productTypes.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })\r\n                    }`\r\n            }\r\n            return ``;\r\n        },\r\n        async productTypeSelected ($event, dontResetDistrict = false) {\r\n            if (!dontResetDistrict) {\r\n                this.products = []\r\n                this.editingItem.directoryProductOrServiceId = null\r\n                this.productOrServicesSearchPayload.page = 1\r\n            }\r\n            if ($event) {\r\n                // GET PRODUCT_OR_SERVICES\r\n                await this.fetchProductOrServices($event)\r\n                // await helperService.getProductsByProdectTypeId($event)\r\n                //     .then(res => {\r\n                //         this.products = res.data\r\n                //     })\r\n                //     .catch(e => {\r\n                //         this.products = []\r\n                //         console.log(e)\r\n                //     })\r\n            }\r\n        },\r\n        contractorReachedEndOfList (e) {\r\n            if (e && !this.isLoadingContractors) {\r\n                this.fetchContractors()\r\n            }\r\n        },\r\n        productOrServicesReachedEndOfList (e) {\r\n            if (e) {\r\n                this.fetchProductOrServices(this.editingItem.directoryProductOrServiceTypeId)\r\n            }\r\n        },\r\n        customLabelContractor (opt) {\r\n            let selected = this.contractors.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${selected.fullName}`\r\n            }\r\n            return ``;\r\n        },\r\n        async debounceSearchProductOrServices (searchText) {\r\n            clearTimeout(this.debounce);\r\n            this.debounce = setTimeout(async () => {\r\n                await this.fetchProductOrServicesWithKeyword(searchText);\r\n            }, 1000);\r\n        },\r\n        async debounceSearchContractors (searchText) {\r\n            clearTimeout(this.debounce);\r\n            this.debounce = setTimeout(async () => {\r\n                await this.fetchContractorsWithKeyword(searchText);\r\n            }, 1000);\r\n        },\r\n        fetchProductOrServicesWithKeyword (keyword) {\r\n            this.products = []\r\n            this.productOrServicesSearchPayload.page = 1\r\n            this.productOrServicesSearchPayload.keyword = keyword ? keyword : ''\r\n            this.fetchProductOrServices(this.editingItem.directoryProductOrServiceTypeId)\r\n        },\r\n        // OKED METHODS\r\n        okedReachedEndOfList (e) {\r\n            if (e) {\r\n                this.fetchOkeds()\r\n            }\r\n        },\r\n        async debounceSearchOked (searchText) {\r\n            clearTimeout(this.debounce);\r\n            this.debounce = setTimeout(async () => {\r\n                await this.fetchOkedsWithKeyword(searchText);\r\n            }, 1000);\r\n        },\r\n        fetchOkedsWithKeyword (keyword) {\r\n            this.okeds = []\r\n            this.okedSearchPayload.page = 1\r\n            this.okedSearchPayload.keyword = keyword ? keyword : ''\r\n            this.fetchOkeds()\r\n        },\r\n        async fetchOkeds () {\r\n            this.isLoadingOked = true\r\n            await crudAndListsService.searchListWithKeyword(OKED_API_URL, this.okedSearchPayload)\r\n                .then(res => {\r\n                    this.okeds.push(...res.data.list)\r\n                    this.hasNextPageOked = res.data.total / this.okedSearchPayload.itemsPerPage > this.okedSearchPayload.page\r\n                    this.okedSearchPayload.page += 1\r\n                    if (!this.isModeCreate && this.editingItem.okedId) {\r\n                        let foundItm = this.okeds.find(el => el.id == this.editingItem.okedId)\r\n                        if (!foundItm && this.editingItem.infoOkedDto) {\r\n                            this.okeds.push(this.editingItem.infoOkedDto)\r\n                        }\r\n                    }\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                    this.okeds = []\r\n                })\r\n                .finally(() => {\r\n                    this.isLoadingOked = false\r\n                })\r\n        },\r\n        customLabelOked (opt) {\r\n            let selected = this.okeds.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${selected.code} - ${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })}`\r\n            }\r\n            return ``;\r\n        },\r\n        // --------------------------\r\n\r\n        // SKP METHODS\r\n        skpReachedEndOfList (e) {\r\n            if (e) {\r\n                this.fetchSkps()\r\n            }\r\n        },\r\n        async debounceSearchSkp (searchText) {\r\n            clearTimeout(this.debounce);\r\n            this.debounce = setTimeout(async () => {\r\n                await this.fetchSkpsWithKeyword(searchText);\r\n            }, 1000);\r\n        },\r\n        fetchSkpsWithKeyword (keyword) {\r\n            this.skps = []\r\n            this.skpSearchPayload.page = 1\r\n            this.skpSearchPayload.keyword = keyword ? keyword : ''\r\n            this.fetchSkps()\r\n        },\r\n        async fetchSkps () {\r\n            this.isLoadingSkp = true\r\n            await crudAndListsService.searchListWithKeyword(SKP_API_URL, this.skpSearchPayload)\r\n                .then(res => {\r\n                    this.skps.push(...res.data.list)\r\n                    this.hasNextPageSkp = res.data.total / this.skpSearchPayload.itemsPerPage > this.skpSearchPayload.page\r\n                    this.skpSearchPayload.page += 1\r\n                    if (!this.isModeCreate && this.editingItem.skpId) {\r\n                        let foundItm = this.skps.find(el => el.id == this.editingItem.skpId)\r\n                        if (!foundItm && this.editingItem.infoSKPDto) {\r\n                            this.skps.push(this.editingItem.infoSKPDto)\r\n                        }\r\n                    }\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                    this.skps = []\r\n                })\r\n                .finally(() => {\r\n                    this.isLoadingSkp = false\r\n                })\r\n        },\r\n        customLabelSkp (opt) {\r\n            let selected = this.skps.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${selected.code} - ${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })}`\r\n            }\r\n            return ``;\r\n        },\r\n        // --------------------------\r\n\r\n        // TNVED METHODS\r\n        tnvedReachedEndOfList (e) {\r\n            if (e) {\r\n                this.fetchTnveds()\r\n            }\r\n        },\r\n        async debounceSearchTnved (searchText) {\r\n            clearTimeout(this.debounce);\r\n            this.debounce = setTimeout(async () => {\r\n                await this.fetchTnvedsWithKeyword(searchText);\r\n            }, 1000);\r\n        },\r\n        fetchTnvedsWithKeyword (keyword) {\r\n            this.tnveds = []\r\n            this.tnvedSearchPayload.page = 1\r\n            this.tnvedSearchPayload.keyword = keyword ? keyword : ''\r\n            this.fetchTnveds()\r\n        },\r\n        async fetchTnveds () {\r\n            this.isLoadingTnved = true\r\n            await crudAndListsService.searchListWithKeyword(TNVED_API_URL, this.tnvedSearchPayload)\r\n                .then(res => {\r\n                    this.tnveds.push(...res.data.list)\r\n                    this.hasNextPageTnved = res.data.total / this.tnvedSearchPayload.itemsPerPage > this.tnvedSearchPayload.page\r\n                    this.tnvedSearchPayload.page += 1\r\n                    if (!this.isModeCreate && this.editingItem.tnvedId) {\r\n                        let foundItm = this.tnveds.find(el => el.id == this.editingItem.tnvedId)\r\n                        if (!foundItm && this.editingItem.infoTNVEDDto) {\r\n                            this.tnveds.push(this.editingItem.infoTNVEDDto)\r\n                        }\r\n                    }\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                    this.tnveds = []\r\n                })\r\n                .finally(() => {\r\n                    this.isLoadingTnved = false\r\n                })\r\n        },\r\n        customLabelTnved (opt) {\r\n            let selected = this.tnveds.find(e => e.id == opt);\r\n            if (selected) {\r\n                return `${selected.code} - ${this.getName({\r\n                    nameRu: selected.nameRu,\r\n                    nameLt: selected.nameLt,\r\n                    nameUz: selected.nameUz,\r\n                })}`\r\n            }\r\n            return ``;\r\n        },\r\n        // --------------------------\r\n        async fetchProductOrServices (typeId) {\r\n            this.isLoadingProductOrServices = true\r\n            await helperService.getProductOrServicesByTypeId(typeId, this.productOrServicesSearchPayload)\r\n                .then(res => {\r\n                    this.products.push(...res.data.list)\r\n                    this.hasNextPageProductOrServices = res.data.total / this.productOrServicesSearchPayload.itemsPerPage > this.productOrServicesSearchPayload.page\r\n                    this.productOrServicesSearchPayload.page += 1\r\n                    if (!this.isModeCreate && this.editingItem.directoryProductOrServiceId) {\r\n                        let foundItm = this.products.find(el => el.id == this.editingItem.directoryProductOrServiceId)\r\n                        if (!foundItm && this.editingItem.directoryProductOrServiceDto) {\r\n                            this.products.push(this.editingItem.directoryProductOrServiceDto)\r\n                        }\r\n                    }\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                    this.products = []\r\n                })\r\n                .finally(() => {\r\n                    this.isLoadingProductOrServices = false\r\n                })\r\n        },\r\n        fetchContractorsWithKeyword (keyword, makeFirstSelected = false) {\r\n            this.contractors = []\r\n            this.contractorSearchPayload.page = 1\r\n            this.contractorSearchPayload.keyword = keyword ? keyword : ''\r\n            // this.contractorSearchPayload.sortBy = []\r\n            // this.contractorSearchPayload.sortBy.push('created')\r\n            // this.contractorSearchPayload.sortDesc = []\r\n            // this.contractorSearchPayload.sortDesc.push(false)\r\n            this.fetchContractors(makeFirstSelected)\r\n        },\r\n        async fetchContractors (makeFirstSelected) {\r\n            this.contractorSearchPayload.sortBy = []\r\n            this.contractorSearchPayload.sortBy.push('created')\r\n            this.contractorSearchPayload.sortDesc = []\r\n            this.contractorSearchPayload.sortDesc.push(true)\r\n            this.isLoadingContractors = true\r\n            await crudAndListsService.searchListWithKeyword('contractor', this.contractorSearchPayload, 'by-contractor')\r\n                .then(res => {\r\n                    this.contractors.push(...res.data.list)\r\n                    this.hasNextPageContractors = res.data.total / this.contractorSearchPayload.itemsPerPage > this.contractorSearchPayload.page\r\n                    this.contractorSearchPayload.page += 1\r\n                    if (makeFirstSelected) {\r\n                        this.editingItem.contractorId = this.contractors.length ? this.contractors[0].id : null\r\n                    }\r\n                    if (!this.isModeCreate && this.editingItem.contractorId) {\r\n                        let contractorFound = this.contractors.find(el => el.id == this.editingItem.contractorId)\r\n                        if (!contractorFound && this.editingItem.contractorDto) {\r\n                            this.contractors.push(this.editingItem.contractorDto)\r\n                        }\r\n                    }\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                    this.contractors = []\r\n                })\r\n                .finally(() => {\r\n                    this.isLoadingContractors = false\r\n                })\r\n        },\r\n    },\r\n    /*\r\n    * CREATED */\r\n    async created () {\r\n        this.contractorSearchPayload = Object.assign({}, this.var_default_search_payload)\r\n        this.productOrServicesSearchPayload = Object.assign({}, this.var_default_search_payload)\r\n        this.okedSearchPayload = Object.assign({}, this.var_default_search_payload)\r\n        this.skpSearchPayload = Object.assign({}, this.var_default_search_payload)\r\n        this.tnvedSearchPayload = Object.assign({}, this.var_default_search_payload)\r\n        this.var_default_search_payload.itemsPerPage = 500\r\n        if (this.isModeCreate) {\r\n            await crudAndListsService.getEmpty(MAIN_API_URL)\r\n                .then(res => {\r\n                    this.editingItem = res.data\r\n                    crudAndListsService.getEmptyCustomUrl(`${ANNOUNCED_MEDIA_API_URL}/empty`)\r\n                        .then(res => {\r\n                            this.defaultAnnouncedMediaDto = res.data\r\n                            if (!this.editingItem.announcedMediaDtos || !this.editingItem.announcedMediaDtos.length) {\r\n                                this.editingItem.announcedMediaDtos = []\r\n                                let tmp = Object.assign({}, this.defaultAnnouncedMediaDto)\r\n                                this.editingItem.announcedMediaDtos.push(tmp)\r\n                            }\r\n                        })\r\n                        .catch(e => {\r\n                            console.log(e)\r\n                        })\r\n\r\n                    crudAndListsService.getEmptyCustomUrl(`${PRICE_APPROVAL_API_URL}/empty`)\r\n                        .then(res => {\r\n                            this.defaultPriceApprovalDto = res.data\r\n                            if (!this.editingItem.priceApprovalDtos || !this.editingItem.priceApprovalDtos.length) {\r\n                                this.editingItem.priceApprovalDtos = []\r\n                                let tmp = Object.assign({}, this.defaultPriceApprovalDto)\r\n                                this.editingItem.priceApprovalDtos.push(tmp)\r\n                            }\r\n                        })\r\n                        .catch(e => {\r\n                            console.log(e)\r\n                        })\r\n\r\n                    crudAndListsService.getEmptyCustomUrl(`${COMMISSION_APPLICATION_API_URL}/empty`)\r\n                        .then(res => {\r\n                            this.defaultCommissionApplicationDto = res.data\r\n                            if (!this.editingItem.commissionApplicationDtos || !this.editingItem.commissionApplicationDtos.length) {\r\n                                this.editingItem.commissionApplicationDtos = []\r\n                                let tmp = Object.assign({}, this.defaultCommissionApplicationDto)\r\n                                this.editingItem.commissionApplicationDtos.push(tmp)\r\n                            }\r\n                        })\r\n                        .catch(e => {\r\n                            console.log(e)\r\n                        })\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                })\r\n\r\n        } else {\r\n            await crudAndListsService.getById(MAIN_API_URL, this.$route.params.id, true)\r\n                .then(res => {\r\n                    if (res.data.documentStatusCode != 'PENDING') {\r\n                        this.$router.go(-1)\r\n                    }\r\n                    this.editingItem = res.data\r\n                    // this.setFilesFromServer()\r\n\r\n                    if (!this.editingItem.announcedMediaDtos || !this.editingItem.announcedMediaDtos.length) {\r\n                        crudAndListsService.getEmptyCustomUrl(`${ANNOUNCED_MEDIA_API_URL}/empty`)\r\n                            .then(res => {\r\n                                this.defaultAnnouncedMediaDto = res.data\r\n                                if (!this.editingItem.announcedMediaDtos || !this.editingItem.announcedMediaDtos.length) {\r\n                                    this.editingItem.announcedMediaDtos = []\r\n                                    let tmp = Object.assign({}, this.defaultAnnouncedMediaDto)\r\n                                    this.editingItem.announcedMediaDtos.push(tmp)\r\n                                }\r\n                            })\r\n                            .catch(e => {\r\n                                console.log(e)\r\n                            })\r\n                    }\r\n\r\n                    if (!this.editingItem.priceApprovalDtos || !this.editingItem.priceApprovalDtos.length) {\r\n                        crudAndListsService.getEmptyCustomUrl(`${PRICE_APPROVAL_API_URL}/empty`)\r\n                            .then(res => {\r\n                                this.defaultPriceApprovalDto = res.data\r\n                                if (!this.editingItem.priceApprovalDtos || !this.editingItem.priceApprovalDtos.length) {\r\n                                    this.editingItem.priceApprovalDtos = []\r\n                                    let tmp = Object.assign({}, this.defaultPriceApprovalDto)\r\n                                    this.editingItem.priceApprovalDtos.push(tmp)\r\n                                }\r\n                            })\r\n                            .catch(e => {\r\n                                console.log(e)\r\n                            })\r\n                    }\r\n\r\n                    if (!this.editingItem.commissionApplicationDtos || !this.editingItem.commissionApplicationDtos.length) {\r\n                        crudAndListsService.getEmptyCustomUrl(`${COMMISSION_APPLICATION_API_URL}/empty`)\r\n                            .then(res => {\r\n                                this.defaultCommissionApplicationDto = res.data\r\n                                if (!this.editingItem.commissionApplicationDtos || !this.editingItem.commissionApplicationDtos.length) {\r\n                                    this.editingItem.commissionApplicationDtos = []\r\n                                    let tmp = Object.assign({}, this.defaultCommissionApplicationDto)\r\n                                    this.editingItem.commissionApplicationDtos.push(tmp)\r\n                                }\r\n                            })\r\n                            .catch(e => {\r\n                                console.log(e)\r\n                            })\r\n                    }\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                })\r\n        }\r\n        // GET CONTRACTORS\r\n        await this.fetchContractors()\r\n\r\n        // GET OKEDS\r\n        await this.fetchOkeds()\r\n\r\n        if (this.isDominant) {\r\n            // GET SKPS\r\n            await this.fetchSkps()\r\n\r\n            // GET TNVEDS\r\n            await this.fetchTnveds()\r\n\r\n            // GET GROUP_OF_INDIVIDUALS\r\n            crudAndListsService\r\n                .searchList('reestr/group-of-individuals', this.var_default_search_payload)\r\n                .then((res) => {\r\n                    this.groupOfIndividuals = res.data.list;\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                })\r\n        }\r\n\r\n        // GET REGIONS\r\n        await helperService.fetchRegionsForContractorReestrByCurrentUserId()\r\n            .then(res => {\r\n                this.regions = res.data\r\n                this.regionSelected(this.editingItem.regionId, true)\r\n            })\r\n            .catch(e => {\r\n                console.log(e)\r\n            })\r\n\r\n        if (this.$route.name.includes('Create') || this.$route.name.includes('Update')) {\r\n            // GET PRODUCT_OR_SERVICE_TYPES\r\n            crudAndListsService\r\n                .searchList('directory/product-or-service-types', this.var_default_search_payload, this.isDominant ? APPEND_API_URL_DOMINANT : this.isNatural ? APPEND_API_URL_NATURAL : '')\r\n                .then((res) => {\r\n                    this.productTypes = res.data.list;\r\n                    this.productTypeSelected(this.editingItem.directoryProductOrServiceTypeId, true)\r\n                })\r\n                .catch(e => {\r\n                    console.log(e)\r\n                })\r\n        }\r\n\r\n        // GET UNITS\r\n        crudAndListsService\r\n            .searchListWithKeyword('directory/units', this.var_default_search_payload)\r\n            .then((res) => {\r\n                this.units = res.data.list;\r\n            })\r\n            .catch(e => {\r\n                console.log(e)\r\n            })\r\n    }\r\n}\r\n</script>\r\n<style scoped>\r\n.col-form-label {\r\n    padding-top: 0;\r\n}\r\n\r\nul {\r\n    list-style-type: none;\r\n}\r\n</style>"]}]}