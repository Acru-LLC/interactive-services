{"remainingRequest":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\state\\modules\\messenger.js","dependencies":[{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\state\\modules\\messenger.js","mtime":1675054786294},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\babel.config.js","mtime":1667352074157},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1667355379758},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1667355397815}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6XFxBQ1JVIFBST0pFQ1RcXEZhaXIgVGVjaFxcYWNydS1mcm9udGVuZFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuanNvbi5zdHJpbmdpZnkuanMiOwppbXBvcnQgeyBUb2tlblNlcnZpY2UgfSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9zdG9yYWdlLnNlcnZpY2UiOwppbXBvcnQgbWVzc2VuZ2VyU2VydmljZSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9tZXNzZW5nZXJTZXJ2aWNlIjsKaW1wb3J0IFNvY2tKUyBmcm9tICJzb2NranMtY2xpZW50IjsKaW1wb3J0IFN0b21wIGZyb20gIndlYnN0b21wLWNsaWVudCI7CmltcG9ydCBWdWUgZnJvbSAidnVlIjsKdmFyIGdsb2JhbFN0b21wQ2xpZW50ID0gbnVsbDsKZXhwb3J0IHZhciBzdGF0ZSA9IHsKICBtYXJrZXRpbmc6IG51bGwsCiAgbm90aWZpY2F0aW9uOiBudWxsLAogIGNvbnRhY3RMaXN0OiBbXSwKICBjb250YWN0VG90YWw6IDAsCiAgZ3JvdXBDaGF0TGlzdDogW10sCiAgZ3JvdXBDaGF0VG90YWw6IDAsCiAgY29tbWVudHM6IFtdLAogIGNvbW1lbnRzVG90YWw6IDAsCiAgb3BlblBhZ2U6ICJkZWZhdWx0IiwKICBjaGF0TGlzdE1lc3NhZ2VzOiBbXSwKICBjaGF0VG90YWxNZXNzYWdlczogMCwKICBncm91cENoYXRMaXN0TWVzc2FnZXM6IFtdLAogIGdyb3VwQ2hhdFRvdGFsTWVzc2FnZXM6IDAsCiAgbGFzdE1lc3NhZ2U6IHt9LAogIGxhc3RNZXNzYWdlR3JvdXA6IHt9LAogIGdyb3VwVXBkYXRlOiBmYWxzZSwKICBncm91cFVwZGF0ZU1zZzogbnVsbCwKICBpbmNvbWluZ1BlcnNvbjogbnVsbCwKICBleGl0aW5nUGVyc29uOiBudWxsLAogIGNoYXRVbnJlYWRDb3VudDogMCwKICB1bnJlYWREYXRhOiBudWxsLAogIENIQVQ6IG51bGwKfTsKZXhwb3J0IHZhciBtdXRhdGlvbnMgPSB7CiAgc2V0Q3VycmVudENoYXQ6IGZ1bmN0aW9uIHNldEN1cnJlbnRDaGF0KHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5DSEFUID0gZGF0YTsKICB9LAogIHNldENoYXRNZXNzYWdlTWFrZVJlYWQ6IGZ1bmN0aW9uIHNldENoYXRNZXNzYWdlTWFrZVJlYWQoc3RhdGUsIGlkKSB7CiAgICB2YXIgaW5kZXggPSBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZS5pZCA9PSBpZDsKICAgIH0pOwoKICAgIGlmIChpbmRleCA+IC0xKSB7CiAgICAgIFZ1ZS5zZXQoc3RhdGUuY2hhdExpc3RNZXNzYWdlc1tpbmRleF0sICJpc1JlYWQiLCAiUkVBRCIpOwogICAgfQogIH0sCiAgc2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50OiBmdW5jdGlvbiBzZXRDaGF0VW5yZWFkTWVzc2FnQ291bnQoc3RhdGUsIGNvdW50KSB7CiAgICBzdGF0ZS5jaGF0VW5yZWFkQ291bnQgPSBjb3VudDsKCiAgICBpZiAoY291bnQgPiAwKSB7Ly8gcGxheVNvdW5kKCkKICAgIH0KICB9LAogIHNldENoYXRVbnJlYWRDb3VudDogZnVuY3Rpb24gc2V0Q2hhdFVucmVhZENvdW50KHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS51bnJlYWREYXRhID0gZGF0YTsKICB9LAogIHNldENvbW1lbnRzOiBmdW5jdGlvbiBzZXRDb21tZW50cyhzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuY29tbWVudHMgPSBkYXRhOwogIH0sCiAgc2V0SW5jb21pbmdQZXJzb246IGZ1bmN0aW9uIHNldEluY29taW5nUGVyc29uKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5pbmNvbWluZ1BlcnNvbiA9IGRhdGE7CiAgfSwKICBzZXRFeGl0aW5nUGVyc29uOiBmdW5jdGlvbiBzZXRFeGl0aW5nUGVyc29uKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5leGl0aW5nUGVyc29uID0gZGF0YTsKICB9LAogIHNldE1hcmtldGluZzogZnVuY3Rpb24gc2V0TWFya2V0aW5nKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5tYXJrZXRpbmcgPSBkYXRhOwogIH0sCiAgc2V0Tm90aWZpY2F0aW9uOiBmdW5jdGlvbiBzZXROb3RpZmljYXRpb24oc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLm5vdGlmaWNhdGlvbiA9IGRhdGE7CiAgfSwKICBzZXRHcm91cFVwZGF0ZUU6IGZ1bmN0aW9uIHNldEdyb3VwVXBkYXRlRShzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuZ3JvdXBVcGRhdGUgPSBkYXRhOwogIH0sCiAgc2V0R3JvdXBDaGF0VXBkYXRlOiBmdW5jdGlvbiBzZXRHcm91cENoYXRVcGRhdGUoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmdyb3VwVXBkYXRlID0gdHJ1ZTsKICAgIHN0YXRlLmdyb3VwVXBkYXRlTXNnID0gZGF0YTsKICB9LAogIHNldExpc3RSZXNwb25zZUdyb3VwQ2hhdDogZnVuY3Rpb24gc2V0TGlzdFJlc3BvbnNlR3JvdXBDaGF0KHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5ncm91cENoYXRMaXN0ID0gZGF0YS5saXN0OwogICAgc3RhdGUuZ3JvdXBDaGF0VG90YWwgPSBkYXRhLnRvdGFsOwogIH0sCiAgc2V0TGlzdFJlc3BvbnNlOiBmdW5jdGlvbiBzZXRMaXN0UmVzcG9uc2Uoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmNvbnRhY3RMaXN0ID0gZGF0YS5saXN0Lm1hcChmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gewogICAgICAgIGZpcnN0TmFtZTogZS5maXJzdE5hbWUsCiAgICAgICAgbGFzdE5hbWU6IGUubGFzdE5hbWUsCiAgICAgICAgZW1wbG95ZWVJZDogZS5lbXBsb3llZUlkLAogICAgICAgIGNoYXRJZDogZS5jaGF0SWQsCiAgICAgICAgdXBsb2FkUGF0aDogZS51cGxvYWRQYXRoCiAgICAgIH07CiAgICB9KTsKICAgIHN0YXRlLmNvbnRhY3RUb3RhbCA9IGRhdGEudG90YWw7CiAgfSwKICBzZXRPcGVuUGFnZTogZnVuY3Rpb24gc2V0T3BlblBhZ2Uoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLm9wZW5QYWdlID0gZGF0YTsKICB9LAogIHNldExpc3RDaGF0TWVzc2VnZXM6IGZ1bmN0aW9uIHNldExpc3RDaGF0TWVzc2VnZXMoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMgPSBkYXRhLmxpc3Q7CiAgICBzdGF0ZS5jaGF0VG90YWxNZXNzYWdlcyA9IGRhdGEudG90YWw7CiAgfSwKICBzZXRMaXN0R3JvdXBDaGF0TWVzc2VnZXM6IGZ1bmN0aW9uIHNldExpc3RHcm91cENoYXRNZXNzZWdlcyhzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzID0gZGF0YS5saXN0OwogICAgc3RhdGUuZ3JvdXBDaGF0VG90YWxNZXNzYWdlcyA9IGRhdGEudG90YWw7CiAgfSwKICBwdXNoSXRlbXM6IGZ1bmN0aW9uIHB1c2hJdGVtcyhzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuY2hhdExpc3RNZXNzYWdlcyA9IGRhdGEuY29uY2F0KHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMpOwogIH0sCiAgcHVzaEdyb3VwSXRlbXM6IGZ1bmN0aW9uIHB1c2hHcm91cEl0ZW1zKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMgPSBkYXRhLmNvbmNhdChzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMpOwogIH0sCiAgcHVzaENoYXRMaXN0OiBmdW5jdGlvbiBwdXNoQ2hhdExpc3Qoc3RhdGUsIGRhdGEpIHsKICAgIGlmIChzdGF0ZS5DSEFUICYmIHN0YXRlLkNIQVQuaWQgPT0gZGF0YS5jaGF0SWQpIHsKICAgICAgaWYgKGRhdGEuZXh0cmEgPT09ICdkZWxldGUnKSB7CiAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuY2hhdExpc3RNZXNzYWdlcy5maW5kSW5kZXgoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBlLmlkID09IGRhdGEuZGVsZXRlSWQ7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChpbmRleCA+IC0xKSB7CiAgICAgICAgICBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGRhdGEuZXh0cmEgPT09ICd1cGRhdGUnKSB7CiAgICAgICAgdmFyIF9pbmRleCA9IHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmVkaXRlZE1lc3NhZ2UuaWQ7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChfaW5kZXggPiAtMSkgewogICAgICAgICAgc3RhdGUuY2hhdExpc3RNZXNzYWdlc1tfaW5kZXhdLm1lc3NhZ2UgPSBkYXRhLmVkaXRlZE1lc3NhZ2UubWVzc2FnZTsKICAgICAgICAgIHN0YXRlLmNoYXRMaXN0TWVzc2FnZXNbX2luZGV4XS5lZGl0ZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgX2luZGV4MiA9IHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmlkOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoIV9pbmRleDIgfHwgX2luZGV4MiA8PSAtMSkgewogICAgICAgICAgc3RhdGUuY2hhdExpc3RNZXNzYWdlcy5wdXNoKGRhdGEpOwogICAgICAgICAgc3RhdGUuY2hhdFRvdGFsTWVzc2FnZXMrKzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAogIHB1c2hDb3VudDogZnVuY3Rpb24gcHVzaENvdW50KHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5jaGF0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgIGlmIChlbGVtZW50LmlkID09PSBkYXRhLmNoYXRJZCkgewogICAgICAgIGJ1cy4kc2V0KGVsZW1lbnQsICJjb3VudCIsIGVsZW1lbnQuY291bnQrKyk7CiAgICAgIH0KICAgIH0pOwogIH0sCiAgcHVzaEdyb3VwQ2hhdExpc3Q6IGZ1bmN0aW9uIHB1c2hHcm91cENoYXRMaXN0KHN0YXRlLCBkYXRhKSB7CiAgICBpZiAoc3RhdGUuQ0hBVCAmJiBzdGF0ZS5DSEFULmlkID09IGRhdGEuZ3JvdXBDaGF0SWQpIHsKICAgICAgaWYgKGRhdGEuZXh0cmEgPT09ICJ1bnJlYWQiKSB7CiAgICAgICAgc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICAgIGlmIChlbGVtZW50LmlkID09IGRhdGEudW5yZWFkSWQpIHsKICAgICAgICAgICAgZWxlbWVudC5pc1JlYWQgPSAiUkVBRCI7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZGF0YS5leHRyYSA9PT0gImRlbGV0ZSIpIHsKICAgICAgICB2YXIgaW5kZXggPSBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmRlbGV0ZUlkOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoaW5kZXggPiAtMSkgewogICAgICAgICAgc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGRhdGEuZXh0cmEgPT09ICJ1cGRhdGUiKSB7CiAgICAgICAgdmFyIF9pbmRleDMgPSBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmVkaXRlZEdyb3VwTWVzc2FnZS5pZDsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKF9pbmRleDMgPiAtMSkgewogICAgICAgICAgc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzW19pbmRleDNdLm1lc3NhZ2UgPSBkYXRhLmVkaXRlZEdyb3VwTWVzc2FnZS5tZXNzYWdlOwogICAgICAgICAgc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzW19pbmRleDNdLmVkaXRlZCA9IHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBfaW5kZXg0ID0gc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUuaWQgPT0gZGF0YS5pZDsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKF9pbmRleDQgPD0gLTEpIHsKICAgICAgICAgIHN0YXRlLmdyb3VwQ2hhdExpc3RNZXNzYWdlcy5wdXNoKGRhdGEpOwogICAgICAgICAgc3RhdGUuZ3JvdXBDaGF0VG90YWxNZXNzYWdlcysrOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sCiAgcHVzaEdyb3VwQ291bnQ6IGZ1bmN0aW9uIHB1c2hHcm91cENvdW50KHN0YXRlLCBkYXRhKSB7CiAgICBpZiAoZGF0YS5leHRyYSA9PT0gInVucmVhZCIpIHt9IGVsc2UgaWYgKGRhdGEuZXh0cmEgPT09ICJkZWxldGUiKSB7fSBlbHNlIGlmIChkYXRhLmV4dHJhID09PSAidXBkYXRlIikge30gZWxzZSB7CiAgICAgIHN0YXRlLmdyb3VwQ2hhdExpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIGlmIChlbGVtZW50LmlkID09PSBkYXRhLmNoYXRJZCkgewogICAgICAgICAgYnVzLiRzZXQoZWxlbWVudCwgImNvdW50IiwgZWxlbWVudC5jb3VudCsrKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sCiAgcmVtb3Y6IGZ1bmN0aW9uIHJlbW92KHN0YXRlKSB7CiAgICBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzLnNwbGljZSgtMSwgMSk7CiAgfQp9OwpleHBvcnQgdmFyIGFjdGlvbnMgPSB7CiAgc2V0Q2hhdE1lc3NhZ2VNYWtlUmVhZDogZnVuY3Rpb24gc2V0Q2hhdE1lc3NhZ2VNYWtlUmVhZChfcmVmLCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgnc2V0Q2hhdE1lc3NhZ2VNYWtlUmVhZCcsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpKCk7CiAgfSwKICBnZXRVbnJlYWRNZXNzYWdlczogZnVuY3Rpb24gZ2V0VW5yZWFkTWVzc2FnZXMoc3QpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIG1lc3NlbmdlclNlcnZpY2UuZ2V0VW5yZWFkTWVzc2FnZXMoKS50aGVuKGZ1bmN0aW9uIChycykgewogICAgICAgICAgICAgICAgc3QuY29tbWl0KCdzZXRDaGF0VW5yZWFkTWVzc2FnQ291bnQnLCBycy5kYXRhKTsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyKTsKICAgIH0pKSgpOwogIH0sCiAgc2VuZEFubm91bmNlbWVudERvY3VtZW50TWFya2luZzogZnVuY3Rpb24gc2VuZEFubm91bmNlbWVudERvY3VtZW50TWFya2luZyhzdCwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wQ2xpZW50U2VuZE1lc3NhZ2UiLCB7CiAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICBlbmRwb2ludDogIi9hcHAvYW5ub3VuY2VtZW50RG9jdW1lbnRNYXJraW5nIiwKICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUzKTsKICAgIH0pKSgpOwogIH0sCiAgc2V0Q2hhdFVucmVhZENvdW50OiBmdW5jdGlvbiBzZXRDaGF0VW5yZWFkQ291bnQoX3JlZjIsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYyLmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgnc2V0Q2hhdFVucmVhZENvdW50JywgSlNPTi5wYXJzZShkYXRhLmJvZHkpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU0KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50OiBmdW5jdGlvbiBzZXRDaGF0VW5yZWFkTWVzc2FnQ291bnQoX3JlZjMsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYzLmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50IiwgSlNPTi5wYXJzZShkYXRhLmJvZHkpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU1KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0RG9jdW1lbnRNYXJraW5nOiBmdW5jdGlvbiBzZXREb2N1bWVudE1hcmtpbmcoX3JlZjQsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TWFya2V0aW5nIiwgSlNPTi5wYXJzZShkYXRhLmJvZHkpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU2KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0Tm90aWZpY2F0aW9uTXNnOiBmdW5jdGlvbiBzZXROb3RpZmljYXRpb25Nc2coX3JlZjUsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWY1LmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0Tm90aWZpY2F0aW9uIiwgSlNPTi5wYXJzZShkYXRhLmJvZHkpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU3KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0Q29tbWVudFRhc2s6IGZ1bmN0aW9uIHNldENvbW1lbnRUYXNrKF9yZWY2LCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgICAgdmFyIGNvbW1pdDsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmNi5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldENvbW1lbnRzIiwgSlNPTi5wYXJzZShkYXRhLmJvZHkpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU4KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0SW5jb21pbmdQZXJzb246IGZ1bmN0aW9uIHNldEluY29taW5nUGVyc29uKF9yZWY3LCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOSgpIHsKICAgICAgdmFyIGNvbW1pdCwgcGFyc2VkOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWY3LmNvbW1pdDsKICAgICAgICAgICAgICBwYXJzZWQgPSBKU09OLnBhcnNlKGRhdGEuYm9keSk7CgogICAgICAgICAgICAgIGlmICghKHBhcnNlZC5kZXZpY2VOYW1lID09PSAnZW50ZXInKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDU7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0SW5jb21pbmdQZXJzb24iLCBwYXJzZWQpOwoKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gOTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDk7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0RXhpdGluZ1BlcnNvbiIsIHBhcnNlZCk7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlOSk7CiAgICB9KSkoKTsKICB9LAogIHNldEdyb3VwVXBkYXRlOiBmdW5jdGlvbiBzZXRHcm91cFVwZGF0ZShfcmVmOCkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEwJChfY29udGV4dDEwKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmOC5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRHcm91cFVwZGF0ZUUiLCBmYWxzZSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTEwKTsKICAgIH0pKSgpOwogIH0sCiAgc2V0TWVzc2FnZTogZnVuY3Rpb24gc2V0TWVzc2FnZShfcmVmOSwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTExJChfY29udGV4dDExKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmOS5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJwdXNoQ2hhdExpc3QiLCBKU09OLnBhcnNlKGRhdGEuYm9keSkpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUxMSk7CiAgICB9KSkoKTsKICB9LAogIHNldEdyb3VwTWVzc2FnZTogZnVuY3Rpb24gc2V0R3JvdXBNZXNzYWdlKF9yZWYxMCwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEyKCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEyJChfY29udGV4dDEyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMi5wcmV2ID0gX2NvbnRleHQxMi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmMTAuY29tbWl0OwogICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgicHVzaEdyb3VwQ291bnQiLCBKU09OLnBhcnNlKGRhdGEuYm9keSkpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDU7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgicHVzaEdyb3VwQ2hhdExpc3QiLCBKU09OLnBhcnNlKGRhdGEuYm9keSkpOwoKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUxMik7CiAgICB9KSkoKTsKICB9LAogIHNlbmRNZXNzYWdlOiBmdW5jdGlvbiBzZW5kTWVzc2FnZShzdCwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMy5wcmV2ID0gX2NvbnRleHQxMy5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBDbGllbnRTZW5kTWVzc2FnZSIsIHsKICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL2FwcC9zZW5kTWVzc2FnZSIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiBkYXRhCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTEzKTsKICAgIH0pKSgpOwogIH0sCiAgc2VuZE1lc3NhZ2VHcm91cDogZnVuY3Rpb24gc2VuZE1lc3NhZ2VHcm91cChzdCwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE0KCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE0JChfY29udGV4dDE0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNC5wcmV2ID0gX2NvbnRleHQxNC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBDbGllbnRTZW5kTWVzc2FnZSIsIHsKICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL2FwcC9zZW5kR3JvdXBNZXNzYWdlIiwKICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMTQpOwogICAgfSkpKCk7CiAgfSwKICBhbGxVbnJlYWRNZXNzYWdlczogZnVuY3Rpb24gYWxsVW5yZWFkTWVzc2FnZXMoc3QpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNSgpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNSQoX2NvbnRleHQxNSkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTUucHJldiA9IF9jb250ZXh0MTUubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wQ2xpZW50U2VuZE1lc3NhZ2UiLCB7CiAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICBlbmRwb2ludDogIi9hcHAvYWxsVW5yZWFkTWVzc2FnZXMiLAogICAgICAgICAgICAgICAgbWVzc2FnZTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICB1c2VyX2lkOiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VyX2lkIikpCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE1LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUxNSk7CiAgICB9KSkoKTsKICB9LAogIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKHN0KSB7CiAgICB2YXIgX2FyZ3VtZW50cyA9IGFyZ3VtZW50czsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyNSgpIHsKICAgICAgdmFyIHVzciwgdXNlcm5hbWUsIGZ1bGxOYW1lOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI1JChfY29udGV4dDI1KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyNS5wcmV2ID0gX2NvbnRleHQyNS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICB1c3IgPSBfYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50c1sxXSA6IG51bGw7CiAgICAgICAgICAgICAgdXNlcm5hbWUgPSBudWxsLCBmdWxsTmFtZSA9IG51bGw7CgogICAgICAgICAgICAgIGlmICghdXNyKSB7CiAgICAgICAgICAgICAgICB1c2VybmFtZSA9IFRva2VuU2VydmljZS5nZXRVc2VySW5mbygpID8gVG9rZW5TZXJ2aWNlLmdldFVzZXJJbmZvKCkudXNlcm5hbWUgOiBudWxsOwogICAgICAgICAgICAgICAgZnVsbE5hbWUgPSBUb2tlblNlcnZpY2UuZ2V0VXNlckluZm8oKSA/IFRva2VuU2VydmljZS5nZXRVc2VySW5mbygpLmVtcGxveWVlRnVsbE5hbWUgOiBudWxsOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB1c2VybmFtZSA9IHVzcjsKICAgICAgICAgICAgICB9IC8vIGxldCBvd25lcklkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcl9pZCIpKTsKCgogICAgICAgICAgICAgIGlmICh1c2VybmFtZSB8fCBmdWxsTmFtZSkgewogICAgICAgICAgICAgICAgaWYgKHVzciA9PT0gJ3NlY3VyaXR5JykgewogICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgiY29ubmVjdCIpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL3VzZXIvc2VjdXJpdHkvaW5jb21pbmdQZXJzb24iLAogICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9jYWxsYmFjayA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE2KGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE2JChfY29udGV4dDE2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTYucHJldiA9IF9jb250ZXh0MTYubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXRJbmNvbWluZ1BlcnNvbiIsIGRhdGEpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE2LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxNik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKF94KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jYWxsYmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgICB9KCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgiY29ubmVjdCIpLnRoZW4oIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYxMSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE3KHMpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTckKF9jb250ZXh0MTcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTcucHJldiA9IF9jb250ZXh0MTcubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBDbGllbnRTZW5kTWVzc2FnZSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvYXBwL3JlZ2lzdGVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB1c2VybmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNy5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTcpOwogICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDIpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmMTEuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB9KCkpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL3VzZXIvIi5jb25jYXQodXNlcm5hbWUsICIvbXNnIiksCiAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NhbGxiYWNrMiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE4KGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE4JChfY29udGV4dDE4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTgucHJldiA9IF9jb250ZXh0MTgubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXRNZXNzYWdlIiwgZGF0YSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTguc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTE4KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3gzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jYWxsYmFjazIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrOwogICAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL3VzZXIvIi5jb25jYXQodXNlcm5hbWUsICIvZ3JvdXBNc2ciKSwKICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2szID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTkoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTkkKF9jb250ZXh0MTkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxOS5wcmV2ID0gX2NvbnRleHQxOS5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldEdyb3VwTWVzc2FnZSIsIGRhdGEpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE5LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxOSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKF94NCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2szLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjazsKICAgICAgICAgICAgICAgICAgICAgIH0oKQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBTdWJzY3JpYmUiLCB7CiAgICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludDogIi91c2VyLyIuY29uY2F0KHVzZXJuYW1lLCAiL2RvY3VtZW50TWFya2luZyIpLAogICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9jYWxsYmFjazQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyMChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMCQoX2NvbnRleHQyMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIwLnByZXYgPSBfY29udGV4dDIwLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0RG9jdW1lbnRNYXJraW5nIiwgZGF0YSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjAuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTIwKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3g1KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jYWxsYmFjazQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrOwogICAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL3VzZXIvIi5jb25jYXQodXNlcm5hbWUsICIvbm90aWZpY2F0aW9uTXNnIiksCiAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NhbGxiYWNrNSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIxKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIxJChfY29udGV4dDIxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjEucHJldiA9IF9jb250ZXh0MjEubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXROb3RpZmljYXRpb25Nc2ciLCBkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXRDb3VudCIsIG51bGwsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjEuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTIxKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3g2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jYWxsYmFjazUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrOwogICAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pIC8vIC50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgICAgLy8gICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgZW5kcG9pbnQ6IGAvdXNlci8ke2Z1bGxOYW1lfS9jb21tZW50TWdzYCwKICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBjYWxsYmFjazogYXN5bmMgKGRhdGEpID0+IHsKICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldENvbW1lbnRUYXNrIiwgZGF0YSk7CiAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgLy8gICAgIH0pOwogICAgICAgICAgICAgICAgICAvLyB9KQogICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wU3Vic2NyaWJlIiwgewogICAgICAgICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci8iLmNvbmNhdCh1c2VybmFtZSwgIi91bnJlYWRNZXNzYWdlcyIpLAogICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9jYWxsYmFjazYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyMihkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMiQoX2NvbnRleHQyMikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIyLnByZXYgPSBfY29udGV4dDIyLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50IiwgZGF0YSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjIuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTIyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3g3KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jYWxsYmFjazYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrOwogICAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL3VzZXIvIi5jb25jYXQodXNlcm5hbWUsICIvdW5yZWFkTWVzc2FnZSIpLAogICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9jYWxsYmFjazcgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyMyhkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMyQoX2NvbnRleHQyMykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIzLnByZXYgPSBfY29udGV4dDIzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0Q2hhdFVucmVhZENvdW50IiwgZGF0YSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjMuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTIzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3g4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jYWxsYmFjazcuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrOwogICAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL3VzZXIvIi5jb25jYXQodXNlcm5hbWUsICIvbWFrZVJlYWQiKSwKICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2s4ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjQoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjQkKF9jb250ZXh0MjQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyNC5wcmV2ID0gX2NvbnRleHQyNC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldENoYXRNZXNzYWdlTWFrZVJlYWQiLCBkYXRhKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjQpOwogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhfeDkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NhbGxiYWNrOC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgICB9KCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI1LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyNSk7CiAgICB9KSkoKTsKICB9LAogIGNvbm5lY3Q6IGZ1bmN0aW9uIGNvbm5lY3QoX3JlZjEyKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjEyLmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGdsb2JhbFN0b21wQ2xpZW50ID0gU3RvbXAub3ZlcihuZXcgU29ja0pTKCIiLmNvbmNhdChwcm9jZXNzLmVudi5WVUVfQVBQX1dFQlNPQ0tFVF9BUEksICIvZ3MtZ3VpZGUtd2Vic29ja2V0IikpKTsKCiAgICAgIGlmIChnbG9iYWxTdG9tcENsaWVudCkgewogICAgICAgIGdsb2JhbFN0b21wQ2xpZW50Lmhhc0RlYnVnID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIGdsb2JhbFN0b21wQ2xpZW50LmNvbm5lY3Qoe30sIGZ1bmN0aW9uIChmcmFtZSkgewogICAgICAgIHJldHVybiByZXNvbHZlKGdsb2JhbFN0b21wQ2xpZW50KTsKICAgICAgfSk7CiAgICB9KTsKICB9LAogIHN0b21wQ2xpZW50U2VuZE1lc3NhZ2U6IGZ1bmN0aW9uIHN0b21wQ2xpZW50U2VuZE1lc3NhZ2Uoc3QsIF9yZWYxMykgewogICAgdmFyIHN0b21wQ2xpZW50ID0gX3JlZjEzLnN0b21wQ2xpZW50LAogICAgICAgIGVuZHBvaW50ID0gX3JlZjEzLmVuZHBvaW50LAogICAgICAgIG1lc3NhZ2UgPSBfcmVmMTMubWVzc2FnZTsKICAgIHN0b21wQ2xpZW50LnNlbmQoZW5kcG9pbnQsIG1lc3NhZ2UpOwogIH0sCiAgc3RvbXBTdWJzY3JpYmU6IGZ1bmN0aW9uIHN0b21wU3Vic2NyaWJlKHN0LCBfcmVmMTQpIHsKICAgIHZhciBzdG9tcENsaWVudCA9IF9yZWYxNC5zdG9tcENsaWVudCwKICAgICAgICBlbmRwb2ludCA9IF9yZWYxNC5lbmRwb2ludCwKICAgICAgICBjYWxsYmFjayA9IF9yZWYxNC5jYWxsYmFjazsKICAgIHN0b21wQ2xpZW50LnN1YnNjcmliZShlbmRwb2ludCwgY2FsbGJhY2spOwogICAgcmV0dXJuIHN0b21wQ2xpZW50OwogIH0sCiAgZ2V0QnlDaGF0SWQ6IGZ1bmN0aW9uIGdldEJ5Q2hhdElkKF9yZWYxNSwgcGFyYW1zKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjYoKSB7CiAgICAgIHZhciBjb21taXQsIHJlczsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyNiQoX2NvbnRleHQyNikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjYucHJldiA9IF9jb250ZXh0MjYubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZjE1LmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDI2LnByZXYgPSAxOwogICAgICAgICAgICAgIF9jb250ZXh0MjYubmV4dCA9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuIG1lc3NlbmdlclNlcnZpY2UuZ2V0QnlDaGF0SWQocGFyYW1zKTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDI2LnNlbnQ7CiAgICAgICAgICAgICAgX2NvbnRleHQyNi5uZXh0ID0gNzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRMaXN0Q2hhdE1lc3NlZ2VzIiwgcmVzLmRhdGEgPyByZXMuZGF0YSA6IHsKICAgICAgICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgICAgICAgICAgdG90YWw6IDAKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBfY29udGV4dDI2Lm5leHQgPSAxMzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBfY29udGV4dDI2LnByZXYgPSA5OwogICAgICAgICAgICAgIF9jb250ZXh0MjYudDAgPSBfY29udGV4dDI2WyJjYXRjaCJdKDEpOwogICAgICAgICAgICAgIF9jb250ZXh0MjYubmV4dCA9IDEzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldExpc3RDaGF0TWVzc2VnZXMiLCB7CiAgICAgICAgICAgICAgICBsaXN0OiBbXSwKICAgICAgICAgICAgICAgIHRvdGFsOiAwCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI2LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyNiwgbnVsbCwgW1sxLCA5XV0pOwogICAgfSkpKCk7CiAgfSwKICBnZXRCeUdyb3VwQ2hhdElkOiBmdW5jdGlvbiBnZXRCeUdyb3VwQ2hhdElkKF9yZWYxNiwgcGFyYW1zKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjcoKSB7CiAgICAgIHZhciBjb21taXQsIHJlczsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyNyQoX2NvbnRleHQyNykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjcucHJldiA9IF9jb250ZXh0MjcubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZjE2LmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDI3LnByZXYgPSAxOwogICAgICAgICAgICAgIF9jb250ZXh0MjcubmV4dCA9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuIG1lc3NlbmdlclNlcnZpY2UuZ2V0QnlHcm91cENoYXRJZChwYXJhbXMpOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0Mjcuc2VudDsKICAgICAgICAgICAgICBfY29udGV4dDI3Lm5leHQgPSA3OwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldExpc3RHcm91cENoYXRNZXNzZWdlcyIsIHJlcy5kYXRhID8gcmVzLmRhdGEgOiB7CiAgICAgICAgICAgICAgICBsaXN0OiBbXSwKICAgICAgICAgICAgICAgIHRvdGFsOiAwCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgX2NvbnRleHQyNy5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgX2NvbnRleHQyNy5wcmV2ID0gOTsKICAgICAgICAgICAgICBfY29udGV4dDI3LnQwID0gX2NvbnRleHQyN1siY2F0Y2giXSgxKTsKICAgICAgICAgICAgICBfY29udGV4dDI3Lm5leHQgPSAxMzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRMaXN0R3JvdXBDaGF0TWVzc2VnZXMiLCB7CiAgICAgICAgICAgICAgICBsaXN0OiBbXSwKICAgICAgICAgICAgICAgIHRvdGFsOiAwCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI3LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyNywgbnVsbCwgW1sxLCA5XV0pOwogICAgfSkpKCk7CiAgfSwKICBnZXRDb250YWN0TGlzdDogZnVuY3Rpb24gZ2V0Q29udGFjdExpc3QoX3JlZjE3LCBwYXJhbXMpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyOCgpIHsKICAgICAgdmFyIGNvbW1pdCwgcmVzOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI4JChfY29udGV4dDI4KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyOC5wcmV2ID0gX2NvbnRleHQyOC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmMTcuY29tbWl0OwogICAgICAgICAgICAgIF9jb250ZXh0MjgucHJldiA9IDE7CiAgICAgICAgICAgICAgX2NvbnRleHQyOC5uZXh0ID0gNDsKICAgICAgICAgICAgICByZXR1cm4gbWVzc2VuZ2VyU2VydmljZS5nZXRDb250YWN0TGlzdChwYXJhbXMpOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0Mjguc2VudDsKICAgICAgICAgICAgICBfY29udGV4dDI4Lm5leHQgPSA3OwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldExpc3RSZXNwb25zZSIsIHJlcy5kYXRhID8gcmVzLmRhdGEgOiB7CiAgICAgICAgICAgICAgICBsaXN0OiBbXSwKICAgICAgICAgICAgICAgIHRvdGFsOiAwCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgX2NvbnRleHQyOC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgX2NvbnRleHQyOC5wcmV2ID0gOTsKICAgICAgICAgICAgICBfY29udGV4dDI4LnQwID0gX2NvbnRleHQyOFsiY2F0Y2giXSgxKTsKICAgICAgICAgICAgICBfY29udGV4dDI4Lm5leHQgPSAxMzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRMaXN0UmVzcG9uc2UiLCB7CiAgICAgICAgICAgICAgICBsaXN0OiBbXSwKICAgICAgICAgICAgICAgIHRvdGFsOiAwCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI4LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyOCwgbnVsbCwgW1sxLCA5XV0pOwogICAgfSkpKCk7CiAgfSwKICBnZXRHcm91cENoYXRMaXN0OiBmdW5jdGlvbiBnZXRHcm91cENoYXRMaXN0KF9yZWYxOCwgcGFyYW1zKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjkoKSB7CiAgICAgIHZhciBjb21taXQsIHJlczsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyOSQoX2NvbnRleHQyOSkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjkucHJldiA9IF9jb250ZXh0MjkubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZjE4LmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDI5LnByZXYgPSAxOwogICAgICAgICAgICAgIF9jb250ZXh0MjkubmV4dCA9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuIG1lc3NlbmdlclNlcnZpY2UuZ3JvdXBDaGF0TGlzdChwYXJhbXMpOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0Mjkuc2VudDsKICAgICAgICAgICAgICBfY29udGV4dDI5Lm5leHQgPSA3OwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldExpc3RSZXNwb25zZUdyb3VwQ2hhdCIsIHJlcy5kYXRhID8gcmVzLmRhdGEgOiB7CiAgICAgICAgICAgICAgICBsaXN0OiBbXSwKICAgICAgICAgICAgICAgIHRvdGFsOiAwCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgX2NvbnRleHQyOS5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgX2NvbnRleHQyOS5wcmV2ID0gOTsKICAgICAgICAgICAgICBfY29udGV4dDI5LnQwID0gX2NvbnRleHQyOVsiY2F0Y2giXSgxKTsKICAgICAgICAgICAgICBfY29udGV4dDI5Lm5leHQgPSAxMzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRMaXN0UmVzcG9uc2VHcm91cENoYXQiLCB7CiAgICAgICAgICAgICAgICBsaXN0OiBbXSwKICAgICAgICAgICAgICAgIHRvdGFsOiAwCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI5LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyOSwgbnVsbCwgW1sxLCA5XV0pOwogICAgfSkpKCk7CiAgfQp9Ow=="},{"version":3,"sources":["C:/ACRU PROJECT/Fair Tech/acru-frontend/src/state/modules/messenger.js"],"names":["TokenService","messengerService","SockJS","Stomp","Vue","globalStompClient","state","marketing","notification","contactList","contactTotal","groupChatList","groupChatTotal","comments","commentsTotal","openPage","chatListMessages","chatTotalMessages","groupChatListMessages","groupChatTotalMessages","lastMessage","lastMessageGroup","groupUpdate","groupUpdateMsg","incomingPerson","exitingPerson","chatUnreadCount","unreadData","CHAT","mutations","setCurrentChat","data","setChatMessageMakeRead","id","index","findIndex","e","set","setChatUnreadMessagCount","count","setChatUnreadCount","setComments","setIncomingPerson","setExitingPerson","setMarketing","setNotification","setGroupUpdateE","setGroupChatUpdate","setListResponseGroupChat","list","total","setListResponse","map","firstName","lastName","employeeId","chatId","uploadPath","setOpenPage","setListChatMesseges","setListGroupChatMesseges","pushItems","concat","pushGroupItems","pushChatList","extra","deleteId","splice","editedMessage","message","edited","push","pushCount","chatList","forEach","element","bus","$set","pushGroupChatList","groupChatId","unreadId","isRead","editedGroupMessage","pushGroupCount","remov","actions","commit","JSON","parse","body","getUnreadMessages","st","then","rs","sendAnnouncementDocumentMarking","dispatch","stompClient","endpoint","setDocumentMarking","setNotificationMsg","setCommentTask","parsed","deviceName","setGroupUpdate","setMessage","setGroupMessage","sendMessage","sendMessageGroup","allUnreadMessages","stringify","user_id","localStorage","getItem","onLoad","usr","username","fullName","getUserInfo","employeeFullName","callback","s","root","connect","Promise","resolve","reject","over","process","env","VUE_APP_WEBSOCKET_API","hasDebug","frame","stompClientSendMessage","send","stompSubscribe","subscribe","getByChatId","params","res","getByGroupChatId","getContactList","getGroupChatList"],"mappings":"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","sourcesContent":["import { TokenService } from \"@/shared/services/storage.service\"\r\nimport messengerService from \"@/shared/services/messengerService\";\r\nimport SockJS from \"sockjs-client\";\r\nimport Stomp from \"webstomp-client\";\r\nimport Vue from \"vue\"\r\nlet globalStompClient = null;\r\nexport const state = {\r\n  marketing: null,\r\n  notification: null,\r\n  contactList: [],\r\n  contactTotal: 0,\r\n  groupChatList: [],\r\n  groupChatTotal: 0,\r\n  comments: [],\r\n  commentsTotal: 0,\r\n  openPage: \"default\",\r\n  chatListMessages: [],\r\n  chatTotalMessages: 0,\r\n  groupChatListMessages: [],\r\n  groupChatTotalMessages: 0,\r\n  lastMessage: {},\r\n  lastMessageGroup: {},\r\n  groupUpdate: false,\r\n  groupUpdateMsg: null,\r\n  incomingPerson: null,\r\n  exitingPerson: null,\r\n  chatUnreadCount: 0,\r\n  unreadData: null,\r\n  CHAT: null\r\n}\r\nexport const mutations = {\r\n  setCurrentChat(state, data) {\r\n    state.CHAT = data\r\n  },\r\n  setChatMessageMakeRead(state, id) {\r\n    let index = state.chatListMessages.findIndex(e => e.id == id)\r\n    if (index > -1) {\r\n      Vue.set(state.chatListMessages[index], \"isRead\", \"READ\")\r\n    }\r\n  },\r\n  setChatUnreadMessagCount(state, count) {\r\n    state.chatUnreadCount = count\r\n    if (count > 0) {\r\n      // playSound()\r\n    }\r\n  },\r\n  setChatUnreadCount(state, data) {\r\n    state.unreadData = data\r\n  },\r\n  setComments(state, data) {\r\n    state.comments = data\r\n  },\r\n  setIncomingPerson(state, data) {\r\n    state.incomingPerson = data\r\n  },\r\n  setExitingPerson(state, data) {\r\n    state.exitingPerson = data\r\n  },\r\n  setMarketing(state, data) {\r\n    state.marketing = data\r\n  },\r\n  setNotification(state, data) {\r\n    state.notification = data\r\n  },\r\n  setGroupUpdateE(state, data) {\r\n    state.groupUpdate = data;\r\n  },\r\n  setGroupChatUpdate(state, data) {\r\n    state.groupUpdate = true;\r\n    state.groupUpdateMsg = data;\r\n  },\r\n  setListResponseGroupChat(state, data) {\r\n    state.groupChatList = data.list;\r\n    state.groupChatTotal = data.total;\r\n  },\r\n  setListResponse(state, data) {\r\n    state.contactList = data.list.map(e => {\r\n      return {\r\n        firstName: e.firstName,\r\n        lastName: e.lastName,\r\n        employeeId: e.employeeId,\r\n        chatId: e.chatId,\r\n        uploadPath: e.uploadPath\r\n      }\r\n    })\r\n    state.contactTotal = data.total;\r\n  },\r\n  setOpenPage(state, data) {\r\n    state.openPage = data;\r\n  },\r\n  setListChatMesseges(state, data) {\r\n    state.chatListMessages = data.list;\r\n    state.chatTotalMessages = data.total;\r\n  },\r\n  setListGroupChatMesseges(state, data) {\r\n    state.groupChatListMessages = data.list;\r\n    state.groupChatTotalMessages = data.total;\r\n  },\r\n  pushItems(state, data) {\r\n    state.chatListMessages = data.concat(state.chatListMessages)\r\n  },\r\n  pushGroupItems(state, data) {\r\n    state.groupChatListMessages = data.concat(state.groupChatListMessages)\r\n  },\r\n  pushChatList(state, data) {\r\n    if (state.CHAT && state.CHAT.id == data.chatId) {\r\n      if (data.extra === 'delete') {\r\n        const index = state.chatListMessages.findIndex(e => e.id == data.deleteId)\r\n        if (index > -1) {\r\n          state.chatListMessages.splice(index, 1);\r\n        }\r\n      } else if (data.extra === 'update') {\r\n        const index = state.chatListMessages.findIndex(e => e.id == data.editedMessage.id)\r\n        if (index > -1) {\r\n          state.chatListMessages[index].message = data.editedMessage.message\r\n          state.chatListMessages[index].edited = true\r\n        }\r\n      } else {\r\n        let index = state.chatListMessages.findIndex(e => e.id == data.id)\r\n        if (!index || index <= -1) {\r\n          state.chatListMessages.push(data)\r\n          state.chatTotalMessages++\r\n        }\r\n      }\r\n    }\r\n  },\r\n  pushCount(state, data) {\r\n    state.chatList.forEach((element) => {\r\n      if (element.id === data.chatId) {\r\n        bus.$set(element, \"count\", element.count++);\r\n      }\r\n    });\r\n  },\r\n  pushGroupChatList(state, data) {\r\n    if (state.CHAT && state.CHAT.id == data.groupChatId) {\r\n      if (data.extra === \"unread\") {\r\n        state.groupChatListMessages.forEach((element) => {\r\n          if (element.id == data.unreadId) {\r\n            element.isRead = \"READ\";\r\n          }\r\n        });\r\n      } else if (data.extra === \"delete\") {\r\n        const index = state.groupChatListMessages.findIndex(e => e.id == data.deleteId)\r\n        if (index > -1) {\r\n          state.groupChatListMessages.splice(index, 1);\r\n        }\r\n      } else if (data.extra === \"update\") {\r\n        const index = state.groupChatListMessages.findIndex(e => e.id == data.editedGroupMessage.id)\r\n        if (index > -1) {\r\n          state.groupChatListMessages[index].message = data.editedGroupMessage.message\r\n          state.groupChatListMessages[index].edited = true\r\n        }\r\n      } else {\r\n        const index = state.groupChatListMessages.findIndex(e => e.id == data.id)\r\n        if (index <= -1) {\r\n          state.groupChatListMessages.push(data)\r\n          state.groupChatTotalMessages++\r\n        }\r\n      }\r\n    }\r\n  },\r\n  pushGroupCount(state, data) {\r\n    if (data.extra === \"unread\") {\r\n    } else if (data.extra === \"delete\") {\r\n    } else if (data.extra === \"update\") {\r\n    } else {\r\n      state.groupChatList.forEach((element) => {\r\n        if (element.id === data.chatId) {\r\n          bus.$set(element, \"count\", element.count++);\r\n        }\r\n      });\r\n    }\r\n  },\r\n  remov(state) {\r\n    state.chatListMessages.splice(-1, 1)\r\n  }\r\n}\r\nexport const actions = {\r\n  async setChatMessageMakeRead({ commit }, data) {\r\n    await commit('setChatMessageMakeRead', JSON.parse(data.body))\r\n  },\r\n  async getUnreadMessages(st) {\r\n    messengerService.getUnreadMessages()\r\n      .then(rs => {\r\n        st.commit('setChatUnreadMessagCount', rs.data)\r\n      })\r\n  },\r\n  async sendAnnouncementDocumentMarking(st, data) {\r\n    st.dispatch(\"stompClientSendMessage\", {\r\n      stompClient: globalStompClient,\r\n      endpoint: \"/app/announcementDocumentMarking\",\r\n      message: data,\r\n    });\r\n  },\r\n  async setChatUnreadCount({ commit }, data) {\r\n    await commit('setChatUnreadCount', JSON.parse(data.body))\r\n  },\r\n  async setChatUnreadMessagCount({ commit }, data) {\r\n    await commit(\"setChatUnreadMessagCount\", JSON.parse(data.body));\r\n  },\r\n  async setDocumentMarking({ commit }, data) {\r\n    await commit(\"setMarketing\", JSON.parse(data.body));\r\n  },\r\n  async setNotificationMsg({ commit }, data) {\r\n    await commit(\"setNotification\", JSON.parse(data.body));\r\n  },\r\n  async setCommentTask({ commit }, data) {\r\n    await commit(\"setComments\", JSON.parse(data.body));\r\n  },\r\n  async setIncomingPerson({ commit }, data) {\r\n    let parsed = JSON.parse(data.body)\r\n    if (parsed.deviceName === 'enter') {\r\n      await commit(\"setIncomingPerson\", parsed);\r\n    } else {\r\n      await commit(\"setExitingPerson\", parsed);\r\n    }\r\n  },\r\n  async setGroupUpdate({ commit }) {\r\n    await commit(\"setGroupUpdateE\", false);\r\n  },\r\n  async setMessage({ commit }, data) {\r\n    await commit(\"pushChatList\", JSON.parse(data.body));\r\n  },\r\n  async setGroupMessage({ commit }, data) {\r\n    await commit(\"pushGroupCount\", JSON.parse(data.body));\r\n    await commit(\"pushGroupChatList\", JSON.parse(data.body));\r\n  },\r\n  async sendMessage(st, data) {\r\n    st.dispatch(\"stompClientSendMessage\", {\r\n      stompClient: globalStompClient,\r\n      endpoint: \"/app/sendMessage\",\r\n      message: data,\r\n    });\r\n  },\r\n  async sendMessageGroup(st, data) {\r\n    st.dispatch(\"stompClientSendMessage\", {\r\n      stompClient: globalStompClient,\r\n      endpoint: \"/app/sendGroupMessage\",\r\n      message: data,\r\n    });\r\n  },\r\n  async allUnreadMessages(st) {\r\n    st.dispatch(\"stompClientSendMessage\", {\r\n      stompClient: globalStompClient,\r\n      endpoint: \"/app/allUnreadMessages\",\r\n      message: JSON.stringify({ user_id: JSON.parse(localStorage.getItem(\"user_id\")) }),\r\n    });\r\n  },\r\n  async onLoad(st, usr = null) {\r\n    let username = null, fullName = null;\r\n    if (!usr) {\r\n      username = TokenService.getUserInfo() ? TokenService.getUserInfo().username : null;\r\n      fullName = TokenService.getUserInfo() ? TokenService.getUserInfo().employeeFullName : null;\r\n    } else {\r\n      username = usr\r\n    }\r\n    // let ownerId = JSON.parse(localStorage.getItem(\"user_id\"));\r\n    if (username || fullName) {\r\n      if (usr === 'security') {\r\n        st.dispatch(\"connect\").then(() => {\r\n          st.dispatch(\"stompSubscribe\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: `/user/security/incomingPerson`,\r\n            callback: async (data) => {\r\n              st.dispatch(\"setIncomingPerson\", data);\r\n            },\r\n          });\r\n        })\r\n      } else {\r\n        st.dispatch(\"connect\")\r\n          .then(async (s) => {\r\n            st.dispatch(\"stompClientSendMessage\", {\r\n              stompClient: globalStompClient,\r\n              endpoint: \"/app/register\",\r\n              message: username,\r\n            });\r\n          })\r\n          .then(() => {\r\n            st.dispatch(\"stompSubscribe\", {\r\n              stompClient: globalStompClient,\r\n              endpoint: `/user/${username}/msg`,\r\n              callback: async (data) => {\r\n                st.dispatch(\"setMessage\", data);\r\n              },\r\n            });\r\n          }).then(() => {\r\n          st.dispatch(\"stompSubscribe\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: `/user/${username}/groupMsg`,\r\n            callback: async (data) => {\r\n              st.dispatch(\"setGroupMessage\", data);\r\n            },\r\n          });\r\n        }).then(() => {\r\n          st.dispatch(\"stompSubscribe\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: `/user/${username}/documentMarking`,\r\n            callback: async (data) => {\r\n              st.dispatch(\"setDocumentMarking\", data);\r\n            },\r\n          });\r\n        }).then(() => {\r\n          st.dispatch(\"stompSubscribe\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: `/user/${username}/notificationMsg`,\r\n            callback: async (data) => {\r\n              st.dispatch(\"setNotificationMsg\", data);\r\n              st.dispatch(\"setCount\", null, { root: true })\r\n            },\r\n          });\r\n        })\r\n          // .then(() => {\r\n          //     st.dispatch(\"stompSubscribe\", {\r\n          //         stompClient: globalStompClient,\r\n          //         endpoint: `/user/${fullName}/commentMgs`,\r\n          //         callback: async (data) => {\r\n          //             st.dispatch(\"setCommentTask\", data);\r\n          //         },\r\n          //     });\r\n          // })\r\n          .then(() => {\r\n            st.dispatch(\"stompSubscribe\", {\r\n              stompClient: globalStompClient,\r\n              endpoint: `/user/${username}/unreadMessages`,\r\n              callback: async (data) => {\r\n                st.dispatch(\"setChatUnreadMessagCount\", data);\r\n              },\r\n            });\r\n          }).then(() => {\r\n          st.dispatch(\"stompSubscribe\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: `/user/${username}/unreadMessage`,\r\n            callback: async (data) => {\r\n              st.dispatch(\"setChatUnreadCount\", data);\r\n            },\r\n          });\r\n        }).then(() => {\r\n          st.dispatch(\"stompSubscribe\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: `/user/${username}/makeRead`,\r\n            callback: async (data) => {\r\n              st.dispatch(\"setChatMessageMakeRead\", data);\r\n            },\r\n          });\r\n        })\r\n      }\r\n    }\r\n  },\r\n  connect({ commit }) {\r\n    return new Promise((resolve, reject) => {\r\n      globalStompClient = Stomp.over(\r\n        new SockJS(`${process.env.VUE_APP_WEBSOCKET_API}/gs-guide-websocket`)\r\n      );\r\n      if (globalStompClient) {\r\n        globalStompClient.hasDebug = false\r\n      }\r\n      globalStompClient.connect({}, (frame) => resolve(globalStompClient));\r\n    });\r\n  },\r\n  stompClientSendMessage(st, { stompClient, endpoint, message }) {\r\n    stompClient.send(endpoint, message);\r\n  },\r\n  stompSubscribe(st, { stompClient, endpoint, callback }) {\r\n    stompClient.subscribe(endpoint, callback);\r\n    return stompClient;\r\n  },\r\n  async getByChatId({ commit }, params) {\r\n    try {\r\n      const res = await messengerService.getByChatId(params);\r\n      await commit(\r\n        \"setListChatMesseges\",\r\n        res.data ? res.data : { list: [], total: 0 }\r\n      );\r\n    } catch (error) {\r\n      await commit(\"setListChatMesseges\", { list: [], total: 0 });\r\n    }\r\n  },\r\n  async getByGroupChatId({ commit }, params) {\r\n    try {\r\n      const res = await messengerService.getByGroupChatId(params);\r\n      await commit(\r\n        \"setListGroupChatMesseges\",\r\n        res.data ? res.data : { list: [], total: 0 }\r\n      );\r\n    } catch (error) {\r\n      await commit(\"setListGroupChatMesseges\", { list: [], total: 0 });\r\n    }\r\n  },\r\n  async getContactList({ commit }, params) {\r\n    try {\r\n      const res = await messengerService.getContactList(params);\r\n      await commit(\r\n        \"setListResponse\",\r\n        res.data ? res.data : { list: [], total: 0 }\r\n      );\r\n    } catch (error) {\r\n      await commit(\"setListResponse\", { list: [], total: 0 });\r\n    }\r\n  },\r\n  async getGroupChatList({ commit }, params) {\r\n    try {\r\n      const res = await messengerService.groupChatList(params);\r\n      await commit(\"setListResponseGroupChat\", res.data ? res.data : { list: [], total: 0 }\r\n      );\r\n    } catch (error) {\r\n      await commit(\"setListResponseGroupChat\", { list: [], total: 0 });\r\n    }\r\n  }\r\n}\r\n"]}]}