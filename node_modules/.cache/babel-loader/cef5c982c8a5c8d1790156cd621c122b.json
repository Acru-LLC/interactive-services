{"remainingRequest":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\report\\organizitional\\components\\editReportModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\report\\organizitional\\components\\editReportModal.vue","mtime":1680686863113},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\babel.config.js","mtime":1667352074157},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1675061970665},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1675061970715}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovQUNSVSBQUk9KRUNUL0ZhaXIgVGVjaC9hY3J1LWZyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIkM6L0FDUlUgUFJPSkVDVC9GYWlyIFRlY2gvYWNydS1mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheS5qcyI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiQzovQUNSVSBQUk9KRUNUL0ZhaXIgVGVjaC9hY3J1LWZyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheS5qcyI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkM6L0FDUlUgUFJPSkVDVC9GYWlyIFRlY2gvYWNydS1mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcmVnZW5lcmF0b3JSdW50aW1lLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6L0FDUlUgUFJPSkVDVC9GYWlyIFRlY2gvYWNydS1mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmpzb24uc3RyaW5naWZ5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCBTZXJ2aWNlIGZyb20gIkAvbW9kdWxlcy9yZXBvcnQvcmVwb3J0U2VydmljZSI7CmltcG9ydCBjcnVkQW5kTGlzdHNTZXJ2aWNlIGZyb20gIkAvc2hhcmVkL3NlcnZpY2VzL2NydWRfYW5kX2xpc3Quc2VydmljZSI7CmltcG9ydCBDaGVja2JveCBmcm9tICJ2dWUtbWF0ZXJpYWwtY2hlY2tib3giOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQ2hlY2tib3g6IENoZWNrYm94CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGVib3VuY2U6IG51bGwsCiAgICAgIC8vIE9LRUQgVkFSSUFCTEVTCiAgICAgIG9rZWRzOiBbXSwKICAgICAgaGFzTmV4dFBhZ2VPa2VkOiBmYWxzZSwKICAgICAgaXNMb2FkaW5nT2tlZDogZmFsc2UsCiAgICAgIG9rZWRTZWFyY2hQYXlsb2FkOiB7fSwKICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLQogICAgICBmMUlkczogW10sCiAgICAgIGYySWRzOiBbXSwKICAgICAgZlJvd0lkOiBudWxsLAogICAgICB0YWJsZUlkOiBudWxsLAogICAgICByZXBvcnRJZDogbnVsbCwKICAgICAgLy8gZ2V0TmFtZTogZ2V0TmFtZSwKICAgICAgc2VsZWN0ZWRDb2x1bW5zOiBbXSwKICAgICAgc2VsZWN0ZWRSb3dzOiBbXSwKICAgICAgZmlyc3RDb2x1bW5zOiBbXSwKICAgICAgc2Vjb25kQ29sdW1uczogW10sCiAgICAgIHRoaXJkQ29sdW1uczogW10sCiAgICAgIHRoaXJkVHJJZERhdGE6IFtdLAogICAgICBsb2FkZXI6IGZhbHNlLAogICAgICByZXBvcnQ6IHt9LAogICAgICBzaG93UmVzdWx0OiBmYWxzZSwKICAgICAgc2hvd0RhdGE6IFtdLAogICAgICB0YWJsZToge30sCiAgICAgIGZvcm11bGFzOiBbXSwKICAgICAgY3VycmVudFBvc2l0aW9uOiB7CiAgICAgICAgcm93SW5kZXg6IG51bGwsCiAgICAgICAgY29sdW1uSW5kZXg6IG51bGwsCiAgICAgICAgcm93SWQ6IG51bGwsCiAgICAgICAgY29sdW1uSWQ6IG51bGwKICAgICAgfQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldENvbHVtbkRhdGE6IGZ1bmN0aW9uIGdldENvbHVtbkRhdGEoaSkgewogICAgICB2YXIgZm91bmQgPSB0aGlzLnNob3dEYXRhLmZpbmQoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZS5jb2x1bW5JZCA9PSBpLmNvbHVtbklkOwogICAgICB9KTsKICAgICAgaWYgKGZvdW5kKSB7CiAgICAgICAgcmV0dXJuIGZvdW5kLmNvbHVtbkRhdGE7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICIiOwogICAgICB9CiAgICB9LAogICAgLy8gRFlOQU1JQ19SRUZFUkVOQ0VTIE1FVEhPRFMKICAgIGR5bmFtaWNSZWZzUmVhY2hlZEVuZE9mTGlzdDogZnVuY3Rpb24gZHluYW1pY1JlZnNSZWFjaGVkRW5kT2ZMaXN0KGUpIHsKICAgICAgaWYgKGUpIHsKICAgICAgICB0aGlzLmZldGNoRHluYW1pY1JlZnMoKTsKICAgICAgfQogICAgfSwKICAgIGRlYm91bmNlU2VhcmNoRHluYW1pY1JlZnM6IGZ1bmN0aW9uIGRlYm91bmNlU2VhcmNoRHluYW1pY1JlZnMoc2VhcmNoVGV4dCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KF90aGlzLmRlYm91bmNlKTsKICAgICAgICAgICAgICBfdGhpcy5kZWJvdW5jZSA9IHNldFRpbWVvdXQoIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5mZXRjaER5bmFtaWNSZWZzV2l0aEtleXdvcmQoc2VhcmNoVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgICAgICAgICB9KSksIDEwMDApOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBmZXRjaER5bmFtaWNSZWZzV2l0aEtleXdvcmQ6IGZ1bmN0aW9uIGZldGNoRHluYW1pY1JlZnNXaXRoS2V5d29yZChrZXl3b3JkKSB7CiAgICAgIHRoaXMub2tlZHMgPSBbXTsKICAgICAgdGhpcy5va2VkU2VhcmNoUGF5bG9hZC5wYWdlID0gMTsKICAgICAgdGhpcy5va2VkU2VhcmNoUGF5bG9hZC5rZXl3b3JkID0ga2V5d29yZCA/IGtleXdvcmQgOiAnJzsKICAgICAgdGhpcy5mZXRjaER5bmFtaWNSZWZzKCk7CiAgICB9LAogICAgZmV0Y2hEeW5hbWljUmVmczogZnVuY3Rpb24gZmV0Y2hEeW5hbWljUmVmcygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfdGhpczIuaXNMb2FkaW5nT2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBjcnVkQW5kTGlzdHNTZXJ2aWNlLnNlYXJjaExpc3RXaXRoS2V5d29yZChPS0VEX0FQSV9VUkwsIF90aGlzMi5va2VkU2VhcmNoUGF5bG9hZCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICB2YXIgX3RoaXMyJG9rZWRzOwogICAgICAgICAgICAgICAgKF90aGlzMiRva2VkcyA9IF90aGlzMi5va2VkcykucHVzaC5hcHBseShfdGhpczIkb2tlZHMsIF90b0NvbnN1bWFibGVBcnJheShyZXMuZGF0YS5saXN0KSk7CiAgICAgICAgICAgICAgICBfdGhpczIuaGFzTmV4dFBhZ2VPa2VkID0gcmVzLmRhdGEudG90YWwgLyBfdGhpczIub2tlZFNlYXJjaFBheWxvYWQuaXRlbXNQZXJQYWdlID4gX3RoaXMyLm9rZWRTZWFyY2hQYXlsb2FkLnBhZ2U7CiAgICAgICAgICAgICAgICBfdGhpczIub2tlZFNlYXJjaFBheWxvYWQucGFnZSArPSAxOwogICAgICAgICAgICAgICAgaWYgKCFfdGhpczIuaXNNb2RlQ3JlYXRlICYmIF90aGlzMi5lZGl0aW5nSXRlbS5va2VkSWQpIHsKICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kSXRtID0gX3RoaXMyLm9rZWRzLmZpbmQoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmlkID09IF90aGlzMi5lZGl0aW5nSXRlbS5va2VkSWQ7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBpZiAoIWZvdW5kSXRtICYmIF90aGlzMi5lZGl0aW5nSXRlbS5pbmZvT2tlZER0bykgewogICAgICAgICAgICAgICAgICAgIF90aGlzMi5va2Vkcy5wdXNoKF90aGlzMi5lZGl0aW5nSXRlbS5pbmZvT2tlZER0byk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgICAgICBfdGhpczIub2tlZHMgPSBbXTsKICAgICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIF90aGlzMi5pc0xvYWRpbmdPa2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGN1c3RvbUxhYmVsRHluYW1pY1JlZjogZnVuY3Rpb24gY3VzdG9tTGFiZWxEeW5hbWljUmVmKG9wdCkgewogICAgICB2YXIgc2VsZWN0ZWQgPSB0aGlzLm9rZWRzLmZpbmQoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZS5pZCA9PSBvcHQuaWQ7CiAgICAgIH0pOwogICAgICBpZiAoc2VsZWN0ZWQpIHsKICAgICAgICByZXR1cm4gIiIuY29uY2F0KHNlbGVjdGVkLmNvZGUsICIgLSAiKS5jb25jYXQodGhpcy5nZXROYW1lKHsKICAgICAgICAgIG5hbWVSdTogc2VsZWN0ZWQubmFtZVJ1LAogICAgICAgICAgbmFtZUx0OiBzZWxlY3RlZC5uYW1lTHQsCiAgICAgICAgICBuYW1lVXo6IHNlbGVjdGVkLm5hbWVVegogICAgICAgIH0pKTsKICAgICAgfQogICAgICByZXR1cm4gIiI7CiAgICB9LAogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIGNsZWFyQWxsOiBmdW5jdGlvbiBjbGVhckFsbCgpIHsKICAgICAgdGhpcy5zZWxlY3RlZENvbHVtbnMgPSBbXTsKICAgICAgdGhpcy5zZWxlY3RlZFJvd3MgPSBbXTsKICAgICAgdGhpcy5maXJzdENvbHVtbnMgPSBbXTsKICAgICAgdGhpcy5zZWNvbmRDb2x1bW5zID0gW107CiAgICAgIHRoaXMudGhpcmRDb2x1bW5zID0gW107CiAgICAgIHRoaXMudGhpcmRUcklkRGF0YSA9IFtdOwogICAgICB0aGlzLmZvcm11bGFzID0gW107CiAgICAgIHRoaXMudGFibGUgPSBbXTsKICAgICAgdGhpcy5mMUlkcyA9IFtdOwogICAgICB0aGlzLmYySWRzID0gW107CiAgICB9LAogICAga2V5ZG93bkV2dDogZnVuY3Rpb24ga2V5ZG93bkV2dChldnQsIHJvd0lkLCB2YWx1ZSwgcm93SW5kZXgsIGNvbHVtbkluZGV4LCBjb2x1bW5JZCwgdHlwZUNvZGUpIHsKICAgICAgdGhpcy5rZXlVcEV2ZW50c0Rpc2FibGUoZXZ0KTsKICAgICAgaWYgKGNvbHVtbklkICE9IG51bGwpIHsKICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT0gNDAgJiYgcm93SWQgIT0gbnVsbCkgewogICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAvLyBkb3duCiAgICAgICAgICBpZiAocm93SW5kZXggPCB0aGlzLnNlbGVjdGVkUm93cy5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgIHZhciBjdXJyZW50Q29sdW1uID0gdGhpcy50aGlyZFRySWREYXRhW2NvbHVtbkluZGV4XTsKICAgICAgICAgICAgdmFyIGRvd25Sb3dDb2x1bW4gPSB0aGlzLnNlbGVjdGVkUm93c1tyb3dJbmRleCArIDFdOwogICAgICAgICAgICB2YXIgZG93bklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgIHJvd0lkOiBkb3duUm93Q29sdW1uLmlkLAogICAgICAgICAgICAgIGNvbHVtbklkOiBjdXJyZW50Q29sdW1uLmNvbHVtbklkCiAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgaWYgKGRvd25JbnB1dCkgewogICAgICAgICAgICAgIGRvd25JbnB1dC5mb2N1cygpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChldnQua2V5Q29kZSA9PSAzOCAmJiByb3dJZCAhPSBudWxsKSB7CiAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgIGlmIChyb3dJbmRleCAhPSAwKSB7CiAgICAgICAgICAgIHZhciBfY3VycmVudENvbHVtbiA9IHRoaXMudGhpcmRUcklkRGF0YVtjb2x1bW5JbmRleF07CiAgICAgICAgICAgIHZhciB1cFJvd0NvbHVtbiA9IHRoaXMuc2VsZWN0ZWRSb3dzW3Jvd0luZGV4IC0gMV07CiAgICAgICAgICAgIHZhciB1cElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgIHJvd0lkOiB1cFJvd0NvbHVtbi5pZCwKICAgICAgICAgICAgICBjb2x1bW5JZDogX2N1cnJlbnRDb2x1bW4uY29sdW1uSWQKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBpZiAodXBJbnB1dCkgewogICAgICAgICAgICAgIHVwSW5wdXQuZm9jdXMoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgLy91cAogICAgICAgIH0gZWxzZSBpZiAoZXZ0LmtleUNvZGUgPT0gMzcpIHsKICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgLy9sZWZ0CiAgICAgICAgICBpZiAoY29sdW1uSW5kZXggIT0gMCkgewogICAgICAgICAgICB2YXIgcHJldkNvbHVtbiA9IHRoaXMudGhpcmRUcklkRGF0YVtjb2x1bW5JbmRleCAtIDFdOwogICAgICAgICAgICB2YXIgY3VycmVudFJvdyA9IHRoaXMuc2VsZWN0ZWRSb3dzW3Jvd0luZGV4XTsKICAgICAgICAgICAgdmFyIHByZXZJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICByb3dJZDogY3VycmVudFJvdy5pZCwKICAgICAgICAgICAgICBjb2x1bW5JZDogcHJldkNvbHVtbi5jb2x1bW5JZAogICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIGlmIChwcmV2SW5wdXQpIHsKICAgICAgICAgICAgICBpZiAocHJldklucHV0LmRpc2FibGVkKSB7CiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSB0aGlzLnRoaXJkVHJJZERhdGEubGVuZ3RoIC0gKGNvbHVtbkluZGV4IC0gMSk7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICAgICAgICAgICAgdmFyIHByZXZDb2x1bW4yID0gdGhpcy50aGlyZFRySWREYXRhW2NvbHVtbkluZGV4IC0gMSAtIGldOwogICAgICAgICAgICAgICAgICBpZiAocHJldkNvbHVtbjIpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgICByb3dJZDogY3VycmVudFJvdy5pZCwKICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbklkOiBwcmV2Q29sdW1uMi5jb2x1bW5JZAogICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgICBpZiAoaW5wdXQgJiYgaW5wdXQuZGlzYWJsZWQpIHsKICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5wdXQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuZm9jdXMoKTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBwcmV2SW5wdXQuZm9jdXMoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGV2dC5rZXlDb2RlID09IDM5KSB7CiAgICAgICAgICAvL3JpZ2h0CiAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgIGlmICh0aGlzLnRoaXJkVHJJZERhdGEubGVuZ3RoIC0gMSA+IGNvbHVtbkluZGV4KSB7CiAgICAgICAgICAgIHZhciBuZXh0Q29sdW1uID0gdGhpcy50aGlyZFRySWREYXRhW2NvbHVtbkluZGV4ICsgMV07CiAgICAgICAgICAgIHZhciBfY3VycmVudFJvdyA9IHRoaXMuc2VsZWN0ZWRSb3dzW3Jvd0luZGV4XTsKICAgICAgICAgICAgdmFyIG5leHRJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICByb3dJZDogX2N1cnJlbnRSb3cuaWQsCiAgICAgICAgICAgICAgY29sdW1uSWQ6IG5leHRDb2x1bW4uY29sdW1uSWQKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBpZiAobmV4dElucHV0KSB7CiAgICAgICAgICAgICAgaWYgKG5leHRJbnB1dC5kaXNhYmxlZCkgewogICAgICAgICAgICAgICAgdmFyIGZvckNvdW50ID0gdGhpcy50aGlyZFRySWREYXRhLmxlbmd0aCAtIChjb2x1bW5JbmRleCArIDEpOwogICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGZvckNvdW50OyBfaSsrKSB7CiAgICAgICAgICAgICAgICAgIHZhciBuZXh0Q29sdW1uMiA9IHRoaXMudGhpcmRUcklkRGF0YVtjb2x1bW5JbmRleCArIDEgKyBfaV07CiAgICAgICAgICAgICAgICAgIHZhciBfaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgcm93SWQ6IF9jdXJyZW50Um93LmlkLAogICAgICAgICAgICAgICAgICAgIGNvbHVtbklkOiBuZXh0Q29sdW1uMi5jb2x1bW5JZAogICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgIGlmIChfaW5wdXQuZGlzYWJsZWQpIHsKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAoX2lucHV0KSB7CiAgICAgICAgICAgICAgICAgICAgICBfaW5wdXQuZm9jdXMoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbmV4dElucHV0LmZvY3VzKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgcmVzZXRJbmRleDogZnVuY3Rpb24gcmVzZXRJbmRleCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy4kc2V0KF90aGlzMy5jdXJyZW50UG9zaXRpb24sICJyb3dJbmRleCIsIG51bGwpOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiBfdGhpczMuJHNldChfdGhpczMuY3VycmVudFBvc2l0aW9uLCAiY29sdW1uSW5kZXgiLCBudWxsKTsKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNjsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLiRzZXQoX3RoaXMzLmN1cnJlbnRQb3NpdGlvbiwgInJvd0lkIiwgbnVsbCk7CiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDg7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy4kc2V0KF90aGlzMy5jdXJyZW50UG9zaXRpb24sICJjb2x1bW5JZCIsIG51bGwpOwogICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBzZXRFcnJvcjogZnVuY3Rpb24gc2V0RXJyb3IoZjEsIGYyLCBmcm93SWQpIHsKICAgICAgdGhpcy5mMUlkcyA9IGYxOwogICAgICB0aGlzLmYySWRzID0gZjI7CiAgICAgIHRoaXMuZlJvd0lkID0gZnJvd0lkOwogICAgfSwKICAgIGtleVVwRXZlbnRzRGlzYWJsZTogZnVuY3Rpb24ga2V5VXBFdmVudHNEaXNhYmxlKGUpIHsKICAgICAgaWYgKHRoaXMuY3VycmVudFBvc2l0aW9uLmNvbHVtbklkICE9IG51bGwpIHsKICAgICAgICBpZiAoZS53aGljaCA9PT0gMzggfHwgZS53aGljaCA9PT0gNDApIHsKICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBrZXlVcEV2ZW50czogZnVuY3Rpb24ga2V5VXBFdmVudHMoZXZ0KSB7CiAgICAgIHRoaXMua2V5VXBFdmVudHNEaXNhYmxlKGV2dCk7CiAgICAgIC8vIGlmICh0aGlzLmN1cnJlbnRQb3NpdGlvbi5jb2x1bW5JZCAhPSBudWxsKSB7CiAgICAgIC8vICAgaWYgKGV2dC5rZXlDb2RlID09IDQwICYmIHRoaXMuY3VycmVudFBvc2l0aW9uLnJvd0lkICE9IG51bGwpIHsKICAgICAgLy8gICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAvLyAgICAgLy8gZG93bgogICAgICAvLyAgICAgaWYgKHRoaXMuY3VycmVudFBvc2l0aW9uLnJvd0luZGV4IDwgdGhpcy5zZWxlY3RlZFJvd3MubGVuZ3RoIC0gMSkgewogICAgICAvLyAgICAgICBsZXQgY3VycmVudENvbHVtbiA9CiAgICAgIC8vICAgICAgICAgdGhpcy50aGlyZFRySWREYXRhW3RoaXMuY3VycmVudFBvc2l0aW9uLmNvbHVtbkluZGV4XTsKICAgICAgLy8gICAgICAgbGV0IGRvd25Sb3dDb2x1bW4gPQogICAgICAvLyAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dzW3RoaXMuY3VycmVudFBvc2l0aW9uLnJvd0luZGV4ICsgMV07CiAgICAgIC8vICAgICAgIGxldCBkb3duSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgKICAgICAgLy8gICAgICAgICBKU09OLnN0cmluZ2lmeSh7CiAgICAgIC8vICAgICAgICAgICByb3dJZDogZG93blJvd0NvbHVtbi5pZCwKICAgICAgLy8gICAgICAgICAgIGNvbHVtbklkOiBjdXJyZW50Q29sdW1uLmNvbHVtbklkLAogICAgICAvLyAgICAgICAgIH0pCiAgICAgIC8vICAgICAgICk7CiAgICAgIC8vICAgICAgIGlmIChkb3duSW5wdXQpIHsKICAgICAgLy8gICAgICAgICBkb3duSW5wdXQuZm9jdXMoKTsKICAgICAgLy8gICAgICAgfQogICAgICAvLyAgICAgfQogICAgICAvLyAgIH0gZWxzZSBpZiAoZXZ0LmtleUNvZGUgPT0gMzggJiYgdGhpcy5jdXJyZW50UG9zaXRpb24ucm93SWQgIT0gbnVsbCkgewogICAgICAvLyAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIC8vICAgICBpZiAodGhpcy5jdXJyZW50UG9zaXRpb24ucm93SW5kZXggIT0gMCkgewogICAgICAvLyAgICAgICBsZXQgY3VycmVudENvbHVtbiA9CiAgICAgIC8vICAgICAgICAgdGhpcy50aGlyZFRySWREYXRhW3RoaXMuY3VycmVudFBvc2l0aW9uLmNvbHVtbkluZGV4XTsKICAgICAgLy8gICAgICAgbGV0IHVwUm93Q29sdW1uID0KICAgICAgLy8gICAgICAgICB0aGlzLnNlbGVjdGVkUm93c1t0aGlzLmN1cnJlbnRQb3NpdGlvbi5yb3dJbmRleCAtIDFdOwogICAgICAvLyAgICAgICBsZXQgdXBJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKAogICAgICAvLyAgICAgICAgIEpTT04uc3RyaW5naWZ5KHsKICAgICAgLy8gICAgICAgICAgIHJvd0lkOiB1cFJvd0NvbHVtbi5pZCwKICAgICAgLy8gICAgICAgICAgIGNvbHVtbklkOiBjdXJyZW50Q29sdW1uLmNvbHVtbklkLAogICAgICAvLyAgICAgICAgIH0pCiAgICAgIC8vICAgICAgICk7CiAgICAgIC8vICAgICAgIGlmICh1cElucHV0KSB7CiAgICAgIC8vICAgICAgICAgdXBJbnB1dC5mb2N1cygpOwogICAgICAvLyAgICAgICB9CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICAvL3VwCiAgICAgIC8vICAgfSBlbHNlIGlmIChldnQua2V5Q29kZSA9PSAzNykgewogICAgICAvLyAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIC8vICAgICAvL2xlZnQKICAgICAgLy8gICAgIGlmICh0aGlzLmN1cnJlbnRQb3NpdGlvbi5jb2x1bW5JbmRleCAhPSAwKSB7CiAgICAgIC8vICAgICAgIGxldCBwcmV2Q29sdW1uID0KICAgICAgLy8gICAgICAgICB0aGlzLnRoaXJkVHJJZERhdGFbdGhpcy5jdXJyZW50UG9zaXRpb24uY29sdW1uSW5kZXggLSAxXTsKICAgICAgLy8gICAgICAgbGV0IGN1cnJlbnRSb3cgPSB0aGlzLnNlbGVjdGVkUm93c1t0aGlzLmN1cnJlbnRQb3NpdGlvbi5yb3dJbmRleF07CiAgICAgIC8vICAgICAgIGxldCBwcmV2SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgKICAgICAgLy8gICAgICAgICBKU09OLnN0cmluZ2lmeSh7CiAgICAgIC8vICAgICAgICAgICByb3dJZDogY3VycmVudFJvdy5pZCwKICAgICAgLy8gICAgICAgICAgIGNvbHVtbklkOiBwcmV2Q29sdW1uLmNvbHVtbklkLAogICAgICAvLyAgICAgICAgIH0pCiAgICAgIC8vICAgICAgICk7CiAgICAgIC8vICAgICAgIGlmIChwcmV2SW5wdXQpIHsKICAgICAgLy8gICAgICAgICBpZiAocHJldklucHV0LmRpc2FibGVkKSB7CiAgICAgIC8vICAgICAgICAgICBsZXQgY291bnQgPQogICAgICAvLyAgICAgICAgICAgICB0aGlzLnRoaXJkVHJJZERhdGEubGVuZ3RoIC0KICAgICAgLy8gICAgICAgICAgICAgKHRoaXMuY3VycmVudFBvc2l0aW9uLmNvbHVtbkluZGV4IC0gMSk7CiAgICAgIC8vICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgLy8gICAgICAgICAgICAgbGV0IHByZXZDb2x1bW4yID0KICAgICAgLy8gICAgICAgICAgICAgICB0aGlzLnRoaXJkVHJJZERhdGFbCiAgICAgIC8vICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQb3NpdGlvbi5jb2x1bW5JbmRleCAtIDEgLSBpCiAgICAgIC8vICAgICAgICAgICAgICAgXTsKICAgICAgLy8gICAgICAgICAgICAgbGV0IGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoCiAgICAgIC8vICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoewogICAgICAvLyAgICAgICAgICAgICAgICAgcm93SWQ6IGN1cnJlbnRSb3cuaWQsCiAgICAgIC8vICAgICAgICAgICAgICAgICBjb2x1bW5JZDogcHJldkNvbHVtbjIuY29sdW1uSWQsCiAgICAgIC8vICAgICAgICAgICAgICAgfSkKICAgICAgLy8gICAgICAgICAgICAgKTsKICAgICAgLy8gICAgICAgICAgICAgaWYgKGlucHV0ICYmIGlucHV0LmRpc2FibGVkKSB7CiAgICAgIC8vICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgIC8vICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgIC8vICAgICAgICAgICAgICAgaWYgKGlucHV0KSB7CiAgICAgIC8vICAgICAgICAgICAgICAgICBpbnB1dC5mb2N1cygpOwogICAgICAvLyAgICAgICAgICAgICAgIH0KICAgICAgLy8gICAgICAgICAgICAgICBicmVhazsKICAgICAgLy8gICAgICAgICAgICAgfQogICAgICAvLyAgICAgICAgICAgfQogICAgICAvLyAgICAgICAgIH0gZWxzZSB7CiAgICAgIC8vICAgICAgICAgICBwcmV2SW5wdXQuZm9jdXMoKTsKICAgICAgLy8gICAgICAgICB9CiAgICAgIC8vICAgICAgIH0KICAgICAgLy8gICAgIH0KICAgICAgLy8gICB9IGVsc2UgaWYgKGV2dC5rZXlDb2RlID09IDM5KSB7CiAgICAgIC8vICAgICAvL3JpZ2h0CiAgICAgIC8vICAgICBldnQucHJldmVudERlZmF1bHQoKTsKICAgICAgLy8gICAgIGlmICgKICAgICAgLy8gICAgICAgdGhpcy50aGlyZFRySWREYXRhLmxlbmd0aCAtIDEgPgogICAgICAvLyAgICAgICB0aGlzLmN1cnJlbnRQb3NpdGlvbi5jb2x1bW5JbmRleAogICAgICAvLyAgICAgKSB7CiAgICAgIC8vICAgICAgIGxldCBuZXh0Q29sdW1uID0KICAgICAgLy8gICAgICAgICB0aGlzLnRoaXJkVHJJZERhdGFbdGhpcy5jdXJyZW50UG9zaXRpb24uY29sdW1uSW5kZXggKyAxXTsKICAgICAgLy8gICAgICAgbGV0IGN1cnJlbnRSb3cgPSB0aGlzLnNlbGVjdGVkUm93c1t0aGlzLmN1cnJlbnRQb3NpdGlvbi5yb3dJbmRleF07CiAgICAgIC8vICAgICAgIGxldCBuZXh0SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgKICAgICAgLy8gICAgICAgICBKU09OLnN0cmluZ2lmeSh7CiAgICAgIC8vICAgICAgICAgICByb3dJZDogY3VycmVudFJvdy5pZCwKICAgICAgLy8gICAgICAgICAgIGNvbHVtbklkOiBuZXh0Q29sdW1uLmNvbHVtbklkLAogICAgICAvLyAgICAgICAgIH0pCiAgICAgIC8vICAgICAgICk7CiAgICAgIC8vICAgICAgIGlmIChuZXh0SW5wdXQpIHsKICAgICAgLy8gICAgICAgICBpZiAobmV4dElucHV0LmRpc2FibGVkKSB7CiAgICAgIC8vICAgICAgICAgICBsZXQgZm9yQ291bnQgPQogICAgICAvLyAgICAgICAgICAgICB0aGlzLnRoaXJkVHJJZERhdGEubGVuZ3RoIC0KICAgICAgLy8gICAgICAgICAgICAgKHRoaXMuY3VycmVudFBvc2l0aW9uLmNvbHVtbkluZGV4ICsgMSk7CiAgICAgIC8vICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZvckNvdW50OyBpKyspIHsKICAgICAgLy8gICAgICAgICAgICAgbGV0IG5leHRDb2x1bW4yID0KICAgICAgLy8gICAgICAgICAgICAgICB0aGlzLnRoaXJkVHJJZERhdGFbCiAgICAgIC8vICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQb3NpdGlvbi5jb2x1bW5JbmRleCArIDEgKyBpCiAgICAgIC8vICAgICAgICAgICAgICAgXTsKCiAgICAgIC8vICAgICAgICAgICAgIGxldCBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKAogICAgICAvLyAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHsKICAgICAgLy8gICAgICAgICAgICAgICAgIHJvd0lkOiBjdXJyZW50Um93LmlkLAogICAgICAvLyAgICAgICAgICAgICAgICAgY29sdW1uSWQ6IG5leHRDb2x1bW4yLmNvbHVtbklkLAogICAgICAvLyAgICAgICAgICAgICAgIH0pCiAgICAgIC8vICAgICAgICAgICAgICk7CiAgICAgIC8vICAgICAgICAgICAgIGlmIChpbnB1dC5kaXNhYmxlZCkgewogICAgICAvLyAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAvLyAgICAgICAgICAgICB9IGVsc2UgewogICAgICAvLyAgICAgICAgICAgICAgIGlmIChpbnB1dCkgewogICAgICAvLyAgICAgICAgICAgICAgICAgaW5wdXQuZm9jdXMoKTsKICAgICAgLy8gICAgICAgICAgICAgICB9CiAgICAgIC8vICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgIC8vICAgICAgICAgICAgIH0KICAgICAgLy8gICAgICAgICAgIH0KICAgICAgLy8gICAgICAgICB9IGVsc2UgewogICAgICAvLyAgICAgICAgICAgbmV4dElucHV0LmZvY3VzKCk7CiAgICAgIC8vICAgICAgICAgfQogICAgICAvLyAgICAgICB9CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgfQogICAgICAvLyB9CiAgICB9LAogICAgZm9jdXNWYWw6IGZ1bmN0aW9uIGZvY3VzVmFsKHJvd0lkLCB2YWx1ZSwgcm93SW5kZXgsIGNvbHVtbkluZGV4LCBjb2x1bW5JZCwgdHlwZUNvZGUpIHsKICAgICAgdGhpcy4kc2V0KHRoaXMuY3VycmVudFBvc2l0aW9uLCAicm93SW5kZXgiLCBwYXJzZUZsb2F0KHJvd0luZGV4KSk7CiAgICAgIHRoaXMuJHNldCh0aGlzLmN1cnJlbnRQb3NpdGlvbiwgImNvbHVtbkluZGV4IiwgcGFyc2VGbG9hdChjb2x1bW5JbmRleCkpOwogICAgICB0aGlzLiRzZXQodGhpcy5jdXJyZW50UG9zaXRpb24sICJyb3dJZCIsIHBhcnNlRmxvYXQocm93SWQpKTsKICAgICAgdGhpcy4kc2V0KHRoaXMuY3VycmVudFBvc2l0aW9uLCAiY29sdW1uSWQiLCBwYXJzZUZsb2F0KGNvbHVtbklkKSk7CiAgICB9LAogICAgZ2V0Rm9ybXVsYXNfMjogZnVuY3Rpb24gZ2V0Rm9ybXVsYXNfMigpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzLCByZWopIHsKICAgICAgICBpZiAoX3RoaXM0LnRhYmxlSWQpIHsKICAgICAgICAgIFNlcnZpY2UuZm9ybXVsYXNCeVRhYmxlSWRfMihfdGhpczQudGFibGVJZCkudGhlbihmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgICAgICAgdmFyIGRhdGEgPSBfcmVmMi5kYXRhOwogICAgICAgICAgICBfdGhpczQuZm9ybXVsYXMgPSBkYXRhOwogICAgICAgICAgICByZXMoZGF0YSk7CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICByZXR1cm4gcmVqKGUpOwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlaigpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZ2V0RGF0YUJ5SWQ6IGZ1bmN0aW9uIGdldERhdGFCeUlkKGlkKSB7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzLCByZWopIHsKICAgICAgICBTZXJ2aWNlLmdldFJlcG9ydEJ5SWQoaWQpLnRoZW4oZnVuY3Rpb24gKF9yZWYzKSB7CiAgICAgICAgICB2YXIgZGF0YSA9IF9yZWYzLmRhdGE7CiAgICAgICAgICByZXMoZGF0YSk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiByZWooZSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGVkaXRWYWx1ZTogZnVuY3Rpb24gZWRpdFZhbHVlKHJvd0luZGV4LCBpbmRleCkgewogICAgICB0aGlzLiRzZXQodGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtyb3dJbmRleF0sICdub3RFZGl0YWJsZScsIGZhbHNlKTsKICAgICAgdGhpcy4kZm9yY2VVcGRhdGUoKTsKICAgIH0sCiAgICByZXNldFZhbHVlOiBmdW5jdGlvbiByZXNldFZhbHVlKHJvd0luZGV4LCBpbmRleCkgewogICAgICB0aGlzLiRzZXQodGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtyb3dJbmRleF0sICdzZWxlY3RWYWx1ZUlkJywgdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtyb3dJbmRleF0ub3JpZ2luYWxTZWxlY3RWYWx1ZUlkKTsKICAgICAgdGhpcy4kc2V0KHRoaXMudGhpcmRUcklkRGF0YVtpbmRleF0udmFsdWVbcm93SW5kZXhdLCAnc2VsZWN0VmFsdWVOYW1lVXonLCB0aGlzLnRoaXJkVHJJZERhdGFbaW5kZXhdLnZhbHVlW3Jvd0luZGV4XS5vcmlnaW5hbFNlbGVjdFZhbHVlTmFtZVV6KTsKICAgICAgdGhpcy4kc2V0KHRoaXMudGhpcmRUcklkRGF0YVtpbmRleF0udmFsdWVbcm93SW5kZXhdLCAnc2VsZWN0VmFsdWVOYW1lTHQnLCB0aGlzLnRoaXJkVHJJZERhdGFbaW5kZXhdLnZhbHVlW3Jvd0luZGV4XS5vcmlnaW5hbFNlbGVjdFZhbHVlTmFtZUx0KTsKICAgICAgdGhpcy4kc2V0KHRoaXMudGhpcmRUcklkRGF0YVtpbmRleF0udmFsdWVbcm93SW5kZXhdLCAnc2VsZWN0VmFsdWVOYW1lUnUnLCB0aGlzLnRoaXJkVHJJZERhdGFbaW5kZXhdLnZhbHVlW3Jvd0luZGV4XS5vcmlnaW5hbFNlbGVjdFZhbHVlTmFtZVJ1KTsKICAgICAgdGhpcy4kc2V0KHRoaXMudGhpcmRUcklkRGF0YVtpbmRleF0udmFsdWVbcm93SW5kZXhdLCAnbm90RWRpdGFibGUnLCB0cnVlKTsKICAgICAgdGhpcy4kZm9yY2VVcGRhdGUoKTsKICAgIH0sCiAgICBzZXRWYWx1ZTogZnVuY3Rpb24gc2V0VmFsdWUocm93SWQsIHZhbHVlLCByb3dJbmRleCwgaW5kZXgsIGlkLCB0eXBlQ29kZSkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKICAgICAgdmFyIG5vdEVkaXRhYmxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDYgJiYgYXJndW1lbnRzWzZdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNl0gOiBmYWxzZTsKICAgICAgdmFyIGluaXRpYWxMb2FkQ2FsbCA9IGFyZ3VtZW50cy5sZW5ndGggPiA3ICYmIGFyZ3VtZW50c1s3XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzddIDogZmFsc2U7CiAgICAgIC8qIHRoaXMudGhpcmRUcklkRGF0YVtpbmRleF0udmFsdWVbcm93SW5kZXhdID0gew0KICAgICAgICByb3dJZDogcm93SWQgPyByb3dJZCA6IG51bGwsDQogICAgICAgIHZhbHVlOiB0eXBlQ29kZSA9PT0gJ1NFTEVDVCcgPyAnJyA6IHZhbHVlLA0KICAgICAgICBzZWxlY3RWYWx1ZUlkOiB2YWx1ZSA/IHZhbHVlLmlkIDogbnVsbCwNCiAgICAgICAgc2VsZWN0VmFsdWVOYW1lVXo6IHZhbHVlID8gdmFsdWUubmFtZVV6IDogbnVsbCwNCiAgICAgICAgc2VsZWN0VmFsdWVOYW1lTHQ6IHZhbHVlID8gdmFsdWUubmFtZUx0IDogbnVsbCwNCiAgICAgICAgc2VsZWN0VmFsdWVOYW1lUnU6IHZhbHVlID8gdmFsdWUubmFtZVJ1IDogbnVsbCwNCiAgICAgICAgb3JpZ2luYWxTZWxlY3RWYWx1ZU5hbWVVejogdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtyb3dJbmRleF0gPyB0aGlzLnRoaXJkVHJJZERhdGFbaW5kZXhdLnZhbHVlW3Jvd0luZGV4XS5vcmlnaW5hbFNlbGVjdFZhbHVlTmFtZVV6IDogJycsDQogICAgICAgIG9yaWdpbmFsU2VsZWN0VmFsdWVOYW1lTHQ6IHRoaXMudGhpcmRUcklkRGF0YVtpbmRleF0udmFsdWVbcm93SW5kZXhdID8gdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtyb3dJbmRleF0ub3JpZ2luYWxTZWxlY3RWYWx1ZU5hbWVMdCA6ICcnLA0KICAgICAgICBvcmlnaW5hbFNlbGVjdFZhbHVlTmFtZVJ1OiB0aGlzLnRoaXJkVHJJZERhdGFbaW5kZXhdLnZhbHVlW3Jvd0luZGV4XSA/IHRoaXMudGhpcmRUcklkRGF0YVtpbmRleF0udmFsdWVbcm93SW5kZXhdLm9yaWdpbmFsU2VsZWN0VmFsdWVOYW1lUnUgOiAnJywNCiAgICAgICAgdHlwZUNvZGU6IHR5cGVDb2RlLA0KICAgICAgICBjb2x1bW5JZDogaWQsDQogICAgICAgIG5vdEVkaXRhYmxlOiBub3RFZGl0YWJsZQ0KICAgICAgfTsgKi8KICAgICAgaWYgKGluaXRpYWxMb2FkQ2FsbCAmJiB0eXBlQ29kZSA9PT0gJ1NFTEVDVCcpIHsKICAgICAgICB2YXIgX3Jvd0luZGV4ID0gdGhpcy5zZWxlY3RlZFJvd3MuZmluZEluZGV4KGZ1bmN0aW9uIChlbCkgewogICAgICAgICAgcmV0dXJuIGVsLmlkID09IHJvd0lkOwogICAgICAgIH0pOwogICAgICAgIGlmICghdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtfcm93SW5kZXhdLnJvd0lkKSB7CiAgICAgICAgICB0aGlzLnRoaXJkVHJJZERhdGFbaW5kZXhdLnZhbHVlW19yb3dJbmRleF0gPSB7CiAgICAgICAgICAgIHJvd0lkOiByb3dJZCwKICAgICAgICAgICAgdmFsdWU6IHR5cGVDb2RlID09PSAnU0VMRUNUJyA/ICcnIDogdmFsdWUsCiAgICAgICAgICAgIHNlbGVjdFZhbHVlSWQ6IHZhbHVlID8gdmFsdWUuaWQgOiBudWxsLAogICAgICAgICAgICBzZWxlY3RWYWx1ZU5hbWVVejogdmFsdWUgPyB2YWx1ZS5uYW1lVXogPyB2YWx1ZS5uYW1lVXogOiB2YWx1ZS5uYW1lIDogbnVsbCwKICAgICAgICAgICAgc2VsZWN0VmFsdWVOYW1lTHQ6IHZhbHVlID8gdmFsdWUubmFtZUx0IDogbnVsbCwKICAgICAgICAgICAgc2VsZWN0VmFsdWVOYW1lUnU6IHZhbHVlID8gdmFsdWUubmFtZVJ1IDogbnVsbCwKICAgICAgICAgICAgb3JpZ2luYWxTZWxlY3RWYWx1ZU5hbWVVejogdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtfcm93SW5kZXhdID8gdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtfcm93SW5kZXhdLm9yaWdpbmFsU2VsZWN0VmFsdWVOYW1lVXogOiAnJywKICAgICAgICAgICAgb3JpZ2luYWxTZWxlY3RWYWx1ZU5hbWVMdDogdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtfcm93SW5kZXhdID8gdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtfcm93SW5kZXhdLm9yaWdpbmFsU2VsZWN0VmFsdWVOYW1lTHQgOiAnJywKICAgICAgICAgICAgb3JpZ2luYWxTZWxlY3RWYWx1ZU5hbWVSdTogdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtfcm93SW5kZXhdID8gdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtfcm93SW5kZXhdLm9yaWdpbmFsU2VsZWN0VmFsdWVOYW1lUnUgOiAnJywKICAgICAgICAgICAgdHlwZUNvZGU6IHR5cGVDb2RlLAogICAgICAgICAgICBjb2x1bW5JZDogaWQsCiAgICAgICAgICAgIG5vdEVkaXRhYmxlOiBub3RFZGl0YWJsZQogICAgICAgICAgfTsKICAgICAgICAgIHRoaXMudGhpcmRUcklkRGF0YVtpbmRleF0udmFsdWVbX3Jvd0luZGV4XS5vcmlnaW5hbHNlbGVjdFZhbHVlSWQgPSB2YWx1ZS5pZDsKICAgICAgICAgIHRoaXMudGhpcmRUcklkRGF0YVtpbmRleF0udmFsdWVbX3Jvd0luZGV4XS5vcmlnaW5hbFNlbGVjdFZhbHVlTmFtZVV6ID0gdmFsdWUubmFtZVV6OwogICAgICAgICAgdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtfcm93SW5kZXhdLm9yaWdpbmFsU2VsZWN0VmFsdWVOYW1lTHQgPSB2YWx1ZS5uYW1lTHQ7CiAgICAgICAgICB0aGlzLnRoaXJkVHJJZERhdGFbaW5kZXhdLnZhbHVlW19yb3dJbmRleF0ub3JpZ2luYWxTZWxlY3RWYWx1ZU5hbWVSdSA9IHZhbHVlLm5hbWVSdTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHR5cGVDb2RlID09PSAnU0VMRUNUJykgewogICAgICAgICAgdmFsdWUucm93SWQgPSByb3dJZDsKICAgICAgICAgIHZhbHVlLmNvbHVtbklkID0gaWQ7CiAgICAgICAgICB2YWx1ZS50eXBlQ29kZSA9IHR5cGVDb2RlOwogICAgICAgICAgdmFsdWUubm90RWRpdGFibGUgPSBub3RFZGl0YWJsZTsKICAgICAgICAgIHZhbHVlLnNlbGVjdFZhbHVlSWQgPSB2YWx1ZS5pZDsKICAgICAgICAgIHZhbHVlLnNlbGVjdFZhbHVlTmFtZUx0ID0gdmFsdWUubmFtZUx0OwogICAgICAgICAgdmFsdWUuc2VsZWN0VmFsdWVOYW1lUnUgPSB2YWx1ZS5uYW1lUnU7CiAgICAgICAgICB2YWx1ZS5zZWxlY3RWYWx1ZU5hbWVVeiA9IHZhbHVlLm5hbWVVeiA/IHZhbHVlLm5hbWVVeiA6IHZhbHVlLm5hbWU7CiAgICAgICAgfQogICAgICAgIHRoaXMudGhpcmRUcklkRGF0YVtpbmRleF0udmFsdWVbcm93SW5kZXhdID0gewogICAgICAgICAgcm93SWQ6IHJvd0lkLAogICAgICAgICAgdmFsdWU6IHR5cGVDb2RlID09PSAnU0VMRUNUJyA/ICcnIDogdmFsdWUsCiAgICAgICAgICBzZWxlY3RWYWx1ZUlkOiB2YWx1ZSA/IHZhbHVlLmlkIDogbnVsbCwKICAgICAgICAgIHNlbGVjdFZhbHVlTmFtZVV6OiB2YWx1ZSA/IHZhbHVlLm5hbWVVeiA6IG51bGwsCiAgICAgICAgICBzZWxlY3RWYWx1ZU5hbWVMdDogdmFsdWUgPyB2YWx1ZS5uYW1lTHQgOiBudWxsLAogICAgICAgICAgc2VsZWN0VmFsdWVOYW1lUnU6IHZhbHVlID8gdmFsdWUubmFtZVJ1IDogbnVsbCwKICAgICAgICAgIG9yaWdpbmFsU2VsZWN0VmFsdWVOYW1lVXo6IHRoaXMudGhpcmRUcklkRGF0YVtpbmRleF0udmFsdWVbcm93SW5kZXhdID8gdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtyb3dJbmRleF0ub3JpZ2luYWxTZWxlY3RWYWx1ZU5hbWVVeiA6ICcnLAogICAgICAgICAgb3JpZ2luYWxTZWxlY3RWYWx1ZU5hbWVMdDogdGhpcy50aGlyZFRySWREYXRhW2luZGV4XS52YWx1ZVtyb3dJbmRleF0gPyB0aGlzLnRoaXJkVHJJZERhdGFbaW5kZXhdLnZhbHVlW3Jvd0luZGV4XS5vcmlnaW5hbFNlbGVjdFZhbHVlTmFtZUx0IDogJycsCiAgICAgICAgICBvcmlnaW5hbFNlbGVjdFZhbHVlTmFtZVJ1OiB0aGlzLnRoaXJkVHJJZERhdGFbaW5kZXhdLnZhbHVlW3Jvd0luZGV4XSA/IHRoaXMudGhpcmRUcklkRGF0YVtpbmRleF0udmFsdWVbcm93SW5kZXhdLm9yaWdpbmFsU2VsZWN0VmFsdWVOYW1lUnUgOiAnJywKICAgICAgICAgIHR5cGVDb2RlOiB0eXBlQ29kZSwKICAgICAgICAgIGNvbHVtbklkOiBpZCwKICAgICAgICAgIG5vdEVkaXRhYmxlOiBub3RFZGl0YWJsZQogICAgICAgIH07CiAgICAgIH0KICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibm9fZW50ZXJfdmFsdWUiKS5mb3JFYWNoKGZ1bmN0aW9uIChpbnB1dCkgewogICAgICAgIGlmIChKU09OLnBhcnNlKGlucHV0LmlkKS5yb3dJZCkgewogICAgICAgICAgX3RoaXM1LmZvcm11bGFzLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgdmFyIGluZGV4X2YyID0gSlNPTi5wYXJzZShlLmYyKS5maW5kSW5kZXgoZnVuY3Rpb24gKGQpIHsKICAgICAgICAgICAgICByZXR1cm4gZCA9PSBwYXJzZUZsb2F0KGlkKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHZhciBpbmRleF9mMSA9IEpTT04ucGFyc2UoZS5mMSkuZmluZEluZGV4KGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGQgPT0gcGFyc2VGbG9hdChKU09OLnBhcnNlKGlucHV0LmlkKS5jb2x1bW5JZCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZiAoaW5kZXhfZjIgPiAtMSAmJiBpbmRleF9mMSA+IC0xICYmIHBhcnNlRmxvYXQoSlNPTi5wYXJzZShpbnB1dC5pZCkucm93SWQpID09IHBhcnNlRmxvYXQocm93SWQpKSB7CiAgICAgICAgICAgICAgdmFyIGFsbFZhbCA9IDA7CiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiaW5wdXRfdmFsIikuZm9yRWFjaChmdW5jdGlvbiAodklucHV0KSB7CiAgICAgICAgICAgICAgICB2YXIgZV9pbmRleF9mMiA9IEpTT04ucGFyc2UoZS5mMikuZmluZEluZGV4KGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBkID09IHBhcnNlRmxvYXQoSlNPTi5wYXJzZSh2SW5wdXQuaWQpLmNvbHVtbklkKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKGVfaW5kZXhfZjIgPiAtMSAmJiBwYXJzZUZsb2F0KEpTT04ucGFyc2UodklucHV0LmlkKS5yb3dJZCkgPT0gcGFyc2VGbG9hdChyb3dJZCkpIHsKICAgICAgICAgICAgICAgICAgaWYgKF90aGlzNS5fZW1wdHkodklucHV0LnZhbHVlKSkge30gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXJzZUZsb2F0KHZJbnB1dC52YWx1ZSkgPT09ICJudW1iZXIiKSB7CiAgICAgICAgICAgICAgICAgICAgICBhbGxWYWwgKz0gcGFyc2VGbG9hdCh2SW5wdXQudmFsdWUpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICBhbGxWYWwgKz0gMDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgX3RoaXM1LiRzZXQoaW5wdXQsICJ2YWx1ZSIsIHBhcnNlRmxvYXQoYWxsVmFsKSk7CiAgICAgICAgICAgICAgICAgIHZhciBmb3VuZEluZGV4ID0gX3RoaXM1LnRoaXJkVHJJZERhdGEuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUuY29sdW1uSWQgPT0gSlNPTi5wYXJzZShpbnB1dC5pZCkuY29sdW1uSWQ7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBfdGhpczUudGhpcmRUcklkRGF0YVtmb3VuZEluZGV4XS52YWx1ZVtyb3dJbmRleF0gPSB7CiAgICAgICAgICAgICAgICAgICAgcm93SWQ6IHJvd0lkID8gcm93SWQgOiBudWxsLAogICAgICAgICAgICAgICAgICAgIHZhbHVlOiBhbGxWYWwsCiAgICAgICAgICAgICAgICAgICAgdHlwZUNvZGU6IHR5cGVDb2RlLAogICAgICAgICAgICAgICAgICAgIGNvbHVtbklkOiBKU09OLnBhcnNlKGlucHV0LmlkKS5jb2x1bW5JZAogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICBfdGhpczUuJGZvcmNlVXBkYXRlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpczUuZm9ybXVsYXMuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgaW5kZXhfZjIgPSBKU09OLnBhcnNlKGUuZjIpLmZpbmRJbmRleChmdW5jdGlvbiAoZCkgewogICAgICAgICAgICAgIHJldHVybiBkID09IHBhcnNlRmxvYXQoaWQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdmFyIGluZGV4X2YxID0gSlNPTi5wYXJzZShlLmYxKS5maW5kSW5kZXgoZnVuY3Rpb24gKGQpIHsKICAgICAgICAgICAgICByZXR1cm4gZCA9PSBwYXJzZUZsb2F0KEpTT04ucGFyc2UoaW5wdXQuaWQpLmNvbHVtbklkKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChpbmRleF9mMiA+IC0xICYmIGluZGV4X2YxID4gLTEpIHsKICAgICAgICAgICAgICB2YXIgYWxsVmFsID0gMDsKICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJpbnB1dF92YWwiKS5mb3JFYWNoKGZ1bmN0aW9uICh2SW5wdXQpIHsKICAgICAgICAgICAgICAgIHZhciBlX2luZGV4X2YyID0gSlNPTi5wYXJzZShlLmYyKS5maW5kSW5kZXgoZnVuY3Rpb24gKGQpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGQgPT0gcGFyc2VGbG9hdChKU09OLnBhcnNlKHZJbnB1dC5pZCkuY29sdW1uSWQpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpZiAoZV9pbmRleF9mMiA+IC0xKSB7CiAgICAgICAgICAgICAgICAgIGlmIChfdGhpczUuX2VtcHR5KHZJbnB1dC52YWx1ZSkpIHt9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcGFyc2VGbG9hdCh2SW5wdXQudmFsdWUpID09PSAibnVtYmVyIikgewogICAgICAgICAgICAgICAgICAgICAgYWxsVmFsICs9IHBhcnNlRmxvYXQodklucHV0LnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgYWxsVmFsICs9IDA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfdGhpczUuJHNldChpbnB1dCwgInZhbHVlIiwgcGFyc2VGbG9hdChhbGxWYWwpKTsKICAgICAgICAgICAgICAgIHZhciBmb3VuZEluZGV4ID0gX3RoaXM1LnRoaXJkVHJJZERhdGEuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlLmNvbHVtbklkID09IEpTT04ucGFyc2UoaW5wdXQuaWQpLmNvbHVtbklkOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBfdGhpczUudGhpcmRUcklkRGF0YVtmb3VuZEluZGV4XS52YWx1ZVswXSA9IHsKICAgICAgICAgICAgICAgICAgcm93SWQ6IG51bGwsCiAgICAgICAgICAgICAgICAgIHZhbHVlOiBhbGxWYWwsCiAgICAgICAgICAgICAgICAgIHR5cGVDb2RlOiB0eXBlQ29kZSwKICAgICAgICAgICAgICAgICAgY29sdW1uSWQ6IEpTT04ucGFyc2UoaW5wdXQuaWQpLmNvbHVtbklkCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX3RoaXM1LiRmb3JjZVVwZGF0ZSgpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLiRmb3JjZVVwZGF0ZSgpOwogICAgfSwKICAgIGdldEJ5SWQ6IGZ1bmN0aW9uIGdldEJ5SWQoaWQsIHJlcG9ydElkKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwogICAgICB0aGlzLmNsZWFyQWxsKCk7CiAgICAgIHRoaXMudGFibGVJZCA9IGlkOwogICAgICB0aGlzLnJlcG9ydElkID0gcmVwb3J0SWQ7CiAgICAgIHRoaXMubG9hZGVyID0gdHJ1ZTsKICAgICAgU2VydmljZS5yZXBvcnRHZXRCeUlkKHJlcG9ydElkKS50aGVuKGZ1bmN0aW9uIChfcmVmNCkgewogICAgICAgIHZhciBkYXRhID0gX3JlZjQuZGF0YTsKICAgICAgICBfdGhpczYucmVwb3J0ID0gZGF0YTsKICAgICAgfSk7CiAgICAgIFNlcnZpY2UuZ2V0QnlJZFRhYmxlKGlkLCByZXBvcnRJZCkudGhlbiggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3JlZjUgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KHJzKSB7CiAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCFycy5kYXRhKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM2LnNldENvbHVtbnMocnMuZGF0YS5jb2x1bW5zLCBycy5kYXRhLnJvd3MubGVuZ3RoKTsKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfdGhpczYuc2V0Um93KHJzLmRhdGEucm93cyk7CiAgICAgICAgICAgICAgICBfdGhpczYudGFibGUgPSBycy5kYXRhLnRhYmxlOwogICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIFByb21pc2UuYWxsKFtfdGhpczYuZ2V0RGF0YUJ5SWQocmVwb3J0SWQpLCBfdGhpczYuZ2V0Rm9ybXVsYXNfMigpXSkudGhlbihmdW5jdGlvbiAoX3JlZjYpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZjcgPSBfc2xpY2VkVG9BcnJheShfcmVmNiwgMiksCiAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gX3JlZjdbMF0sCiAgICAgICAgICAgICAgICAgICAgICBmb3JtdWxhcyA9IF9yZWY3WzFdOwogICAgICAgICAgICAgICAgICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUudmFsdWVTdHJpbmcgfHwgZS52YWx1ZUJpZ0RlY2ltYWwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS50eXBlQ29kZSA9PT0gIllFQVIiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJjdXN0b20tZGF0ZXBpY2tlciBteC1kYXRlcGlja2VyIGR5bmFtaWMteWVhciIpLmZvckVhY2goZnVuY3Rpb24gKGZpZWxkLCBpZHgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEpTT04ucGFyc2UoZmllbGQuaWQpLnJvd0lkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoSlNPTi5wYXJzZShmaWVsZC5pZCkuY29sdW1uSWQpID09PSBwYXJzZUZsb2F0KGUuY29sdW1uSWQpICYmIHBhcnNlRmxvYXQoSlNPTi5wYXJzZShmaWVsZC5pZCkucm93SWQpID09PSBwYXJzZUZsb2F0KGUucm93SWQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93SW5kZXggPSBfdGhpczYuc2VsZWN0ZWRSb3dzLmZpbmRJbmRleChmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmlkID09IEpTT04ucGFyc2UoZmllbGQuaWQpLnJvd0lkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sSW5kZXggPSBfdGhpczYudGhpcmRUcklkRGF0YS5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uY29sdW1uSWQgPT09IGUuY29sdW1uSWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzNi5zZXRWYWx1ZShlLnJvd0lkLCBlLnZhbHVlLCByb3dJbmRleCwgY29sSW5kZXgsIGUuY29sdW1uSWQsICdEQVRFJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUudHlwZUNvZGUgPT09ICdCSUdERUNJTUFMJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmRDb2x1bW5JZCA9IF90aGlzNi5zaG93RGF0YS5maW5kSW5kZXgoZnVuY3Rpb24gKGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5jb2x1bW5JZCA9PT0gZS5jb2x1bW5JZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZENvbHVtbklkID4gLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuc2hvd0RhdGEubWFwKGZ1bmN0aW9uIChmKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZi5jb2x1bW5JZCA9PSBlLmNvbHVtbklkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYuY29sdW1uRGF0YSA9ICtmLmNvbHVtbkRhdGEgKyArZS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuc2hvd0RhdGEucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5JZDogZS5jb2x1bW5JZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbkRhdGE6IGUudmFsdWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiaW5wdXRfdmFsIikuZm9yRWFjaChmdW5jdGlvbiAoaW5wdXQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybXVsYXMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleF9WID0gSlNPTi5wYXJzZShlbGVtZW50LmYxKS5maW5kSW5kZXgoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlID09IEpTT04ucGFyc2UoaW5wdXQuaWQpLmNvbHVtbklkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleF9WID4gLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzNi4kc2V0KGlucHV0LCAiZGlzYWJsZWQiLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzNi4kc2V0KGlucHV0LnN0eWxlLCAiYm9yZGVyIiwgIm5vbmUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmNsYXNzTGlzdC5hZGQoIm5vX2VudGVyX3ZhbHVlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5zdHlsZS5mb250V2VpZ2h0ID0gImJvbGQiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChKU09OLnBhcnNlKGlucHV0LmlkKS5yb3dJZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KEpTT04ucGFyc2UoaW5wdXQuaWQpLmNvbHVtbklkKSA9PSBwYXJzZUZsb2F0KGUuY29sdW1uSWQpICYmIHBhcnNlRmxvYXQoSlNPTi5wYXJzZShpbnB1dC5pZCkucm93SWQpID09IHBhcnNlRmxvYXQoZS5yb3dJZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzNi4kc2V0KGlucHV0LCAidmFsdWUiLCBlLnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoSlNPTi5wYXJzZShpbnB1dC5pZCkuY29sdW1uSWQpID09IHBhcnNlRmxvYXQoZS5jb2x1bW5JZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzNi4kc2V0KGlucHV0LCAidmFsdWUiLCBlLnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLnZhbHVlRGF0ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImN1c3RvbS1kYXRlcGlja2VyIG14LWRhdGVwaWNrZXIiKS5mb3JFYWNoKGZ1bmN0aW9uIChmaWVsZCwgaWR4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoSlNPTi5wYXJzZShmaWVsZC5pZCkucm93SWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoSlNPTi5wYXJzZShmaWVsZC5pZCkuY29sdW1uSWQpID09IHBhcnNlRmxvYXQoZS5jb2x1bW5JZCkgJiYgcGFyc2VGbG9hdChKU09OLnBhcnNlKGZpZWxkLmlkKS5yb3dJZCkgPT0gcGFyc2VGbG9hdChlLnJvd0lkKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xJbmRleCA9IF90aGlzNi50aGlyZFRySWREYXRhLmZpbmRJbmRleChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uY29sdW1uSWQgPT0gZS5jb2x1bW5JZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuc2V0VmFsdWUoZS5yb3dJZCwgZS52YWx1ZSwgaWR4LCBjb2xJbmRleCwgZS5jb2x1bW5JZCwgJ0RBVEUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUudmFsdWVCb29sZWFuICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiY2hlY2tib3hfZmllbGQiKS5mb3JFYWNoKGZ1bmN0aW9uIChmaWVsZCwgaWR4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hlY2tib3hJbnB1dCA9IGZpZWxkLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEpTT04ucGFyc2UoY2hlY2tib3hJbnB1dC5pZCkucm93SWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoSlNPTi5wYXJzZShjaGVja2JveElucHV0LmlkKS5jb2x1bW5JZCkgPT0gcGFyc2VGbG9hdChlLmNvbHVtbklkKSAmJiBwYXJzZUZsb2F0KEpTT04ucGFyc2UoY2hlY2tib3hJbnB1dC5pZCkucm93SWQpID09IHBhcnNlRmxvYXQoZS5yb3dJZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sSW5kZXggPSBfdGhpczYudGhpcmRUcklkRGF0YS5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmNvbHVtbklkID09IGUuY29sdW1uSWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM2LnNldFZhbHVlKGUucm93SWQsIEpTT04ucGFyc2UoZS52YWx1ZSksIGlkeCwgY29sSW5kZXgsIGUuY29sdW1uSWQsICdCT09MRUFOJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLnNlbGVjdFZhbHVlTmFtZVV6KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgic2VsZWN0X2ZpZWxkIikuZm9yRWFjaChmdW5jdGlvbiAoZmllbGQsIGlkeCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEpTT04ucGFyc2UoZmllbGQuaWQpLnJvd0lkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KEpTT04ucGFyc2UoZmllbGQuaWQpLmNvbHVtbklkKSA9PSBwYXJzZUZsb2F0KGUuY29sdW1uSWQpICYmIHBhcnNlRmxvYXQoSlNPTi5wYXJzZShmaWVsZC5pZCkucm93SWQpID09IHBhcnNlRmxvYXQoZS5yb3dJZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sSW5kZXggPSBfdGhpczYudGhpcmRUcklkRGF0YS5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLmNvbHVtbklkID09IGUuY29sdW1uSWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM2LnNldFZhbHVlKGUucm93SWQsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBlLmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVV6OiBlLnNlbGVjdFZhbHVlTmFtZVV6LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZUx0OiBlLnNlbGVjdFZhbHVlTmFtZUx0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVJ1OiBlLnNlbGVjdFZhbHVlTmFtZVJ1CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgaWR4LCBjb2xJbmRleCwgZS5jb2x1bW5JZCwgJ1NFTEVDVCcsIHRydWUsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJpbnB1dF92YWwiKS5mb3JFYWNoKGZ1bmN0aW9uIChpbnB1dCkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3JtdWxhcy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4X1YgPSBKU09OLnBhcnNlKGVsZW1lbnQuZjEpLmZpbmRJbmRleChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUgPT0gSlNPTi5wYXJzZShpbnB1dC5pZCkuY29sdW1uSWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4X1YgPiAtMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM2LiRzZXQoaW5wdXQsICJkaXNhYmxlZCIsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM2LiRzZXQoaW5wdXQuc3R5bGUsICJib3JkZXIiLCAibm9uZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZCgibm9fZW50ZXJfdmFsdWUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlLmZvbnRXZWlnaHQgPSAiYm9sZCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBfdGhpczYubG9hZGVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSwgNTAwKTsKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlNSk7CiAgICAgICAgfSkpOwogICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICAgIHJldHVybiBfcmVmNS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH07CiAgICAgIH0oKSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczYubG9hZGVyID0gZmFsc2U7CiAgICAgICAgLy8gdGhpcy5jYXRjaEVycihlKTsKICAgICAgfSk7CiAgICB9LAogICAgc2V0Q29sdW1uczogZnVuY3Rpb24gc2V0Q29sdW1ucyh2LCByb3dzQ291bnQpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQxNCkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQxNC5wcmV2ID0gX2NvbnRleHQxNC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfdGhpczcuc2VsZWN0ZWRDb2x1bW5zID0gdjsKICAgICAgICAgICAgICBfdGhpczcuZmlyc3RDb2x1bW5zID0gW107CiAgICAgICAgICAgICAgX3RoaXM3LnNlY29uZENvbHVtbnMgPSBbXTsKICAgICAgICAgICAgICBfdGhpczcudGhpcmRDb2x1bW5zID0gW107CiAgICAgICAgICAgICAgdi5mb3JFYWNoKGZ1bmN0aW9uIChlbDEpIHsKICAgICAgICAgICAgICAgIF90aGlzNy5maXJzdENvbHVtbnMucHVzaChlbDEpOwogICAgICAgICAgICAgICAgZWwxLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGVsMikgewogICAgICAgICAgICAgICAgICBfdGhpczcuc2Vjb25kQ29sdW1ucy5wdXNoKGVsMik7CiAgICAgICAgICAgICAgICAgIGVsMi5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChlbDMpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczcudGhpcmRDb2x1bW5zLnB1c2goX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBlbDMpLCB7fSwgewogICAgICAgICAgICAgICAgICAgICAgZklkOiBlbDEuaWQKICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgc2V0VGltZW91dCggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgICAgICAgICB2YXIgZmlyc3RUclRoLCBzZWNvbmRUclRoLCB0aGlyZFRyVGgsIGNvdW50ZXIyLCBjb3VudGVyMzsKICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQxMykgewogICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnRoaXJkVHJJZERhdGEgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UKICAgICAgICAgICAgICAgICAgICAgIC8vICAgLmNhbGwoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidGhpcmRUcklkIikpCiAgICAgICAgICAgICAgICAgICAgICAvLyAgIC5tYXAoKGUpID0+IHsKICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBsZXQgYXJyYXkgPSBlLmlkLnNwbGl0KCIsIik7CiAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgIGNvbHVtbklkOiBhcnJheVswXSwKICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgIHR5cGVDb2RlOiBhcnJheVsxXSwKICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgIHJvd0lkOiBbXSwKICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAgIHZhbHVlOiBbXSwKICAgICAgICAgICAgICAgICAgICAgIC8vICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgLy8gICB9KTsKICAgICAgICAgICAgICAgICAgICAgIGZpcnN0VHJUaCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImZpcnN0VHJUaCIpOwogICAgICAgICAgICAgICAgICAgICAgc2Vjb25kVHJUaCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoInNlY29uZFRyVGgiKTsKICAgICAgICAgICAgICAgICAgICAgIHRoaXJkVHJUaCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoInRoaXJkVHJUaCIpOwogICAgICAgICAgICAgICAgICAgICAgY291bnRlcjIgPSAwLCBjb3VudGVyMyA9IDA7CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSA2OwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpcnN0VHJUaC5mb3JFYWNoKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZjkgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KHRoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9sb29wLCBpbmRleDIsIGFycmF5LCB0bXAsIGksIF9sb29wNCwgX2luZGV4MjsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0MTIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MTIucHJldiA9IF9jb250ZXh0MTIubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGguY29sU3BhbiA+IDEpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9vcCA9IC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfbG9vcCgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfbG9vcDIsIGluZGV4MywgYXJyYXksIHRtcCwgaSwgX2xvb3AzLCBfaW5kZXg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2xvb3AkKF9jb250ZXh0OCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoc2Vjb25kVHJUaFtjb3VudGVyMl0gJiYgc2Vjb25kVHJUaFtjb3VudGVyMl0uY29sU3BhbiA+IDEpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvb3AyID0gLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9sb29wMigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFycmF5LCB0bXAsIGk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfbG9vcDIkKF9jb250ZXh0NikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyYXkgPSB0aGlyZFRyVGhbY291bnRlcjNdLmlkLnNwbGl0KCIsIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5JZDogYXJyYXlbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUNvZGU6IGFycmF5WzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZkNvZGU6IGFycmF5WzJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZVVybDogYXJyYXlbM10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlQXBwZW5kVXJsOiBhcnJheVs0XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VDb2RlOiBhcnJheVs1XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VOYW1lVXo6IGFycmF5WzZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZU5hbWVMdDogYXJyYXlbN10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlTmFtZVJ1OiBhcnJheVs4XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hQYXlsb2FkOiBPYmplY3QuYXNzaWduKHt9LCBfdGhpczcudmFyX2RlZmF1bHRfc2VhcmNoX3BheWxvYWQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc05leHRQYWdlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dJZDogW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07IC8vIEdFVCBEWU5BTUlDIFJFRlJFTkNFIE9QVElPTlMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRtcC50eXBlQ29kZSA9PT0gJ1NFTEVDVCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcm93c0NvdW50OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcC52YWx1ZS5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJdGVtOiBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3J1ZEFuZExpc3RzU2VydmljZS5zZWFyY2hMaXN0V2l0aEtleXdvcmQodG1wLnJlZmVyZW5jZVVybCwgdG1wLnNlYXJjaFBheWxvYWQsIHRtcC5yZWZlcmVuY2VBcHBlbmRVcmwpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF90bXAkb3B0aW9uczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfdG1wJG9wdGlvbnMgPSB0bXAub3B0aW9ucykucHVzaC5hcHBseShfdG1wJG9wdGlvbnMsIF90b0NvbnN1bWFibGVBcnJheShyZXMuZGF0YS5saXN0KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAuaGFzTmV4dFBhZ2UgPSByZXMuZGF0YS50b3RhbCAvIHRtcC5zZWFyY2hQYXlsb2FkLml0ZW1zUGVyUGFnZSA+IHRtcC5zZWFyY2hQYXlsb2FkLnBhZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAuc2VhcmNoUGF5bG9hZC5wYWdlICs9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBpZiAoIXRoaXMuaXNNb2RlQ3JlYXRlICYmIHRoaXMuZWRpdGluZ0l0ZW0ub2tlZElkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmb3VuZEl0bSA9IHRoaXMub2tlZHMuZmluZChlbCA9PiBlbC5pZCA9PSB0aGlzLmVkaXRpbmdJdGVtLm9rZWRJZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3VuZEl0bSAmJiB0aGlzLmVkaXRpbmdJdGVtLmluZm9Pa2VkRHRvKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rZWRzLnB1c2godGhpcy5lZGl0aW5nSXRlbS5pbmZvT2tlZER0bykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLm9rZWRzID0gW10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuaXNMb2FkaW5nT2tlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM3LnRoaXJkVHJJZERhdGEucHVzaCh0bXApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVyMysrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfbG9vcDIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDMgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGluZGV4MyA8IHNlY29uZFRyVGhbY291bnRlcjJdLmNvbFNwYW4pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmRlbGVnYXRlWWllbGQoX2xvb3AyKCksICJ0MCIsIDUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4MysrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRlcjIrKzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMjg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoc2Vjb25kVHJUaFtjb3VudGVyMl0gJiYgc2Vjb25kVHJUaFtjb3VudGVyMl0uY2xhc3NMaXN0LmNvbnRhaW5zKCJ0aGlyZFRySWQiKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAxOTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJheSA9IHNlY29uZFRyVGhbY291bnRlcjJdLmlkLnNwbGl0KCIsIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbklkOiBhcnJheVswXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUNvZGU6IGFycmF5WzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZDb2RlOiBhcnJheVsyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlVXJsOiBhcnJheVszXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlQXBwZW5kVXJsOiBhcnJheVs0XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlQ29kZTogYXJyYXlbNV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZU5hbWVVejogYXJyYXlbNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZU5hbWVMdDogYXJyYXlbN10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZU5hbWVSdTogYXJyYXlbOF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFBheWxvYWQ6IE9iamVjdC5hc3NpZ24oe30sIF90aGlzNy52YXJfZGVmYXVsdF9zZWFyY2hfcGF5bG9hZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc05leHRQYWdlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0lkOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OyAvLyBHRVQgRFlOQU1JQyBSRUZSRU5DRSBPUFRJT05TCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG1wLnR5cGVDb2RlID09PSAnU0VMRUNUJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcm93c0NvdW50OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAudmFsdWUucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEl0ZW06IG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcnVkQW5kTGlzdHNTZXJ2aWNlLnNlYXJjaExpc3RXaXRoS2V5d29yZCh0bXAucmVmZXJlbmNlVXJsLCB0bXAuc2VhcmNoUGF5bG9hZCwgdG1wLnJlZmVyZW5jZUFwcGVuZFVybCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF90bXAkb3B0aW9uczI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKF90bXAkb3B0aW9uczIgPSB0bXAub3B0aW9ucykucHVzaC5hcHBseShfdG1wJG9wdGlvbnMyLCBfdG9Db25zdW1hYmxlQXJyYXkocmVzLmRhdGEubGlzdCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcC5oYXNOZXh0UGFnZSA9IHJlcy5kYXRhLnRvdGFsIC8gdG1wLnNlYXJjaFBheWxvYWQuaXRlbXNQZXJQYWdlID4gdG1wLnNlYXJjaFBheWxvYWQucGFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAuc2VhcmNoUGF5bG9hZC5wYWdlICs9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogaWYgKCF0aGlzLmlzTW9kZUNyZWF0ZSAmJiB0aGlzLmVkaXRpbmdJdGVtLm9rZWRJZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZvdW5kSXRtID0gdGhpcy5va2Vkcy5maW5kKGVsID0+IGVsLmlkID09IHRoaXMuZWRpdGluZ0l0ZW0ub2tlZElkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3VuZEl0bSAmJiB0aGlzLmVkaXRpbmdJdGVtLmluZm9Pa2VkRHRvKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5va2Vkcy5wdXNoKHRoaXMuZWRpdGluZ0l0ZW0uaW5mb09rZWREdG8pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLm9rZWRzID0gW10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5pc0xvYWRpbmdPa2VkID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczcudGhpcmRUcklkRGF0YS5wdXNoKHRtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVyMisrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAyODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNlY29uZFRyVGhbY291bnRlcjJdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMjg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvb3AzID0gLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9sb29wMygpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFycmF5LCB0bXAsIF9pMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9sb29wMyQoX2NvbnRleHQ3KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJheSA9IHRoaXJkVHJUaFtjb3VudGVyM10uaWQuc3BsaXQoIiwiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbklkOiBhcnJheVswXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlQ29kZTogYXJyYXlbMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmQ29kZTogYXJyYXlbMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlVXJsOiBhcnJheVszXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VBcHBlbmRVcmw6IGFycmF5WzRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUNvZGU6IGFycmF5WzVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZU5hbWVVejogYXJyYXlbNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlTmFtZUx0OiBhcnJheVs3XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VOYW1lUnU6IGFycmF5WzhdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFBheWxvYWQ6IE9iamVjdC5hc3NpZ24oe30sIF90aGlzNy52YXJfZGVmYXVsdF9zZWFyY2hfcGF5bG9hZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzTmV4dFBhZ2U6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0lkOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsgLy8gR0VUIERZTkFNSUMgUkVGUkVOQ0UgT1BUSU9OUwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG1wLnR5cGVDb2RlID09PSAnU0VMRUNUJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoX2kyID0gMDsgX2kyIDwgcm93c0NvdW50OyBfaTIrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wLnZhbHVlLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEl0ZW06IG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcnVkQW5kTGlzdHNTZXJ2aWNlLnNlYXJjaExpc3RXaXRoS2V5d29yZCh0bXAucmVmZXJlbmNlVXJsLCB0bXAuc2VhcmNoUGF5bG9hZCwgdG1wLnJlZmVyZW5jZUFwcGVuZFVybCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RtcCRvcHRpb25zMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfdG1wJG9wdGlvbnMzID0gdG1wLm9wdGlvbnMpLnB1c2guYXBwbHkoX3RtcCRvcHRpb25zMywgX3RvQ29uc3VtYWJsZUFycmF5KHJlcy5kYXRhLmxpc3QpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcC5oYXNOZXh0UGFnZSA9IHJlcy5kYXRhLnRvdGFsIC8gdG1wLnNlYXJjaFBheWxvYWQuaXRlbXNQZXJQYWdlID4gdG1wLnNlYXJjaFBheWxvYWQucGFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcC5zZWFyY2hQYXlsb2FkLnBhZ2UgKz0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGlmICghdGhpcy5pc01vZGVDcmVhdGUgJiYgdGhpcy5lZGl0aW5nSXRlbS5va2VkSWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZvdW5kSXRtID0gdGhpcy5va2Vkcy5maW5kKGVsID0+IGVsLmlkID09IHRoaXMuZWRpdGluZ0l0ZW0ub2tlZElkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZvdW5kSXRtICYmIHRoaXMuZWRpdGluZ0l0ZW0uaW5mb09rZWREdG8pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2tlZHMucHVzaCh0aGlzLmVkaXRpbmdJdGVtLmluZm9Pa2VkRHRvKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAqLwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMub2tlZHMgPSBbXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5pc0xvYWRpbmdPa2VkID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczcudGhpcmRUcklkRGF0YS5wdXNoKHRtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ZXIzKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9sb29wMyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pbmRleCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKF9pbmRleCA8IHNlY29uZFRyVGhbY291bnRlcjJdLmNvbFNwYW4pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMjc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5kZWxlZ2F0ZVlpZWxkKF9sb29wMygpLCAidDEiLCAyNCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pbmRleCsrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAyMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVyMisrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfbG9vcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgyID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGluZGV4MiA8IHRoLmNvbFNwYW4pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSA4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLmRlbGVnYXRlWWllbGQoX2xvb3AoKSwgInQwIiwgNSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDIrKzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMjQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aC5jbGFzc0xpc3QuY29udGFpbnMoInRoaXJkVHJJZCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAxNzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJheSA9IHRoLmlkLnNwbGl0KCIsIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uSWQ6IGFycmF5WzBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUNvZGU6IGFycmF5WzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmQ29kZTogYXJyYXlbMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VVcmw6IGFycmF5WzNdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlQXBwZW5kVXJsOiBhcnJheVs0XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUNvZGU6IGFycmF5WzVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlTmFtZVV6OiBhcnJheVs2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZU5hbWVMdDogYXJyYXlbN10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VOYW1lUnU6IGFycmF5WzhdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoUGF5bG9hZDogT2JqZWN0LmFzc2lnbih7fSwgX3RoaXM3LnZhcl9kZWZhdWx0X3NlYXJjaF9wYXlsb2FkKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc05leHRQYWdlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93SWQ6IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsgLy8gR0VUIERZTkFNSUMgUkVGUkVOQ0UgT1BUSU9OUwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0bXAudHlwZUNvZGUgPT09ICdTRUxFQ1QnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcm93c0NvdW50OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wLnZhbHVlLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkSXRlbTogbnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNydWRBbmRMaXN0c1NlcnZpY2Uuc2VhcmNoTGlzdFdpdGhLZXl3b3JkKHRtcC5yZWZlcmVuY2VVcmwsIHRtcC5zZWFyY2hQYXlsb2FkLCB0bXAucmVmZXJlbmNlQXBwZW5kVXJsKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF90bXAkb3B0aW9uczQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfdG1wJG9wdGlvbnM0ID0gdG1wLm9wdGlvbnMpLnB1c2guYXBwbHkoX3RtcCRvcHRpb25zNCwgX3RvQ29uc3VtYWJsZUFycmF5KHJlcy5kYXRhLmxpc3QpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wLmhhc05leHRQYWdlID0gcmVzLmRhdGEudG90YWwgLyB0bXAuc2VhcmNoUGF5bG9hZC5pdGVtc1BlclBhZ2UgPiB0bXAuc2VhcmNoUGF5bG9hZC5wYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAuc2VhcmNoUGF5bG9hZC5wYWdlICs9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGlmICghdGhpcy5pc01vZGVDcmVhdGUgJiYgdGhpcy5lZGl0aW5nSXRlbS5va2VkSWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZm91bmRJdG0gPSB0aGlzLm9rZWRzLmZpbmQoZWwgPT4gZWwuaWQgPT0gdGhpcy5lZGl0aW5nSXRlbS5va2VkSWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3VuZEl0bSAmJiB0aGlzLmVkaXRpbmdJdGVtLmluZm9Pa2VkRHRvKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2tlZHMucHVzaCh0aGlzLmVkaXRpbmdJdGVtLmluZm9Pa2VkRHRvKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLm9rZWRzID0gW10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmlzTG9hZGluZ09rZWQgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzNy50aGlyZFRySWREYXRhLnB1c2godG1wKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAyNDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9vcDQgPSAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2xvb3A0KCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9sb29wNSwgaW5kZXgzLCBfYXJyYXksIF90bXAsIF9pNCwgX2xvb3A2LCBfaW5kZXgzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9sb29wNCQoX2NvbnRleHQxMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShzZWNvbmRUclRoW2NvdW50ZXIyXS5jb2xTcGFuID4gMSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvb3A1ID0gLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9sb29wNSgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFycmF5LCB0bXAsIF9pMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9sb29wNSQoX2NvbnRleHQ5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJheSA9IHRoaXJkVHJUaFtjb3VudGVyM10uaWQuc3BsaXQoIiwiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbklkOiBhcnJheVswXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlQ29kZTogYXJyYXlbMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmQ29kZTogYXJyYXlbMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlVXJsOiBhcnJheVszXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VBcHBlbmRVcmw6IGFycmF5WzRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUNvZGU6IGFycmF5WzVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZU5hbWVVejogYXJyYXlbNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlTmFtZUx0OiBhcnJheVs3XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VOYW1lUnU6IGFycmF5WzhdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFBheWxvYWQ6IE9iamVjdC5hc3NpZ24oe30sIF90aGlzNy52YXJfZGVmYXVsdF9zZWFyY2hfcGF5bG9hZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzTmV4dFBhZ2U6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0lkOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogW10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsgLy8gR0VUIERZTkFNSUMgUkVGUkVOQ0UgT1BUSU9OUwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG1wLnR5cGVDb2RlID09PSAnU0VMRUNUJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoX2kzID0gMDsgX2kzIDwgcm93c0NvdW50OyBfaTMrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wLnZhbHVlLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEl0ZW06IG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcnVkQW5kTGlzdHNTZXJ2aWNlLnNlYXJjaExpc3RXaXRoS2V5d29yZCh0bXAucmVmZXJlbmNlVXJsLCB0bXAuc2VhcmNoUGF5bG9hZCwgdG1wLnJlZmVyZW5jZUFwcGVuZFVybCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RtcCRvcHRpb25zNTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfdG1wJG9wdGlvbnM1ID0gdG1wLm9wdGlvbnMpLnB1c2guYXBwbHkoX3RtcCRvcHRpb25zNSwgX3RvQ29uc3VtYWJsZUFycmF5KHJlcy5kYXRhLmxpc3QpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcC5oYXNOZXh0UGFnZSA9IHJlcy5kYXRhLnRvdGFsIC8gdG1wLnNlYXJjaFBheWxvYWQuaXRlbXNQZXJQYWdlID4gdG1wLnNlYXJjaFBheWxvYWQucGFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcC5zZWFyY2hQYXlsb2FkLnBhZ2UgKz0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGlmICghdGhpcy5pc01vZGVDcmVhdGUgJiYgdGhpcy5lZGl0aW5nSXRlbS5va2VkSWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZvdW5kSXRtID0gdGhpcy5va2Vkcy5maW5kKGVsID0+IGVsLmlkID09IHRoaXMuZWRpdGluZ0l0ZW0ub2tlZElkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZvdW5kSXRtICYmIHRoaXMuZWRpdGluZ0l0ZW0uaW5mb09rZWREdG8pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2tlZHMucHVzaCh0aGlzLmVkaXRpbmdJdGVtLmluZm9Pa2VkRHRvKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAqLwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMub2tlZHMgPSBbXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5pc0xvYWRpbmdPa2VkID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczcudGhpcmRUcklkRGF0YS5wdXNoKHRtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ZXIzKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9sb29wNSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4MyA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoaW5kZXgzIDwgc2Vjb25kVHJUaFtjb3VudGVyMl0uY29sU3BhbikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5kZWxlZ2F0ZVlpZWxkKF9sb29wNSgpLCAidDAiLCA1KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDMrKzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVyMisrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMjg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoc2Vjb25kVHJUaFtjb3VudGVyMl0gJiYgc2Vjb25kVHJUaFtjb3VudGVyMl0uY2xhc3NMaXN0LmNvbnRhaW5zKCJ0aGlyZFRySWQiKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMTk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FycmF5ID0gc2Vjb25kVHJUaFtjb3VudGVyMl0uaWQuc3BsaXQoIiwiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90bXAgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbklkOiBfYXJyYXlbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVDb2RlOiBfYXJyYXlbMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZkNvZGU6IF9hcnJheVsyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlVXJsOiBfYXJyYXlbM10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZUFwcGVuZFVybDogX2FycmF5WzRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VDb2RlOiBfYXJyYXlbNV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZU5hbWVVejogX2FycmF5WzZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VOYW1lTHQ6IF9hcnJheVs3XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlTmFtZVJ1OiBfYXJyYXlbOF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFBheWxvYWQ6IE9iamVjdC5hc3NpZ24oe30sIF90aGlzNy52YXJfZGVmYXVsdF9zZWFyY2hfcGF5bG9hZCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc05leHRQYWdlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0lkOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OyAvLyBHRVQgRFlOQU1JQyBSRUZSRU5DRSBPUFRJT05TCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RtcC50eXBlQ29kZSA9PT0gJ1NFTEVDVCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChfaTQgPSAwOyBfaTQgPCByb3dzQ291bnQ7IF9pNCsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RtcC52YWx1ZS5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkSXRlbTogbnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNydWRBbmRMaXN0c1NlcnZpY2Uuc2VhcmNoTGlzdFdpdGhLZXl3b3JkKF90bXAucmVmZXJlbmNlVXJsLCBfdG1wLnNlYXJjaFBheWxvYWQsIF90bXAucmVmZXJlbmNlQXBwZW5kVXJsKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RtcCRvcHRpb25zNjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX3RtcCRvcHRpb25zNiA9IF90bXAub3B0aW9ucykucHVzaC5hcHBseShfdG1wJG9wdGlvbnM2LCBfdG9Db25zdW1hYmxlQXJyYXkocmVzLmRhdGEubGlzdCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90bXAuaGFzTmV4dFBhZ2UgPSByZXMuZGF0YS50b3RhbCAvIF90bXAuc2VhcmNoUGF5bG9hZC5pdGVtc1BlclBhZ2UgPiBfdG1wLnNlYXJjaFBheWxvYWQucGFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdG1wLnNlYXJjaFBheWxvYWQucGFnZSArPSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGlmICghdGhpcy5pc01vZGVDcmVhdGUgJiYgdGhpcy5lZGl0aW5nSXRlbS5va2VkSWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmb3VuZEl0bSA9IHRoaXMub2tlZHMuZmluZChlbCA9PiBlbC5pZCA9PSB0aGlzLmVkaXRpbmdJdGVtLm9rZWRJZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZm91bmRJdG0gJiYgdGhpcy5lZGl0aW5nSXRlbS5pbmZvT2tlZER0bykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2tlZHMucHVzaCh0aGlzLmVkaXRpbmdJdGVtLmluZm9Pa2VkRHRvKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICovCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5va2VkcyA9IFtdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuaXNMb2FkaW5nT2tlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM3LnRoaXJkVHJJZERhdGEucHVzaChfdG1wKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ZXIyKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAyODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNlY29uZFRyVGhbY291bnRlcjJdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDI4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb29wNiA9IC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfbG9vcDYoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcnJheSwgdG1wLCBfaTU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfbG9vcDYkKF9jb250ZXh0MTApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyYXkgPSB0aGlyZFRyVGhbY291bnRlcjNdLmlkLnNwbGl0KCIsIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcCA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5JZDogYXJyYXlbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUNvZGU6IGFycmF5WzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZkNvZGU6IGFycmF5WzJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZVVybDogYXJyYXlbM10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlQXBwZW5kVXJsOiBhcnJheVs0XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VDb2RlOiBhcnJheVs1XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2VOYW1lVXo6IGFycmF5WzZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZU5hbWVMdDogYXJyYXlbN10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlTmFtZVJ1OiBhcnJheVs4XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hQYXlsb2FkOiBPYmplY3QuYXNzaWduKHt9LCBfdGhpczcudmFyX2RlZmF1bHRfc2VhcmNoX3BheWxvYWQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc05leHRQYWdlOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dJZDogW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFtdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07IC8vIEdFVCBEWU5BTUlDIFJFRlJFTkNFIE9QVElPTlMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRtcC50eXBlQ29kZSA9PT0gJ1NFTEVDVCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKF9pNSA9IDA7IF9pNSA8IHJvd3NDb3VudDsgX2k1KyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcC52YWx1ZS5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJdGVtOiBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3J1ZEFuZExpc3RzU2VydmljZS5zZWFyY2hMaXN0V2l0aEtleXdvcmQodG1wLnJlZmVyZW5jZVVybCwgdG1wLnNlYXJjaFBheWxvYWQsIHRtcC5yZWZlcmVuY2VBcHBlbmRVcmwpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF90bXAkb3B0aW9uczc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX3RtcCRvcHRpb25zNyA9IHRtcC5vcHRpb25zKS5wdXNoLmFwcGx5KF90bXAkb3B0aW9uczcsIF90b0NvbnN1bWFibGVBcnJheShyZXMuZGF0YS5saXN0KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAuaGFzTmV4dFBhZ2UgPSByZXMuZGF0YS50b3RhbCAvIHRtcC5zZWFyY2hQYXlsb2FkLml0ZW1zUGVyUGFnZSA+IHRtcC5zZWFyY2hQYXlsb2FkLnBhZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXAuc2VhcmNoUGF5bG9hZC5wYWdlICs9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBpZiAoIXRoaXMuaXNNb2RlQ3JlYXRlICYmIHRoaXMuZWRpdGluZ0l0ZW0ub2tlZElkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmb3VuZEl0bSA9IHRoaXMub2tlZHMuZmluZChlbCA9PiBlbC5pZCA9PSB0aGlzLmVkaXRpbmdJdGVtLm9rZWRJZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3VuZEl0bSAmJiB0aGlzLmVkaXRpbmdJdGVtLmluZm9Pa2VkRHRvKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9rZWRzLnB1c2godGhpcy5lZGl0aW5nSXRlbS5pbmZvT2tlZER0bykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLm9rZWRzID0gW10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuaXNMb2FkaW5nT2tlZCA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM3LnRoaXJkVHJJZERhdGEucHVzaCh0bXApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVyMysrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2xvb3A2KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2luZGV4MyA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKF9pbmRleDMgPCBzZWNvbmRUclRoW2NvdW50ZXIyXS5jb2xTcGFuKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAyNzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5kZWxlZ2F0ZVlpZWxkKF9sb29wNigpLCAidDEiLCAyNCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pbmRleDMrKzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDIyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyNzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ZXIyKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyODoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfbG9vcDQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pbmRleDIgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKF9pbmRleDIgPCB0aC5jb2xTcGFuKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMjQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuZGVsZWdhdGVZaWVsZChfbG9vcDQoKSwgInQxIiwgMjEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pbmRleDIrKzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAxOTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTYpOwogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWY5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICB9KCkpOwogICAgICAgICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuc3RvcCgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgICAgICAgICAgfSkpLCAzMDApOwogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU4KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgc2V0Um93OiBmdW5jdGlvbiBzZXRSb3codikgewogICAgICB0aGlzLnNlbGVjdGVkUm93cyA9IHY7CiAgICAgIGlmICh0aGlzLnNlbGVjdGVkUm93cy5sZW5ndGggPT0gMCkgewogICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dzID0gW3t9XTsKICAgICAgfQogICAgfSwKICAgIHJvd3NwYW5GaXJzdDogZnVuY3Rpb24gcm93c3BhbkZpcnN0KGVsKSB7CiAgICAgIHJldHVybiBlbC5jaGlsZHJlbi5sZW5ndGggPiAwID8gMSA6IGVsLmNoaWxkcmVuLmxlbmd0aCA+IDAgJiYgdGhpcy50aGlyZENvbHVtbnMubGVuZ3RoID4gMCA/IDMgOiAzOwogICAgfSwKICAgIGNvbHNwYW5GaXJzdDogZnVuY3Rpb24gY29sc3BhbkZpcnN0KGVsKSB7CiAgICAgIHZhciBmb3VuZCA9IHRoaXMudGhpcmRDb2x1bW5zLmZpbHRlcihmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiBpLmZJZCA9PT0gZWwuaWQ7CiAgICAgIH0pOwogICAgICB2YXIgdG90YWxOb3RDaGlsZCA9IGVsLmNoaWxkcmVuLmZpbHRlcihmdW5jdGlvbiAoZCkgewogICAgICAgIHJldHVybiBkLmNoaWxkcmVuLmxlbmd0aCA9PSAwOwogICAgICB9KTsKICAgICAgcmV0dXJuIGVsLmNoaWxkcmVuLmxlbmd0aCA+IDAgJiYgZm91bmQubGVuZ3RoID09IDAgPyBlbC5jaGlsZHJlbi5sZW5ndGggOiBlbC5jaGlsZHJlbi5sZW5ndGggPiAwICYmIGZvdW5kLmxlbmd0aCA+IDAgPyB0b3RhbE5vdENoaWxkLmxlbmd0aCArIGZvdW5kLmxlbmd0aCA6IDE7CiAgICB9LAogICAgcm93c3BhblNlY29uZDogZnVuY3Rpb24gcm93c3BhblNlY29uZChlbCkgewogICAgICByZXR1cm4gZWwuY2hpbGRyZW4ubGVuZ3RoID09IDAgJiYgdGhpcy50aGlyZENvbHVtbnMubGVuZ3RoID09IDAgPyAxIDogZWwuY2hpbGRyZW4ubGVuZ3RoID09IDAgJiYgdGhpcy50aGlyZENvbHVtbnMubGVuZ3RoID4gMCA/IDIgOiAxOwogICAgfSwKICAgIGNvbHNwYW5TZWNvbmQ6IGZ1bmN0aW9uIGNvbHNwYW5TZWNvbmQoZWwpIHsKICAgICAgcmV0dXJuIGVsLmNoaWxkcmVuLmxlbmd0aCA+IDAgPyBlbC5jaGlsZHJlbi5sZW5ndGggOiAxOwogICAgfSwKICAgIHJvd3NwYW5GaXJzdENsYXNzOiBmdW5jdGlvbiByb3dzcGFuRmlyc3RDbGFzcyhlbCkgewogICAgICByZXR1cm4gZWwuY2hpbGRyZW4ubGVuZ3RoID4gMCA/ICIiIDogZWwuY2hpbGRyZW4ubGVuZ3RoID4gMCAmJiB0aGlzLnRoaXJkQ29sdW1ucy5sZW5ndGggPiAwID8gInRoaXJkVHJJZCIgOiAidGhpcmRUcklkIjsKICAgIH0sCiAgICByb3dzcGFuU2Vjb25kQ2xhc3M6IGZ1bmN0aW9uIHJvd3NwYW5TZWNvbmRDbGFzcyhlbCkgewogICAgICByZXR1cm4gZWwuY2hpbGRyZW4ubGVuZ3RoID09IDAgJiYgdGhpcy50aGlyZENvbHVtbnMubGVuZ3RoID09IDAgPyAidGhpcmRUcklkIiA6IGVsLmNoaWxkcmVuLmxlbmd0aCA9PSAwICYmIHRoaXMudGhpcmRDb2x1bW5zLmxlbmd0aCA+IDAgPyAidGhpcmRUcklkIiA6ICIiOwogICAgfQogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;AACA;AACA;AACA;AAEA;EACAA;IAAAC;EAAA;EACAC;IACA;MACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;MACAC;MAEAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;MACA;IACA;EACA;EACAC;IACAC;MACA;QAAA;MAAA;MACA;QACA;MACA;QACA;MACA;IACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACAC;cACA;gBAAA;kBAAA;oBAAA;sBAAA;sBAAA,OACA;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA,CACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cAAA;cAAA,OACAC,kFACAC;gBAAA;gBACA;gBACA;gBACA;gBACA;kBACA;oBAAA;kBAAA;kBACA;oBACA;kBACA;gBACA;cACA,GACAC;gBACAC;gBACA;cACA,GACAC;gBACA;cACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAC;MACA;QAAA;MAAA;MACA;QACA;UACAC;UACAC;UACAC;QACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;QACA;UACAC;UACA;UACA;YACA;YACA;YACA,wCACAC;cACArB;cACAC;YACA,GACA;YACA;cACAqB;YACA;UACA;QACA;UACAF;UACA;YACA;YACA;YACA,sCACAC;cACArB;cACAC;YACA,GACA;YACA;cACAsB;YACA;UACA;UACA;QACA;UACAH;UACA;UACA;YACA;YAEA;YACA,wCACAC;cACArB;cACAC;YACA,GACA;YACA;cACA;gBACA;gBACA;kBACA;kBACA;oBACA,oCACAoB;sBACArB;sBACAC;oBACA,GACA;oBACA;sBACA;oBACA;sBACA;wBACAuB;sBACA;sBACA;oBACA;kBACA;gBACA;cACA;gBACAC;cACA;YACA;UACA;QACA;UACA;UACAL;UACA;YACA;YACA;YACA,wCACAC;cACArB;cACAC;YACA,GACA;YACA;cACA;gBACA;gBACA;kBACA;kBAEA,qCACAoB;oBACArB;oBACAC;kBACA,GACA;kBACA;oBACA;kBACA;oBACA;sBACAuB;oBACA;oBACA;kBACA;gBACA;cACA;gBACAE;cACA;YACA;UACA;QACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACA;YAAA;cAAA;cAAA,OACA;YAAA;cAAA;cAAA,OACA;YAAA;cAAA;cAAA,OACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAEA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;QACA;UACAC;QACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MAEA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MACA;QACA;UACAC,4CACAxB;YAAA;YACA;YACAyB;UACA,GACAxB;YAAA;UAAA;QACA;UACAyB;QACA;MACA;IACA;IACAC;MACA;QACAH,0BACAxB;UAAA;UACAyB;QACA,GACAxB;UAAA;QAAA;MACA;IACA;IACA2B;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;MAAA;MACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACA;QACA;UAAA;QAAA;QACA;UACA;YACAxC;YACAyC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAC;YACAhD;YACAiD;UACA;UACA;UACA;UACA;UACA;QACA;MACA;QACA;UACAT;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;QACA;QAEA;UACAzC;UACAyC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAhD;UACAiD;QACA;MACA;MACAC;QACA;UACA;YACA,0CACA;cAAA;YAAA,EACA;YACA,0CACA;cAAA;YAAA,EACA;YACA,IACAC,iBACAC,iBACAC,6DACA;cACA;cACAH;gBAEA,4CACA;kBAAA;gBAAA,EACA;gBACA,IACAI,mBACAD,8DACA;kBACA,kCACA;oBACA;sBACAE;oBACA;sBACAA;oBACA;kBACA;kBAEA;kBACA,gDACA;oBAAA;kBAAA,EACA;kBACA;oBACAxD;oBACAyC;oBACAQ;oBACAhD;kBACA;kBACA;gBACA;cACA;YACA;UACA;QACA;UACA;YACA,0CACA;cAAA;YAAA,EACA;YACA,0CACA;cAAA;YAAA,EACA;YAEA;cACA;cACAkD;gBACA,4CACA;kBAAA;gBAAA,EACA;gBACA;kBACA,kCACA;oBACA;sBACAK;oBACA;sBACAA;oBACA;kBACA;gBACA;gBACA;gBACA,gDACA;kBAAA;gBAAA,EACA;gBACA;kBACAxD;kBACAyC;kBACAQ;kBACAhD;gBACA;gBAEA;cACA;YACA;UACA;QACA;MACA;MAEA;IACA;IACAwD;MAAA;MACA;MACA;MACA;MACA;MAEAvB;QAAA;QACA;MACA;MAEAA,mCACAxB;QAAA;UAAA;YAAA;cAAA;gBAAA,KACAgD;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACA;cAAA;gBACA;gBACA;gBACAC;kBACAC,aACA,8BACA,uBACA;oBAAA;sBAAAtF;sBAAAsB;oBACA;sBACAtB;wBAEA;0BACA;4BACA6E;8BACA;gCACA,IACAG,wEACAA,gEACA;kCACA;oCAAA;kCAAA;kCACA;oCAAA;kCAAA;kCACA;gCACA;8BACA;4BACA;0BACA;4BACA;8BACA;gCAAA;8BAAA;8BAEA;gCACA;kCAEA;oCACAO;kCACA;gCACA;8BACA;gCACA;kCACA5D;kCACA6D;gCACA;8BACA;4BACA;4BACAX,SACAY,oCACAC;8BACApE;gCACA,+CACA;kCAAA;gCAAA,EACA;gCACA;kCACA;kCACA;kCACA4B;kCACAA;gCACA;8BACA;8BACA;gCACA,IACA8B,6CACAA,0BACAA,0CACAA,qBACA;kCACA;gCACA;8BACA;gCACA,IACAA,6CACAA,wBACA;kCACA;gCACA;8BACA;4BACA;0BACA;wBACA;0BACAH;4BACA;8BACA,IACAG,6CACAA,0BACAA,0CACAA,qBACA;gCACA;kCAAA;gCAAA;gCACA,gBACAxB,SACAA,SACAmC,KACAC,UACApC,YACA,OACA;8BACA;4BACA;0BACA;wBACA;0BACAqB;4BACA;4BACA;8BACA,IACAG,qDACAA,0BACAA,kDACAA,qBACA;gCAEA;kCAAA;gCAAA;gCAEA,gBACAxB,SACAT,qBACA4C,KACAC,UACApC,YACA,UACA;8BACA;4BACA;0BACA;wBACA;0BACAqB;4BACA;8BACA,IACAG,6CACAA,0BACAA,0CACAA,qBACA;gCACA;kCAAA;gCAAA;gCACA,gBACAxB,SACA;kCACAqC;kCACAlD;kCACAD;kCACAD;gCACA,GACAkD,KACAC,UACApC,YACA,UACA,MACA,KACA;8BACA;4BACA;0BACA;wBACA;sBACA;oBACA;sBACAqB,SACAY,oCACAC;wBACApE;0BACA,+CACA;4BAAA;0BAAA,EACA;0BACA;4BACA;4BACA;4BACA4B;4BACAA;0BACA;wBACA;sBACA;oBACA;oBAEA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA,CAEA;QAAA;UAAA;QAAA;MAAA,KACAb;QACA;QACA;MACA;IAGA;IACAyD;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cACA;cACA;cACA;cACAC;gBACA;gBACAC;kBACA;kBACAC;oBACA;sBAAAC;oBAAA;kBACA;gBACA;cACA;cACAb;gBAAA;gBAAA;kBAAA;oBAAA;sBACA;sBACA;sBACA;sBACA;sBACA;sBACA;sBACA;sBACA;sBACA;sBACA;sBACA;sBACAc;sBACAC;sBACAC;sBACAC,cACAC;sBAAA;sBAAA,OACAJ;wBAAA;0BAAA;0BAAA;4BAAA;8BAAA;gCAAA,MACAK;kCAAA;kCAAA;gCAAA;gCAAA;kCAAA;kCAAA;oCAAA;sCAAA;wCAAA,MAEAJ;0CAAA;0CAAA;wCAAA;wCAAA;0CAAA;0CAAA;4CAAA;8CAAA;gDAMAK;gDACAC;kDACA/E;kDACAgD;kDACAgC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACA1F;kDACAyC;gDACA,GACA;gDACA;kDACA;oDACAuC;sDAAAW;oDAAA;kDACA;kDACAlF,uGACAC;oDAAA;oDACA;oDACAsE;oDACAA;oDACA;AACA;AACA;AACA;AACA;AACA;kDACA,GACArE;oDACAC;oDACA;kDACA,GACAC;oDACA;kDAAA,CACA;gDACA;gDACA;gDACAgE;8CAAA;8CAAA;gDAAA;4CAAA;0CAAA;wCAAA;wCA/CAe;sCAAA;wCAAA,MACAA;0CAAA;0CAAA;wCAAA;wCAAA;sCAAA;wCACAA;wCAAA;wCAAA;sCAAA;wCA+CAhB;wCAAA;wCAAA;sCAAA;wCAAA,MAGAF,wBACAA;0CAAA;0CAAA;wCAAA;wCAEAK;wCACAC;0CACA/E;0CACAgD;0CACAgC;0CACAC;0CACAC;0CACAC;0CACAC;0CACAC;0CACAC;0CACAC;0CACAC;0CACAC;0CACA1F;0CACAyC;wCACA,GACA;wCACA;0CACA;4CACAuC;8CAAAW;4CAAA;0CACA;0CACAlF,uGACAC;4CAAA;4CACA;4CACAsE;4CACAA;4CACA;AACA;AACA;AACA;AACA;AACA;0CACA,GACArE;4CACAC;4CACA;0CACA,GACAC;4CACA;0CAAA,CACA;wCACA;wCACA;wCACA+D;wCAAA;wCAAA;sCAAA;wCAAA,KAEAF;0CAAA;0CAAA;wCAAA;wCAAA;0CAAA;0CAAA;4CAAA;8CAAA;gDAMAK;gDACAC;kDACA/E;kDACAgD;kDACAgC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACA1F;kDACAyC;gDACA,GACA;gDACA;kDACA;oDACAuC;sDAAAW;oDAAA;kDACA;kDACAlF,uGACAC;oDAAA;oDACA;oDACAsE;oDACAA;oDACA;AACA;AACA;AACA;AACA;AACA;kDACA,GACArE;oDACAC;oDACA;kDACA,GACAC;oDACA;kDAAA,CACA;gDACA;gDACA;gDACAgE;8CAAA;8CAAA;gDAAA;4CAAA;0CAAA;wCAAA;wCA/CAe;sCAAA;wCAAA,MACAA;0CAAA;0CAAA;wCAAA;wCAAA;sCAAA;wCACAA;wCAAA;wCAAA;sCAAA;wCAgDAhB;sCAAA;sCAAA;wCAAA;oCAAA;kCAAA;gCAAA;gCA3JAiB;8BAAA;gCAAA;kCAAA;kCAAA;gCAAA;gCAAA;8BAAA;gCAAAA;gCAAA;gCAAA;8BAAA;gCAAA;gCAAA;8BAAA;gCAAA,KAiKAf;kCAAA;kCAAA;gCAAA;gCACAC;gCACAC;kCACA/E;kCACAgD;kCACAgC;kCACAC;kCACAC;kCACAC;kCACAC;kCACAC;kCACAC;kCACAC;kCACAC;kCACAC;kCACA1F;kCACAyC;gCACA,GACA;gCACA;kCACA;oCACAuC;sCAAAW;oCAAA;kCACA;kCACAlF,uGACAC;oCAAA;oCACA;oCACAsE;oCACAA;oCACA;AACA;AACA;AACA;AACA;AACA;kCACA,GACArE;oCACAC;oCACA;kCACA,GACAC;oCACA;kCAAA,CACA;gCACA;gCACA;gCAAA;gCAAA;8BAAA;gCAAA;kCAAA;kCAAA;oCAAA;sCAAA;wCAAA,MAGA6D;0CAAA;0CAAA;wCAAA;wCAAA;0CAAA;0CAAA;4CAAA;8CAAA;gDAMAK;gDACAC;kDACA/E;kDACAgD;kDACAgC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACA1F;kDACAyC;gDACA,GACA;gDACA;kDACA;oDACAuC;sDAAAW;oDAAA;kDACA;kDACAlF,uGACAC;oDAAA;oDACA;oDACAsE;oDACAA;oDACA;AACA;AACA;AACA;AACA;AACA;kDACA,GACArE;oDACAC;oDACA;kDACA,GACAC;oDACA;kDAAA,CACA;gDACA;gDACA;gDACAgE;8CAAA;8CAAA;gDAAA;4CAAA;0CAAA;wCAAA;wCA/CAe;sCAAA;wCAAA,MACAA;0CAAA;0CAAA;wCAAA;wCAAA;sCAAA;wCACAA;wCAAA;wCAAA;sCAAA;wCA+CAhB;wCAAA;wCAAA;sCAAA;wCAAA,MAGAF,wBACAA;0CAAA;0CAAA;wCAAA;wCAEAK;wCACAC;0CACA/E;0CACAgD;0CACAgC;0CACAC;0CACAC;0CACAC;0CACAC;0CACAC;0CACAC;0CACAC;0CACAC;0CACAC;0CACA1F;0CACAyC;wCACA,GACA;wCACA;0CACA;4CACAuC;8CAAAW;4CAAA;0CACA;0CACAlF,0GACAC;4CAAA;4CACA;4CACAsE;4CACAA;4CACA;AACA;AACA;AACA;AACA;AACA;0CACA,GACArE;4CACAC;4CACA;0CACA,GACAC;4CACA;0CAAA,CACA;wCACA;wCACA;wCACA+D;wCAAA;wCAAA;sCAAA;wCAAA,KAEAF;0CAAA;0CAAA;wCAAA;wCAAA;0CAAA;0CAAA;4CAAA;8CAAA;gDAMAK;gDACAC;kDACA/E;kDACAgD;kDACAgC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACAC;kDACA1F;kDACAyC;gDACA,GACA;gDACA;kDACA;oDACAuC;sDAAAW;oDAAA;kDACA;kDACAlF,uGACAC;oDAAA;oDACA;oDACAsE;oDACAA;oDACA;AACA;AACA;AACA;AACA;AACA;kDACA,GACArE;oDACAC;oDACA;kDACA,GACAC;oDACA;kDAAA,CACA;gDACA;gDACA;gDACAgE;8CAAA;8CAAA;gDAAA;4CAAA;0CAAA;wCAAA;wCA/CAe;sCAAA;wCAAA,MACAA;0CAAA;0CAAA;wCAAA;wCAAA;sCAAA;wCACAA;wCAAA;wCAAA;sCAAA;wCA+CAhB;sCAAA;sCAAA;wCAAA;oCAAA;kCAAA;gCAAA;gCA1JAiB;8BAAA;gCAAA;kCAAA;kCAAA;gCAAA;gCAAA;8BAAA;gCAAAA;gCAAA;gCAAA;8BAAA;8BAAA;gCAAA;4BAAA;0BAAA;wBAAA,CAiKA;wBAAA;0BAAA;wBAAA;sBAAA;oBAAA;oBAAA;sBAAA;kBAAA;gBAAA;cAAA,CACA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IACA;IACAC;MACA;MACA;QACA;MACA;IACA;IAEAC;MACA,gCACA,IACAC,yDACA,IACA;IACA;IACAC;MACA;QAAA;MAAA;MACA;QAAA;MAAA;MACA,qDACAD,qBACAA,6CACAE,sCACA;IACA;IAEAC;MACA,kEACA,IACAH,0DACA,IACA;IACA;IACAI;MACA;IACA;IAEAC;MACA,gCACA,KACAL,yDACA,cACA;IACA;IACAM;MACA,kEACA,cACAN,0DACA,cACA;IACA;EACA;AACA","names":["components","Checkbox","data","debounce","okeds","hasNextPageOked","isLoadingOked","okedSearchPayload","f1Ids","f2Ids","fRowId","tableId","reportId","selectedColumns","selectedRows","firstColumns","secondColumns","thirdColumns","thirdTrIdData","loader","report","showResult","showData","table","formulas","currentPosition","rowIndex","columnIndex","rowId","columnId","methods","getColumnData","dynamicRefsReachedEndOfList","debounceSearchDynamicRefs","clearTimeout","fetchDynamicRefsWithKeyword","fetchDynamicRefs","crudAndListsService","then","catch","console","finally","customLabelDynamicRef","nameRu","nameLt","nameUz","clearAll","keydownEvt","evt","JSON","downInput","upInput","input","prevInput","nextInput","resetIndex","setError","keyUpEventsDisable","e","keyUpEvents","focusVal","getFormulas_2","Service","res","rej","getDataById","editValue","resetValue","setValue","value","selectValueId","selectValueNameUz","selectValueNameLt","selectValueNameRu","originalSelectValueNameUz","originalSelectValueNameLt","originalSelectValueNameRu","typeCode","notEditable","document","index_f2","index_f1","parseFloat","e_index_f2","allVal","getById","rs","setTimeout","Promise","f","columnData","getElementsByClassName","forEach","idx","colIndex","id","setColumns","v","el1","el2","fId","firstTrTh","secondTrTh","thirdTrTh","counter2","counter3","th","array","tmp","refCode","referenceUrl","referenceAppendUrl","referenceCode","referenceNameUz","referenceNameLt","referenceNameRu","searchPayload","hasNextPage","options","selectedItem","index3","index2","setRow","rowspanFirst","el","colspanFirst","totalNotChild","rowspanSecond","colspanSecond","rowspanFirstClass","rowspanSecondClass"],"sourceRoot":"src/modules/report/organizitional/components","sources":["editReportModal.vue"],"sourcesContent":["<script>\r\nimport Service from \"@/modules/report/reportService\";\r\nimport crudAndListsService from \"@/shared/services/crud_and_list.service\"\r\nimport Checkbox from \"vue-material-checkbox\";\r\n\r\nexport default {\r\n  components: { Checkbox },\r\n  data() {\r\n    return {\r\n      debounce: null,\r\n      // OKED VARIABLES\r\n      okeds: [],\r\n      hasNextPageOked: false,\r\n      isLoadingOked: false,\r\n      okedSearchPayload: {},\r\n      // ----------------\r\n      f1Ids: [],\r\n      f2Ids: [],\r\n      fRowId: null,\r\n      tableId: null,\r\n      reportId: null,\r\n      // getName: getName,\r\n      selectedColumns: [],\r\n      selectedRows: [],\r\n\r\n      firstColumns: [],\r\n      secondColumns: [],\r\n      thirdColumns: [],\r\n\r\n      thirdTrIdData: [],\r\n      loader: false,\r\n      report: {},\r\n      showResult: false,\r\n      showData: [],\r\n      table: {},\r\n      formulas: [],\r\n      currentPosition: {\r\n        rowIndex: null,\r\n        columnIndex: null,\r\n        rowId: null,\r\n        columnId: null,\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    getColumnData(i) {\r\n      let found = this.showData.find((e) => e.columnId == i.columnId)\r\n      if (found) {\r\n        return found.columnData\r\n      } else {\r\n        return \"\"\r\n      }\r\n    },\r\n    // DYNAMIC_REFERENCES METHODS\r\n    dynamicRefsReachedEndOfList(e) {\r\n      if (e) {\r\n        this.fetchDynamicRefs()\r\n      }\r\n    },\r\n    async debounceSearchDynamicRefs(searchText) {\r\n      clearTimeout(this.debounce);\r\n      this.debounce = setTimeout(async () => {\r\n        await this.fetchDynamicRefsWithKeyword(searchText);\r\n      }, 1000);\r\n    },\r\n    fetchDynamicRefsWithKeyword(keyword) {\r\n      this.okeds = []\r\n      this.okedSearchPayload.page = 1\r\n      this.okedSearchPayload.keyword = keyword ? keyword : ''\r\n      this.fetchDynamicRefs()\r\n    },\r\n    async fetchDynamicRefs() {\r\n      this.isLoadingOked = true\r\n      await crudAndListsService.searchListWithKeyword(OKED_API_URL, this.okedSearchPayload)\r\n          .then(res => {\r\n            this.okeds.push(...res.data.list)\r\n            this.hasNextPageOked = res.data.total / this.okedSearchPayload.itemsPerPage > this.okedSearchPayload.page\r\n            this.okedSearchPayload.page += 1\r\n            if (!this.isModeCreate && this.editingItem.okedId) {\r\n              let foundItm = this.okeds.find(el => el.id == this.editingItem.okedId)\r\n              if (!foundItm && this.editingItem.infoOkedDto) {\r\n                this.okeds.push(this.editingItem.infoOkedDto)\r\n              }\r\n            }\r\n          })\r\n          .catch(e => {\r\n            console.log(e)\r\n            this.okeds = []\r\n          })\r\n          .finally(() => {\r\n            this.isLoadingOked = false\r\n          })\r\n    },\r\n    customLabelDynamicRef(opt) {\r\n      let selected = this.okeds.find(e => e.id == opt.id);\r\n      if (selected) {\r\n        return `${selected.code} - ${this.getName({\r\n          nameRu: selected.nameRu,\r\n          nameLt: selected.nameLt,\r\n          nameUz: selected.nameUz,\r\n        })}`\r\n      }\r\n      return ``;\r\n    },\r\n    // --------------------------\r\n    clearAll() {\r\n      this.selectedColumns = [];\r\n      this.selectedRows = [];\r\n      this.firstColumns = [];\r\n      this.secondColumns = [];\r\n      this.thirdColumns = [];\r\n      this.thirdTrIdData = [];\r\n      this.formulas = [];\r\n      this.table = [];\r\n      this.f1Ids = [];\r\n      this.f2Ids = [];\r\n    },\r\n    keydownEvt(evt, rowId, value, rowIndex, columnIndex, columnId, typeCode) {\r\n      this.keyUpEventsDisable(evt);\r\n      if (columnId != null) {\r\n        if (evt.keyCode == 40 && rowId != null) {\r\n          evt.preventDefault();\r\n          // down\r\n          if (rowIndex < this.selectedRows.length - 1) {\r\n            let currentColumn = this.thirdTrIdData[columnIndex];\r\n            let downRowColumn = this.selectedRows[rowIndex + 1];\r\n            let downInput = document.getElementById(\r\n                JSON.stringify({\r\n                  rowId: downRowColumn.id,\r\n                  columnId: currentColumn.columnId,\r\n                })\r\n            );\r\n            if (downInput) {\r\n              downInput.focus();\r\n            }\r\n          }\r\n        } else if (evt.keyCode == 38 && rowId != null) {\r\n          evt.preventDefault();\r\n          if (rowIndex != 0) {\r\n            let currentColumn = this.thirdTrIdData[columnIndex];\r\n            let upRowColumn = this.selectedRows[rowIndex - 1];\r\n            let upInput = document.getElementById(\r\n                JSON.stringify({\r\n                  rowId: upRowColumn.id,\r\n                  columnId: currentColumn.columnId,\r\n                })\r\n            );\r\n            if (upInput) {\r\n              upInput.focus();\r\n            }\r\n          }\r\n          //up\r\n        } else if (evt.keyCode == 37) {\r\n          evt.preventDefault();\r\n          //left\r\n          if (columnIndex != 0) {\r\n            let prevColumn = this.thirdTrIdData[columnIndex - 1];\r\n\r\n            let currentRow = this.selectedRows[rowIndex];\r\n            let prevInput = document.getElementById(\r\n                JSON.stringify({\r\n                  rowId: currentRow.id,\r\n                  columnId: prevColumn.columnId,\r\n                })\r\n            );\r\n            if (prevInput) {\r\n              if (prevInput.disabled) {\r\n                let count = this.thirdTrIdData.length - (columnIndex - 1);\r\n                for (let i = 0; i < count; i++) {\r\n                  let prevColumn2 = this.thirdTrIdData[columnIndex - 1 - i];\r\n                  if (prevColumn2) {\r\n                    let input = document.getElementById(\r\n                        JSON.stringify({\r\n                          rowId: currentRow.id,\r\n                          columnId: prevColumn2.columnId,\r\n                        })\r\n                    );\r\n                    if (input && input.disabled) {\r\n                      continue;\r\n                    } else {\r\n                      if (input) {\r\n                        input.focus();\r\n                      }\r\n                      break;\r\n                    }\r\n                  }\r\n                }\r\n              } else {\r\n                prevInput.focus();\r\n              }\r\n            }\r\n          }\r\n        } else if (evt.keyCode == 39) {\r\n          //right\r\n          evt.preventDefault();\r\n          if (this.thirdTrIdData.length - 1 > columnIndex) {\r\n            let nextColumn = this.thirdTrIdData[columnIndex + 1];\r\n            let currentRow = this.selectedRows[rowIndex];\r\n            let nextInput = document.getElementById(\r\n                JSON.stringify({\r\n                  rowId: currentRow.id,\r\n                  columnId: nextColumn.columnId,\r\n                })\r\n            );\r\n            if (nextInput) {\r\n              if (nextInput.disabled) {\r\n                let forCount = this.thirdTrIdData.length - (columnIndex + 1);\r\n                for (let i = 0; i < forCount; i++) {\r\n                  let nextColumn2 = this.thirdTrIdData[columnIndex + 1 + i];\r\n\r\n                  let input = document.getElementById(\r\n                      JSON.stringify({\r\n                        rowId: currentRow.id,\r\n                        columnId: nextColumn2.columnId,\r\n                      })\r\n                  );\r\n                  if (input.disabled) {\r\n                    continue;\r\n                  } else {\r\n                    if (input) {\r\n                      input.focus();\r\n                    }\r\n                    break;\r\n                  }\r\n                }\r\n              } else {\r\n                nextInput.focus();\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    async resetIndex() {\r\n      await this.$set(this.currentPosition, \"rowIndex\", null);\r\n      await this.$set(this.currentPosition, \"columnIndex\", null);\r\n      await this.$set(this.currentPosition, \"rowId\", null);\r\n      await this.$set(this.currentPosition, \"columnId\", null);\r\n      // await document.addEventListener(\"keydown\", this.keyUpEvents);\r\n    },\r\n    setError(f1, f2, frowId) {\r\n      this.f1Ids = f1;\r\n      this.f2Ids = f2;\r\n      this.fRowId = frowId;\r\n    },\r\n    keyUpEventsDisable(e) {\r\n      if (this.currentPosition.columnId != null) {\r\n        if (e.which === 38 || e.which === 40) {\r\n          e.preventDefault();\r\n        }\r\n      }\r\n    },\r\n    keyUpEvents(evt) {\r\n      this.keyUpEventsDisable(evt);\r\n      // if (this.currentPosition.columnId != null) {\r\n      //   if (evt.keyCode == 40 && this.currentPosition.rowId != null) {\r\n      //     evt.preventDefault();\r\n      //     // down\r\n      //     if (this.currentPosition.rowIndex < this.selectedRows.length - 1) {\r\n      //       let currentColumn =\r\n      //         this.thirdTrIdData[this.currentPosition.columnIndex];\r\n      //       let downRowColumn =\r\n      //         this.selectedRows[this.currentPosition.rowIndex + 1];\r\n      //       let downInput = document.getElementById(\r\n      //         JSON.stringify({\r\n      //           rowId: downRowColumn.id,\r\n      //           columnId: currentColumn.columnId,\r\n      //         })\r\n      //       );\r\n      //       if (downInput) {\r\n      //         downInput.focus();\r\n      //       }\r\n      //     }\r\n      //   } else if (evt.keyCode == 38 && this.currentPosition.rowId != null) {\r\n      //     evt.preventDefault();\r\n      //     if (this.currentPosition.rowIndex != 0) {\r\n      //       let currentColumn =\r\n      //         this.thirdTrIdData[this.currentPosition.columnIndex];\r\n      //       let upRowColumn =\r\n      //         this.selectedRows[this.currentPosition.rowIndex - 1];\r\n      //       let upInput = document.getElementById(\r\n      //         JSON.stringify({\r\n      //           rowId: upRowColumn.id,\r\n      //           columnId: currentColumn.columnId,\r\n      //         })\r\n      //       );\r\n      //       if (upInput) {\r\n      //         upInput.focus();\r\n      //       }\r\n      //     }\r\n      //     //up\r\n      //   } else if (evt.keyCode == 37) {\r\n      //     evt.preventDefault();\r\n      //     //left\r\n      //     if (this.currentPosition.columnIndex != 0) {\r\n      //       let prevColumn =\r\n      //         this.thirdTrIdData[this.currentPosition.columnIndex - 1];\r\n      //       let currentRow = this.selectedRows[this.currentPosition.rowIndex];\r\n      //       let prevInput = document.getElementById(\r\n      //         JSON.stringify({\r\n      //           rowId: currentRow.id,\r\n      //           columnId: prevColumn.columnId,\r\n      //         })\r\n      //       );\r\n      //       if (prevInput) {\r\n      //         if (prevInput.disabled) {\r\n      //           let count =\r\n      //             this.thirdTrIdData.length -\r\n      //             (this.currentPosition.columnIndex - 1);\r\n      //           for (let i = 0; i < count; i++) {\r\n      //             let prevColumn2 =\r\n      //               this.thirdTrIdData[\r\n      //                 this.currentPosition.columnIndex - 1 - i\r\n      //               ];\r\n      //             let input = document.getElementById(\r\n      //               JSON.stringify({\r\n      //                 rowId: currentRow.id,\r\n      //                 columnId: prevColumn2.columnId,\r\n      //               })\r\n      //             );\r\n      //             if (input && input.disabled) {\r\n      //               continue;\r\n      //             } else {\r\n      //               if (input) {\r\n      //                 input.focus();\r\n      //               }\r\n      //               break;\r\n      //             }\r\n      //           }\r\n      //         } else {\r\n      //           prevInput.focus();\r\n      //         }\r\n      //       }\r\n      //     }\r\n      //   } else if (evt.keyCode == 39) {\r\n      //     //right\r\n      //     evt.preventDefault();\r\n      //     if (\r\n      //       this.thirdTrIdData.length - 1 >\r\n      //       this.currentPosition.columnIndex\r\n      //     ) {\r\n      //       let nextColumn =\r\n      //         this.thirdTrIdData[this.currentPosition.columnIndex + 1];\r\n      //       let currentRow = this.selectedRows[this.currentPosition.rowIndex];\r\n      //       let nextInput = document.getElementById(\r\n      //         JSON.stringify({\r\n      //           rowId: currentRow.id,\r\n      //           columnId: nextColumn.columnId,\r\n      //         })\r\n      //       );\r\n      //       if (nextInput) {\r\n      //         if (nextInput.disabled) {\r\n      //           let forCount =\r\n      //             this.thirdTrIdData.length -\r\n      //             (this.currentPosition.columnIndex + 1);\r\n      //           for (let i = 0; i < forCount; i++) {\r\n      //             let nextColumn2 =\r\n      //               this.thirdTrIdData[\r\n      //                 this.currentPosition.columnIndex + 1 + i\r\n      //               ];\r\n\r\n      //             let input = document.getElementById(\r\n      //               JSON.stringify({\r\n      //                 rowId: currentRow.id,\r\n      //                 columnId: nextColumn2.columnId,\r\n      //               })\r\n      //             );\r\n      //             if (input.disabled) {\r\n      //               continue;\r\n      //             } else {\r\n      //               if (input) {\r\n      //                 input.focus();\r\n      //               }\r\n      //               break;\r\n      //             }\r\n      //           }\r\n      //         } else {\r\n      //           nextInput.focus();\r\n      //         }\r\n      //       }\r\n      //     }\r\n      //   }\r\n      // }\r\n    },\r\n\r\n    focusVal(rowId, value, rowIndex, columnIndex, columnId, typeCode) {\r\n      this.$set(this.currentPosition, \"rowIndex\", parseFloat(rowIndex));\r\n      this.$set(this.currentPosition, \"columnIndex\", parseFloat(columnIndex));\r\n      this.$set(this.currentPosition, \"rowId\", parseFloat(rowId));\r\n      this.$set(this.currentPosition, \"columnId\", parseFloat(columnId));\r\n    },\r\n    getFormulas_2() {\r\n      return new Promise((res, rej) => {\r\n        if (this.tableId) {\r\n          Service.formulasByTableId_2(this.tableId)\r\n              .then(({ data }) => {\r\n                this.formulas = data;\r\n                res(data);\r\n              })\r\n              .catch((e) => rej(e));\r\n        } else {\r\n          rej();\r\n        }\r\n      });\r\n    },\r\n    getDataById(id) {\r\n      return new Promise((res, rej) => {\r\n        Service.getReportById(id)\r\n            .then(({ data }) => {\r\n              res(data);\r\n            })\r\n            .catch((e) => rej(e));\r\n      });\r\n    },\r\n    editValue(rowIndex, index) {\r\n      this.$set(this.thirdTrIdData[index].value[rowIndex], 'notEditable', false)\r\n      this.$forceUpdate();\r\n    },\r\n    resetValue(rowIndex, index) {\r\n      this.$set(this.thirdTrIdData[index].value[rowIndex], 'selectValueId', this.thirdTrIdData[index].value[rowIndex].originalSelectValueId)\r\n      this.$set(this.thirdTrIdData[index].value[rowIndex], 'selectValueNameUz', this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameUz)\r\n      this.$set(this.thirdTrIdData[index].value[rowIndex], 'selectValueNameLt', this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameLt)\r\n      this.$set(this.thirdTrIdData[index].value[rowIndex], 'selectValueNameRu', this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameRu)\r\n      this.$set(this.thirdTrIdData[index].value[rowIndex], 'notEditable', true)\r\n      this.$forceUpdate();\r\n    },\r\n    setValue(rowId, value, rowIndex, index, id, typeCode, notEditable = false, initialLoadCall = false) {\r\n      /* this.thirdTrIdData[index].value[rowIndex] = {\r\n        rowId: rowId ? rowId : null,\r\n        value: typeCode === 'SELECT' ? '' : value,\r\n        selectValueId: value ? value.id : null,\r\n        selectValueNameUz: value ? value.nameUz : null,\r\n        selectValueNameLt: value ? value.nameLt : null,\r\n        selectValueNameRu: value ? value.nameRu : null,\r\n        originalSelectValueNameUz: this.thirdTrIdData[index].value[rowIndex] ? this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameUz : '',\r\n        originalSelectValueNameLt: this.thirdTrIdData[index].value[rowIndex] ? this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameLt : '',\r\n        originalSelectValueNameRu: this.thirdTrIdData[index].value[rowIndex] ? this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameRu : '',\r\n        typeCode: typeCode,\r\n        columnId: id,\r\n        notEditable: notEditable\r\n      }; */\r\n      if (initialLoadCall && typeCode === 'SELECT') {\r\n        let rowIndex = this.selectedRows.findIndex(el => el.id == rowId)\r\n        if (!this.thirdTrIdData[index].value[rowIndex].rowId) {\r\n          this.thirdTrIdData[index].value[rowIndex] = {\r\n            rowId: rowId,\r\n            value: typeCode === 'SELECT' ? '' : value,\r\n            selectValueId: value ? value.id : null,\r\n            selectValueNameUz: value ? (value.nameUz ? value.nameUz : value.name) : null,\r\n            selectValueNameLt: value ? value.nameLt : null,\r\n            selectValueNameRu: value ? value.nameRu : null,\r\n            originalSelectValueNameUz: this.thirdTrIdData[index].value[rowIndex] ? this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameUz : '',\r\n            originalSelectValueNameLt: this.thirdTrIdData[index].value[rowIndex] ? this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameLt : '',\r\n            originalSelectValueNameRu: this.thirdTrIdData[index].value[rowIndex] ? this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameRu : '',\r\n            typeCode: typeCode,\r\n            columnId: id,\r\n            notEditable: notEditable,\r\n          }\r\n          this.thirdTrIdData[index].value[rowIndex].originalselectValueId = value.id\r\n          this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameUz = value.nameUz\r\n          this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameLt = value.nameLt\r\n          this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameRu = value.nameRu\r\n        }\r\n      } else {\r\n        if (typeCode === 'SELECT') {\r\n          value.rowId = rowId\r\n          value.columnId = id\r\n          value.typeCode = typeCode\r\n          value.notEditable = notEditable\r\n          value.selectValueId = value.id\r\n          value.selectValueNameLt = value.nameLt\r\n          value.selectValueNameRu = value.nameRu\r\n          value.selectValueNameUz = value.nameUz ? value.nameUz : value.name\r\n        }\r\n\r\n        this.thirdTrIdData[index].value[rowIndex] = {\r\n          rowId: rowId,\r\n          value: typeCode === 'SELECT' ? '' : value,\r\n          selectValueId: value ? value.id : null,\r\n          selectValueNameUz: value ? value.nameUz : null,\r\n          selectValueNameLt: value ? value.nameLt : null,\r\n          selectValueNameRu: value ? value.nameRu : null,\r\n          originalSelectValueNameUz: this.thirdTrIdData[index].value[rowIndex] ? this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameUz : '',\r\n          originalSelectValueNameLt: this.thirdTrIdData[index].value[rowIndex] ? this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameLt : '',\r\n          originalSelectValueNameRu: this.thirdTrIdData[index].value[rowIndex] ? this.thirdTrIdData[index].value[rowIndex].originalSelectValueNameRu : '',\r\n          typeCode: typeCode,\r\n          columnId: id,\r\n          notEditable: notEditable,\r\n        };\r\n      }\r\n      document.getElementsByClassName(\"no_enter_value\").forEach((input) => {\r\n        if (JSON.parse(input.id).rowId) {\r\n          this.formulas.forEach((e) => {\r\n            let index_f2 = JSON.parse(e.f2).findIndex(\r\n                (d) => d == parseFloat(id)\r\n            );\r\n            let index_f1 = JSON.parse(e.f1).findIndex(\r\n                (d) => d == parseFloat(JSON.parse(input.id).columnId)\r\n            );\r\n            if (\r\n                index_f2 > -1 &&\r\n                index_f1 > -1 &&\r\n                parseFloat(JSON.parse(input.id).rowId) == parseFloat(rowId)\r\n            ) {\r\n              let allVal = 0;\r\n              document.getElementsByClassName(\"input_val\").forEach((vInput) => {\r\n\r\n                let e_index_f2 = JSON.parse(e.f2).findIndex(\r\n                    (d) => d == parseFloat(JSON.parse(vInput.id).columnId)\r\n                );\r\n                if (\r\n                    e_index_f2 > -1 &&\r\n                    parseFloat(JSON.parse(vInput.id).rowId) == parseFloat(rowId)\r\n                ) {\r\n                  if (this._empty(vInput.value)) {\r\n                  } else {\r\n                    if (typeof parseFloat(vInput.value) === \"number\") {\r\n                      allVal += parseFloat(vInput.value);\r\n                    } else {\r\n                      allVal += 0;\r\n                    }\r\n                  }\r\n\r\n                  this.$set(input, \"value\", parseFloat(allVal));\r\n                  let foundIndex = this.thirdTrIdData.findIndex(\r\n                      (e) => e.columnId == JSON.parse(input.id).columnId\r\n                  );\r\n                  this.thirdTrIdData[foundIndex].value[rowIndex] = {\r\n                    rowId: rowId ? rowId : null,\r\n                    value: allVal,\r\n                    typeCode: typeCode,\r\n                    columnId: JSON.parse(input.id).columnId,\r\n                  };\r\n                  this.$forceUpdate();\r\n                }\r\n              });\r\n            }\r\n          });\r\n        } else {\r\n          this.formulas.forEach((e) => {\r\n            let index_f2 = JSON.parse(e.f2).findIndex(\r\n                (d) => d == parseFloat(id)\r\n            );\r\n            let index_f1 = JSON.parse(e.f1).findIndex(\r\n                (d) => d == parseFloat(JSON.parse(input.id).columnId)\r\n            );\r\n\r\n            if (index_f2 > -1 && index_f1 > -1) {\r\n              let allVal = 0;\r\n              document.getElementsByClassName(\"input_val\").forEach((vInput) => {\r\n                let e_index_f2 = JSON.parse(e.f2).findIndex(\r\n                    (d) => d == parseFloat(JSON.parse(vInput.id).columnId)\r\n                );\r\n                if (e_index_f2 > -1) {\r\n                  if (this._empty(vInput.value)) {\r\n                  } else {\r\n                    if (typeof parseFloat(vInput.value) === \"number\") {\r\n                      allVal += parseFloat(vInput.value);\r\n                    } else {\r\n                      allVal += 0;\r\n                    }\r\n                  }\r\n                }\r\n                this.$set(input, \"value\", parseFloat(allVal));\r\n                let foundIndex = this.thirdTrIdData.findIndex(\r\n                    (e) => e.columnId == JSON.parse(input.id).columnId\r\n                );\r\n                this.thirdTrIdData[foundIndex].value[0] = {\r\n                  rowId: null,\r\n                  value: allVal,\r\n                  typeCode: typeCode,\r\n                  columnId: JSON.parse(input.id).columnId,\r\n                };\r\n\r\n                this.$forceUpdate();\r\n              });\r\n            }\r\n          });\r\n        }\r\n      });\r\n\r\n      this.$forceUpdate();\r\n    },\r\n    getById(id, reportId) {\r\n      this.clearAll();\r\n      this.tableId = id;\r\n      this.reportId = reportId;\r\n      this.loader = true;\r\n\r\n      Service.reportGetById(reportId).then(({ data }) => {\r\n        this.report = data;\r\n      });\r\n\r\n      Service.getByIdTable(id, reportId)\r\n          .then(async (rs) => {\r\n            if (rs.data) {\r\n              await this.setColumns(rs.data.columns, rs.data.rows.length);\r\n              this.setRow(rs.data.rows);\r\n              this.table = rs.data.table;\r\n              setTimeout(() => {\r\n                Promise.all([\r\n                  this.getDataById(reportId),\r\n                  this.getFormulas_2(),\r\n                ]).then(([data, formulas]) => {\r\n                  if (data && data.length) {\r\n                    data.forEach((e) => {\r\n\r\n                      if (e.valueString || e.valueBigDecimal) {\r\n                        if (e.typeCode === \"YEAR\") {\r\n                          document.getElementsByClassName(\"custom-datepicker mx-datepicker dynamic-year\").forEach((field, idx) => {\r\n                            if (JSON.parse(field.id).rowId) {\r\n                              if (\r\n                                  parseFloat(JSON.parse(field.id).columnId) === parseFloat(e.columnId) &&\r\n                                  parseFloat(JSON.parse(field.id).rowId) === parseFloat(e.rowId)\r\n                              ) {\r\n                                let rowIndex = this.selectedRows.findIndex(el => el.id == JSON.parse(field.id).rowId)\r\n                                let colIndex = this.thirdTrIdData.findIndex(item => item.columnId === e.columnId)\r\n                                this.setValue(e.rowId, e.value, rowIndex, colIndex, e.columnId, 'DATE')\r\n                              }\r\n                            }\r\n                          })\r\n                        } else {\r\n                          if (e.typeCode === 'BIGDECIMAL') {\r\n                            let foundColumnId = this.showData.findIndex((d) => d.columnId === e.columnId)\r\n\r\n                            if (foundColumnId > -1) {\r\n                              this.showData.map(f => {\r\n\r\n                                if (f.columnId == e.columnId) {\r\n                                  f.columnData = (+f.columnData) + (+e.value)\r\n                                }\r\n                              })\r\n                            } else {\r\n                              this.showData.push({\r\n                                columnId: e.columnId,\r\n                                columnData: (e.value)\r\n                              })\r\n                            }\r\n                          }\r\n                          document\r\n                              .getElementsByClassName(\"input_val\")\r\n                              .forEach((input) => {\r\n                                formulas.forEach((element) => {\r\n                                  let index_V = JSON.parse(element.f1).findIndex(\r\n                                      (e) => e == JSON.parse(input.id).columnId\r\n                                  );\r\n                                  if (index_V > -1) {\r\n                                    this.$set(input, \"disabled\", true);\r\n                                    this.$set(input.style, \"border\", \"none\");\r\n                                    input.classList.add(\"no_enter_value\");\r\n                                    input.style.fontWeight = \"bold\";\r\n                                  }\r\n                                });\r\n                                if (JSON.parse(input.id).rowId) {\r\n                                  if (\r\n                                      parseFloat(JSON.parse(input.id).columnId) ==\r\n                                      parseFloat(e.columnId) &&\r\n                                      parseFloat(JSON.parse(input.id).rowId) ==\r\n                                      parseFloat(e.rowId)\r\n                                  ) {\r\n                                    this.$set(input, \"value\", e.value);\r\n                                  }\r\n                                } else {\r\n                                  if (\r\n                                      parseFloat(JSON.parse(input.id).columnId) ==\r\n                                      parseFloat(e.columnId)\r\n                                  ) {\r\n                                    this.$set(input, \"value\", e.value);\r\n                                  }\r\n                                }\r\n                              });\r\n                        }\r\n                      } else if (e.valueDate) {\r\n                        document.getElementsByClassName(\"custom-datepicker mx-datepicker\").forEach((field, idx) => {\r\n                          if (JSON.parse(field.id).rowId) {\r\n                            if (\r\n                                parseFloat(JSON.parse(field.id).columnId) ==\r\n                                parseFloat(e.columnId) &&\r\n                                parseFloat(JSON.parse(field.id).rowId) ==\r\n                                parseFloat(e.rowId)\r\n                            ) {\r\n                              let colIndex = this.thirdTrIdData.findIndex(item => item.columnId == e.columnId)\r\n                              this.setValue(\r\n                                  e.rowId,\r\n                                  e.value,\r\n                                  idx,\r\n                                  colIndex,\r\n                                  e.columnId,\r\n                                  'DATE'\r\n                              )\r\n                            }\r\n                          }\r\n                        })\r\n                      } else if (e.valueBoolean !== null) {\r\n                        document.getElementsByClassName(\"checkbox_field\").forEach((field, idx) => {\r\n                          let checkboxInput = field.children[0].children[0].children[0]\r\n                          if (JSON.parse(checkboxInput.id).rowId) {\r\n                            if (\r\n                                parseFloat(JSON.parse(checkboxInput.id).columnId) ==\r\n                                parseFloat(e.columnId) &&\r\n                                parseFloat(JSON.parse(checkboxInput.id).rowId) ==\r\n                                parseFloat(e.rowId)\r\n                            ) {\r\n\r\n                              let colIndex = this.thirdTrIdData.findIndex(item => item.columnId == e.columnId)\r\n\r\n                              this.setValue(\r\n                                  e.rowId,\r\n                                  JSON.parse(e.value),\r\n                                  idx,\r\n                                  colIndex,\r\n                                  e.columnId,\r\n                                  'BOOLEAN'\r\n                              )\r\n                            }\r\n                          }\r\n                        })\r\n                      } else if (e.selectValueNameUz) {\r\n                        document.getElementsByClassName(\"select_field\").forEach((field, idx) => {\r\n                          if (JSON.parse(field.id).rowId) {\r\n                            if (\r\n                                parseFloat(JSON.parse(field.id).columnId) ==\r\n                                parseFloat(e.columnId) &&\r\n                                parseFloat(JSON.parse(field.id).rowId) ==\r\n                                parseFloat(e.rowId)\r\n                            ) {\r\n                              let colIndex = this.thirdTrIdData.findIndex(item => item.columnId == e.columnId)\r\n                              this.setValue(\r\n                                  e.rowId,\r\n                                  {\r\n                                    id: e.id,\r\n                                    nameUz: e.selectValueNameUz,\r\n                                    nameLt: e.selectValueNameLt,\r\n                                    nameRu: e.selectValueNameRu\r\n                                  },\r\n                                  idx,\r\n                                  colIndex,\r\n                                  e.columnId,\r\n                                  'SELECT',\r\n                                  true,\r\n                                  true\r\n                              )\r\n                            }\r\n                          }\r\n                        })\r\n                      }\r\n                    });\r\n                  } else {\r\n                    document\r\n                        .getElementsByClassName(\"input_val\")\r\n                        .forEach((input) => {\r\n                          formulas.forEach((element) => {\r\n                            let index_V = JSON.parse(element.f1).findIndex(\r\n                                (e) => e == JSON.parse(input.id).columnId\r\n                            );\r\n                            if (index_V > -1) {\r\n                              this.$set(input, \"disabled\", true);\r\n                              this.$set(input.style, \"border\", \"none\");\r\n                              input.classList.add(\"no_enter_value\");\r\n                              input.style.fontWeight = \"bold\";\r\n                            }\r\n                          });\r\n                        });\r\n                  }\r\n\r\n                  this.loader = false;\r\n                });\r\n              }, 500);\r\n            }\r\n          })\r\n          .catch((e) => {\r\n            this.loader = false;\r\n            // this.catchErr(e);\r\n          });\r\n\r\n\r\n    },\r\n    async setColumns(v, rowsCount) {\r\n      this.selectedColumns = v;\r\n      this.firstColumns = [];\r\n      this.secondColumns = [];\r\n      this.thirdColumns = [];\r\n      v.forEach((el1) => {\r\n        this.firstColumns.push(el1);\r\n        el1.children.forEach((el2) => {\r\n          this.secondColumns.push(el2);\r\n          el2.children.forEach((el3) => {\r\n            this.thirdColumns.push({ ...el3, fId: el1.id });\r\n          });\r\n        });\r\n      });\r\n      setTimeout(async () => {\r\n        // this.thirdTrIdData = Array.prototype.slice\r\n        //   .call(document.getElementsByClassName(\"thirdTrId\"))\r\n        //   .map((e) => {\r\n        //     let array = e.id.split(\",\");\r\n        //     return {\r\n        //       columnId: array[0],\r\n        //       typeCode: array[1],\r\n        //       rowId: [],\r\n        //       value: [],\r\n        //     };\r\n        //   });\r\n        let firstTrTh = document.getElementsByClassName(\"firstTrTh\");\r\n        let secondTrTh = document.getElementsByClassName(\"secondTrTh\");\r\n        let thirdTrTh = document.getElementsByClassName(\"thirdTrTh\");\r\n        let counter2 = 0,\r\n            counter3 = 0;\r\n        await firstTrTh.forEach(async (th) => {\r\n          if (th.colSpan > 1) {\r\n            for (let index2 = 0; index2 < th.colSpan; index2++) {\r\n              if (secondTrTh[counter2] && secondTrTh[counter2].colSpan > 1) {\r\n                for (\r\n                    let index3 = 0;\r\n                    index3 < secondTrTh[counter2].colSpan;\r\n                    index3++\r\n                ) {\r\n                  let array = thirdTrTh[counter3].id.split(\",\");\r\n                  let tmp = {\r\n                    columnId: array[0],\r\n                    typeCode: array[1],\r\n                    refCode: array[2],\r\n                    referenceUrl: array[3],\r\n                    referenceAppendUrl: array[4],\r\n                    referenceCode: array[5],\r\n                    referenceNameUz: array[6],\r\n                    referenceNameLt: array[7],\r\n                    referenceNameRu: array[8],\r\n                    searchPayload: Object.assign({}, this.var_default_search_payload),\r\n                    hasNextPage: false,\r\n                    options: [],\r\n                    rowId: [],\r\n                    value: [],\r\n                  };\r\n                  // GET DYNAMIC REFRENCE OPTIONS\r\n                  if (tmp.typeCode === 'SELECT') {\r\n                    for (let i = 0; i < rowsCount; i++) {\r\n                      tmp.value.push({ selectedItem: null })\r\n                    }\r\n                    crudAndListsService.searchListWithKeyword(tmp.referenceUrl, tmp.searchPayload, tmp.referenceAppendUrl)\r\n                        .then(res => {\r\n                          tmp.options.push(...res.data.list)\r\n                          tmp.hasNextPage = res.data.total / tmp.searchPayload.itemsPerPage > tmp.searchPayload.page\r\n                          tmp.searchPayload.page += 1\r\n                          /* if (!this.isModeCreate && this.editingItem.okedId) {\r\n                              let foundItm = this.okeds.find(el => el.id == this.editingItem.okedId)\r\n                              if (!foundItm && this.editingItem.infoOkedDto) {\r\n                                  this.okeds.push(this.editingItem.infoOkedDto)\r\n                              }\r\n                          } */\r\n                        })\r\n                        .catch(e => {\r\n                          console.log(e)\r\n                          // this.okeds = []\r\n                        })\r\n                        .finally(() => {\r\n                          // this.isLoadingOked = false\r\n                        })\r\n                  }\r\n                  this.thirdTrIdData.push(tmp);\r\n                  counter3++;\r\n                }\r\n                counter2++;\r\n              } else {\r\n                if (\r\n                    secondTrTh[counter2] &&\r\n                    secondTrTh[counter2].classList.contains(\"thirdTrId\")\r\n                ) {\r\n                  let array = secondTrTh[counter2].id.split(\",\");\r\n                  let tmp = {\r\n                    columnId: array[0],\r\n                    typeCode: array[1],\r\n                    refCode: array[2],\r\n                    referenceUrl: array[3],\r\n                    referenceAppendUrl: array[4],\r\n                    referenceCode: array[5],\r\n                    referenceNameUz: array[6],\r\n                    referenceNameLt: array[7],\r\n                    referenceNameRu: array[8],\r\n                    searchPayload: Object.assign({}, this.var_default_search_payload),\r\n                    hasNextPage: false,\r\n                    options: [],\r\n                    rowId: [],\r\n                    value: [],\r\n                  };\r\n                  // GET DYNAMIC REFRENCE OPTIONS\r\n                  if (tmp.typeCode === 'SELECT') {\r\n                    for (let i = 0; i < rowsCount; i++) {\r\n                      tmp.value.push({ selectedItem: null })\r\n                    }\r\n                    crudAndListsService.searchListWithKeyword(tmp.referenceUrl, tmp.searchPayload, tmp.referenceAppendUrl)\r\n                        .then(res => {\r\n                          tmp.options.push(...res.data.list)\r\n                          tmp.hasNextPage = res.data.total / tmp.searchPayload.itemsPerPage > tmp.searchPayload.page\r\n                          tmp.searchPayload.page += 1\r\n                          /* if (!this.isModeCreate && this.editingItem.okedId) {\r\n                              let foundItm = this.okeds.find(el => el.id == this.editingItem.okedId)\r\n                              if (!foundItm && this.editingItem.infoOkedDto) {\r\n                                  this.okeds.push(this.editingItem.infoOkedDto)\r\n                              }\r\n                          } */\r\n                        })\r\n                        .catch(e => {\r\n                          console.log(e)\r\n                          // this.okeds = []\r\n                        })\r\n                        .finally(() => {\r\n                          // this.isLoadingOked = false\r\n                        })\r\n                  }\r\n                  this.thirdTrIdData.push(tmp);\r\n                  counter2++;\r\n                } else {\r\n                  if (secondTrTh[counter2]) {\r\n                    for (\r\n                        let index3 = 0;\r\n                        index3 < secondTrTh[counter2].colSpan;\r\n                        index3++\r\n                    ) {\r\n                      let array = thirdTrTh[counter3].id.split(\",\");\r\n                      let tmp = {\r\n                        columnId: array[0],\r\n                        typeCode: array[1],\r\n                        refCode: array[2],\r\n                        referenceUrl: array[3],\r\n                        referenceAppendUrl: array[4],\r\n                        referenceCode: array[5],\r\n                        referenceNameUz: array[6],\r\n                        referenceNameLt: array[7],\r\n                        referenceNameRu: array[8],\r\n                        searchPayload: Object.assign({}, this.var_default_search_payload),\r\n                        hasNextPage: false,\r\n                        options: [],\r\n                        rowId: [],\r\n                        value: [],\r\n                      };\r\n                      // GET DYNAMIC REFRENCE OPTIONS\r\n                      if (tmp.typeCode === 'SELECT') {\r\n                        for (let i = 0; i < rowsCount; i++) {\r\n                          tmp.value.push({ selectedItem: null })\r\n                        }\r\n                        crudAndListsService.searchListWithKeyword(tmp.referenceUrl, tmp.searchPayload, tmp.referenceAppendUrl)\r\n                            .then(res => {\r\n                              tmp.options.push(...res.data.list)\r\n                              tmp.hasNextPage = res.data.total / tmp.searchPayload.itemsPerPage > tmp.searchPayload.page\r\n                              tmp.searchPayload.page += 1\r\n                              /* if (!this.isModeCreate && this.editingItem.okedId) {\r\n                                  let foundItm = this.okeds.find(el => el.id == this.editingItem.okedId)\r\n                                  if (!foundItm && this.editingItem.infoOkedDto) {\r\n                                      this.okeds.push(this.editingItem.infoOkedDto)\r\n                                  }\r\n                              } */\r\n                            })\r\n                            .catch(e => {\r\n                              console.log(e)\r\n                              // this.okeds = []\r\n                            })\r\n                            .finally(() => {\r\n                              // this.isLoadingOked = false\r\n                            })\r\n                      }\r\n                      this.thirdTrIdData.push(tmp);\r\n                      counter3++;\r\n                    }\r\n\r\n                    counter2++;\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          } else {\r\n            if (th.classList.contains(\"thirdTrId\")) {\r\n              let array = th.id.split(\",\");\r\n              let tmp = {\r\n                columnId: array[0],\r\n                typeCode: array[1],\r\n                refCode: array[2],\r\n                referenceUrl: array[3],\r\n                referenceAppendUrl: array[4],\r\n                referenceCode: array[5],\r\n                referenceNameUz: array[6],\r\n                referenceNameLt: array[7],\r\n                referenceNameRu: array[8],\r\n                searchPayload: Object.assign({}, this.var_default_search_payload),\r\n                hasNextPage: false,\r\n                options: [],\r\n                rowId: [],\r\n                value: [],\r\n              };\r\n              // GET DYNAMIC REFRENCE OPTIONS\r\n              if (tmp.typeCode === 'SELECT') {\r\n                for (let i = 0; i < rowsCount; i++) {\r\n                  tmp.value.push({ selectedItem: null })\r\n                }\r\n                crudAndListsService.searchListWithKeyword(tmp.referenceUrl, tmp.searchPayload, tmp.referenceAppendUrl)\r\n                    .then(res => {\r\n                      tmp.options.push(...res.data.list)\r\n                      tmp.hasNextPage = res.data.total / tmp.searchPayload.itemsPerPage > tmp.searchPayload.page\r\n                      tmp.searchPayload.page += 1\r\n                      /* if (!this.isModeCreate && this.editingItem.okedId) {\r\n                          let foundItm = this.okeds.find(el => el.id == this.editingItem.okedId)\r\n                          if (!foundItm && this.editingItem.infoOkedDto) {\r\n                              this.okeds.push(this.editingItem.infoOkedDto)\r\n                          }\r\n                      } */\r\n                    })\r\n                    .catch(e => {\r\n                      console.log(e)\r\n                      // this.okeds = []\r\n                    })\r\n                    .finally(() => {\r\n                      // this.isLoadingOked = false\r\n                    })\r\n              }\r\n              this.thirdTrIdData.push(tmp);\r\n            } else {\r\n              for (let index2 = 0; index2 < th.colSpan; index2++) {\r\n                if (secondTrTh[counter2].colSpan > 1) {\r\n                  for (\r\n                      let index3 = 0;\r\n                      index3 < secondTrTh[counter2].colSpan;\r\n                      index3++\r\n                  ) {\r\n                    let array = thirdTrTh[counter3].id.split(\",\");\r\n                    let tmp = {\r\n                      columnId: array[0],\r\n                      typeCode: array[1],\r\n                      refCode: array[2],\r\n                      referenceUrl: array[3],\r\n                      referenceAppendUrl: array[4],\r\n                      referenceCode: array[5],\r\n                      referenceNameUz: array[6],\r\n                      referenceNameLt: array[7],\r\n                      referenceNameRu: array[8],\r\n                      searchPayload: Object.assign({}, this.var_default_search_payload),\r\n                      hasNextPage: false,\r\n                      options: [],\r\n                      rowId: [],\r\n                      value: [],\r\n                    };\r\n                    // GET DYNAMIC REFRENCE OPTIONS\r\n                    if (tmp.typeCode === 'SELECT') {\r\n                      for (let i = 0; i < rowsCount; i++) {\r\n                        tmp.value.push({ selectedItem: null })\r\n                      }\r\n                      crudAndListsService.searchListWithKeyword(tmp.referenceUrl, tmp.searchPayload, tmp.referenceAppendUrl)\r\n                          .then(res => {\r\n                            tmp.options.push(...res.data.list)\r\n                            tmp.hasNextPage = res.data.total / tmp.searchPayload.itemsPerPage > tmp.searchPayload.page\r\n                            tmp.searchPayload.page += 1\r\n                            /* if (!this.isModeCreate && this.editingItem.okedId) {\r\n                                let foundItm = this.okeds.find(el => el.id == this.editingItem.okedId)\r\n                                if (!foundItm && this.editingItem.infoOkedDto) {\r\n                                    this.okeds.push(this.editingItem.infoOkedDto)\r\n                                }\r\n                            } */\r\n                          })\r\n                          .catch(e => {\r\n                            console.log(e)\r\n                            // this.okeds = []\r\n                          })\r\n                          .finally(() => {\r\n                            // this.isLoadingOked = false\r\n                          })\r\n                    }\r\n                    this.thirdTrIdData.push(tmp);\r\n                    counter3++;\r\n                  }\r\n                  counter2++;\r\n                } else {\r\n                  if (\r\n                      secondTrTh[counter2] &&\r\n                      secondTrTh[counter2].classList.contains(\"thirdTrId\")\r\n                  ) {\r\n                    let array = secondTrTh[counter2].id.split(\",\");\r\n                    let tmp = {\r\n                      columnId: array[0],\r\n                      typeCode: array[1],\r\n                      refCode: array[2],\r\n                      referenceUrl: array[3],\r\n                      referenceAppendUrl: array[4],\r\n                      referenceCode: array[5],\r\n                      referenceNameUz: array[6],\r\n                      referenceNameLt: array[7],\r\n                      referenceNameRu: array[8],\r\n                      searchPayload: Object.assign({}, this.var_default_search_payload),\r\n                      hasNextPage: false,\r\n                      options: [],\r\n                      rowId: [],\r\n                      value: [],\r\n                    };\r\n                    // GET DYNAMIC REFRENCE OPTIONS\r\n                    if (tmp.typeCode === 'SELECT') {\r\n                      for (let i = 0; i < rowsCount; i++) {\r\n                        tmp.value.push({ selectedItem: null })\r\n                      }\r\n                      crudAndListsService.searchListWithKeyword(tmp.referenceUrl, tmp.searchPayload, tmp.referenceAppendUrl)\r\n                          .then(res => {\r\n                            tmp.options.push(...res.data.list)\r\n                            tmp.hasNextPage = res.data.total / tmp.searchPayload.itemsPerPage > tmp.searchPayload.page\r\n                            tmp.searchPayload.page += 1\r\n                            /* if (!this.isModeCreate && this.editingItem.okedId) {\r\n                                let foundItm = this.okeds.find(el => el.id == this.editingItem.okedId)\r\n                                if (!foundItm && this.editingItem.infoOkedDto) {\r\n                                    this.okeds.push(this.editingItem.infoOkedDto)\r\n                                }\r\n                            } */\r\n                          })\r\n                          .catch(e => {\r\n                            console.log(e)\r\n                            // this.okeds = []\r\n                          })\r\n                          .finally(() => {\r\n                            // this.isLoadingOked = false\r\n                          })\r\n                    }\r\n                    this.thirdTrIdData.push(tmp);\r\n                    counter2++;\r\n                  } else {\r\n                    if (secondTrTh[counter2]) {\r\n                      for (\r\n                          let index3 = 0;\r\n                          index3 < secondTrTh[counter2].colSpan;\r\n                          index3++\r\n                      ) {\r\n                        let array = thirdTrTh[counter3].id.split(\",\");\r\n                        let tmp = {\r\n                          columnId: array[0],\r\n                          typeCode: array[1],\r\n                          refCode: array[2],\r\n                          referenceUrl: array[3],\r\n                          referenceAppendUrl: array[4],\r\n                          referenceCode: array[5],\r\n                          referenceNameUz: array[6],\r\n                          referenceNameLt: array[7],\r\n                          referenceNameRu: array[8],\r\n                          searchPayload: Object.assign({}, this.var_default_search_payload),\r\n                          hasNextPage: false,\r\n                          options: [],\r\n                          rowId: [],\r\n                          value: [],\r\n                        };\r\n                        // GET DYNAMIC REFRENCE OPTIONS\r\n                        if (tmp.typeCode === 'SELECT') {\r\n                          for (let i = 0; i < rowsCount; i++) {\r\n                            tmp.value.push({ selectedItem: null })\r\n                          }\r\n                          crudAndListsService.searchListWithKeyword(tmp.referenceUrl, tmp.searchPayload, tmp.referenceAppendUrl)\r\n                              .then(res => {\r\n                                tmp.options.push(...res.data.list)\r\n                                tmp.hasNextPage = res.data.total / tmp.searchPayload.itemsPerPage > tmp.searchPayload.page\r\n                                tmp.searchPayload.page += 1\r\n                                /* if (!this.isModeCreate && this.editingItem.okedId) {\r\n                                    let foundItm = this.okeds.find(el => el.id == this.editingItem.okedId)\r\n                                    if (!foundItm && this.editingItem.infoOkedDto) {\r\n                                        this.okeds.push(this.editingItem.infoOkedDto)\r\n                                    }\r\n                                } */\r\n                              })\r\n                              .catch(e => {\r\n                                console.log(e)\r\n                                // this.okeds = []\r\n                              })\r\n                              .finally(() => {\r\n                                // this.isLoadingOked = false\r\n                              })\r\n                        }\r\n                        this.thirdTrIdData.push(tmp);\r\n                        counter3++;\r\n                      }\r\n                      counter2++;\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        });\r\n      }, 300);\r\n    },\r\n    setRow(v) {\r\n      this.selectedRows = v;\r\n      if (this.selectedRows.length == 0) {\r\n        this.selectedRows = [{}];\r\n      }\r\n    },\r\n\r\n    rowspanFirst(el) {\r\n      return el.children.length > 0\r\n          ? 1\r\n          : el.children.length > 0 && this.thirdColumns.length > 0\r\n              ? 3\r\n              : 3;\r\n    },\r\n    colspanFirst(el) {\r\n      let found = this.thirdColumns.filter((i) => i.fId === el.id);\r\n      let totalNotChild = el.children.filter((d) => d.children.length == 0);\r\n      return el.children.length > 0 && found.length == 0\r\n          ? el.children.length\r\n          : el.children.length > 0 && found.length > 0\r\n              ? totalNotChild.length + found.length\r\n              : 1;\r\n    },\r\n\r\n    rowspanSecond(el) {\r\n      return el.children.length == 0 && this.thirdColumns.length == 0\r\n          ? 1\r\n          : el.children.length == 0 && this.thirdColumns.length > 0\r\n              ? 2\r\n              : 1;\r\n    },\r\n    colspanSecond(el) {\r\n      return el.children.length > 0 ? el.children.length : 1;\r\n    },\r\n\r\n    rowspanFirstClass(el) {\r\n      return el.children.length > 0\r\n          ? \"\"\r\n          : el.children.length > 0 && this.thirdColumns.length > 0\r\n              ? \"thirdTrId\"\r\n              : \"thirdTrId\";\r\n    },\r\n    rowspanSecondClass(el) {\r\n      return el.children.length == 0 && this.thirdColumns.length == 0\r\n          ? \"thirdTrId\"\r\n          : el.children.length == 0 && this.thirdColumns.length > 0\r\n              ? \"thirdTrId\"\r\n              : \"\";\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div>\r\n    <div>\r\n      <div class=\"row\">\r\n        <div class=\"col-lg-12\">\r\n          <h5 class=\"text-center mb-1\">\r\n            <strong>\r\n              {{ getName({ nameLt: table.nameLt, nameRu: table.nameRu }) }}\r\n\r\n            </strong>\r\n          </h5>\r\n          <p class=\"text-center m-0\">\r\n            {{ getName({ nameLt: table.titleLt, nameRu: table.titleRu }) }}\r\n\r\n          </p>\r\n        </div>\r\n        <div class=\"col-lg-12\">\r\n          <div class=\"d-flex justify-content-between align-items-end pl-3 pr-3\">\r\n            <div>\r\n              <strong>\r\n                {{\r\n                  getName({\r\n                    nameLt: report.nameLt,\r\n                    nameRu: report.nameRu,\r\n                    nameUz: report.nameUz\r\n                  })\r\n                }}\r\n              </strong><br>\r\n              <span>\r\n                {{\r\n                  report.reportDate\r\n                }}\r\n              </span>\r\n            </div>\r\n            <div>\r\n              <strong>\r\n                {{\r\n                  getName({\r\n                    nameLt: table.conditionLt,\r\n                    nameRu: table.conditionRu,\r\n                  })\r\n                }}\r\n              </strong>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"col-lg-12\">\r\n          <b-overlay :opacity=\"0.1\" :show=\"loader\" rounded=\"sm\">\r\n            <div class=\"bg-white pl-3 pr-3 pt-1\" style=\"min-height: 60vh; overflow: auto;\">\r\n              <div class=\"pb-5\">\r\n                <table class=\"table thead-table table-centered  table-custom-bordered\">\r\n                  <thead>\r\n                  <tr class=\"tr-text-center\">\r\n                    <th\r\n                        :id=\"[el.id, el.typeCode, el.refCode, el.referenceUrl, el.referenceAppendUrl, el.referenceCode, el.referenceNameUz, el.referenceNameLt, el.referenceNameRu]\"\r\n                        :class=\"rowspanFirstClass(el, index)\"\r\n                        class=\"firstTrTh\"\r\n                        style=\"min-width: 70px\"\r\n                        :rowspan=\"rowspanFirst(el)\"\r\n                        :colspan=\"colspanFirst(el)\"\r\n                        v-for=\"(el, index) in firstColumns\"\r\n                        :key=\"index + 'first'\"\r\n                    >\r\n                      <div style=\" max-height: 200px; display: inline-block; \">\r\n                        <div :class=\" (el.isVertical == 1 ) ? 'rotate_text' : '' \">\r\n                          {{\r\n                            getName({ nameLt: el.nameLt, nameRu: el.nameRu, nameUz: el.nameUz })\r\n                          }}\r\n                        </div>\r\n                      </div>\r\n                    </th>\r\n                  </tr>\r\n                  <tr class=\"tr-text-center\">\r\n                    <th\r\n                        style=\"min-width: 70px\"\r\n                        :id=\"[el.id, el.typeCode, el.refCode, el.referenceUrl, el.referenceAppendUrl, el.referenceCode, el.referenceNameUz, el.referenceNameLt, el.referenceNameRu]\"\r\n                        :class=\"rowspanSecondClass(el)\"\r\n                        class=\"secondTrTh\"\r\n                        :rowspan=\"rowspanSecond(el)\"\r\n                        :colspan=\"colspanSecond(el)\"\r\n                        v-for=\"(el, index) in secondColumns\"\r\n                        :key=\"index + 'second'\"\r\n                    >\r\n                      <div style=\" max-height: 200px; position: relative; display: inline-block; cursor: pointer;\">\r\n                        <div :class=\"(el.isVertical == 1 )  ? 'rotate_text' : ''\">\r\n                          {{ getName({ nameLt: el.nameLt, nameRu: el.nameRu, nameUz: el.nameUz }) }}\r\n                        </div>\r\n                      </div>\r\n                    </th>\r\n                  </tr>\r\n\r\n                  <tr class=\"tr-text-center\">\r\n                    <th\r\n                        style=\"min-width: 70px\"\r\n                        :id=\"[el.id, el.typeCode, el.refCode, el.referenceUrl, el.referenceAppendUrl, el.referenceCode, el.referenceNameUz, el.referenceNameLt, el.referenceNameRu]\"\r\n                        class=\"thirdTrId thirdTrTh\"\r\n                        :colspan=\"el.children.length > 0 ? el.children.length : 1\"\r\n                        v-for=\"(el, index) in thirdColumns\"\r\n                        :key=\"index + 'third'\"\r\n                    >\r\n                      <div style=\" max-height: 200px; position: relative; display: inline-block; cursor: pointer; \">\r\n                        <div :class=\"(el.isVertical == 1 )  ? 'rotate_text' : ''\">\r\n                          {{\r\n                            getName({ nameLt: el.nameLt, nameRu: el.nameRu, nameUz: el.nameUz })\r\n                          }}\r\n                        </div>\r\n                      </div>\r\n                    </th>\r\n                  </tr>\r\n\r\n                  <tr class=\"tr-text-center\">\r\n                    <td v-for=\"(item, index) of thirdTrIdData\" :key=\"index + 'I-1'\">\r\n                      <strong v-if=\"selectedRows.length > 1\">\r\n                        {{\r\n                          selectedRows.length > 1 && index == 0 ? \"\" : index\r\n                        }}\r\n                      </strong>\r\n                      <strong v-else>\r\n                        {{ index + 1 }}\r\n                      </strong>\r\n                    </td>\r\n                  </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                  <tr v-for=\"(data, index1) in selectedRows\" :key=\"index1 + 'MM'\">\r\n                    <!-- <th>\r\n                      {{ getName({ ...data }) }}\r\n                    </th> -->\r\n\r\n                    <td\r\n                        :class=\"[\r\n                          f1Ids &&\r\n                          f1Ids.indexOf(i.columnId) > -1 &&\r\n                          selectedRows.length > 1 &&\r\n                          fRowId == data.id\r\n                            ? 'bg-success'\r\n                            : f1Ids &&\r\n                              f1Ids.indexOf(i.columnId) > -1 &&\r\n                              selectedRows.length <= 1\r\n                            ? 'bg-success'\r\n                            : '',\r\n                          f2Ids &&\r\n                          f2Ids.indexOf(i.columnId) > -1 &&\r\n                          selectedRows.length > 1 &&\r\n                          fRowId == data.id\r\n                            ? 'bg-primary'\r\n                            : f2Ids &&\r\n                              f2Ids.indexOf(i.columnId) > -1 &&\r\n                              selectedRows.length <= 1\r\n                            ? 'bg-primary'\r\n                            : '',\r\n                        ]\"\r\n                        v-for=\"(i, index) in thirdTrIdData\"\r\n                        :key=\"index + 'td'\"\r\n                        class=\"text-center p\"\r\n                    >\r\n                      <p class=\"m-0 p-2\" v-if=\"data.id && index == 0\">\r\n                        {{ getName(data) }}\r\n                      </p>\r\n\r\n                      <div\r\n                          v-else-if=\"i.typeCode === 'SELECT' && thirdTrIdData[index].value[index1] && thirdTrIdData[index].value[index1].notEditable\"\r\n                          v-b-tooltip=\"{ variant: 'info' }\"\r\n                          class=\"cursor-pointer\"\r\n                          @click=\"editValue(index1, index)\"\r\n                          :title=\"$t('actions.click_to_edit')\"\r\n                      >\r\n                        {{\r\n                          getName({\r\n                            nameUz: thirdTrIdData[index].value[index1].selectValueNameUz,\r\n                            nameLt: thirdTrIdData[index].value[index1].selectValueNameLt,\r\n                            nameRu: thirdTrIdData[index].value[index1].selectValueNameRu\r\n                          })\r\n                        }}\r\n                      </div>\r\n                      <!-- FOR SELECT -->\r\n                      <div v-else-if=\"i.typeCode === 'SELECT'\" style=\"min-width: 300px;\">\r\n                        <BaseMultiselectWithValidation\r\n                            v-if=\"thirdTrIdData[index].value[index1]\"\r\n                            not-required\r\n                            only-form-element\r\n                            v-model=\"thirdTrIdData[index].value[index1].selectedItem\"\r\n                            class=\"select_field\"\r\n                            :id=\"\r\n                                JSON.stringify({\r\n                                  rowId: data.id,\r\n                                  columnId: i.columnId,\r\n                                })\r\n                              \"\r\n                            :custom-label=\"({nameUz, nameLt, nameRu}) => getName({nameUz: nameUz, nameLt: nameLt, nameRu: nameRu})\"\r\n                            @select=\"setValue(\r\n                                    data.id,\r\n                                    $event,\r\n                                    index1,\r\n                                    index,\r\n                                    i.columnId,\r\n                                    i.typeCode,\r\n                                    i.notEditable\r\n                                )\"\r\n                            :options=\"i.options\"\r\n                            :placeholder=\"getName({nameUz: i.referenceNameUz, nameLt: i.referenceNameLt, nameRu: i.referenceNameRu})\"\r\n                            open-direction=\"bottom\"\r\n                            :max-height=\"600\"\r\n                            :show-labels=\"false\"\r\n                            :has-next-page=\"i.hasNextPage\"\r\n                            @reachedEndOfList=\"dynamicRefsReachedEndOfList\"\r\n                            @search-change=\"debounceSearchDynamicRefs\"\r\n                            :searchable=\"true\"\r\n                            preserve-search\r\n                            :clear-on-select=\"false\"\r\n                            :loading=\"i.isLoading\"\r\n                            :internal-search=\"false\"\r\n                            :with-create-addition=\"(thirdTrIdData[index].value[index1] && thirdTrIdData[index].value[index1].originalSelectValueNameUz) ? true : false\"\r\n                        >\r\n                          <template v-slot:append-slot>\r\n                            <b-btn\r\n                                v-if=\"thirdTrIdData[index].value[index1] && thirdTrIdData[index].value[index1].originalSelectValueNameUz\"\r\n                                variant=\"link\"\r\n                                class=\"text-decoration-none p-0 text-danger\"\r\n                                style=\"font-size: 1.2rem;\"\r\n                            >\r\n                              <i @click=\"resetValue(index1, index)\" class=\"mdi mdi-refresh\"></i>\r\n                            </b-btn>\r\n                          </template>\r\n                        </BaseMultiselectWithValidation>\r\n                        <BaseMultiselectWithValidation\r\n                            v-else-if=\"!thirdTrIdData[index].value[index1]\"\r\n                            not-required\r\n                            only-form-element\r\n                            class=\"select_field\"\r\n                            :id=\"JSON.stringify({rowId: data.id,columnId: i.columnId})\"\r\n                            v-model=\"thirdTrIdData[index].value[index1]\"\r\n                            :custom-label=\"({nameUz, nameLt, nameRu}) => getName({nameUz: nameUz, nameLt: nameLt, nameRu: nameRu})\"\r\n                            @select=\"setValue( data.id, $event, index1, index, i.columnId, i.typeCode, i.notEditable )\"\r\n                            :options=\"i.options\"\r\n                            :placeholder=\"getName({nameUz: i.referenceNameUz, nameLt: i.referenceNameLt, nameRu: i.referenceNameRu})\"\r\n                            open-direction=\"bottom\"\r\n                            :max-height=\"600\"\r\n                            :show-labels=\"false\"\r\n                            :has-next-page=\"i.hasNextPage\"\r\n                            @reachedEndOfList=\"dynamicRefsReachedEndOfList\"\r\n                            @search-change=\"debounceSearchDynamicRefs\"\r\n                            :searchable=\"true\"\r\n                            preserve-search\r\n                            :clear-on-select=\"false\"\r\n                            :loading=\"i.isLoading\"\r\n                            :internal-search=\"false\"\r\n                        />\r\n                      </div>\r\n                      <!-- FOR DATE -->\r\n                      <BaseDatePickerWithValidation\r\n                          v-else-if=\"i.typeCode === 'DATE' && thirdTrIdData[index].value[index1]\"\r\n                          not-required\r\n                          only-form-element\r\n                          custom-styles=\"min-width: 140px;\"\r\n                          placeholder=\"\"\r\n                          v-model=\"thirdTrIdData[index].value[index1].value\"\r\n                          class=\"datepicker_field\"\r\n                          :id=\"JSON.stringify({rowId: data.id,columnId: i.columnId,})\"\r\n                          @input=\"(e) =>setValue(data.id,e,index1,index,i.columnId,i.typeCode)\"\r\n                          lang=\"ru\"\r\n                      />\r\n                      <BaseDatePickerWithValidation\r\n                          v-else-if=\"i.typeCode === 'DATE'\"\r\n                          not-required\r\n                          only-form-element\r\n                          custom-styles=\"min-width: 140px;\"\r\n                          class=\"datepicker_field\"\r\n                          :id=\"JSON.stringify({rowId: data.id,columnId: i.columnId,})\"\r\n                          placeholder=\"\"\r\n                          @input=\"(e) =>setValue(data.id,e,index1,index,i.columnId,i.typeCode)\"\r\n                          lang=\"ru\"\r\n                      />\r\n\r\n                      <!-- FOR YEAR -->\r\n                      <BaseDatePickerWithValidation\r\n                          v-else-if=\"i.typeCode === 'YEAR' && thirdTrIdData[index].value[index1]\"\r\n                          not-required\r\n                          only-form-element\r\n                          custom-styles=\"min-width: 140px;\"\r\n                          placeholder=\"\"\r\n                          v-model=\"thirdTrIdData[index].value[index1].value\"\r\n                          class=\"datepicker_field\"\r\n                          :id=\"JSON.stringify({rowId: data.id,columnId: i.columnId,})\"\r\n                          @input=\"(e) =>setValue(data.id,e,index1,index,i.columnId,i.typeCode)\"\r\n                          lang=\"ru\"\r\n                          type=\"year\"\r\n                      />\r\n                      <BaseDatePickerWithValidation\r\n                          v-else-if=\"i.typeCode === 'YEAR'\"\r\n                          not-required\r\n                          only-form-element\r\n                          custom-styles=\"min-width: 140px;\"\r\n                          class=\"datepicker_field\"\r\n                          :id=\"JSON.stringify({rowId: data.id,columnId: i.columnId,})\"\r\n                          placeholder=\"\"\r\n                          @input=\"(e) =>setValue(data.id,e,index1,index,i.columnId,i.typeCode)\"\r\n                          lang=\"ru\"\r\n                          type=\"year\"\r\n                      />\r\n\r\n                      <!-- FOR STRING -->\r\n                      <div v-else-if=\"i.typeCode === 'STRING'\" style=\"min-width: 300px;\">\r\n                        <b-form-input\r\n                            @keydown=\"(evt) =>keydownEvt(evt,data.id,evt.target.value,index1,index,i.columnId,i.typeCode)\"\r\n                            :class=\"\r\n                              currentPosition.rowId &&\r\n                              currentPosition.columnId &&\r\n                              i.columnId == currentPosition.columnId &&\r\n                              data.id == currentPosition.rowId\r\n                                ? 'borderInput'\r\n                                : currentPosition.columnId &&\r\n                                  !currentPosition.rowId &&\r\n                                  i.columnId == currentPosition.columnId\r\n                                ? 'borderInput'\r\n                                : ''\r\n                            \"\r\n                            @focus=\"(e) =>focusVal(data.id,e,index1,index,i.columnId,i.typeCode)\"\r\n                            :style=\"report.status && report.status !== 'CREATED'? 'border: none !important': ''\"\r\n                            :disabled=\"report.status && report.status !== 'CREATED'\"\r\n                            :id=\"JSON.stringify({rowId: data.id,columnId: i.columnId,})\"\r\n                            @input=\"(e) =>setValue(data.id,e,index1,index,i.columnId,i.typeCode)\"\r\n                            class=\"text-center input_val p-0\"\r\n                        >\r\n                        </b-form-input>\r\n                      </div>\r\n                      <!-- FOR BOOLEAN -->\r\n                      <Checkbox\r\n                          v-else-if=\"i.typeCode === 'BOOLEAN' && thirdTrIdData[index].value[index1]\"\r\n                          v-model=\"thirdTrIdData[index].value[index1].value\"\r\n                          :font-size=\"0\"\r\n                          :disabled=\"report.status && report.status !== 'CREATED'\"\r\n                          :id=\"JSON.stringify({rowId: data.id,columnId: i.columnId,})\"\r\n                          class=\"justify-content-center checkbox_field\"\r\n                          @change=\"(e) =>setValue(data.id,e,index1,index,i.columnId,i.typeCode)\"\r\n                      />\r\n                      <Checkbox\r\n                          v-else-if=\"i.typeCode === 'BOOLEAN'\"\r\n                          :font-size=\"0\"\r\n                          :disabled=\"report.status && report.status !== 'CREATED'\"\r\n                          :id=\"JSON.stringify({rowId: data.id,columnId: i.columnId,})\"\r\n                          class=\"justify-content-center checkbox_field\"\r\n                          @change=\"(e) =>setValue(data.id,e,index1,index,i.columnId,i.typeCode)\"\r\n                      />\r\n                      <!-- FOR INTEGER -->\r\n                      <div v-else>\r\n                        <b-form-input\r\n                            @keydown=\"(evt) =>keydownEvt(evt,data.id,evt.target.value,index1,index,i.columnId,i.typeCode)\"\r\n                            :class=\"\r\n                              currentPosition.rowId &&\r\n                              currentPosition.columnId &&\r\n                              i.columnId == currentPosition.columnId &&\r\n                              data.id == currentPosition.rowId\r\n                                ? 'borderInput'\r\n                                : currentPosition.columnId &&\r\n                                  !currentPosition.rowId &&\r\n                                  i.columnId == currentPosition.columnId\r\n                                ? 'borderInput'\r\n                                : ''\r\n                            \"\r\n                            @focus=\"(e) =>focusVal(data.id,e,index1,index,i.columnId,i.typeCode)\"\r\n                            :style=\"report.status && report.status !== 'CREATED'? 'border: none !important': ''\"\r\n                            :disabled=\"report.status && report.status !== 'CREATED'\"\r\n                            :id=\"JSON.stringify({rowId: data.id,columnId: i.columnId,})\"\r\n                            @input=\"(e) =>setValue(data.id,e,index1,index,i.columnId,i.typeCode)\"\r\n                            type=\"number\"\r\n                            class=\"text-center input_val p-0\"\r\n                        >\r\n                        </b-form-input>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                  </tbody>\r\n                  <tfoot>\r\n                  <tr class=\"mt-5\" v-show=\"showResult\"\r\n                  >\r\n                    <td v-for=\"(i, index) in thirdTrIdData\"\r\n                        :key=\"index + 'td'\"\r\n                        class=\"text-center p\"\r\n                    >\r\n                      <p v-if=\"index === 0\">Jami</p>\r\n                      <div v-else-if=\"i.typeCode === 'BIGDECIMAL'\">\r\n                        {{ getColumnData(i) }}\r\n                      </div>\r\n                      <div v-else>---</div>\r\n                    </td>\r\n                  </tr>\r\n                  </tfoot>\r\n                </table>\r\n              </div>\r\n              <div>\r\n              </div>\r\n            </div>\r\n          </b-overlay>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<style lang=\"scss\">\r\n.borderInput {\r\n  border: 2px solid green !important;\r\n}\r\n\r\nth {\r\n  /* &#SELECT {\r\n    width: 20%;\r\n  } */\r\n  &[id*=\"SELECT\"] {\r\n    width: 150px;\r\n  }\r\n}\r\n\r\n.check {\r\n  margin-top: 5px;\r\n\r\n  .m-chckbox--container {\r\n    margin: 0px !important;\r\n    width: 22px !important;\r\n  }\r\n\r\n  label {\r\n    margin: 0;\r\n    display: none;\r\n  }\r\n}\r\n</style>\r\n<style lang=\"scss\">\r\n/* Chrome, Safari, Edge, Opera */\r\ninput::-webkit-outer-spin-button,\r\ninput::-webkit-inner-spin-button {\r\n  -webkit-appearance: none;\r\n  margin: 0;\r\n}\r\n\r\n/* Firefox */\r\ninput[type=\"number\"] {\r\n  -moz-appearance: textfield;\r\n}\r\n\r\n.rotate_text {\r\n  height: 100%;\r\n  word-break: normal;\r\n  writing-mode: vertical-rl;\r\n  -ms-writing-mode: vertical-lr;\r\n  -webkit-transform: rotate(-180deg);\r\n  -moz-transform: rotate(-180deg);\r\n  -o-transform: rotate(-180deg);\r\n  transform: rotate(-180deg);\r\n  padding-bottom: 20px !important;\r\n  padding-top: 20px !important;\r\n}\r\n\r\n.no_enter_value {\r\n  padding: 0px !important;\r\n  min-width: auto !important;\r\n}\r\n</style>\r\n"]}]}