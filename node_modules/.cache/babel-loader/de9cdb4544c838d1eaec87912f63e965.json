{"remainingRequest":"D:\\ACRU\\interactive-services\\node_modules\\thread-loader\\dist\\cjs.js!D:\\ACRU\\interactive-services\\node_modules\\babel-loader\\lib\\index.js!D:\\ACRU\\interactive-services\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\ACRU\\interactive-services\\src\\state\\modules\\messenger.js","dependencies":[{"path":"D:\\ACRU\\interactive-services\\src\\state\\modules\\messenger.js","mtime":1709020148572},{"path":"D:\\ACRU\\interactive-services\\babel.config.js","mtime":1709020148252},{"path":"D:\\ACRU\\interactive-services\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ACRU\\interactive-services\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ACRU\\interactive-services\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\ACRU\\interactive-services\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiRDovQUNSVS9pbnRlcmFjdGl2ZS1zZXJ2aWNlcy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcmVnZW5lcmF0b3JSdW50aW1lLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L0FDUlUvaW50ZXJhY3RpdmUtc2VydmljZXMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLWluZGV4LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmpzb24uc3RyaW5naWZ5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCB7IFRva2VuU2VydmljZSB9IGZyb20gIkAvc2hhcmVkL3NlcnZpY2VzL3N0b3JhZ2Uuc2VydmljZSI7CmltcG9ydCBtZXNzZW5nZXJTZXJ2aWNlIGZyb20gIkAvc2hhcmVkL3NlcnZpY2VzL21lc3NlbmdlclNlcnZpY2UiOwppbXBvcnQgU29ja0pTIGZyb20gInNvY2tqcy1jbGllbnQiOwppbXBvcnQgU3RvbXAgZnJvbSAid2Vic3RvbXAtY2xpZW50IjsKaW1wb3J0IFZ1ZSBmcm9tICJ2dWUiOwp2YXIgZ2xvYmFsU3RvbXBDbGllbnQgPSBudWxsOwpleHBvcnQgdmFyIHN0YXRlID0gewogIG1hcmtldGluZzogbnVsbCwKICBub3RpZmljYXRpb246IG51bGwsCiAgY29udGFjdExpc3Q6IFtdLAogIGNvbnRhY3RUb3RhbDogMCwKICBncm91cENoYXRMaXN0OiBbXSwKICBncm91cENoYXRUb3RhbDogMCwKICBjb21tZW50czogW10sCiAgY29tbWVudHNUb3RhbDogMCwKICBvcGVuUGFnZTogImRlZmF1bHQiLAogIGNoYXRMaXN0TWVzc2FnZXM6IFtdLAogIGNoYXRUb3RhbE1lc3NhZ2VzOiAwLAogIGdyb3VwQ2hhdExpc3RNZXNzYWdlczogW10sCiAgZ3JvdXBDaGF0VG90YWxNZXNzYWdlczogMCwKICBsYXN0TWVzc2FnZToge30sCiAgbGFzdE1lc3NhZ2VHcm91cDoge30sCiAgZ3JvdXBVcGRhdGU6IGZhbHNlLAogIGdyb3VwVXBkYXRlTXNnOiBudWxsLAogIGluY29taW5nUGVyc29uOiBudWxsLAogIGV4aXRpbmdQZXJzb246IG51bGwsCiAgY2hhdFVucmVhZENvdW50OiAwLAogIHVucmVhZERhdGE6IG51bGwsCiAgQ0hBVDogbnVsbAp9OwpleHBvcnQgdmFyIG11dGF0aW9ucyA9IHsKICBzZXRDdXJyZW50Q2hhdDogZnVuY3Rpb24gc2V0Q3VycmVudENoYXQoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLkNIQVQgPSBkYXRhOwogIH0sCiAgc2V0Q2hhdE1lc3NhZ2VNYWtlUmVhZDogZnVuY3Rpb24gc2V0Q2hhdE1lc3NhZ2VNYWtlUmVhZChzdGF0ZSwgaWQpIHsKICAgIHZhciBpbmRleCA9IHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBlLmlkID09IGlkOwogICAgfSk7CiAgICBpZiAoaW5kZXggPiAtMSkgewogICAgICBWdWUuc2V0KHN0YXRlLmNoYXRMaXN0TWVzc2FnZXNbaW5kZXhdLCAiaXNSZWFkIiwgIlJFQUQiKTsKICAgIH0KICB9LAogIHNldENoYXRVbnJlYWRNZXNzYWdDb3VudDogZnVuY3Rpb24gc2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50KHN0YXRlLCBjb3VudCkgewogICAgc3RhdGUuY2hhdFVucmVhZENvdW50ID0gY291bnQ7CiAgICBpZiAoY291bnQgPiAwKSB7CiAgICAgIC8vIHBsYXlTb3VuZCgpCiAgICB9CiAgfSwKICBzZXRDaGF0VW5yZWFkQ291bnQ6IGZ1bmN0aW9uIHNldENoYXRVbnJlYWRDb3VudChzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUudW5yZWFkRGF0YSA9IGRhdGE7CiAgfSwKICBzZXRDb21tZW50czogZnVuY3Rpb24gc2V0Q29tbWVudHMoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmNvbW1lbnRzID0gZGF0YTsKICB9LAogIHNldEluY29taW5nUGVyc29uOiBmdW5jdGlvbiBzZXRJbmNvbWluZ1BlcnNvbihzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuaW5jb21pbmdQZXJzb24gPSBkYXRhOwogIH0sCiAgc2V0RXhpdGluZ1BlcnNvbjogZnVuY3Rpb24gc2V0RXhpdGluZ1BlcnNvbihzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuZXhpdGluZ1BlcnNvbiA9IGRhdGE7CiAgfSwKICBzZXRNYXJrZXRpbmc6IGZ1bmN0aW9uIHNldE1hcmtldGluZyhzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUubWFya2V0aW5nID0gZGF0YTsKICB9LAogIHNldE5vdGlmaWNhdGlvbjogZnVuY3Rpb24gc2V0Tm90aWZpY2F0aW9uKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5ub3RpZmljYXRpb24gPSBkYXRhOwogIH0sCiAgc2V0R3JvdXBVcGRhdGVFOiBmdW5jdGlvbiBzZXRHcm91cFVwZGF0ZUUoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmdyb3VwVXBkYXRlID0gZGF0YTsKICB9LAogIHNldEdyb3VwQ2hhdFVwZGF0ZTogZnVuY3Rpb24gc2V0R3JvdXBDaGF0VXBkYXRlKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5ncm91cFVwZGF0ZSA9IHRydWU7CiAgICBzdGF0ZS5ncm91cFVwZGF0ZU1zZyA9IGRhdGE7CiAgfSwKICBzZXRMaXN0UmVzcG9uc2VHcm91cENoYXQ6IGZ1bmN0aW9uIHNldExpc3RSZXNwb25zZUdyb3VwQ2hhdChzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuZ3JvdXBDaGF0TGlzdCA9IGRhdGEubGlzdDsKICAgIHN0YXRlLmdyb3VwQ2hhdFRvdGFsID0gZGF0YS50b3RhbDsKICB9LAogIHNldExpc3RSZXNwb25zZTogZnVuY3Rpb24gc2V0TGlzdFJlc3BvbnNlKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5jb250YWN0TGlzdCA9IGRhdGEubGlzdC5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBmaXJzdE5hbWU6IGUuZmlyc3ROYW1lLAogICAgICAgIGxhc3ROYW1lOiBlLmxhc3ROYW1lLAogICAgICAgIGVtcGxveWVlSWQ6IGUuZW1wbG95ZWVJZCwKICAgICAgICBjaGF0SWQ6IGUuY2hhdElkLAogICAgICAgIHVwbG9hZFBhdGg6IGUudXBsb2FkUGF0aAogICAgICB9OwogICAgfSk7CiAgICBzdGF0ZS5jb250YWN0VG90YWwgPSBkYXRhLnRvdGFsOwogIH0sCiAgc2V0T3BlblBhZ2U6IGZ1bmN0aW9uIHNldE9wZW5QYWdlKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5vcGVuUGFnZSA9IGRhdGE7CiAgfSwKICBzZXRMaXN0Q2hhdE1lc3NlZ2VzOiBmdW5jdGlvbiBzZXRMaXN0Q2hhdE1lc3NlZ2VzKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzID0gZGF0YS5saXN0OwogICAgc3RhdGUuY2hhdFRvdGFsTWVzc2FnZXMgPSBkYXRhLnRvdGFsOwogIH0sCiAgc2V0TGlzdEdyb3VwQ2hhdE1lc3NlZ2VzOiBmdW5jdGlvbiBzZXRMaXN0R3JvdXBDaGF0TWVzc2VnZXMoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmdyb3VwQ2hhdExpc3RNZXNzYWdlcyA9IGRhdGEubGlzdDsKICAgIHN0YXRlLmdyb3VwQ2hhdFRvdGFsTWVzc2FnZXMgPSBkYXRhLnRvdGFsOwogIH0sCiAgcHVzaEl0ZW1zOiBmdW5jdGlvbiBwdXNoSXRlbXMoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMgPSBkYXRhLmNvbmNhdChzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzKTsKICB9LAogIHB1c2hHcm91cEl0ZW1zOiBmdW5jdGlvbiBwdXNoR3JvdXBJdGVtcyhzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzID0gZGF0YS5jb25jYXQoc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzKTsKICB9LAogIHB1c2hDaGF0TGlzdDogZnVuY3Rpb24gcHVzaENoYXRMaXN0KHN0YXRlLCBkYXRhKSB7CiAgICBpZiAoc3RhdGUuQ0hBVCAmJiBzdGF0ZS5DSEFULmlkID09IGRhdGEuY2hhdElkKSB7CiAgICAgIGlmIChkYXRhLmV4dHJhID09PSAnZGVsZXRlJykgewogICAgICAgIHZhciBpbmRleCA9IHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmRlbGV0ZUlkOwogICAgICAgIH0pOwogICAgICAgIGlmIChpbmRleCA+IC0xKSB7CiAgICAgICAgICBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGRhdGEuZXh0cmEgPT09ICd1cGRhdGUnKSB7CiAgICAgICAgdmFyIF9pbmRleCA9IHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmVkaXRlZE1lc3NhZ2UuaWQ7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKF9pbmRleCA+IC0xKSB7CiAgICAgICAgICBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzW19pbmRleF0ubWVzc2FnZSA9IGRhdGEuZWRpdGVkTWVzc2FnZS5tZXNzYWdlOwogICAgICAgICAgc3RhdGUuY2hhdExpc3RNZXNzYWdlc1tfaW5kZXhdLmVkaXRlZCA9IHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBfaW5kZXgyID0gc3RhdGUuY2hhdExpc3RNZXNzYWdlcy5maW5kSW5kZXgoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBlLmlkID09IGRhdGEuaWQ7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKCFfaW5kZXgyIHx8IF9pbmRleDIgPD0gLTEpIHsKICAgICAgICAgIHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMucHVzaChkYXRhKTsKICAgICAgICAgIHN0YXRlLmNoYXRUb3RhbE1lc3NhZ2VzKys7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKICBwdXNoQ291bnQ6IGZ1bmN0aW9uIHB1c2hDb3VudChzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuY2hhdExpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICBpZiAoZWxlbWVudC5pZCA9PT0gZGF0YS5jaGF0SWQpIHsKICAgICAgICBidXMuJHNldChlbGVtZW50LCAiY291bnQiLCBlbGVtZW50LmNvdW50KyspOwogICAgICB9CiAgICB9KTsKICB9LAogIHB1c2hHcm91cENoYXRMaXN0OiBmdW5jdGlvbiBwdXNoR3JvdXBDaGF0TGlzdChzdGF0ZSwgZGF0YSkgewogICAgaWYgKHN0YXRlLkNIQVQgJiYgc3RhdGUuQ0hBVC5pZCA9PSBkYXRhLmdyb3VwQ2hhdElkKSB7CiAgICAgIGlmIChkYXRhLmV4dHJhID09PSAidW5yZWFkIikgewogICAgICAgIHN0YXRlLmdyb3VwQ2hhdExpc3RNZXNzYWdlcy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICBpZiAoZWxlbWVudC5pZCA9PSBkYXRhLnVucmVhZElkKSB7CiAgICAgICAgICAgIGVsZW1lbnQuaXNSZWFkID0gIlJFQUQiOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGRhdGEuZXh0cmEgPT09ICJkZWxldGUiKSB7CiAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUuaWQgPT0gZGF0YS5kZWxldGVJZDsKICAgICAgICB9KTsKICAgICAgICBpZiAoaW5kZXggPiAtMSkgewogICAgICAgICAgc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGRhdGEuZXh0cmEgPT09ICJ1cGRhdGUiKSB7CiAgICAgICAgdmFyIF9pbmRleDMgPSBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmVkaXRlZEdyb3VwTWVzc2FnZS5pZDsKICAgICAgICB9KTsKICAgICAgICBpZiAoX2luZGV4MyA+IC0xKSB7CiAgICAgICAgICBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXNbX2luZGV4M10ubWVzc2FnZSA9IGRhdGEuZWRpdGVkR3JvdXBNZXNzYWdlLm1lc3NhZ2U7CiAgICAgICAgICBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXNbX2luZGV4M10uZWRpdGVkID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIF9pbmRleDQgPSBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmlkOwogICAgICAgIH0pOwogICAgICAgIGlmIChfaW5kZXg0IDw9IC0xKSB7CiAgICAgICAgICBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMucHVzaChkYXRhKTsKICAgICAgICAgIHN0YXRlLmdyb3VwQ2hhdFRvdGFsTWVzc2FnZXMrKzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAogIHB1c2hHcm91cENvdW50OiBmdW5jdGlvbiBwdXNoR3JvdXBDb3VudChzdGF0ZSwgZGF0YSkgewogICAgaWYgKGRhdGEuZXh0cmEgPT09ICJ1bnJlYWQiKSB7fSBlbHNlIGlmIChkYXRhLmV4dHJhID09PSAiZGVsZXRlIikge30gZWxzZSBpZiAoZGF0YS5leHRyYSA9PT0gInVwZGF0ZSIpIHt9IGVsc2UgewogICAgICBzdGF0ZS5ncm91cENoYXRMaXN0LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBpZiAoZWxlbWVudC5pZCA9PT0gZGF0YS5jaGF0SWQpIHsKICAgICAgICAgIGJ1cy4kc2V0KGVsZW1lbnQsICJjb3VudCIsIGVsZW1lbnQuY291bnQrKyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAogIHJlbW92OiBmdW5jdGlvbiByZW1vdihzdGF0ZSkgewogICAgc3RhdGUuY2hhdExpc3RNZXNzYWdlcy5zcGxpY2UoLTEsIDEpOwogIH0KfTsKZXhwb3J0IHZhciBhY3Rpb25zID0gewogIHNldENoYXRNZXNzYWdlTWFrZVJlYWQ6IGZ1bmN0aW9uIHNldENoYXRNZXNzYWdlTWFrZVJlYWQoX3JlZiwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIGNvbW1pdDsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICByZXR1cm4gY29tbWl0KCdzZXRDaGF0TWVzc2FnZU1ha2VSZWFkJywgSlNPTi5wYXJzZShkYXRhLmJvZHkpKTsKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlKTsKICAgIH0pKSgpOwogIH0sCiAgZ2V0VW5yZWFkTWVzc2FnZXM6IGZ1bmN0aW9uIGdldFVucmVhZE1lc3NhZ2VzKHN0KSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIG1lc3NlbmdlclNlcnZpY2UuZ2V0VW5yZWFkTWVzc2FnZXMoKS50aGVuKGZ1bmN0aW9uIChycykgewogICAgICAgICAgICAgIHN0LmNvbW1pdCgnc2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50JywgcnMuZGF0YSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMik7CiAgICB9KSkoKTsKICB9LAogIHNlbmRBbm5vdW5jZW1lbnREb2N1bWVudE1hcmtpbmc6IGZ1bmN0aW9uIHNlbmRBbm5vdW5jZW1lbnREb2N1bWVudE1hcmtpbmcoc3QsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wQ2xpZW50U2VuZE1lc3NhZ2UiLCB7CiAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgIGVuZHBvaW50OiAiL2FwcC9hbm5vdW5jZW1lbnREb2N1bWVudE1hcmtpbmciLAogICAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEKICAgICAgICAgICAgfSk7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUzKTsKICAgIH0pKSgpOwogIH0sCiAgc2V0Q2hhdFVucmVhZENvdW50OiBmdW5jdGlvbiBzZXRDaGF0VW5yZWFkQ291bnQoX3JlZjIsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29tbWl0ID0gX3JlZjIuY29tbWl0OwogICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDM7CiAgICAgICAgICAgIHJldHVybiBjb21taXQoJ3NldENoYXRVbnJlYWRDb3VudCcsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU0KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50OiBmdW5jdGlvbiBzZXRDaGF0VW5yZWFkTWVzc2FnQ291bnQoX3JlZjMsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29tbWl0ID0gX3JlZjMuY29tbWl0OwogICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDM7CiAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldENoYXRVbnJlYWRNZXNzYWdDb3VudCIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU1KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0RG9jdW1lbnRNYXJraW5nOiBmdW5jdGlvbiBzZXREb2N1bWVudE1hcmtpbmcoX3JlZjQsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29tbWl0ID0gX3JlZjQuY29tbWl0OwogICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDM7CiAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldE1hcmtldGluZyIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU2KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0Tm90aWZpY2F0aW9uTXNnOiBmdW5jdGlvbiBzZXROb3RpZmljYXRpb25Nc2coX3JlZjUsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29tbWl0ID0gX3JlZjUuY29tbWl0OwogICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDM7CiAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldE5vdGlmaWNhdGlvbiIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU3KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0Q29tbWVudFRhc2s6IGZ1bmN0aW9uIHNldENvbW1lbnRUYXNrKF9yZWY2LCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgICAgdmFyIGNvbW1pdDsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGNvbW1pdCA9IF9yZWY2LmNvbW1pdDsKICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAzOwogICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRDb21tZW50cyIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU4KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0SW5jb21pbmdQZXJzb246IGZ1bmN0aW9uIHNldEluY29taW5nUGVyc29uKF9yZWY3LCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlOSgpIHsKICAgICAgdmFyIGNvbW1pdCwgcGFyc2VkOwogICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkgewogICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29tbWl0ID0gX3JlZjcuY29tbWl0OwogICAgICAgICAgICBwYXJzZWQgPSBKU09OLnBhcnNlKGRhdGEuYm9keSk7CiAgICAgICAgICAgIGlmICghKHBhcnNlZC5kZXZpY2VOYW1lID09PSAnZW50ZXInKSkgewogICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gNzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDU7CiAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldEluY29taW5nUGVyc29uIiwgcGFyc2VkKTsKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSA5OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSA5OwogICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRFeGl0aW5nUGVyc29uIiwgcGFyc2VkKTsKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuc3RvcCgpOwogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTkpOwogICAgfSkpKCk7CiAgfSwKICBzZXRHcm91cFVwZGF0ZTogZnVuY3Rpb24gc2V0R3JvdXBVcGRhdGUoX3JlZjgpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMCgpIHsKICAgICAgdmFyIGNvbW1pdDsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMCkgewogICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MTAucHJldiA9IF9jb250ZXh0MTAubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjb21taXQgPSBfcmVmOC5jb21taXQ7CiAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDM7CiAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldEdyb3VwVXBkYXRlRSIsIGZhbHNlKTsKICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUxMCk7CiAgICB9KSkoKTsKICB9LAogIHNldE1lc3NhZ2U6IGZ1bmN0aW9uIHNldE1lc3NhZ2UoX3JlZjksIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMSgpIHsKICAgICAgdmFyIGNvbW1pdDsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MTEucHJldiA9IF9jb250ZXh0MTEubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjb21taXQgPSBfcmVmOS5jb21taXQ7CiAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDM7CiAgICAgICAgICAgIHJldHVybiBjb21taXQoInB1c2hDaGF0TGlzdCIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5zdG9wKCk7CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMTEpOwogICAgfSkpKCk7CiAgfSwKICBzZXRHcm91cE1lc3NhZ2U6IGZ1bmN0aW9uIHNldEdyb3VwTWVzc2FnZShfcmVmMTAsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMigpIHsKICAgICAgdmFyIGNvbW1pdDsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMiQoX2NvbnRleHQxMikgewogICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MTIucHJldiA9IF9jb250ZXh0MTIubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjb21taXQgPSBfcmVmMTAuY29tbWl0OwogICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAzOwogICAgICAgICAgICByZXR1cm4gY29tbWl0KCJwdXNoR3JvdXBDb3VudCIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDU7CiAgICAgICAgICAgIHJldHVybiBjb21taXQoInB1c2hHcm91cENoYXRMaXN0IiwgSlNPTi5wYXJzZShkYXRhLmJvZHkpKTsKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUxMik7CiAgICB9KSkoKTsKICB9LAogIHNlbmRNZXNzYWdlOiBmdW5jdGlvbiBzZW5kTWVzc2FnZShzdCwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKCkgewogICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7CiAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQxMy5wcmV2ID0gX2NvbnRleHQxMy5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcENsaWVudFNlbmRNZXNzYWdlIiwgewogICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICBlbmRwb2ludDogIi9hcHAvc2VuZE1lc3NhZ2UiLAogICAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEKICAgICAgICAgICAgfSk7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMTMpOwogICAgfSkpKCk7CiAgfSwKICBzZW5kTWVzc2FnZUdyb3VwOiBmdW5jdGlvbiBzZW5kTWVzc2FnZUdyb3VwKHN0LCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTQoKSB7CiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTQkKF9jb250ZXh0MTQpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDE0LnByZXYgPSBfY29udGV4dDE0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wQ2xpZW50U2VuZE1lc3NhZ2UiLCB7CiAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgIGVuZHBvaW50OiAiL2FwcC9zZW5kR3JvdXBNZXNzYWdlIiwKICAgICAgICAgICAgICBtZXNzYWdlOiBkYXRhCiAgICAgICAgICAgIH0pOwogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTE0KTsKICAgIH0pKSgpOwogIH0sCiAgYWxsVW5yZWFkTWVzc2FnZXM6IGZ1bmN0aW9uIGFsbFVucmVhZE1lc3NhZ2VzKHN0KSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTUoKSB7CiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTUkKF9jb250ZXh0MTUpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDE1LnByZXYgPSBfY29udGV4dDE1Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wQ2xpZW50U2VuZE1lc3NhZ2UiLCB7CiAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgIGVuZHBvaW50OiAiL2FwcC9hbGxVbnJlYWRNZXNzYWdlcyIsCiAgICAgICAgICAgICAgbWVzc2FnZTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgdXNlcl9pZDogSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcl9pZCIpKQogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pOwogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTUuc3RvcCgpOwogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTE1KTsKICAgIH0pKSgpOwogIH0sCiAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoc3QpIHsKICAgIHZhciBfYXJndW1lbnRzID0gYXJndW1lbnRzOwogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI1KCkgewogICAgICB2YXIgdXNyLCB1c2VybmFtZSwgZnVsbE5hbWU7CiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMjUkKF9jb250ZXh0MjUpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDI1LnByZXYgPSBfY29udGV4dDI1Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgdXNyID0gX2FyZ3VtZW50cy5sZW5ndGggPiAxICYmIF9hcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmd1bWVudHNbMV0gOiBudWxsOwogICAgICAgICAgICB1c2VybmFtZSA9IG51bGwsIGZ1bGxOYW1lID0gbnVsbDsKICAgICAgICAgICAgaWYgKCF1c3IpIHsKICAgICAgICAgICAgICB1c2VybmFtZSA9IFRva2VuU2VydmljZS5nZXRVc2VySW5mbygpID8gVG9rZW5TZXJ2aWNlLmdldFVzZXJJbmZvKCkudXNlcm5hbWUgOiBudWxsOwogICAgICAgICAgICAgIGZ1bGxOYW1lID0gVG9rZW5TZXJ2aWNlLmdldFVzZXJJbmZvKCkgPyBUb2tlblNlcnZpY2UuZ2V0VXNlckluZm8oKS5lbXBsb3llZUZ1bGxOYW1lIDogbnVsbDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB1c2VybmFtZSA9IHVzcjsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBsZXQgb3duZXJJZCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJfaWQiKSk7CiAgICAgICAgICAgIGlmICh1c2VybmFtZSB8fCBmdWxsTmFtZSkgewogICAgICAgICAgICAgIGlmICh1c3IgPT09ICdzZWN1cml0eScpIHsKICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJjb25uZWN0IikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci9zZWN1cml0eS9pbmNvbWluZ1BlcnNvbiIsCiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2sgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNihkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTYkKF9jb250ZXh0MTYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDE2LnByZXYgPSBfY29udGV4dDE2Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldEluY29taW5nUGVyc29uIiwgZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTYpOwogICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3gpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jYWxsYmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrOwogICAgICAgICAgICAgICAgICAgIH0oKQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgiY29ubmVjdCIpLnRoZW4oIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHZhciBfcmVmMTEgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNyhzKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNyQoX2NvbnRleHQxNykgewogICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQxNy5wcmV2ID0gX2NvbnRleHQxNy5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBDbGllbnRTZW5kTWVzc2FnZSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL2FwcC9yZWdpc3RlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB1c2VybmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTcuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxNyk7CiAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjExLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9KCkpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBTdWJzY3JpYmUiLCB7CiAgICAgICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL3VzZXIvIi5jb25jYXQodXNlcm5hbWUsICIvbXNnIiksCiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2syID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTgoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE4JChfY29udGV4dDE4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQxOC5wcmV2ID0gX2NvbnRleHQxOC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXRNZXNzYWdlIiwgZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTgpOwogICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3gzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2syLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci8iLmNvbmNhdCh1c2VybmFtZSwgIi9ncm91cE1zZyIpLAogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NhbGxiYWNrMyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE5KGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxOSQoX2NvbnRleHQxOSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MTkucHJldiA9IF9jb250ZXh0MTkubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0R3JvdXBNZXNzYWdlIiwgZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOS5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTkpOwogICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3g0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2szLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci8iLmNvbmNhdCh1c2VybmFtZSwgIi9kb2N1bWVudE1hcmtpbmciKSwKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIF9jYWxsYmFjazQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyMChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMjAkKF9jb250ZXh0MjApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDIwLnByZXYgPSBfY29udGV4dDIwLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldERvY3VtZW50TWFya2luZyIsIGRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjAuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTIwKTsKICAgICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKF94NSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NhbGxiYWNrNC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrOwogICAgICAgICAgICAgICAgICAgIH0oKQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBTdWJzY3JpYmUiLCB7CiAgICAgICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL3VzZXIvIi5jb25jYXQodXNlcm5hbWUsICIvbm90aWZpY2F0aW9uTXNnIiksCiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2s1ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMjEoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIxJChfY29udGV4dDIxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQyMS5wcmV2ID0gX2NvbnRleHQyMS5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXROb3RpZmljYXRpb25Nc2ciLCBkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldENvdW50IiwgbnVsbCwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMS5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjEpOwogICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3g2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2s1LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC8vIC50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgIC8vICAgICBzdC5kaXNwYXRjaCgic3RvbXBTdWJzY3JpYmUiLCB7CiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgIC8vICAgICAgICAgZW5kcG9pbnQ6IGAvdXNlci8ke2Z1bGxOYW1lfS9jb21tZW50TWdzYCwKICAgICAgICAgICAgICAgIC8vICAgICAgICAgY2FsbGJhY2s6IGFzeW5jIChkYXRhKSA9PiB7CiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0Q29tbWVudFRhc2siLCBkYXRhKTsKICAgICAgICAgICAgICAgIC8vICAgICAgICAgfSwKICAgICAgICAgICAgICAgIC8vICAgICB9KTsKICAgICAgICAgICAgICAgIC8vIH0pCiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci8iLmNvbmNhdCh1c2VybmFtZSwgIi91bnJlYWRNZXNzYWdlcyIpLAogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NhbGxiYWNrNiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIyKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMiQoX2NvbnRleHQyMikgewogICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MjIucHJldiA9IF9jb250ZXh0MjIubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50IiwgZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjIpOwogICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3g3KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2s2LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci8iLmNvbmNhdCh1c2VybmFtZSwgIi91bnJlYWRNZXNzYWdlIiksCiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2s3ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMjMoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIzJChfY29udGV4dDIzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQyMy5wcmV2ID0gX2NvbnRleHQyMy5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXRDaGF0VW5yZWFkQ291bnQiLCBkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIzLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUyMyk7CiAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhfeDgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jYWxsYmFjazcuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjazsKICAgICAgICAgICAgICAgICAgICB9KCkKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wU3Vic2NyaWJlIiwgewogICAgICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgICAgICBlbmRwb2ludDogIi91c2VyLyIuY29uY2F0KHVzZXJuYW1lLCAiL21ha2VSZWFkIiksCiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2s4ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMjQoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI0JChfY29udGV4dDI0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQyNC5wcmV2ID0gX2NvbnRleHQyNC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXRDaGF0TWVzc2FnZU1ha2VSZWFkIiwgZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjQpOwogICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3g5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2s4LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNS5zdG9wKCk7CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMjUpOwogICAgfSkpKCk7CiAgfSwKICBjb25uZWN0OiBmdW5jdGlvbiBjb25uZWN0KF9yZWYxMikgewogICAgdmFyIGNvbW1pdCA9IF9yZWYxMi5jb21taXQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBnbG9iYWxTdG9tcENsaWVudCA9IFN0b21wLm92ZXIobmV3IFNvY2tKUygiIi5jb25jYXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9XRUJTT0NLRVRfQVBJLCAiL2dzLWd1aWRlLXdlYnNvY2tldCIpKSk7CiAgICAgIGlmIChnbG9iYWxTdG9tcENsaWVudCkgewogICAgICAgIGdsb2JhbFN0b21wQ2xpZW50Lmhhc0RlYnVnID0gZmFsc2U7CiAgICAgIH0KICAgICAgZ2xvYmFsU3RvbXBDbGllbnQuY29ubmVjdCh7fSwgZnVuY3Rpb24gKGZyYW1lKSB7CiAgICAgICAgcmV0dXJuIHJlc29sdmUoZ2xvYmFsU3RvbXBDbGllbnQpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgc3RvbXBDbGllbnRTZW5kTWVzc2FnZTogZnVuY3Rpb24gc3RvbXBDbGllbnRTZW5kTWVzc2FnZShzdCwgX3JlZjEzKSB7CiAgICB2YXIgc3RvbXBDbGllbnQgPSBfcmVmMTMuc3RvbXBDbGllbnQsCiAgICAgIGVuZHBvaW50ID0gX3JlZjEzLmVuZHBvaW50LAogICAgICBtZXNzYWdlID0gX3JlZjEzLm1lc3NhZ2U7CiAgICBzdG9tcENsaWVudC5zZW5kKGVuZHBvaW50LCBtZXNzYWdlKTsKICB9LAogIHN0b21wU3Vic2NyaWJlOiBmdW5jdGlvbiBzdG9tcFN1YnNjcmliZShzdCwgX3JlZjE0KSB7CiAgICB2YXIgc3RvbXBDbGllbnQgPSBfcmVmMTQuc3RvbXBDbGllbnQsCiAgICAgIGVuZHBvaW50ID0gX3JlZjE0LmVuZHBvaW50LAogICAgICBjYWxsYmFjayA9IF9yZWYxNC5jYWxsYmFjazsKICAgIHN0b21wQ2xpZW50LnN1YnNjcmliZShlbmRwb2ludCwgY2FsbGJhY2spOwogICAgcmV0dXJuIHN0b21wQ2xpZW50OwogIH0sCiAgZ2V0QnlDaGF0SWQ6IGZ1bmN0aW9uIGdldEJ5Q2hhdElkKF9yZWYxNSwgcGFyYW1zKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMjYoKSB7CiAgICAgIHZhciBjb21taXQsIHJlczsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyNiQoX2NvbnRleHQyNikgewogICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MjYucHJldiA9IF9jb250ZXh0MjYubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjb21taXQgPSBfcmVmMTUuY29tbWl0OwogICAgICAgICAgICBfY29udGV4dDI2LnByZXYgPSAxOwogICAgICAgICAgICBfY29udGV4dDI2Lm5leHQgPSA0OwogICAgICAgICAgICByZXR1cm4gbWVzc2VuZ2VyU2VydmljZS5nZXRCeUNoYXRJZChwYXJhbXMpOwogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICByZXMgPSBfY29udGV4dDI2LnNlbnQ7CiAgICAgICAgICAgIF9jb250ZXh0MjYubmV4dCA9IDc7CiAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldExpc3RDaGF0TWVzc2VnZXMiLCByZXMuZGF0YSA/IHJlcy5kYXRhIDogewogICAgICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgICAgICAgIHRvdGFsOiAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBfY29udGV4dDI2Lm5leHQgPSAxMzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIF9jb250ZXh0MjYucHJldiA9IDk7CiAgICAgICAgICAgIF9jb250ZXh0MjYudDAgPSBfY29udGV4dDI2WyJjYXRjaCJdKDEpOwogICAgICAgICAgICBfY29udGV4dDI2Lm5leHQgPSAxMzsKICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TGlzdENoYXRNZXNzZWdlcyIsIHsKICAgICAgICAgICAgICBsaXN0OiBbXSwKICAgICAgICAgICAgICB0b3RhbDogMAogICAgICAgICAgICB9KTsKICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMjYsIG51bGwsIFtbMSwgOV1dKTsKICAgIH0pKSgpOwogIH0sCiAgZ2V0QnlHcm91cENoYXRJZDogZnVuY3Rpb24gZ2V0QnlHcm91cENoYXRJZChfcmVmMTYsIHBhcmFtcykgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI3KCkgewogICAgICB2YXIgY29tbWl0LCByZXM7CiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMjckKF9jb250ZXh0MjcpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDI3LnByZXYgPSBfY29udGV4dDI3Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29tbWl0ID0gX3JlZjE2LmNvbW1pdDsKICAgICAgICAgICAgX2NvbnRleHQyNy5wcmV2ID0gMTsKICAgICAgICAgICAgX2NvbnRleHQyNy5uZXh0ID0gNDsKICAgICAgICAgICAgcmV0dXJuIG1lc3NlbmdlclNlcnZpY2UuZ2V0QnlHcm91cENoYXRJZChwYXJhbXMpOwogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICByZXMgPSBfY29udGV4dDI3LnNlbnQ7CiAgICAgICAgICAgIF9jb250ZXh0MjcubmV4dCA9IDc7CiAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldExpc3RHcm91cENoYXRNZXNzZWdlcyIsIHJlcy5kYXRhID8gcmVzLmRhdGEgOiB7CiAgICAgICAgICAgICAgbGlzdDogW10sCiAgICAgICAgICAgICAgdG90YWw6IDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIF9jb250ZXh0MjcubmV4dCA9IDEzOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgX2NvbnRleHQyNy5wcmV2ID0gOTsKICAgICAgICAgICAgX2NvbnRleHQyNy50MCA9IF9jb250ZXh0MjdbImNhdGNoIl0oMSk7CiAgICAgICAgICAgIF9jb250ZXh0MjcubmV4dCA9IDEzOwogICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRMaXN0R3JvdXBDaGF0TWVzc2VnZXMiLCB7CiAgICAgICAgICAgICAgbGlzdDogW10sCiAgICAgICAgICAgICAgdG90YWw6IDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mjcuc3RvcCgpOwogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTI3LCBudWxsLCBbWzEsIDldXSk7CiAgICB9KSkoKTsKICB9LAogIGdldENvbnRhY3RMaXN0OiBmdW5jdGlvbiBnZXRDb250YWN0TGlzdChfcmVmMTcsIHBhcmFtcykgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI4KCkgewogICAgICB2YXIgY29tbWl0LCByZXM7CiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMjgkKF9jb250ZXh0MjgpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDI4LnByZXYgPSBfY29udGV4dDI4Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY29tbWl0ID0gX3JlZjE3LmNvbW1pdDsKICAgICAgICAgICAgX2NvbnRleHQyOC5wcmV2ID0gMTsKICAgICAgICAgICAgX2NvbnRleHQyOC5uZXh0ID0gNDsKICAgICAgICAgICAgcmV0dXJuIG1lc3NlbmdlclNlcnZpY2UuZ2V0Q29udGFjdExpc3QocGFyYW1zKTsKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgcmVzID0gX2NvbnRleHQyOC5zZW50OwogICAgICAgICAgICBfY29udGV4dDI4Lm5leHQgPSA3OwogICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRMaXN0UmVzcG9uc2UiLCByZXMuZGF0YSA/IHJlcy5kYXRhIDogewogICAgICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgICAgICAgIHRvdGFsOiAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBfY29udGV4dDI4Lm5leHQgPSAxMzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIF9jb250ZXh0MjgucHJldiA9IDk7CiAgICAgICAgICAgIF9jb250ZXh0MjgudDAgPSBfY29udGV4dDI4WyJjYXRjaCJdKDEpOwogICAgICAgICAgICBfY29udGV4dDI4Lm5leHQgPSAxMzsKICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TGlzdFJlc3BvbnNlIiwgewogICAgICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgICAgICAgIHRvdGFsOiAwCiAgICAgICAgICAgIH0pOwogICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI4LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyOCwgbnVsbCwgW1sxLCA5XV0pOwogICAgfSkpKCk7CiAgfSwKICBnZXRHcm91cENoYXRMaXN0OiBmdW5jdGlvbiBnZXRHcm91cENoYXRMaXN0KF9yZWYxOCwgcGFyYW1zKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMjkoKSB7CiAgICAgIHZhciBjb21taXQsIHJlczsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyOSQoX2NvbnRleHQyOSkgewogICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0MjkucHJldiA9IF9jb250ZXh0MjkubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjb21taXQgPSBfcmVmMTguY29tbWl0OwogICAgICAgICAgICBfY29udGV4dDI5LnByZXYgPSAxOwogICAgICAgICAgICBfY29udGV4dDI5Lm5leHQgPSA0OwogICAgICAgICAgICByZXR1cm4gbWVzc2VuZ2VyU2VydmljZS5ncm91cENoYXRMaXN0KHBhcmFtcyk7CiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0Mjkuc2VudDsKICAgICAgICAgICAgX2NvbnRleHQyOS5uZXh0ID0gNzsKICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TGlzdFJlc3BvbnNlR3JvdXBDaGF0IiwgcmVzLmRhdGEgPyByZXMuZGF0YSA6IHsKICAgICAgICAgICAgICBsaXN0OiBbXSwKICAgICAgICAgICAgICB0b3RhbDogMAogICAgICAgICAgICB9KTsKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgX2NvbnRleHQyOS5uZXh0ID0gMTM7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICBfY29udGV4dDI5LnByZXYgPSA5OwogICAgICAgICAgICBfY29udGV4dDI5LnQwID0gX2NvbnRleHQyOVsiY2F0Y2giXSgxKTsKICAgICAgICAgICAgX2NvbnRleHQyOS5uZXh0ID0gMTM7CiAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldExpc3RSZXNwb25zZUdyb3VwQ2hhdCIsIHsKICAgICAgICAgICAgICBsaXN0OiBbXSwKICAgICAgICAgICAgICB0b3RhbDogMAogICAgICAgICAgICB9KTsKICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyOS5zdG9wKCk7CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMjksIG51bGwsIFtbMSwgOV1dKTsKICAgIH0pKSgpOwogIH0KfTs="},null]}