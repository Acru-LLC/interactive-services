{"remainingRequest":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\projects\\members.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\modules\\projects\\members.vue","mtime":1677039624505},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\babel.config.js","mtime":1667352074157},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1675061970665},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1675061970715}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiQzovQUNSVSBQUk9KRUNUL0ZhaXIgVGVjaC9hY3J1LWZyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovQUNSVSBQUk9KRUNUL0ZhaXIgVGVjaC9hY3J1LWZyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCBwcm9qZWN0U2VydmljZSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9wcm9qZWN0U2VydmljZSI7CmltcG9ydCBzaW1wbGViYXIgZnJvbSAic2ltcGxlYmFyLXZ1ZSI7CmltcG9ydCBNZW1iZXJzIGZyb20gIkAvY29tcG9uZW50cy9tZW1iZXJzIjsKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiBbImhlaWdodFByb3AiLCAiY2xvc2UiLCAiaXNNZW1iZXJzIiwgInByb2plY3QiXSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcGFyYW1zOiB7CiAgICAgICAgcGFnZTogMCwKICAgICAgICBpdGVtc1BlclBhZ2U6IDIwCiAgICAgIH0sCiAgICAgIG1lbWJlcnM6IFtdLAogICAgICBtZW1iZXJQYWdlOiAwLAogICAgICBpc01vZGFsOiBmYWxzZSwKICAgICAgY21wS2V5OiAwCiAgICB9OwogIH0sCiAgLyoNCiAgICBDT01QVVRFRCAqLwogIGNvbXB1dGVkOiB7CiAgICBwcm9qZWN0VHlwZTogZnVuY3Rpb24gcHJvamVjdFR5cGUoKSB7CiAgICAgIHJldHVybiB0aGlzLiRyb3V0ZS5uYW1lID09PSAnQ29tbWlzc2lvblByb2plY3RzJyA/ICdDT01NSVNTSU9OJyA6ICdCRUZPUkVfQ09NTUlTU0lPTic7CiAgICB9LAogICAgaXNDb21taXNzaW9uOiBmdW5jdGlvbiBpc0NvbW1pc3Npb24oKSB7CiAgICAgIHJldHVybiB0aGlzLnByb2plY3RUeXBlID09PSAnQ09NTUlTU0lPTic7CiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBzaW1wbGViYXI6IHNpbXBsZWJhciwKICAgIE1lbWJlcnM6IE1lbWJlcnMKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICBpZiAodGhpcy4kcm91dGUucXVlcnkucGFnZSA9PT0gIm92ZXJ2aWV3IiB8fCB0aGlzLiRyb3V0ZS5xdWVyeS5wYWdlID09PSAidGFza3MiKSB7CiAgICAgIHRoaXMubGlzdE1lbWJlcnMoKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHJlY2FsY3VsYXRlOiBmdW5jdGlvbiByZWNhbGN1bGF0ZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdGhpcy5jbXBLZXkgKz0gMTsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMuc2Nyb2xsQWN0aXZlKCk7CiAgICAgIH0sIDIwMCk7CiAgICB9LAogICAgc2Nyb2xsQWN0aXZlOiBmdW5jdGlvbiBzY3JvbGxBY3RpdmUoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICAvLyBDb250YWN0IGxpc3QgYWN0aW9ucwogICAgICBpZiAodGhpcy5pc01lbWJlcnMpIHsKICAgICAgICB0aGlzLiRyZWZzLm1lbWJlcnNSZWYuU2ltcGxlQmFyLmdldFNjcm9sbEVsZW1lbnQoKS5hZGRFdmVudExpc3RlbmVyKCJzY3JvbGwiLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIF9ldmVudCR0YXJnZXQgPSBldmVudC50YXJnZXQsCiAgICAgICAgICAgIHNjcm9sbFRvcCA9IF9ldmVudCR0YXJnZXQuc2Nyb2xsVG9wLAogICAgICAgICAgICBzY3JvbGxIZWlnaHQgPSBfZXZlbnQkdGFyZ2V0LnNjcm9sbEhlaWdodCwKICAgICAgICAgICAgY2xpZW50SGVpZ2h0ID0gX2V2ZW50JHRhcmdldC5jbGllbnRIZWlnaHQ7CiAgICAgICAgICB2YXIgb2Zmc2V0Rm9yVHJpZ2dlciA9IDE7CiAgICAgICAgICBpZiAoc2Nyb2xsSGVpZ2h0IC0gY2xpZW50SGVpZ2h0IC0gb2Zmc2V0Rm9yVHJpZ2dlciA8IHNjcm9sbFRvcCkgewogICAgICAgICAgICBfdGhpczIubG9hZE1vcmVNZW1iZXJzKF90aGlzMi5tZW1iZXJQYWdlICs9IDEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgc2F2ZTogZnVuY3Rpb24gc2F2ZShtZW1iZXJzKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwogICAgICB2YXIgcHJvamVjdElkID0gdGhpcy4kcm91dGUucXVlcnkuaWQ7CiAgICAgIGlmIChtZW1iZXJzLmxlbmd0aCA+IDApIHsKICAgICAgICBwcm9qZWN0U2VydmljZS5hZGRNZW1iZXIocHJvamVjdElkLCBtZW1iZXJzLm1hcChmdW5jdGlvbiAoZW1wKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBlbXBsb3llZUlkOiBlbXAuZW1wbG95ZWVJZCwKICAgICAgICAgICAgbWFpbGluZ1B1cnBvc2VJZDogZW1wLm1haWxpbmdQdXJwb3NlSWQKICAgICAgICAgIH07CiAgICAgICAgfSkpLnRoZW4oZnVuY3Rpb24gKHJzKSB7CiAgICAgICAgICBfdGhpczMuc3VjY2Vzc1NhdmVkKCk7CiAgICAgICAgICBfdGhpczMuaXNNb2RhbCA9IGZhbHNlOwogICAgICAgICAgX3RoaXMzLmxpc3RNZW1iZXJzKCk7CiAgICAgICAgICBfdGhpczMuJGVtaXQoInN1Y2Nlc3MiKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAvLyB0aGlzLmNhdGNoRXJyKGVycik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBkZWxldGVNZW1iZXI6IGZ1bmN0aW9uIGRlbGV0ZU1lbWJlcihpZCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKICAgICAgdmFyIHByb2plY3RJZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmlkOwogICAgICB0aGlzLmNuZigpLnRoZW4oZnVuY3Rpb24gKHYpIHsKICAgICAgICBpZiAodi52YWx1ZSkgewogICAgICAgICAgcHJvamVjdFNlcnZpY2UuZGVsZXRlTWVtYmVyKHByb2plY3RJZCwgaWQpLnRoZW4oZnVuY3Rpb24gKHJzKSB7CiAgICAgICAgICAgIF90aGlzNC5kZWxldGVTdWNjZXNzKCk7CiAgICAgICAgICAgIF90aGlzNC5saXN0TWVtYmVycygpOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICAvLyB0aGlzLmNhdGNoRXJyKGVycik7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGNsaWNrQWRkOiBmdW5jdGlvbiBjbGlja0FkZCgpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CiAgICAgIHRoaXMuaXNNb2RhbCA9IHRydWU7CiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzNS4kcmVmcy5lbXBNZW1iZXJzUmVmLnJlc2V0KCk7CiAgICAgIH0pOwogICAgfSwKICAgIGxlYXZlTWVtYmVyOiBmdW5jdGlvbiBsZWF2ZU1lbWJlcihjbXQpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CiAgICAgIHZhciBpZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmlkOwogICAgICBpZiAoaWQpIHsKICAgICAgICBwcm9qZWN0U2VydmljZS5sZWF2ZUNvbW1lbnQoaWQsIG51bGwsIGNtdCkudGhlbihmdW5jdGlvbiAocnMpIHsKICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBfdGhpczYubGlzdE1lbWJlcnMoKTsKICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgLy8gdGhpcy5jYXRjaEVycihlcnIpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJvdXRlci5nbygtMSk7CiAgICAgIH0KICAgIH0sCiAgICBsaXN0TWVtYmVyczogZnVuY3Rpb24gbGlzdE1lbWJlcnMoKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwogICAgICB2YXIgaWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5pZDsKICAgICAgaWYgKGlkKSB7CiAgICAgICAgcHJvamVjdFNlcnZpY2UubGlzdE1lbWJlcnMoaWQsIHRoaXMucGFyYW1zLCB0aGlzLnByb2plY3RUeXBlKS50aGVuKGZ1bmN0aW9uIChycykgewogICAgICAgICAgX3RoaXM3Lm1lbWJlcnMgPSBycy5kYXRhLmxpc3Q7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgLy8gdGhpcy5jYXRjaEVycihlcnIpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJvdXRlci5nbygtMSk7CiAgICAgIH0KICAgIH0sCiAgICBsb2FkTW9yZU1lbWJlcnM6IGZ1bmN0aW9uIGxvYWRNb3JlTWVtYmVycyhwYWdlKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwogICAgICB2YXIgaWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5pZDsKICAgICAgaWYgKGlkKSB7CiAgICAgICAgcHJvamVjdFNlcnZpY2UubGlzdE1lbWJlcnMoaWQsIHsKICAgICAgICAgIHBhZ2U6IHRoaXMubWVtYmVyUGFnZSArPSAxLAogICAgICAgICAgaXRlbXNQZXJQYWdlOiAyMAogICAgICAgIH0sIHRoaXMucHJvamVjdFR5cGUpLnRoZW4oIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgX3JlZjIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoX3JlZikgewogICAgICAgICAgICB2YXIgZGF0YTsKICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgZGF0YSA9IF9yZWYuZGF0YTsKICAgICAgICAgICAgICAgICAgaWYgKGRhdGEubGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXM4Lm1lbWJlcnMgPSBfdGhpczgubWVtYmVycy5jb25jYXQoZGF0YS5saXN0KTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczgubWVtYmVyUGFnZSAtPSAyOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgICAgICB9KSk7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgICAgICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICB9KCkpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJvdXRlci5nbygtMSk7CiAgICAgIH0KICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXM5ID0gdGhpczsKICAgIHZhciBjb250YWluZXIzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI21lbWJlci1saXN0IC5zaW1wbGViYXItY29udGVudC13cmFwcGVyIik7CiAgICBpZiAoY29udGFpbmVyMykgewogICAgICBjb250YWluZXIzLnNjcm9sbFRvKHsKICAgICAgICB0b3A6IDUwMCwKICAgICAgICBiZWhhdmlvcjogInNtb290aCIKICAgICAgfSk7CiAgICB9CiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXM5LnNjcm9sbEFjdGl2ZSgpOwogICAgfSwgMjAwKTsKICB9Cn07"},{"version":3,"mappings":";;;;;AAgGA;AACA;AACA;AAEA;EACAA;EACAC;IACA;MACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACA;AACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACAC;IACAC;EACA;EACAC;IACA,IACA,yCACA,oCACA;MACA;IACA;EACA;EACAC;IACAC;MAAA;MACA;MACAC;QACA;MACA;IACA;IACAC;MAAA;MACA;MACA;QACA,oEACA,UACA;UACA;YAAAC;YAAAC;YAAAC;UACA;UACA;YACA;UACA;QACA,EACA;MACA;IACA;IACAC;MAAA;MACA;MACA;QACAC,eACAC;UACA;YAAAC;YAAAC;UAAA;QACA,IACAC;UACA;UACA;UACA;UACA;QACA,GACAC;UACA;QAAA,CACA;MACA;IACA;IACAC;MAAA;MACA;MACA;QACA;UACAN,eACAM,4BACAF;YACA;YACA;UACA,GACAC;YACA;UAAA,CACA;QACA;MACA;IACA;IACAE;MAAA;MACA;MACAb;QACA;MACA;IACA;IACAc;MAAA;MACA;MACA;QACAR,eACAS,4BACAL;UACAV;YACA;UACA;QACA,GACAW;UACA;QAAA,CACA;MACA;QACA;MACA;IACA;IACAK;MAAA;MACA;MACA;QACAV,eACAU,+CACAN;UACA;QACA,GACAC;UACA;QAAA,CACA;MACA;QACA;MACA;IACA;IACAM;MAAA;MACA;MACA;QACAX,eACAU;UACA/B;UACAC;QACA,qBACAwB;UAAA;YAAA;YAAA;cAAA;gBAAA;kBAAA3B;kBACA;oBACA;kBACA;oBACA;kBACA;gBAAA;gBAAA;kBAAA;cAAA;YAAA;UAAA,CACA;UAAA;YAAA;UAAA;QAAA;MACA;QACA;MACA;IACA;EACA;EACAmC;IAAA;IACA,wCACA,0CACA;IACA;MACAC;QAAAC;QAAAC;MAAA;IACA;IACArB;MACA;IACA;EACA;AACA","names":["props","data","params","page","itemsPerPage","members","memberPage","isModal","cmpKey","computed","projectType","isCommission","components","simplebar","Members","created","methods","recalculate","setTimeout","scrollActive","scrollTop","scrollHeight","clientHeight","save","projectService","addMember","employeeId","mailingPurposeId","then","catch","deleteMember","clickAdd","leaveMember","leaveComment","listMembers","loadMoreMembers","mounted","container3","top","behavior"],"sourceRoot":"src/modules/projects","sources":["members.vue"],"sourcesContent":["<template>\r\n  <div class=\"card mb-0\">\r\n    <div class=\"card-body\">\r\n      <h4 class=\"card-title mb-4\">{{ $t('members') }}</h4>\r\n      <simplebar\r\n          :key=\"cmpKey+'MEMBER'\"\r\n          data-simplebar-auto-hide=\"false\"\r\n          :style=\"`height: ${heightProp}px`\"\r\n          id=\"member-list\"\r\n          ref=\"membersRef\"\r\n      >\r\n        <div class=\"table-responsive\">\r\n          <table class=\"table table-centered\">\r\n            <tbody>\r\n            <tr v-for=\"(member, index) in members\" :key=\"index\">\r\n              <td style=\"width: 50px;\">\r\n                <img\r\n                    v-if=\"!member.employeePhotoUploadPath\"\r\n                    :src=\"`${hrUrl}/${member.employeePhotoUploadPath}`\"\r\n                    class=\"rounded-circle avatar-xs\"\r\n                    alt\r\n                />\r\n                <div v-else class=\"avatar-xs mr-3\">\r\n                  <span class=\"avatar-title rounded-circle bg-soft-primary text-white font-size-16\">\r\n                      {{ `${member.firstName.charAt(0)}${member.lastName.charAt(0)}` }}\r\n                  </span>\r\n                </div>\r\n              </td>\r\n              <td style=\"vertical-align: middle\">\r\n                <h5 class=\"font-size-14 m-0\">\r\n                  <p href=\"#\" class=\"text-dark m-0 p-0\">\r\n                    {{ `${member.lastName} ${member.firstName} ${member.middleName}` }}\r\n                  </p>\r\n                </h5>\r\n                <p class=\"m-0 text-muted\">\r\n                  {{ getName({ nameLt: member.departmentNameLt, nameUz: member.departmentNameUz, nameRu: member.departmentNameRu }) }}\r\n                </p>\r\n                <p class=\"m-0 text-muted\">\r\n                  {{ getName({ nameLt: member.staffPositionNameLt, nameUz: member.staffPositionNameUz, nameRu: member.staffPositionNameRu }) }}\r\n                </p>\r\n                <p class=\"m-0\" v-if=\"member.mailingPurposeId\">\r\n                  {{ getName({ nameLt: member.mailingPurposeNameLt, nameUz: member.mailingPurposeNameUz, nameRu: member.mailingPurposeNameRu }) }}\r\n                </p>\r\n              </td>\r\n              <td>\r\n                <div v-if=\"isCommission\">\r\n                  <i v-if=\"member.isAdmin\" class=\"mdi mdi-shield-account-outline text-success font-size-20 hi\" />\r\n                  <i\r\n                      v-else-if=\"project.isAdmin && !['FINISHED', 'REVIEW_FINISHED', 'TEMPORARILY_CLOSED'].includes(project.status)\"\r\n                      class=\"bx bx-trash font-size-20 hi\"\r\n                      @click.prevent=\"deleteMember(member.employeeId)\"\r\n                  ></i>\r\n                </div>\r\n                <div v-else>\r\n                  <i v-if=\"member.isAdmin\" class=\"mdi mdi-shield-account-outline text-success font-size-20 hi\" />\r\n                  <i\r\n                      v-else-if=\"project.isAdmin && !['FINISHED', 'REVIEW_FINISHED', 'COMMISSION_REVIEW_CLOSED', 'TEMPORARILY_CLOSED'].includes(project.status)\"\r\n                      class=\"bx bx-trash font-size-20 hi\"\r\n                      @click.prevent=\"deleteMember(member.employeeId)\"\r\n                  />\r\n                </div>\r\n              </td>\r\n            </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </simplebar>\r\n    </div>\r\n\r\n    <div class=\"p-3\" v-if=\"project && !['TEMPORARILY_CLOSED', 'REVIEW_FINISHED', 'COMMISSION_REVIEW_CLOSED', 'FINISHED'].includes(project.status)\">\r\n      <div>\r\n        <b-button @click.prevent=\"clickAdd\" variant=\"primary\" block >\r\n          <i class=\"fa fa-user-plus d-block font-size-16\"></i>\r\n          {{ $t('actions.add') }}\r\n        </b-button>\r\n      </div>\r\n    </div>\r\n\r\n    <b-sidebar\r\n        backdrop-variant=\"dark\"\r\n        backdrop\r\n        class=\"sidebar1\"\r\n        shadow\r\n        sidebar-class=\"p-0\"\r\n        :no-header=\"true\"\r\n        right\r\n        v-model=\"isModal\"\r\n    >\r\n      <div>\r\n        <members :notIn=\"true\" for-project v-if=\"isModal\" @save=\"save\" @cancel=\"isModal=false\" ref=\"empMembersRef\" />\r\n      </div>\r\n    </b-sidebar>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport projectService from \"@/shared/services/projectService\";\r\nimport simplebar from \"simplebar-vue\";\r\nimport Members from \"@/components/members\";\r\n\r\nexport default {\r\n  props: [\"heightProp\", \"close\", \"isMembers\", \"project\"],\r\n  data() {\r\n    return {\r\n      params: {\r\n        page: 0,\r\n        itemsPerPage: 20\r\n      },\r\n      members: [],\r\n      memberPage: 0,\r\n      isModal: false,\r\n      cmpKey: 0,\r\n    };\r\n  },\r\n  /*\r\n    COMPUTED */\r\n  computed: {\r\n    projectType() {\r\n      return this.$route.name === 'CommissionProjects' ? 'COMMISSION' : 'BEFORE_COMMISSION'\r\n    },\r\n    isCommission() {\r\n      return this.projectType === 'COMMISSION'\r\n    }\r\n  },\r\n  components: {\r\n    simplebar,\r\n    Members\r\n  },\r\n  created() {\r\n    if (\r\n        this.$route.query.page === \"overview\" ||\r\n        this.$route.query.page === \"tasks\"\r\n    ) {\r\n      this.listMembers();\r\n    }\r\n  },\r\n  methods: {\r\n    recalculate() {\r\n      this.cmpKey += 1;\r\n      setTimeout(() => {\r\n        this.scrollActive();\r\n      }, 200);\r\n    },\r\n    scrollActive() {\r\n      // Contact list actions\r\n      if (this.isMembers) {\r\n        this.$refs.membersRef.SimpleBar.getScrollElement().addEventListener(\r\n            \"scroll\",\r\n            e => {\r\n              let { scrollTop, scrollHeight, clientHeight } = event.target;\r\n              const offsetForTrigger = 1;\r\n              if (scrollHeight - clientHeight - offsetForTrigger < scrollTop) {\r\n                this.loadMoreMembers((this.memberPage += 1));\r\n              }\r\n            }\r\n        );\r\n      }\r\n    },\r\n    save(members) {\r\n      let projectId = this.$route.query.id;\r\n      if (members.length > 0) {\r\n        projectService\r\n            .addMember(projectId, members.map(emp => {\r\n              return { employeeId: emp.employeeId, mailingPurposeId: emp.mailingPurposeId }\r\n            }))\r\n            .then(rs => {\r\n              this.successSaved();\r\n              this.isModal = false;\r\n              this.listMembers();\r\n              this.$emit(\"success\");\r\n            })\r\n            .catch(err => {\r\n              // this.catchErr(err);\r\n            });\r\n      }\r\n    },\r\n    deleteMember(id) {\r\n      let projectId = this.$route.query.id;\r\n      this.cnf().then(v => {\r\n        if (v.value) {\r\n          projectService\r\n              .deleteMember(projectId, id)\r\n              .then(rs => {\r\n                this.deleteSuccess();\r\n                this.listMembers();\r\n              })\r\n              .catch(err => {\r\n                // this.catchErr(err);\r\n              });\r\n        }\r\n      });\r\n    },\r\n    clickAdd() {\r\n      this.isModal = true;\r\n      setTimeout(() => {\r\n        this.$refs.empMembersRef.reset();\r\n      });\r\n    },\r\n    leaveMember(cmt) {\r\n      let id = this.$route.query.id;\r\n      if (id) {\r\n        projectService\r\n            .leaveComment(id, null, cmt)\r\n            .then(rs => {\r\n              setTimeout(() => {\r\n                this.listMembers();\r\n              }, 300);\r\n            })\r\n            .catch(err => {\r\n              // this.catchErr(err);\r\n            });\r\n      } else {\r\n        this.$router.go(-1);\r\n      }\r\n    },\r\n    listMembers() {\r\n      let id = this.$route.query.id;\r\n      if (id) {\r\n        projectService\r\n            .listMembers(id, this.params, this.projectType)\r\n            .then(rs => {\r\n              this.members = rs.data.list;\r\n            })\r\n            .catch(err => {\r\n              // this.catchErr(err);\r\n            });\r\n      } else {\r\n        this.$router.go(-1);\r\n      }\r\n    },\r\n    loadMoreMembers(page) {\r\n      let id = this.$route.query.id;\r\n      if (id) {\r\n        projectService\r\n            .listMembers(id, {\r\n              page: (this.memberPage += 1),\r\n              itemsPerPage: 20\r\n            }, this.projectType)\r\n            .then(async ({ data }) => {\r\n              if (data.list.length > 0) {\r\n                this.members = this.members.concat(data.list);\r\n              } else {\r\n                this.memberPage -= 2;\r\n              }\r\n            });\r\n      } else {\r\n        this.$router.go(-1);\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    var container3 = document.querySelector(\r\n        \"#member-list .simplebar-content-wrapper\"\r\n    );\r\n    if (container3) {\r\n      container3.scrollTo({ top: 500, behavior: \"smooth\" });\r\n    }\r\n    setTimeout(() => {\r\n      this.scrollActive();\r\n    }, 200);\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.sidebar1 {\r\n  .b-sidebar {\r\n    width: 500px;\r\n    background: white;\r\n  }\r\n}\r\n</style>"]}]}