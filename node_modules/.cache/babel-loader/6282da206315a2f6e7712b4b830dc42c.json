{"remainingRequest":"D:\\ACRU\\my-fairtech\\node_modules\\thread-loader\\dist\\cjs.js!D:\\ACRU\\my-fairtech\\node_modules\\babel-loader\\lib\\index.js!D:\\ACRU\\my-fairtech\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\ACRU\\my-fairtech\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\ACRU\\my-fairtech\\src\\shared\\views\\components\\CreateFormContractor.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\ACRU\\my-fairtech\\src\\shared\\views\\components\\CreateFormContractor.vue","mtime":1719222285902},{"path":"D:\\ACRU\\my-fairtech\\babel.config.js","mtime":1719222278287},{"path":"D:\\ACRU\\my-fairtech\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1719222280288},{"path":"D:\\ACRU\\my-fairtech\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1719222284617},{"path":"D:\\ACRU\\my-fairtech\\node_modules\\babel-loader\\lib\\index.js","mtime":1719222279696},{"path":"D:\\ACRU\\my-fairtech\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1719222280288},{"path":"D:\\ACRU\\my-fairtech\\node_modules\\vue-loader\\lib\\index.js","mtime":1719222284893}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJEOi9BQ1JVL215LWZhaXJ0ZWNoL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheS5qcyI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkQ6L0FDUlUvbXktZmFpcnRlY2gvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3JlZ2VuZXJhdG9yUnVudGltZS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJEOi9BQ1JVL215LWZhaXJ0ZWNoL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmpzb24uc3RyaW5naWZ5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltLmpzIjsKLyoqIFlPVSBNVVNUIFNFTkQge3sgTUFJTl9BUElfVVJMIH19IFRPIENSVURfU0VSVklDRSAqLwppbXBvcnQgY3J1ZEFuZExpc3RzU2VydmljZSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9jcnVkX2FuZF9saXN0LnNlcnZpY2UiOwppbXBvcnQgaGVscGVyU2VydmljZSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9oZWxwZXIuc2VydmljZSI7CnZhciBNQUlOX0FQSV9VUkwgPSAnY29udHJhY3Rvcic7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQ3JlYXRlRm9ybUNvbnRyYWN0b3IiLAogIC8qKiBQUk9QUyAqLwogIHByb3BzOiB7CiAgICBjdXN0b21Jc01vZGVDcmVhdGU6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0KICB9LAogIC8qKiBDT01QT05FTlRTICovCiAgY29tcG9uZW50czoge30sCiAgLyoqIERBVEEgKi9kYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm91bmRlcnNGaWVsZHM6IFt7CiAgICAgICAgbGFiZWw6ICIjIiwKICAgICAgICB0aENsYXNzOiAidGV4dC1jZW50ZXIiLAogICAgICAgIHRkQ2xhc3M6ICJ0ZXh0LWNlbnRlciIsCiAgICAgICAgc29ydGFibGU6IGZhbHNlLAogICAgICAgIGtleTogImluZGV4IgogICAgICB9LCB7CiAgICAgICAga2V5OiAnZnVsbE5hbWUnLAogICAgICAgIGxhYmVsOiB0aGlzLiR0KCdjb2x1bW4ubmFtZScpCiAgICAgIH0sIHsKICAgICAgICBrZXk6ICdpbm4nLAogICAgICAgIGxhYmVsOiB0aGlzLiR0KCdjb2x1bW4uaW5uJykKICAgICAgfSwgewogICAgICAgIGtleTogJ3BuZmwnLAogICAgICAgIGxhYmVsOiB0aGlzLiR0KCdjb2x1bW4ucGVyc29uYWxfbnVtYmVyJykKICAgICAgfSwgewogICAgICAgIGtleTogJ3R5cGUnLAogICAgICAgIGxhYmVsOiB0aGlzLiR0KCdjb2x1bW4udHlwZScpCiAgICAgIH0sIHsKICAgICAgICBrZXk6ICdmb3VuZGVyU2hhcmVQZXJjZW50JywKICAgICAgICBsYWJlbDogdGhpcy4kdCgnY29sdW1uLnNoYXJlX3BlcmNlbnRhZ2UnKQogICAgICB9LCB7CiAgICAgICAga2V5OiAnZm91bmRlclNoYXJlU3VtJywKICAgICAgICBsYWJlbDogdGhpcy4kdCgnY29sdW1uLnNoYXJlX3N1bScpCiAgICAgIH1dLAogICAgICBvcmlnaW5hbER0bzogewogICAgICAgIGFkZHJlc3NEdG86IHt9LAogICAgICAgIGZvdW5kZXJzRHRvczogW10KICAgICAgfSwKICAgICAgb3JpZ2luYWxJbm46IG51bGwsCiAgICAgIG9yaWdpbmFsUGluZmw6IG51bGwsCiAgICAgIC8vIENPTlRSQUNUT1IgU0VMRUNUX0FORF9DUkVBVEUgVkFSUwogICAgICBoYXNOZXh0UGFnZUNvbnRyYWN0b3JzOiBmYWxzZSwKICAgICAgY29udHJhY3RvcnM6IFtdLAogICAgICBkZWJvdW5jZTogbnVsbCwKICAgICAgaXNMb2FkaW5nQ29udHJhY3RvcnM6IGZhbHNlLAogICAgICBjb250cmFjdG9yQ3JlYXRlTW9kYWw6IGZhbHNlLAogICAgICBjb250cmFjdG9yU2VhcmNoUGF5bG9hZDoge30sCiAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICBmb3JtT2ZPd25lcnNoaXBzOiBbXSwKICAgICAgcmVnaW9uczogW10sCiAgICAgIGRpc3RyaWN0czogW10sCiAgICAgIHN0YXR1c2VzOiBbXSwKICAgICAgZWRpdGluZ0l0ZW06IHsKICAgICAgICBpc1l1cjogdHJ1ZSwKICAgICAgICBhZGRyZXNzRHRvOiB7fSwKICAgICAgICBmb3VuZGVyc0R0b3M6IFtdCiAgICAgIH0sCiAgICAgIGRlZmF1bHRGb3VuZGVyOiB7CiAgICAgICAgZm91bmRlck5hbWU6IG51bGwsCiAgICAgICAgcGVyY2VudGFnZTogbnVsbAogICAgICB9CiAgICB9OwogIH0sCiAgLyoqIENPTVBVVEVEICovCiAgY29tcHV0ZWQ6IHsKICAgIGlzTW9kZUNyZWF0ZTogZnVuY3Rpb24gaXNNb2RlQ3JlYXRlKCkgewogICAgICByZXR1cm4gdGhpcy5jdXN0b21Jc01vZGVDcmVhdGUgPyB0aGlzLmN1c3RvbUlzTW9kZUNyZWF0ZSA6IHRoaXMuJHJvdXRlLm5hbWUgPT09ICdDcmVhdGVDb250cmFjdG9yJzsKICAgIH0sCiAgICBjb21wdXRlZE9ic2VydmVyOiBmdW5jdGlvbiBjb21wdXRlZE9ic2VydmVyKCkgewogICAgICByZXR1cm4gdGhpcy4kcmVmcy5vYnNlcnZlcjsKICAgIH0sCiAgICBjb21wdXRlZEZvdW5kZXJzRHRvczogZnVuY3Rpb24gY29tcHV0ZWRGb3VuZGVyc0R0b3MoKSB7CiAgICAgIHZhciBfdGhpcyRlZGl0aW5nSXRlbSRyZWc7CiAgICAgIGlmICgoKF90aGlzJGVkaXRpbmdJdGVtJHJlZyA9IHRoaXMuZWRpdGluZ0l0ZW0ucmVnQ29udHJhY3RvckR0bykgPT09IG51bGwgfHwgX3RoaXMkZWRpdGluZ0l0ZW0kcmVnID09PSB2b2lkIDAgfHwgKF90aGlzJGVkaXRpbmdJdGVtJHJlZyA9IF90aGlzJGVkaXRpbmdJdGVtJHJlZy5mb3VuZGVycykgPT09IG51bGwgfHwgX3RoaXMkZWRpdGluZ0l0ZW0kcmVnID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRlZGl0aW5nSXRlbSRyZWcubGVuZ3RoKSA+IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5lZGl0aW5nSXRlbS5yZWdDb250cmFjdG9yRHRvLmZvdW5kZXJzLm1hcChmdW5jdGlvbiAoZm91bmRlciwgaW5kZXgpIHsKICAgICAgICAgIGlmIChmb3VuZGVyLmZvdW5kZXJJbmRpdmlkdWFsKSB7CiAgICAgICAgICAgIHZhciBfZm91bmRlciRmb3VuZGVySW5kaXYsIF9mb3VuZGVyJGZvdW5kZXJJbmRpdjIsIF9mb3VuZGVyJGZvdW5kZXJJbmRpdjMsIF9mb3VuZGVyJGZvdW5kZXJJbmRpdjQsIF9mb3VuZGVyJGZvdW5kZXJJbmRpdjUsIF9mb3VuZGVyJGZvdW5kZXJJbmRpdjY7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgaW5kZXg6IGluZGV4LAogICAgICAgICAgICAgIGZ1bGxOYW1lOiAiIi5jb25jYXQoZm91bmRlci5mb3VuZGVySW5kaXZpZHVhbC5sYXN0TmFtZSwgIiAiKS5jb25jYXQoZm91bmRlci5mb3VuZGVySW5kaXZpZHVhbC5maXJzdE5hbWUsICIgIikuY29uY2F0KGZvdW5kZXIuZm91bmRlckluZGl2aWR1YWwubWlkZGxlTmFtZSksCiAgICAgICAgICAgICAgaW5uOiAoX2ZvdW5kZXIkZm91bmRlckluZGl2ID0gZm91bmRlci5mb3VuZGVySW5kaXZpZHVhbC50aW4pICE9PSBudWxsICYmIF9mb3VuZGVyJGZvdW5kZXJJbmRpdiAhPT0gdm9pZCAwID8gX2ZvdW5kZXIkZm91bmRlckluZGl2IDogbnVsbCwKICAgICAgICAgICAgICBwbmZsOiAoX2ZvdW5kZXIkZm91bmRlckluZGl2MiA9IGZvdW5kZXIuZm91bmRlckluZGl2aWR1YWwucGluZmwpICE9PSBudWxsICYmIF9mb3VuZGVyJGZvdW5kZXJJbmRpdjIgIT09IHZvaWQgMCA/IF9mb3VuZGVyJGZvdW5kZXJJbmRpdjIgOiBudWxsLAogICAgICAgICAgICAgIHR5cGU6IG51bGwsCiAgICAgICAgICAgICAgaXNMZWdhbDogZmFsc2UsCiAgICAgICAgICAgICAgZm91bmRlclNoYXJlUGVyY2VudDogKF9mb3VuZGVyJGZvdW5kZXJJbmRpdjMgPSAoX2ZvdW5kZXIkZm91bmRlckluZGl2NCA9IGZvdW5kZXIuZm91bmRlckluZGl2aWR1YWwpID09PSBudWxsIHx8IF9mb3VuZGVyJGZvdW5kZXJJbmRpdjQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9mb3VuZGVyJGZvdW5kZXJJbmRpdjQuZm91bmRlclNoYXJlUGVyY2VudCkgIT09IG51bGwgJiYgX2ZvdW5kZXIkZm91bmRlckluZGl2MyAhPT0gdm9pZCAwID8gX2ZvdW5kZXIkZm91bmRlckluZGl2MyA6IG51bGwsCiAgICAgICAgICAgICAgZm91bmRlclNoYXJlU3VtOiAoX2ZvdW5kZXIkZm91bmRlckluZGl2NSA9IChfZm91bmRlciRmb3VuZGVySW5kaXY2ID0gZm91bmRlci5mb3VuZGVySW5kaXZpZHVhbCkgPT09IG51bGwgfHwgX2ZvdW5kZXIkZm91bmRlckluZGl2NiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2ZvdW5kZXIkZm91bmRlckluZGl2Ni5mb3VuZGVyU2hhcmVTdW0pICE9PSBudWxsICYmIF9mb3VuZGVyJGZvdW5kZXJJbmRpdjUgIT09IHZvaWQgMCA/IF9mb3VuZGVyJGZvdW5kZXJJbmRpdjUgOiBudWxsCiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoZm91bmRlci5mb3VuZGVyTGVnYWwpIHsKICAgICAgICAgICAgdmFyIF9mb3VuZGVyJGZvdW5kZXJMZWdhbCwgX2ZvdW5kZXIkZm91bmRlckxlZ2FsMiwgX2ZvdW5kZXIkZm91bmRlckxlZ2FsMywgX2ZvdW5kZXIkZm91bmRlckxlZ2FsNCwgX2ZvdW5kZXIkZm91bmRlckxlZ2FsNSwgX2ZvdW5kZXIkZm91bmRlckxlZ2FsNiwgX2ZvdW5kZXIkZm91bmRlckxlZ2FsNywgX2ZvdW5kZXIkZm91bmRlckxlZ2FsODsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICBpbmRleDogaW5kZXgsCiAgICAgICAgICAgICAgZnVsbE5hbWU6IChfZm91bmRlciRmb3VuZGVyTGVnYWwgPSAoX2ZvdW5kZXIkZm91bmRlckxlZ2FsMiA9IGZvdW5kZXIuZm91bmRlckxlZ2FsKSA9PT0gbnVsbCB8fCBfZm91bmRlciRmb3VuZGVyTGVnYWwyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZm91bmRlciRmb3VuZGVyTGVnYWwyLm5hbWUpICE9PSBudWxsICYmIF9mb3VuZGVyJGZvdW5kZXJMZWdhbCAhPT0gdm9pZCAwID8gX2ZvdW5kZXIkZm91bmRlckxlZ2FsIDogbnVsbCwKICAgICAgICAgICAgICBpbm46IChfZm91bmRlciRmb3VuZGVyTGVnYWwzID0gKF9mb3VuZGVyJGZvdW5kZXJMZWdhbDQgPSBmb3VuZGVyLmZvdW5kZXJMZWdhbCkgPT09IG51bGwgfHwgX2ZvdW5kZXIkZm91bmRlckxlZ2FsNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2ZvdW5kZXIkZm91bmRlckxlZ2FsNC50aW4pICE9PSBudWxsICYmIF9mb3VuZGVyJGZvdW5kZXJMZWdhbDMgIT09IHZvaWQgMCA/IF9mb3VuZGVyJGZvdW5kZXJMZWdhbDMgOiBudWxsLAogICAgICAgICAgICAgIHBuZmw6IG51bGwsCiAgICAgICAgICAgICAgdHlwZTogbnVsbCwKICAgICAgICAgICAgICBpc0xlZ2FsOiB0cnVlLAogICAgICAgICAgICAgIGZvdW5kZXJTaGFyZVBlcmNlbnQ6IChfZm91bmRlciRmb3VuZGVyTGVnYWw1ID0gKF9mb3VuZGVyJGZvdW5kZXJMZWdhbDYgPSBmb3VuZGVyLmZvdW5kZXJMZWdhbCkgPT09IG51bGwgfHwgX2ZvdW5kZXIkZm91bmRlckxlZ2FsNiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2ZvdW5kZXIkZm91bmRlckxlZ2FsNi5mb3VuZGVyU2hhcmVQZXJjZW50KSAhPT0gbnVsbCAmJiBfZm91bmRlciRmb3VuZGVyTGVnYWw1ICE9PSB2b2lkIDAgPyBfZm91bmRlciRmb3VuZGVyTGVnYWw1IDogbnVsbCwKICAgICAgICAgICAgICBmb3VuZGVyU2hhcmVTdW06IChfZm91bmRlciRmb3VuZGVyTGVnYWw3ID0gKF9mb3VuZGVyJGZvdW5kZXJMZWdhbDggPSBmb3VuZGVyLmZvdW5kZXJMZWdhbCkgPT09IG51bGwgfHwgX2ZvdW5kZXIkZm91bmRlckxlZ2FsOCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2ZvdW5kZXIkZm91bmRlckxlZ2FsOC5mb3VuZGVyU2hhcmVTdW0pICE9PSBudWxsICYmIF9mb3VuZGVyJGZvdW5kZXJMZWdhbDcgIT09IHZvaWQgMCA/IF9mb3VuZGVyJGZvdW5kZXJMZWdhbDcgOiBudWxsCiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuZWRpdGluZ0l0ZW0uZm91bmRlcnNEdG9zOwogICAgfQogIH0sCiAgLyoqIE1FVEhPRFMgKi8KICBtZXRob2RzOiB7CiAgICAvLyBDT05UUkFDVE9SIFNFTEVDVF9BTkRfQ1JFQVRFIE1FVEhPRFMKICAgIGNvbnRyYWN0b3JSZWFjaGVkRW5kT2ZMaXN0OiBmdW5jdGlvbiBjb250cmFjdG9yUmVhY2hlZEVuZE9mTGlzdChlKSB7CiAgICAgIGlmIChlICYmICF0aGlzLmlzTG9hZGluZ0NvbnRyYWN0b3JzKSB7CiAgICAgICAgdGhpcy5mZXRjaENvbnRyYWN0b3JzKCk7CiAgICAgIH0KICAgIH0sCiAgICBkZWJvdW5jZVNlYXJjaENvbnRyYWN0b3JzOiBmdW5jdGlvbiBkZWJvdW5jZVNlYXJjaENvbnRyYWN0b3JzKHNlYXJjaFRleHQpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNsZWFyVGltZW91dChfdGhpcy5kZWJvdW5jZSk7CiAgICAgICAgICAgICAgX3RoaXMuZGVib3VuY2UgPSBzZXRUaW1lb3V0KCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZmV0Y2hDb250cmFjdG9yc1dpdGhLZXl3b3JkKHNlYXJjaFRleHQpOwogICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgICAgICAgICAgfSkpLCAxMDAwKTsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY3VzdG9tTGFiZWxDb250cmFjdG9yOiBmdW5jdGlvbiBjdXN0b21MYWJlbENvbnRyYWN0b3Iob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuY29udHJhY3RvcnMuZmluZChmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLmlkID09IG9wdDsKICAgICAgfSk7CiAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgIHJldHVybiAiIi5jb25jYXQoc2VsZWN0ZWQuZnVsbE5hbWUpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBmZXRjaENvbnRyYWN0b3JzV2l0aEtleXdvcmQ6IGZ1bmN0aW9uIGZldGNoQ29udHJhY3RvcnNXaXRoS2V5d29yZChrZXl3b3JkKSB7CiAgICAgIHZhciBtYWtlRmlyc3RTZWxlY3RlZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIHRoaXMuY29udHJhY3RvcnMgPSBbXTsKICAgICAgdGhpcy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5wYWdlID0gMTsKICAgICAgdGhpcy5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5rZXl3b3JkID0ga2V5d29yZCA/IGtleXdvcmQgOiAnJzsKICAgICAgdGhpcy5mZXRjaENvbnRyYWN0b3JzKG1ha2VGaXJzdFNlbGVjdGVkKTsKICAgIH0sCiAgICBmZXRjaENvbnRyYWN0b3JzOiBmdW5jdGlvbiBmZXRjaENvbnRyYWN0b3JzKG1ha2VGaXJzdFNlbGVjdGVkKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3RoaXMyLmNvbnRyYWN0b3JTZWFyY2hQYXlsb2FkLnNvcnRCeSA9IFtdOwogICAgICAgICAgICAgIF90aGlzMi5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5zb3J0QnkucHVzaCgnY3JlYXRlZCcpOwogICAgICAgICAgICAgIF90aGlzMi5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5zb3J0RGVzYyA9IFtdOwogICAgICAgICAgICAgIF90aGlzMi5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5zb3J0RGVzYy5wdXNoKHRydWUpOwogICAgICAgICAgICAgIF90aGlzMi5pc0xvYWRpbmdDb250cmFjdG9ycyA9IHRydWU7CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA3OwogICAgICAgICAgICAgIHJldHVybiBjcnVkQW5kTGlzdHNTZXJ2aWNlLnNlYXJjaExpc3RXaXRoS2V5d29yZCgnY29udHJhY3RvcicsIF90aGlzMi5jb250cmFjdG9yU2VhcmNoUGF5bG9hZCwgJ2J5LWNvbnRyYWN0b3InLCAhX3RoaXMyLmN1c3RvbUlzTW9kZUNyZWF0ZSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICB2YXIgX3RoaXMyJGNvbnRyYWN0b3JzOwogICAgICAgICAgICAgICAgKF90aGlzMiRjb250cmFjdG9ycyA9IF90aGlzMi5jb250cmFjdG9ycykucHVzaC5hcHBseShfdGhpczIkY29udHJhY3RvcnMsIF90b0NvbnN1bWFibGVBcnJheShyZXMuZGF0YS5saXN0KSk7CiAgICAgICAgICAgICAgICBfdGhpczIuaGFzTmV4dFBhZ2VDb250cmFjdG9ycyA9IHJlcy5kYXRhLnRvdGFsIC8gX3RoaXMyLmNvbnRyYWN0b3JTZWFyY2hQYXlsb2FkLml0ZW1zUGVyUGFnZSA+IF90aGlzMi5jb250cmFjdG9yU2VhcmNoUGF5bG9hZC5wYWdlOwogICAgICAgICAgICAgICAgX3RoaXMyLmNvbnRyYWN0b3JTZWFyY2hQYXlsb2FkLnBhZ2UgKz0gMTsKICAgICAgICAgICAgICAgIGlmIChtYWtlRmlyc3RTZWxlY3RlZCkgewogICAgICAgICAgICAgICAgICBfdGhpczIuZWRpdGluZ0l0ZW0ucGFyZW50SWQgPSBfdGhpczIuY29udHJhY3RvcnMubGVuZ3RoID8gX3RoaXMyLmNvbnRyYWN0b3JzWzBdLmlkIDogbnVsbDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgICAgICBfdGhpczIuY29udHJhY3RvcnMgPSBbXTsKICAgICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIF90aGlzMi5pc0xvYWRpbmdDb250cmFjdG9ycyA9IGZhbHNlOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBuZXdSZWZDcmVhdGVkOiBmdW5jdGlvbiBuZXdSZWZDcmVhdGVkKGZvcm1OYW1lKSB7CiAgICAgIGlmIChmb3JtTmFtZSA9PT0gJ0NyZWF0ZUZvcm1Db250cmFjdG9yJykgewogICAgICAgIHRoaXMuZmV0Y2hDb250cmFjdG9yc1dpdGhLZXl3b3JkKCcnLCB0cnVlKTsKICAgICAgfQogICAgfSwKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgYWRkRm91bmRlckR0bzogZnVuY3Rpb24gYWRkRm91bmRlckR0bygpIHsKICAgICAgdmFyIHRtcCA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEZvdW5kZXIpOwogICAgICB0aGlzLmVkaXRpbmdJdGVtLmZvdW5kZXJzRHRvcy5wdXNoKHRtcCk7CiAgICB9LAogICAgc2V0RGVmYXVsdEFjdGl2ZVN0YXR1czogZnVuY3Rpb24gc2V0RGVmYXVsdEFjdGl2ZVN0YXR1cygpIHsKICAgICAgdmFyIGFjdGl2ZVN0YXR1cyA9IHRoaXMuc3RhdHVzZXMuZmluZChmdW5jdGlvbiAoZWwpIHsKICAgICAgICByZXR1cm4gZWwuY29kZSA9PT0gJ0FDVElWRSc7CiAgICAgIH0pOwogICAgICBpZiAoYWN0aXZlU3RhdHVzKSB7CiAgICAgICAgdGhpcy5lZGl0aW5nSXRlbS5zdGF0dXNJZCA9IGFjdGl2ZVN0YXR1cy5pZDsKICAgICAgfQogICAgfSwKICAgIHJlZ2lvblNlbGVjdGVkOiBmdW5jdGlvbiByZWdpb25TZWxlY3RlZCgkZXZlbnQpIHsKICAgICAgdmFyIF9hcmd1bWVudHMgPSBhcmd1bWVudHMsCiAgICAgICAgX3RoaXMzID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgdmFyIGRvbnRSZXNldERpc3RyaWN0OwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBkb250UmVzZXREaXN0cmljdCA9IF9hcmd1bWVudHMubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgICAgICAgICAgaWYgKCFkb250UmVzZXREaXN0cmljdCkgewogICAgICAgICAgICAgICAgX3RoaXMzLmVkaXRpbmdJdGVtLmFkZHJlc3NEdG8uZGlzdHJpY3RJZCA9IG51bGw7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIEdFVCBESVNUUklDVFMKICAgICAgICAgICAgICBpZiAoISRldmVudCkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNTsKICAgICAgICAgICAgICByZXR1cm4gaGVscGVyU2VydmljZS5nZXRHZW9Mb2NhdGlvbnNCeVBhcmVudElkKCRldmVudCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICBfdGhpczMuZGlzdHJpY3RzID0gcmVzLmRhdGE7CiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICB2YWxpZGF0ZUlubjogZnVuY3Rpb24gdmFsaWRhdGVJbm4oKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgICAgICB2YXIgcmVzOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIGhlbHBlclNlcnZpY2UudmFsaWRhdGVJbm5Gcm9tQXBpKF90aGlzNC5lZGl0aW5nSXRlbS5pbm4pOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgaWYgKCFyZXMuZGF0YSkgewogICAgICAgICAgICAgICAgX3RoaXM0LmNvbXB1dGVkT2JzZXJ2ZXIuc2V0RXJyb3JzKHsKICAgICAgICAgICAgICAgICAgSU5OOiBbX3RoaXM0LiR0KCd2YWxpZGF0b3IuaW5uJyldCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsIHJlcy5kYXRhKTsKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgdmFsaWRhdGVQaW5mbDogZnVuY3Rpb24gdmFsaWRhdGVQaW5mbCgpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBpZiAoIV90aGlzNS5lZGl0aW5nSXRlbS5waW5mbCkgewogICAgICAgICAgICAgICAgX3RoaXM1LmNvbXB1dGVkT2JzZXJ2ZXIuc2V0RXJyb3JzKHsKICAgICAgICAgICAgICAgICAgcGluZmw6IFtfdGhpczUuJHQoJ3ZhbGlkYXRvci5yZXF1aXJlZCcpXQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChfdGhpczUuZWRpdGluZ0l0ZW0ucGluZmwubGVuZ3RoICE9PSAxNCkgewogICAgICAgICAgICAgICAgX3RoaXM1LmNvbXB1dGVkT2JzZXJ2ZXIuc2V0RXJyb3JzKHsKICAgICAgICAgICAgICAgICAgcGluZmw6IFtfdGhpczUuJHQoJ3ZhbGlkYXRvci5yZWdleCcpXQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBzZXRGb3VuZGVyc0Zyb21Tb2xpcTogZnVuY3Rpb24gc2V0Rm91bmRlcnNGcm9tU29saXEoKSB7CiAgICAgIHZhciBmb3VuZGVyc0Zyb21Tb2xpcSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogW107CiAgICAgIHZhciBmb3VuZGVyc0R0b3MgPSBmb3VuZGVyc0Zyb21Tb2xpcS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgdmFyIGZvdW5kZXJEdG8gPSB7CiAgICAgICAgICBjb250cmFjdG9ySWQ6IG51bGwsCiAgICAgICAgICBmb3VuZGVyQWRkcmVzc0lkOiBudWxsLAogICAgICAgICAgZm91bmRlckNvbnRhY3RJZDogbnVsbCwKICAgICAgICAgIGZvdW5kZXJJbmRpdmlkdWFsSWQ6IG51bGwsCiAgICAgICAgICBmb3VuZGVyTGVnYWxJZDogbnVsbCwKICAgICAgICAgIGZvdW5kZXJTaGFyZVBlcmNlbnQ6IGVsLmZvdW5kZXJJbmRpdmlkdWFsID8gZWwuZm91bmRlckluZGl2aWR1YWwuZm91bmRlclNoYXJlUGVyY2VudCA6IGVsLmZvdW5kZXJMZWdhbCA/IGVsLmZvdW5kZXJMZWdhbC5mb3VuZGVyU2hhcmVQZXJjZW50IDogbnVsbCwKICAgICAgICAgIGZvdW5kZXJTaGFyZVN1bTogZWwuZm91bmRlckluZGl2aWR1YWwgPyBlbC5mb3VuZGVySW5kaXZpZHVhbC5mb3VuZGVyU2hhcmVTdW0gOiBlbC5mb3VuZGVyTGVnYWwgPyBlbC5mb3VuZGVyTGVnYWwuZm91bmRlclNoYXJlU3VtIDogbnVsbCwKICAgICAgICAgIGZ1bGxOYW1lOiBlbC5mb3VuZGVyTGVnYWwgPyBlbC5mb3VuZGVyTGVnYWwubmFtZSA6IGVsLmZvdW5kZXJJbmRpdmlkdWFsID8gIiIuY29uY2F0KGVsLmZvdW5kZXJJbmRpdmlkdWFsLmZpcnN0TmFtZSwgIiAiKS5jb25jYXQoZWwuZm91bmRlckluZGl2aWR1YWwubGFzdE5hbWUsICIgIikuY29uY2F0KGVsLmZvdW5kZXJJbmRpdmlkdWFsLm1pZGRsZU5hbWUgPyBlbC5mb3VuZGVySW5kaXZpZHVhbC5taWRkbGVOYW1lIDogJycpIDogbnVsbCwKICAgICAgICAgIGlkOiBudWxsLAogICAgICAgICAgaW5uOiBlbC5mb3VuZGVyTGVnYWwgPyBlbC5mb3VuZGVyTGVnYWwudGluIDogZWwuZm91bmRlckluZGl2aWR1YWwgPyBlbC5mb3VuZGVySW5kaXZpZHVhbC50aW4gOiBudWxsLAogICAgICAgICAgaXNMZWdhbDogZWwuZm91bmRlckxlZ2FsID8gdHJ1ZSA6IGVsLmZvdW5kZXJJbmRpdmlkdWFsID8gZmFsc2UgOiBudWxsLAogICAgICAgICAgcG5mbDogZWwuZm91bmRlckluZGl2aWR1YWwgPyBlbC5mb3VuZGVySW5kaXZpZHVhbC5waW5mbCA6IG51bGwKICAgICAgICB9OwogICAgICAgIGlmIChmb3VuZGVyRHRvLmlubikgewogICAgICAgICAgcmV0dXJuIGZvdW5kZXJEdG87CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy4kc2V0KHRoaXMuZWRpdGluZ0l0ZW0sICdmb3VuZGVyc0R0b3MnLCBmb3VuZGVyc0R0b3MpOwogICAgfSwKICAgIGZpbmRDb250cmFjdG9yQnlJbm46IGZ1bmN0aW9uIGZpbmRDb250cmFjdG9yQnlJbm4oKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwogICAgICBpZiAodGhpcy5jb21wdXRlZE9ic2VydmVyLmZpZWxkcy5JTk4udmFsaWQpIGhlbHBlclNlcnZpY2UudmFsaWRhdGVJbm5Gcm9tQXBpKHRoaXMuZWRpdGluZ0l0ZW0uaW5uLCB0cnVlKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBpZiAocmVzLmRhdGEpIHsKICAgICAgICAgIHZhciBfaXNZdXIgPSBfdGhpczYuZWRpdGluZ0l0ZW0uaXNZdXI7CiAgICAgICAgICBpZiAoX3RoaXM2LmVkaXRpbmdJdGVtLmlubiAhPSBfdGhpczYub3JpZ2luYWxJbm4pIHsKICAgICAgICAgICAgaGVscGVyU2VydmljZS5nZXRDb250cmFjdG9ySW5mb0J5SW5uRm9yQ3JlYXRlKF90aGlzNi5lZGl0aW5nSXRlbS5pbm4sIF90aGlzNi5lZGl0aW5nSXRlbS5waW5mbCwgX3RoaXM2LmVkaXRpbmdJdGVtLmlzWXVyLCB0cnVlKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczYuZWRpdGluZ0l0ZW0gPSBPYmplY3QuYXNzaWduKHt9LCByZXMuZGF0YSk7CiAgICAgICAgICAgICAgX3RoaXM2LmVkaXRpbmdJdGVtLmlzWXVyID0gX2lzWXVyOwogICAgICAgICAgICAgIF90aGlzNi5zZXREZWZhdWx0QWN0aXZlU3RhdHVzKCk7CiAgICAgICAgICAgICAgLy8gRkVUQ0ggRElTVFJJQ1RTCiAgICAgICAgICAgICAgX3RoaXM2LnJlZ2lvblNlbGVjdGVkKF90aGlzNi5lZGl0aW5nSXRlbS5hZGRyZXNzRHRvLnJlZ2lvbklkLCB0cnVlKTsKICAgICAgICAgICAgICAvLyBDSEVDSyBBTkQgU0VUIEZPVU5ERVJTIEZST00gU09MSVEKICAgICAgICAgICAgICBpZiAocmVzLmRhdGEucmVnQ29udHJhY3RvckR0byAmJiByZXMuZGF0YS5yZWdDb250cmFjdG9yRHRvLmZvdW5kZXJzKSB7CiAgICAgICAgICAgICAgICBfdGhpczYuc2V0Rm91bmRlcnNGcm9tU29saXEocmVzLmRhdGEucmVnQ29udHJhY3RvckR0by5mb3VuZGVycyk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIF90aGlzNi5zZXRGb3VuZGVyc0Zyb21Tb2xpcSgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAvLyB0aGlzLmNvbXB1dGVkT2JzZXJ2ZXIuc2V0RXJyb3JzKHsgSU5OOiBbdGhpcy4kdCgndmFsaWRhdG9yLmlubl9leGlzdCcpXSB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBoZWxwZXJTZXJ2aWNlLmdldENvbnRyYWN0b3JJbmZvQnlJbm5Gb3JVcGRhdGUoX3RoaXM2LmVkaXRpbmdJdGVtLmlubiwgX3RoaXM2LmVkaXRpbmdJdGVtLnBpbmZsLCBfdGhpczYuZWRpdGluZ0l0ZW0uaXNZdXIsIHRydWUpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgIF90aGlzNi5lZGl0aW5nSXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIHJlcy5kYXRhKTsKICAgICAgICAgICAgICBfdGhpczYuZWRpdGluZ0l0ZW0uaXNZdXIgPSBfaXNZdXI7CiAgICAgICAgICAgICAgX3RoaXM2LiRzZXQoX3RoaXM2LmVkaXRpbmdJdGVtLCAnYWRkcmVzc0R0bycsIF90aGlzNi5vcmlnaW5hbER0by5hZGRyZXNzRHRvKTsKICAgICAgICAgICAgICBfdGhpczYuJHNldChfdGhpczYuZWRpdGluZ0l0ZW0sICdtb2JpbGVOdW1iZXInLCBfdGhpczYub3JpZ2luYWxEdG8ubW9iaWxlTnVtYmVyKTsKICAgICAgICAgICAgICBfdGhpczYuJHNldChfdGhpczYuZWRpdGluZ0l0ZW0sICdlbWFpbCcsIF90aGlzNi5vcmlnaW5hbER0by5lbWFpbCk7CiAgICAgICAgICAgICAgX3RoaXM2LiRzZXQoX3RoaXM2LmVkaXRpbmdJdGVtLCAnY2FuUmVnaXN0ZXInLCBfdGhpczYub3JpZ2luYWxEdG8uY2FuUmVnaXN0ZXIpOwogICAgICAgICAgICAgIF90aGlzNi5zZXREZWZhdWx0QWN0aXZlU3RhdHVzKCk7CiAgICAgICAgICAgICAgLy8gRkVUQ0ggRElTVFJJQ1RTCiAgICAgICAgICAgICAgX3RoaXM2LnJlZ2lvblNlbGVjdGVkKF90aGlzNi5lZGl0aW5nSXRlbS5hZGRyZXNzRHRvLnJlZ2lvbklkLCB0cnVlKTsKICAgICAgICAgICAgICAvLyBDSEVDSyBBTkQgU0VUIEZPVU5ERVJTIEZST00gU09MSVEKICAgICAgICAgICAgICBpZiAocmVzLmRhdGEucmVnQ29udHJhY3RvckR0byAmJiByZXMuZGF0YS5yZWdDb250cmFjdG9yRHRvLmZvdW5kZXJzKSB7CiAgICAgICAgICAgICAgICBfdGhpczYuc2V0Rm91bmRlcnNGcm9tU29saXEocmVzLmRhdGEucmVnQ29udHJhY3RvckR0by5mb3VuZGVycyk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIF90aGlzNi5zZXRGb3VuZGVyc0Zyb21Tb2xpcSgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAvLyB0aGlzLmNvbXB1dGVkT2JzZXJ2ZXIuc2V0RXJyb3JzKHsgSU5OOiBbdGhpcy4kdCgndmFsaWRhdG9yLmlubl9leGlzdCcpXSB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzNi5jb21wdXRlZE9ic2VydmVyLnNldEVycm9ycyh7CiAgICAgICAgICAgIElOTjogW190aGlzNi4kdCgndmFsaWRhdG9yLmlubicpXQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICB9KTsKICAgIH0sCiAgICBmaW5kQ29udHJhY3RvckJ5UGluZmw6IGZ1bmN0aW9uIGZpbmRDb250cmFjdG9yQnlQaW5mbCgpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CiAgICAgIGlmICh0aGlzLmNvbXB1dGVkT2JzZXJ2ZXIuZmllbGRzLlBJTkZMLnZhbGlkKSBpZiAodGhpcy5lZGl0aW5nSXRlbS5waW5mbCAhPT0gdGhpcy5vcmlnaW5hbFBpbmZsKSB7CiAgICAgICAgdmFyIF9pc1l1cjIgPSB0aGlzLmVkaXRpbmdJdGVtLmlzWXVyOwogICAgICAgIGhlbHBlclNlcnZpY2UuZ2V0Q29udHJhY3RvckluZm9CeUlubkZvckNyZWF0ZSh0aGlzLmVkaXRpbmdJdGVtLmlubiwgdGhpcy5lZGl0aW5nSXRlbS5waW5mbCwgdGhpcy5lZGl0aW5nSXRlbS5pc1l1ciwgdHJ1ZSkudGhlbihmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgICAgIHZhciBkYXRhID0gX3JlZjIuZGF0YTsKICAgICAgICAgIF90aGlzNy5lZGl0aW5nSXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIGRhdGEpOwogICAgICAgICAgX3RoaXM3LmVkaXRpbmdJdGVtLmlzWXVyID0gX2lzWXVyMjsKICAgICAgICAgIF90aGlzNy5zZXREZWZhdWx0QWN0aXZlU3RhdHVzKCk7CiAgICAgICAgICAvLyBGRVRDSCBESVNUUklDVFMKICAgICAgICAgIF90aGlzNy5yZWdpb25TZWxlY3RlZChfdGhpczcuZWRpdGluZ0l0ZW0uYWRkcmVzc0R0by5yZWdpb25JZCwgdHJ1ZSk7CiAgICAgICAgICAvLyBDSEVDSyBBTkQgU0VUIEZPVU5ERVJTIEZST00gU09MSVEKICAgICAgICAgIGlmIChkYXRhLnJlZ0NvbnRyYWN0b3JEdG8gJiYgZGF0YS5yZWdDb250cmFjdG9yRHRvLmZvdW5kZXJzKSB7CiAgICAgICAgICAgIF90aGlzNy5zZXRGb3VuZGVyc0Zyb21Tb2xpcShkYXRhLnJlZ0NvbnRyYWN0b3JEdG8uZm91bmRlcnMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RoaXM3LnNldEZvdW5kZXJzRnJvbVNvbGlxKCk7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHt9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBoZWxwZXJTZXJ2aWNlLmdldENvbnRyYWN0b3JJbmZvQnlJbm5Gb3JVcGRhdGUodGhpcy5lZGl0aW5nSXRlbS5pbm4sIHRoaXMuZWRpdGluZ0l0ZW0ucGluZmwsIHRoaXMuZWRpdGluZ0l0ZW0uaXNZdXIsIHRydWUpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgX3RoaXM3LmVkaXRpbmdJdGVtID0gT2JqZWN0LmFzc2lnbih7fSwgcmVzLmRhdGEpOwogICAgICAgICAgX3RoaXM3LmVkaXRpbmdJdGVtLmlzWXVyID0gaXNZdXI7CiAgICAgICAgICBfdGhpczcuJHNldChfdGhpczcuZWRpdGluZ0l0ZW0sICdhZGRyZXNzRHRvJywgX3RoaXM3Lm9yaWdpbmFsRHRvLmFkZHJlc3NEdG8pOwogICAgICAgICAgX3RoaXM3LiRzZXQoX3RoaXM3LmVkaXRpbmdJdGVtLCAnbW9iaWxlTnVtYmVyJywgX3RoaXM3Lm9yaWdpbmFsRHRvLm1vYmlsZU51bWJlcik7CiAgICAgICAgICBfdGhpczcuJHNldChfdGhpczcuZWRpdGluZ0l0ZW0sICdlbWFpbCcsIF90aGlzNy5vcmlnaW5hbER0by5lbWFpbCk7CiAgICAgICAgICBfdGhpczcuJHNldChfdGhpczcuZWRpdGluZ0l0ZW0sICdjYW5SZWdpc3RlcicsIF90aGlzNy5vcmlnaW5hbER0by5jYW5SZWdpc3Rlcik7CiAgICAgICAgICBfdGhpczcuc2V0RGVmYXVsdEFjdGl2ZVN0YXR1cygpOwogICAgICAgICAgLy8gRkVUQ0ggRElTVFJJQ1RTCiAgICAgICAgICBfdGhpczcucmVnaW9uU2VsZWN0ZWQoX3RoaXM3LmVkaXRpbmdJdGVtLmFkZHJlc3NEdG8ucmVnaW9uSWQsIHRydWUpOwogICAgICAgICAgLy8gQ0hFQ0sgQU5EIFNFVCBGT1VOREVSUyBGUk9NIFNPTElRCiAgICAgICAgICBpZiAocmVzLmRhdGEucmVnQ29udHJhY3RvckR0byAmJiByZXMuZGF0YS5yZWdDb250cmFjdG9yRHRvLmZvdW5kZXJzKSB7CiAgICAgICAgICAgIF90aGlzNy5zZXRGb3VuZGVyc0Zyb21Tb2xpcShyZXMuZGF0YS5yZWdDb250cmFjdG9yRHRvLmZvdW5kZXJzKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzNy5zZXRGb3VuZGVyc0Zyb21Tb2xpcSgpOwogICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAvLyB0aGlzLmNvbXB1dGVkT2JzZXJ2ZXIuc2V0RXJyb3JzKHsgSU5OOiBbdGhpcy4kdCgndmFsaWRhdG9yLmlubl9leGlzdCcpXSB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGN1c3RvbUxhYmVsRGlzdHJpY3Q6IGZ1bmN0aW9uIGN1c3RvbUxhYmVsRGlzdHJpY3Qob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZERpc3RyaWN0ID0gdGhpcy5kaXN0cmljdHMuZmluZChmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLmlkID09IG9wdDsKICAgICAgfSk7CiAgICAgIGlmIChzZWxlY3RlZERpc3RyaWN0KSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZERpc3RyaWN0Lm5hbWVSdSwKICAgICAgICAgIG5hbWVMdDogc2VsZWN0ZWREaXN0cmljdC5uYW1lTHQsCiAgICAgICAgICBuYW1lVXo6IHNlbGVjdGVkRGlzdHJpY3QubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbFJlZ2lvbjogZnVuY3Rpb24gY3VzdG9tTGFiZWxSZWdpb24ob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZFJlZ2lvbiA9IHRoaXMucmVnaW9ucy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkUmVnaW9uKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZFJlZ2lvbi5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkUmVnaW9uLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWRSZWdpb24ubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBjdXN0b21MYWJlbEZvcm1PZk93bmVyc2hpcDogZnVuY3Rpb24gY3VzdG9tTGFiZWxGb3JtT2ZPd25lcnNoaXAob3B0KSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuZm9ybU9mT3duZXJzaGlwcy5maW5kKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUuaWQgPT0gb3B0OwogICAgICB9KTsKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICIiLmNvbmNhdCh0aGlzLmdldE5hbWUoewogICAgICAgICAgbmFtZVJ1OiBzZWxlY3RlZC5uYW1lUnUsCiAgICAgICAgICBuYW1lTHQ6IHNlbGVjdGVkLm5hbWVMdCwKICAgICAgICAgIG5hbWVVejogc2VsZWN0ZWQubmFtZVV6CiAgICAgICAgfSkpOwogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0sCiAgICBzYXZlOiBmdW5jdGlvbiBzYXZlKCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgdmFyIGlzSW5uVmFsaWQ7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXM4LnZhbGlkYXRlSW5uKCk7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBpc0lublZhbGlkID0gX2NvbnRleHQ3LnNlbnQ7CiAgICAgICAgICAgICAgaWYgKGlzSW5uVmFsaWQpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIik7CiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBfdGhpczguY29tcHV0ZWRPYnNlcnZlci52YWxpZGF0ZSgpLnRoZW4oZnVuY3Rpb24gKHZhbGlkKSB7CiAgICAgICAgICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgICAgICAgICAgaWYgKF90aGlzOC5lZGl0aW5nSXRlbS5mb3VuZGVyc0R0b3MpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczguZWRpdGluZ0l0ZW0uZm91bmRlcnNEdG9zID0gX3RoaXM4LmVkaXRpbmdJdGVtLmZvdW5kZXJzRHRvcy5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWwuZm91bmRlck5hbWUgJiYgZWwuZm91bmRlck5hbWUudG9TdHJpbmcoKS50cmltKCkubGVuZ3RoICYmIGVsLnBlcmNlbnRhZ2U7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgaWYgKCFfdGhpczguaXNNb2RlQ3JlYXRlKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXM4LmVkaXRpbmdJdGVtLmlkID0gX3RoaXM4LiRyb3V0ZS5wYXJhbXMuaWQudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgICAgICBjcnVkQW5kTGlzdHNTZXJ2aWNlLnVwZGF0ZShNQUlOX0FQSV9VUkwsIF90aGlzOC5lZGl0aW5nSXRlbSwgbnVsbCwgdHJ1ZSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczguY29tcHV0ZWRPYnNlcnZlci5yZXNldCgpOwogICAgICAgICAgICAgICAgICAgICAgX3RoaXM4LmVkaXRpbmdJdGVtID0gT2JqZWN0LmFzc2lnbih7fSwgewogICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzRHRvOiB7fQogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLiRyb3V0ZXIuZ28oLTEpCiAgICAgICAgICAgICAgICAgICAgICBfdGhpczguJHRvYXN0KF90aGlzOC4kdCgnbWVzc2FnZXMuc2F2ZWRfc3VjY2Vzc2Z1bGx5JyksIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzOC4kZW1pdCgnc2F2ZWQnLCByZXMuZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY3J1ZEFuZExpc3RzU2VydmljZS5jcmVhdGUoTUFJTl9BUElfVVJMLCBfdGhpczguZWRpdGluZ0l0ZW0sIG51bGwsIHRydWUpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICAgICAgX3RoaXM4LmNvbXB1dGVkT2JzZXJ2ZXIucmVzZXQoKTsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzOC5lZGl0aW5nSXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzc0R0bzoge30KICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgX3RoaXM4LiR0b2FzdChfdGhpczguJHQoJ21lc3NhZ2VzLnNhdmVkX3N1Y2Nlc3NmdWxseScpLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczguJGVtaXQoJ3NhdmVkJywgcmVzLmRhdGEpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpczguJHRvYXN0KF90aGlzOC4kdCgnbWVzc2FnZXMuZmlsbF9yZXF1aXJlZF9maWVsZHMnKSwgewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgIH0pKSgpOwogICAgfQogIH0sCiAgLyoqIENSRUFURUQgKi9jcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzOSA9IHRoaXM7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIC8vIEZPUiBDT05UUkFDVE9SIFNFTEVDVF9BTkRfQURECiAgICAgICAgICAgIF90aGlzOS5jb250cmFjdG9yU2VhcmNoUGF5bG9hZCA9IE9iamVjdC5hc3NpZ24oe30sIF90aGlzOS52YXJfZGVmYXVsdF9zZWFyY2hfcGF5bG9hZCk7CiAgICAgICAgICAgIF90aGlzOS5mZXRjaENvbnRyYWN0b3JzKCk7CiAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgICAgIF90aGlzOS52YXJfZGVmYXVsdF9zZWFyY2hfcGF5bG9hZC5pdGVtc1BlclBhZ2UgPSA1MDA7CiAgICAgICAgICAgIGlmICghX3RoaXM5LmlzTW9kZUNyZWF0ZSkgewogICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gNzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBjcnVkQW5kTGlzdHNTZXJ2aWNlLmdldEVtcHR5KE1BSU5fQVBJX1VSTCwgbnVsbCwgdHJ1ZSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgX3RoaXM5LmVkaXRpbmdJdGVtID0gT2JqZWN0LmFzc2lnbih7fSwgcmVzLmRhdGEpOwogICAgICAgICAgICAgIF90aGlzOS5lZGl0aW5nSXRlbS5pc1l1ciA9IHRydWU7CiAgICAgICAgICAgICAgLyogaWYgKCF0aGlzLmVkaXRpbmdJdGVtLmZvdW5kZXJzRHRvcyB8fCAhdGhpcy5lZGl0aW5nSXRlbS5mb3VuZGVyc0R0b3MubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLmZvdW5kZXJzRHRvcyA9IFtdDQogICAgICAgICAgICAgICAgICBsZXQgdG1wRm91bmRlciA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEZvdW5kZXIpDQogICAgICAgICAgICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLmZvdW5kZXJzRHRvcy5wdXNoKHRtcEZvdW5kZXIpDQogICAgICAgICAgICAgIH0gKi8KICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gOTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gOTsKICAgICAgICAgICAgcmV0dXJuIGNydWRBbmRMaXN0c1NlcnZpY2UuZ2V0QnlJZChNQUlOX0FQSV9VUkwsIF90aGlzOS4kcm91dGUucGFyYW1zLmlkLCB0cnVlKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuaXNZdXIgPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJlcy5kYXRhLmlzWXVyID0gQm9vbGVhbighcmVzLmRhdGEucGluZmwgJiYgcmVzLmRhdGEuaW5uKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX3RoaXM5LmVkaXRpbmdJdGVtID0gT2JqZWN0LmFzc2lnbih7fSwgcmVzLmRhdGEpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKF90aGlzOS5lZGl0aW5nSXRlbS5pbm4sIF90aGlzOS5lZGl0aW5nSXRlbSk7CiAgICAgICAgICAgICAgX3RoaXM5Lm9yaWdpbmFsSW5uID0gX3RoaXM5LmVkaXRpbmdJdGVtLmlubjsKICAgICAgICAgICAgICBfdGhpczkub3JpZ2luYWxQaW5mbCA9IF90aGlzOS5lZGl0aW5nSXRlbS5waW5mbDsKICAgICAgICAgICAgICBfdGhpczkub3JpZ2luYWxEdG8gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJlcy5kYXRhKSk7CiAgICAgICAgICAgICAgLyogaWYgKCF0aGlzLmVkaXRpbmdJdGVtLmZvdW5kZXJzRHRvcyB8fCAhdGhpcy5lZGl0aW5nSXRlbS5mb3VuZGVyc0R0b3MubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLmZvdW5kZXJzRHRvcyA9IFtdDQogICAgICAgICAgICAgICAgICBsZXQgdG1wRm91bmRlciA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEZvdW5kZXIpDQogICAgICAgICAgICAgICAgICB0aGlzLmVkaXRpbmdJdGVtLmZvdW5kZXJzRHRvcy5wdXNoKHRtcEZvdW5kZXIpDQogICAgICAgICAgICAgIH0gKi8KICAgICAgICAgICAgICBpZiAoX3RoaXM5LmVkaXRpbmdJdGVtLnBhcmVudElkKSB7CiAgICAgICAgICAgICAgICB2YXIgcGFyZW50SWR4ID0gX3RoaXM5LmNvbnRyYWN0b3JzLmZpbmRJbmRleChmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsLmlkID09IF90aGlzOS5lZGl0aW5nSXRlbS5wYXJlbnRJZDsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKHBhcmVudElkeCA8IDApIHsKICAgICAgICAgICAgICAgICAgX3RoaXM5LmNvbnRyYWN0b3JzLnB1c2goX3RoaXM5LmVkaXRpbmdJdGVtLnBhcmVudCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgLy8gR0VUIFNUQVRVU0VTCiAgICAgICAgICAgIGhlbHBlclNlcnZpY2UuZ2V0UmVmQnlDb2RlKCdzdGF0dXMnLCB0cnVlKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczkuc3RhdHVzZXMgPSByZXMuZGF0YS5jaGlsZHJlbjsKICAgICAgICAgICAgICBpZiAoX3RoaXM5LmlzTW9kZUNyZWF0ZSkgewogICAgICAgICAgICAgICAgX3RoaXM5LnNldERlZmF1bHRBY3RpdmVTdGF0dXMoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAvLyBHRVQgUkVHSU9OUwogICAgICAgICAgICBoZWxwZXJTZXJ2aWNlLmZldGNoUmVnaW9ucyh0cnVlKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczkucmVnaW9ucyA9IHJlcy5kYXRhOwogICAgICAgICAgICAgIF90aGlzOS5yZWdpb25TZWxlY3RlZChfdGhpczkuZWRpdGluZ0l0ZW0uYWRkcmVzc0R0by5yZWdpb25JZCwgdHJ1ZSk7CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAvLyBHRVQgRk9STV9PRl9PV05FUlNISVAKICAgICAgICAgICAgY3J1ZEFuZExpc3RzU2VydmljZS5zZWFyY2hMaXN0KCdkaXJlY3RvcnkvZm9ybS1vZi1vd25lcnNoaXBzJywgX3RoaXM5LnZhcl9kZWZhdWx0X3NlYXJjaF9wYXlsb2FkLCBudWxsLCB0cnVlKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczkuZm9ybU9mT3duZXJzaGlwcyA9IHJlcy5kYXRhLmxpc3Q7CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTgpOwogICAgfSkpKCk7CiAgfSwKICB3YXRjaDogewogICAgJ2VkaXRpbmdJdGVtLmlzWXVyJzogewogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgICAgY29uc29sZS5sb2cobmV3VmFsLCBvbGRWYWwpOwogICAgICAgIGlmIChuZXdWYWwgIT09IG9sZFZhbCkgewogICAgICAgICAgdGhpcy5lZGl0aW5nSXRlbSA9IHsKICAgICAgICAgICAgaXNZdXI6IG5ld1ZhbCwKICAgICAgICAgICAgYWRkcmVzc0R0bzoge30sCiAgICAgICAgICAgIGZvdW5kZXJzRHRvczogW10KICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LAogICAgICBkZWVwOiB0cnVlCiAgICB9CiAgfQp9Ow=="},null]}