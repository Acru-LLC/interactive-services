{"remainingRequest":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\state\\modules\\messenger.js","dependencies":[{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\state\\modules\\messenger.js","mtime":1674799498875},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\babel.config.js","mtime":1667352074157},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1667355379758},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1667355397815}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6XFxBQ1JVIFBST0pFQ1RcXEZhaXIgVGVjaFxcYWNydS1mcm9udGVuZFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuanNvbi5zdHJpbmdpZnkuanMiOwppbXBvcnQgeyBUb2tlblNlcnZpY2UgfSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9zdG9yYWdlLnNlcnZpY2UiOwppbXBvcnQgbWVzc2VuZ2VyU2VydmljZSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9tZXNzZW5nZXJTZXJ2aWNlIjsKaW1wb3J0IFNvY2tKUyBmcm9tICJzb2NranMtY2xpZW50IjsKaW1wb3J0IFN0b21wIGZyb20gIndlYnN0b21wLWNsaWVudCI7CmltcG9ydCBWdWUgZnJvbSAidnVlIjsKdmFyIGdsb2JhbFN0b21wQ2xpZW50ID0gbnVsbDsKZXhwb3J0IHZhciBzdGF0ZSA9IHsKICBtYXJrZXRpbmc6IG51bGwsCiAgbm90aWZpY2F0aW9uOiBudWxsLAogIGNvbnRhY3RMaXN0OiBbXSwKICBjb250YWN0VG90YWw6IDAsCiAgZ3JvdXBDaGF0TGlzdDogW10sCiAgZ3JvdXBDaGF0VG90YWw6IDAsCiAgY29tbWVudHM6IFtdLAogIGNvbW1lbnRzVG90YWw6IDAsCiAgb3BlblBhZ2U6ICJkZWZhdWx0IiwKICBjaGF0TGlzdE1lc3NhZ2VzOiBbXSwKICBjaGF0VG90YWxNZXNzYWdlczogMCwKICBncm91cENoYXRMaXN0TWVzc2FnZXM6IFtdLAogIGdyb3VwQ2hhdFRvdGFsTWVzc2FnZXM6IDAsCiAgbGFzdE1lc3NhZ2U6IHt9LAogIGxhc3RNZXNzYWdlR3JvdXA6IHt9LAogIGdyb3VwVXBkYXRlOiBmYWxzZSwKICBncm91cFVwZGF0ZU1zZzogbnVsbCwKICBpbmNvbWluZ1BlcnNvbjogbnVsbCwKICBleGl0aW5nUGVyc29uOiBudWxsLAogIGNoYXRVbnJlYWRDb3VudDogMCwKICB1bnJlYWREYXRhOiBudWxsLAogIENIQVQ6IG51bGwKfTsKZXhwb3J0IHZhciBtdXRhdGlvbnMgPSB7CiAgc2V0Q3VycmVudENoYXQ6IGZ1bmN0aW9uIHNldEN1cnJlbnRDaGF0KHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5DSEFUID0gZGF0YTsKICB9LAogIHNldENoYXRNZXNzYWdlTWFrZVJlYWQ6IGZ1bmN0aW9uIHNldENoYXRNZXNzYWdlTWFrZVJlYWQoc3RhdGUsIGlkKSB7CiAgICB2YXIgaW5kZXggPSBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZS5pZCA9PSBpZDsKICAgIH0pOwoKICAgIGlmIChpbmRleCA+IC0xKSB7CiAgICAgIFZ1ZS5zZXQoc3RhdGUuY2hhdExpc3RNZXNzYWdlc1tpbmRleF0sICJpc1JlYWQiLCAiUkVBRCIpOwogICAgfQogIH0sCiAgc2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50OiBmdW5jdGlvbiBzZXRDaGF0VW5yZWFkTWVzc2FnQ291bnQoc3RhdGUsIGNvdW50KSB7CiAgICBzdGF0ZS5jaGF0VW5yZWFkQ291bnQgPSBjb3VudDsKCiAgICBpZiAoY291bnQgPiAwKSB7Ly8gcGxheVNvdW5kKCkKICAgIH0KICB9LAogIHNldENoYXRVbnJlYWRDb3VudDogZnVuY3Rpb24gc2V0Q2hhdFVucmVhZENvdW50KHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS51bnJlYWREYXRhID0gZGF0YTsKICB9LAogIHNldENvbW1lbnRzOiBmdW5jdGlvbiBzZXRDb21tZW50cyhzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuY29tbWVudHMgPSBkYXRhOwogIH0sCiAgc2V0SW5jb21pbmdQZXJzb246IGZ1bmN0aW9uIHNldEluY29taW5nUGVyc29uKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5pbmNvbWluZ1BlcnNvbiA9IGRhdGE7CiAgfSwKICBzZXRFeGl0aW5nUGVyc29uOiBmdW5jdGlvbiBzZXRFeGl0aW5nUGVyc29uKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5leGl0aW5nUGVyc29uID0gZGF0YTsKICB9LAogIHNldE1hcmtldGluZzogZnVuY3Rpb24gc2V0TWFya2V0aW5nKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5tYXJrZXRpbmcgPSBkYXRhOwogIH0sCiAgc2V0Tm90aWZpY2F0aW9uOiBmdW5jdGlvbiBzZXROb3RpZmljYXRpb24oc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLm5vdGlmaWNhdGlvbiA9IGRhdGE7CiAgfSwKICBzZXRHcm91cFVwZGF0ZUU6IGZ1bmN0aW9uIHNldEdyb3VwVXBkYXRlRShzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuZ3JvdXBVcGRhdGUgPSBkYXRhOwogIH0sCiAgc2V0R3JvdXBDaGF0VXBkYXRlOiBmdW5jdGlvbiBzZXRHcm91cENoYXRVcGRhdGUoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmdyb3VwVXBkYXRlID0gdHJ1ZTsKICAgIHN0YXRlLmdyb3VwVXBkYXRlTXNnID0gZGF0YTsKICB9LAogIHNldExpc3RSZXNwb25zZUdyb3VwQ2hhdDogZnVuY3Rpb24gc2V0TGlzdFJlc3BvbnNlR3JvdXBDaGF0KHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5ncm91cENoYXRMaXN0ID0gZGF0YS5saXN0OwogICAgc3RhdGUuZ3JvdXBDaGF0VG90YWwgPSBkYXRhLnRvdGFsOwogIH0sCiAgc2V0TGlzdFJlc3BvbnNlOiBmdW5jdGlvbiBzZXRMaXN0UmVzcG9uc2Uoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmNvbnRhY3RMaXN0ID0gZGF0YS5saXN0Lm1hcChmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gewogICAgICAgIGZpcnN0TmFtZTogZS5maXJzdE5hbWUsCiAgICAgICAgbGFzdE5hbWU6IGUubGFzdE5hbWUsCiAgICAgICAgZW1wbG95ZWVJZDogZS5lbXBsb3llZUlkLAogICAgICAgIGNoYXRJZDogZS5jaGF0SWQsCiAgICAgICAgdXBsb2FkUGF0aDogZS51cGxvYWRQYXRoCiAgICAgIH07CiAgICB9KTsKICAgIHN0YXRlLmNvbnRhY3RUb3RhbCA9IGRhdGEudG90YWw7CiAgfSwKICBzZXRPcGVuUGFnZTogZnVuY3Rpb24gc2V0T3BlblBhZ2Uoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLm9wZW5QYWdlID0gZGF0YTsKICB9LAogIHNldExpc3RDaGF0TWVzc2VnZXM6IGZ1bmN0aW9uIHNldExpc3RDaGF0TWVzc2VnZXMoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMgPSBkYXRhLmxpc3Q7CiAgICBzdGF0ZS5jaGF0VG90YWxNZXNzYWdlcyA9IGRhdGEudG90YWw7CiAgfSwKICBzZXRMaXN0R3JvdXBDaGF0TWVzc2VnZXM6IGZ1bmN0aW9uIHNldExpc3RHcm91cENoYXRNZXNzZWdlcyhzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzID0gZGF0YS5saXN0OwogICAgc3RhdGUuZ3JvdXBDaGF0VG90YWxNZXNzYWdlcyA9IGRhdGEudG90YWw7CiAgfSwKICBwdXNoSXRlbXM6IGZ1bmN0aW9uIHB1c2hJdGVtcyhzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuY2hhdExpc3RNZXNzYWdlcyA9IGRhdGEuY29uY2F0KHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMpOwogIH0sCiAgcHVzaEdyb3VwSXRlbXM6IGZ1bmN0aW9uIHB1c2hHcm91cEl0ZW1zKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMgPSBkYXRhLmNvbmNhdChzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMpOwogIH0sCiAgcHVzaENoYXRMaXN0OiBmdW5jdGlvbiBwdXNoQ2hhdExpc3Qoc3RhdGUsIGRhdGEpIHsKICAgIGlmIChzdGF0ZS5DSEFUICYmIHN0YXRlLkNIQVQuaWQgPT0gZGF0YS5jaGF0SWQpIHsKICAgICAgaWYgKGRhdGEuZXh0cmEgPT0gJ2RlbGV0ZScpIHsKICAgICAgICB2YXIgaW5kZXggPSBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUuaWQgPT0gZGF0YS5kZWxldGVJZDsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgICAgIHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZGF0YS5leHRyYSA9PSAndXBkYXRlJykgewogICAgICAgIHZhciBfaW5kZXggPSBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUuaWQgPT0gZGF0YS5lZGl0ZWRNZXNzYWdlLmlkOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoX2luZGV4ID4gLTEpIHsKICAgICAgICAgIHN0YXRlLmNoYXRMaXN0TWVzc2FnZXNbX2luZGV4XS5tZXNzYWdlID0gZGF0YS5lZGl0ZWRNZXNzYWdlLm1lc3NhZ2U7CiAgICAgICAgICBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzW19pbmRleF0uZWRpdGVkID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIF9pbmRleDIgPSBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUuaWQgPT0gZGF0YS5pZDsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKCFfaW5kZXgyIHx8IF9pbmRleDIgPD0gLTEpIHsKICAgICAgICAgIHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMucHVzaChkYXRhKTsKICAgICAgICAgIHN0YXRlLmNoYXRUb3RhbE1lc3NhZ2VzKys7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKICBwdXNoQ291bnQ6IGZ1bmN0aW9uIHB1c2hDb3VudChzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuY2hhdExpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICBpZiAoZWxlbWVudC5pZCA9PT0gZGF0YS5jaGF0SWQpIHsKICAgICAgICBidXMuJHNldChlbGVtZW50LCAiY291bnQiLCBlbGVtZW50LmNvdW50KyspOwogICAgICB9CiAgICB9KTsKICB9LAogIHB1c2hHcm91cENoYXRMaXN0OiBmdW5jdGlvbiBwdXNoR3JvdXBDaGF0TGlzdChzdGF0ZSwgZGF0YSkgewogICAgaWYgKHN0YXRlLkNIQVQgJiYgc3RhdGUuQ0hBVC5pZCA9PSBkYXRhLmdyb3VwQ2hhdElkKSB7CiAgICAgIGlmIChkYXRhLmV4dHJhID09PSAidW5yZWFkIikgewogICAgICAgIHN0YXRlLmdyb3VwQ2hhdExpc3RNZXNzYWdlcy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICBpZiAoZWxlbWVudC5pZCA9PSBkYXRhLnVucmVhZElkKSB7CiAgICAgICAgICAgIGVsZW1lbnQuaXNSZWFkID0gIlJFQUQiOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGRhdGEuZXh0cmEgPT09ICJkZWxldGUiKSB7CiAgICAgICAgdmFyIGluZGV4ID0gc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUuaWQgPT0gZGF0YS5kZWxldGVJZDsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgICAgIHN0YXRlLmdyb3VwQ2hhdExpc3RNZXNzYWdlcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkYXRhLmV4dHJhID09PSAidXBkYXRlIikgewogICAgICAgIHZhciBfaW5kZXgzID0gc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUuaWQgPT0gZGF0YS5lZGl0ZWRHcm91cE1lc3NhZ2UuaWQ7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChfaW5kZXgzID4gLTEpIHsKICAgICAgICAgIHN0YXRlLmdyb3VwQ2hhdExpc3RNZXNzYWdlc1tfaW5kZXgzXS5tZXNzYWdlID0gZGF0YS5lZGl0ZWRHcm91cE1lc3NhZ2UubWVzc2FnZTsKICAgICAgICAgIHN0YXRlLmdyb3VwQ2hhdExpc3RNZXNzYWdlc1tfaW5kZXgzXS5lZGl0ZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgX2luZGV4NCA9IHN0YXRlLmdyb3VwQ2hhdExpc3RNZXNzYWdlcy5maW5kSW5kZXgoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBlLmlkID09IGRhdGEuaWQ7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChfaW5kZXg0IDw9IC0xKSB7CiAgICAgICAgICBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMucHVzaChkYXRhKTsKICAgICAgICAgIHN0YXRlLmdyb3VwQ2hhdFRvdGFsTWVzc2FnZXMrKzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAogIHB1c2hHcm91cENvdW50OiBmdW5jdGlvbiBwdXNoR3JvdXBDb3VudChzdGF0ZSwgZGF0YSkgewogICAgaWYgKGRhdGEuZXh0cmEgPT09ICJ1bnJlYWQiKSB7fSBlbHNlIGlmIChkYXRhLmV4dHJhID09PSAiZGVsZXRlIikge30gZWxzZSBpZiAoZGF0YS5leHRyYSA9PT0gInVwZGF0ZSIpIHt9IGVsc2UgewogICAgICBzdGF0ZS5ncm91cENoYXRMaXN0LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBpZiAoZWxlbWVudC5pZCA9PT0gZGF0YS5jaGF0SWQpIHsKICAgICAgICAgIGJ1cy4kc2V0KGVsZW1lbnQsICJjb3VudCIsIGVsZW1lbnQuY291bnQrKyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAogIHJlbW92OiBmdW5jdGlvbiByZW1vdihzdGF0ZSkgewogICAgc3RhdGUuY2hhdExpc3RNZXNzYWdlcy5zcGxpY2UoLTEsIDEpOwogIH0KfTsKZXhwb3J0IHZhciBhY3Rpb25zID0gewogIHNldENoYXRNZXNzYWdlTWFrZVJlYWQ6IGZ1bmN0aW9uIHNldENoYXRNZXNzYWdlTWFrZVJlYWQoX3JlZiwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIGNvbW1pdDsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoJ3NldENoYXRNZXNzYWdlTWFrZVJlYWQnLCBKU09OLnBhcnNlKGRhdGEuYm9keSkpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlKTsKICAgIH0pKSgpOwogIH0sCiAgZ2V0VW5yZWFkTWVzc2FnZXM6IGZ1bmN0aW9uIGdldFVucmVhZE1lc3NhZ2VzKHN0KSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBtZXNzZW5nZXJTZXJ2aWNlLmdldFVucmVhZE1lc3NhZ2VzKCkudGhlbihmdW5jdGlvbiAocnMpIHsKICAgICAgICAgICAgICAgIHN0LmNvbW1pdCgnc2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50JywgcnMuZGF0YSk7CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMik7CiAgICB9KSkoKTsKICB9LAogIHNlbmRBbm5vdW5jZW1lbnREb2N1bWVudE1hcmtpbmc6IGZ1bmN0aW9uIHNlbmRBbm5vdW5jZW1lbnREb2N1bWVudE1hcmtpbmcoc3QsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcENsaWVudFNlbmRNZXNzYWdlIiwgewogICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvYXBwL2Fubm91bmNlbWVudERvY3VtZW50TWFya2luZyIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiBkYXRhCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMyk7CiAgICB9KSkoKTsKICB9LAogIHNldENoYXRVbnJlYWRDb3VudDogZnVuY3Rpb24gc2V0Q2hhdFVucmVhZENvdW50KF9yZWYyLCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgdmFyIGNvbW1pdDsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmMi5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoJ3NldENoYXRVbnJlYWRDb3VudCcsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlNCk7CiAgICB9KSkoKTsKICB9LAogIHNldENoYXRVbnJlYWRNZXNzYWdDb3VudDogZnVuY3Rpb24gc2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50KF9yZWYzLCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgICAgdmFyIGNvbW1pdDsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmMy5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldENoYXRVbnJlYWRNZXNzYWdDb3VudCIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlNSk7CiAgICB9KSkoKTsKICB9LAogIHNldERvY3VtZW50TWFya2luZzogZnVuY3Rpb24gc2V0RG9jdW1lbnRNYXJraW5nKF9yZWY0LCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgdmFyIGNvbW1pdDsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmNC5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldE1hcmtldGluZyIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlNik7CiAgICB9KSkoKTsKICB9LAogIHNldE5vdGlmaWNhdGlvbk1zZzogZnVuY3Rpb24gc2V0Tm90aWZpY2F0aW9uTXNnKF9yZWY1LCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHsKICAgICAgdmFyIGNvbW1pdDsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmNS5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldE5vdGlmaWNhdGlvbiIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlNyk7CiAgICB9KSkoKTsKICB9LAogIHNldENvbW1lbnRUYXNrOiBmdW5jdGlvbiBzZXRDb21tZW50VGFzayhfcmVmNiwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgoKSB7CiAgICAgIHZhciBjb21taXQ7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZjYuY29tbWl0OwogICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRDb21tZW50cyIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlOCk7CiAgICB9KSkoKTsKICB9LAogIHNldEluY29taW5nUGVyc29uOiBmdW5jdGlvbiBzZXRJbmNvbWluZ1BlcnNvbihfcmVmNywgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoKSB7CiAgICAgIHZhciBjb21taXQsIHBhcnNlZDsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmNy5jb21taXQ7CiAgICAgICAgICAgICAgcGFyc2VkID0gSlNPTi5wYXJzZShkYXRhLmJvZHkpOwoKICAgICAgICAgICAgICBpZiAoIShwYXJzZWQuZGV2aWNlTmFtZSA9PSAnZW50ZXInKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDU7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0SW5jb21pbmdQZXJzb24iLCBwYXJzZWQpOwoKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gOTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDk7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0RXhpdGluZ1BlcnNvbiIsIHBhcnNlZCk7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlOSk7CiAgICB9KSkoKTsKICB9LAogIHNldEdyb3VwVXBkYXRlOiBmdW5jdGlvbiBzZXRHcm91cFVwZGF0ZShfcmVmOCkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEwJChfY29udGV4dDEwKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmOC5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRHcm91cFVwZGF0ZUUiLCBmYWxzZSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTEwKTsKICAgIH0pKSgpOwogIH0sCiAgc2V0TWVzc2FnZTogZnVuY3Rpb24gc2V0TWVzc2FnZShfcmVmOSwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTExJChfY29udGV4dDExKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmOS5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJwdXNoQ2hhdExpc3QiLCBKU09OLnBhcnNlKGRhdGEuYm9keSkpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUxMSk7CiAgICB9KSkoKTsKICB9LAogIHNldEdyb3VwTWVzc2FnZTogZnVuY3Rpb24gc2V0R3JvdXBNZXNzYWdlKF9yZWYxMCwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEyKCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEyJChfY29udGV4dDEyKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMi5wcmV2ID0gX2NvbnRleHQxMi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmMTAuY29tbWl0OwogICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgicHVzaEdyb3VwQ291bnQiLCBKU09OLnBhcnNlKGRhdGEuYm9keSkpOwoKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDU7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgicHVzaEdyb3VwQ2hhdExpc3QiLCBKU09OLnBhcnNlKGRhdGEuYm9keSkpOwoKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUxMik7CiAgICB9KSkoKTsKICB9LAogIHNlbmRNZXNzYWdlOiBmdW5jdGlvbiBzZW5kTWVzc2FnZShzdCwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMy5wcmV2ID0gX2NvbnRleHQxMy5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBDbGllbnRTZW5kTWVzc2FnZSIsIHsKICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL2FwcC9zZW5kTWVzc2FnZSIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiBkYXRhCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTEzKTsKICAgIH0pKSgpOwogIH0sCiAgc2VuZE1lc3NhZ2VHcm91cDogZnVuY3Rpb24gc2VuZE1lc3NhZ2VHcm91cChzdCwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE0KCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE0JChfY29udGV4dDE0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNC5wcmV2ID0gX2NvbnRleHQxNC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBDbGllbnRTZW5kTWVzc2FnZSIsIHsKICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL2FwcC9zZW5kR3JvdXBNZXNzYWdlIiwKICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMTQpOwogICAgfSkpKCk7CiAgfSwKICBhbGxVbnJlYWRNZXNzYWdlczogZnVuY3Rpb24gYWxsVW5yZWFkTWVzc2FnZXMoc3QpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNSgpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNSQoX2NvbnRleHQxNSkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTUucHJldiA9IF9jb250ZXh0MTUubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wQ2xpZW50U2VuZE1lc3NhZ2UiLCB7CiAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICBlbmRwb2ludDogIi9hcHAvYWxsVW5yZWFkTWVzc2FnZXMiLAogICAgICAgICAgICAgICAgbWVzc2FnZTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICB1c2VyX2lkOiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VyX2lkIikpCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE1LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUxNSk7CiAgICB9KSkoKTsKICB9LAogIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKHN0KSB7CiAgICB2YXIgX2FyZ3VtZW50cyA9IGFyZ3VtZW50czsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyNSgpIHsKICAgICAgdmFyIHVzciwgdXNlcm5hbWUsIGZ1bGxOYW1lOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI1JChfY29udGV4dDI1KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyNS5wcmV2ID0gX2NvbnRleHQyNS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICB1c3IgPSBfYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgX2FyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3VtZW50c1sxXSA6IG51bGw7CiAgICAgICAgICAgICAgdXNlcm5hbWUgPSBudWxsLCBmdWxsTmFtZSA9IG51bGw7CgogICAgICAgICAgICAgIGlmICghdXNyKSB7CiAgICAgICAgICAgICAgICB1c2VybmFtZSA9IFRva2VuU2VydmljZS5nZXRVc2VySW5mbygpID8gVG9rZW5TZXJ2aWNlLmdldFVzZXJJbmZvKCkudXNlcm5hbWUgOiBudWxsOwogICAgICAgICAgICAgICAgZnVsbE5hbWUgPSBUb2tlblNlcnZpY2UuZ2V0VXNlckluZm8oKSA/IFRva2VuU2VydmljZS5nZXRVc2VySW5mbygpLmVtcGxveWVlRnVsbE5hbWUgOiBudWxsOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB1c2VybmFtZSA9IHVzcjsKICAgICAgICAgICAgICB9IC8vIGxldCBvd25lcklkID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcl9pZCIpKTsKCgogICAgICAgICAgICAgIGlmICh1c2VybmFtZSB8fCBmdWxsTmFtZSkgewogICAgICAgICAgICAgICAgaWYgKHVzciA9PSAnc2VjdXJpdHknKSB7CiAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJjb25uZWN0IikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wU3Vic2NyaWJlIiwgewogICAgICAgICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci9zZWN1cml0eS9pbmNvbWluZ1BlcnNvbiIsCiAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NhbGxiYWNrID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTYoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTYkKF9jb250ZXh0MTYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNi5wcmV2ID0gX2NvbnRleHQxNi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldEluY29taW5nUGVyc29uIiwgZGF0YSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTYuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTE2KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3gpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjazsKICAgICAgICAgICAgICAgICAgICAgIH0oKQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJjb25uZWN0IikudGhlbiggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgX3JlZjExID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTcocykgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNyQoX2NvbnRleHQxNykgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNy5wcmV2ID0gX2NvbnRleHQxNy5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcENsaWVudFNlbmRNZXNzYWdlIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludDogIi9hcHAvcmVnaXN0ZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHVzZXJuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE3LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxNyk7CiAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94MikgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWYxMS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIH0oKSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wU3Vic2NyaWJlIiwgewogICAgICAgICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci8iLmNvbmNhdCh1c2VybmFtZSwgIi9tc2ciKSwKICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2syID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTgoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTgkKF9jb250ZXh0MTgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxOC5wcmV2ID0gX2NvbnRleHQxOC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldE1lc3NhZ2UiLCBkYXRhKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTgpOwogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhfeDMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NhbGxiYWNrMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgICB9KCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wU3Vic2NyaWJlIiwgewogICAgICAgICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci8iLmNvbmNhdCh1c2VybmFtZSwgIi9ncm91cE1zZyIpLAogICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9jYWxsYmFjazMgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxOShkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxOSQoX2NvbnRleHQxOSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE5LnByZXYgPSBfY29udGV4dDE5Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0R3JvdXBNZXNzYWdlIiwgZGF0YSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTkuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTE5KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3g0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jYWxsYmFjazMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrOwogICAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL3VzZXIvIi5jb25jYXQodXNlcm5hbWUsICIvZG9jdW1lbnRNYXJraW5nIiksCiAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NhbGxiYWNrNCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIwKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIwJChfY29udGV4dDIwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjAucHJldiA9IF9jb250ZXh0MjAubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXREb2N1bWVudE1hcmtpbmciLCBkYXRhKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjApOwogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhfeDUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NhbGxiYWNrNC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgICB9KCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wU3Vic2NyaWJlIiwgewogICAgICAgICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci8iLmNvbmNhdCh1c2VybmFtZSwgIi9ub3RpZmljYXRpb25Nc2ciKSwKICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2s1ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjEoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjEkKF9jb250ZXh0MjEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyMS5wcmV2ID0gX2NvbnRleHQyMS5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldE5vdGlmaWNhdGlvbk1zZyIsIGRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldENvdW50IiwgbnVsbCwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMS5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjEpOwogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhfeDYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NhbGxiYWNrNS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgICB9KCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSkgLy8gLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgICAvLyAgICAgc3QuZGlzcGF0Y2goInN0b21wU3Vic2NyaWJlIiwgewogICAgICAgICAgICAgICAgICAvLyAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBlbmRwb2ludDogYC91c2VyLyR7ZnVsbE5hbWV9L2NvbW1lbnRNZ3NgLAogICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGNhbGxiYWNrOiBhc3luYyAoZGF0YSkgPT4gewogICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0Q29tbWVudFRhc2siLCBkYXRhKTsKICAgICAgICAgICAgICAgICAgLy8gICAgICAgICB9LAogICAgICAgICAgICAgICAgICAvLyAgICAgfSk7CiAgICAgICAgICAgICAgICAgIC8vIH0pCiAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBTdWJzY3JpYmUiLCB7CiAgICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludDogIi91c2VyLyIuY29uY2F0KHVzZXJuYW1lLCAiL3VucmVhZE1lc3NhZ2VzIiksCiAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NhbGxiYWNrNiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIyKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIyJChfY29udGV4dDIyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjIucHJldiA9IF9jb250ZXh0MjIubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXRDaGF0VW5yZWFkTWVzc2FnQ291bnQiLCBkYXRhKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjIpOwogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhfeDcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NhbGxiYWNrNi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgICB9KCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wU3Vic2NyaWJlIiwgewogICAgICAgICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci8iLmNvbmNhdCh1c2VybmFtZSwgIi91bnJlYWRNZXNzYWdlIiksCiAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NhbGxiYWNrNyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIzKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIzJChfY29udGV4dDIzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjMucHJldiA9IF9jb250ZXh0MjMubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXRDaGF0VW5yZWFkQ291bnQiLCBkYXRhKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMy5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMjMpOwogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhfeDgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NhbGxiYWNrNy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgICB9KCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wU3Vic2NyaWJlIiwgewogICAgICAgICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci8iLmNvbmNhdCh1c2VybmFtZSwgIi9tYWtlUmVhZCIpLAogICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9jYWxsYmFjazggPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyNChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyNCQoX2NvbnRleHQyNCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDI0LnByZXYgPSBfY29udGV4dDI0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0Q2hhdE1lc3NhZ2VNYWtlUmVhZCIsIGRhdGEpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDI0LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUyNCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKF94OSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2s4LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjazsKICAgICAgICAgICAgICAgICAgICAgIH0oKQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjUuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTI1KTsKICAgIH0pKSgpOwogIH0sCiAgY29ubmVjdDogZnVuY3Rpb24gY29ubmVjdChfcmVmMTIpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMTIuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgZ2xvYmFsU3RvbXBDbGllbnQgPSBTdG9tcC5vdmVyKG5ldyBTb2NrSlMoIiIuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfV0VCU09DS0VUX0FQSSwgIi9ncy1ndWlkZS13ZWJzb2NrZXQiKSkpOwoKICAgICAgaWYgKGdsb2JhbFN0b21wQ2xpZW50KSB7CiAgICAgICAgZ2xvYmFsU3RvbXBDbGllbnQuaGFzRGVidWcgPSBmYWxzZTsKICAgICAgfQoKICAgICAgZ2xvYmFsU3RvbXBDbGllbnQuY29ubmVjdCh7fSwgZnVuY3Rpb24gKGZyYW1lKSB7CiAgICAgICAgcmV0dXJuIHJlc29sdmUoZ2xvYmFsU3RvbXBDbGllbnQpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgc3RvbXBDbGllbnRTZW5kTWVzc2FnZTogZnVuY3Rpb24gc3RvbXBDbGllbnRTZW5kTWVzc2FnZShzdCwgX3JlZjEzKSB7CiAgICB2YXIgc3RvbXBDbGllbnQgPSBfcmVmMTMuc3RvbXBDbGllbnQsCiAgICAgICAgZW5kcG9pbnQgPSBfcmVmMTMuZW5kcG9pbnQsCiAgICAgICAgbWVzc2FnZSA9IF9yZWYxMy5tZXNzYWdlOwogICAgc3RvbXBDbGllbnQuc2VuZChlbmRwb2ludCwgbWVzc2FnZSk7CiAgfSwKICBzdG9tcFN1YnNjcmliZTogZnVuY3Rpb24gc3RvbXBTdWJzY3JpYmUoc3QsIF9yZWYxNCkgewogICAgdmFyIHN0b21wQ2xpZW50ID0gX3JlZjE0LnN0b21wQ2xpZW50LAogICAgICAgIGVuZHBvaW50ID0gX3JlZjE0LmVuZHBvaW50LAogICAgICAgIGNhbGxiYWNrID0gX3JlZjE0LmNhbGxiYWNrOwogICAgc3RvbXBDbGllbnQuc3Vic2NyaWJlKGVuZHBvaW50LCBjYWxsYmFjayk7CiAgICByZXR1cm4gc3RvbXBDbGllbnQ7CiAgfSwKICBnZXRCeUNoYXRJZDogZnVuY3Rpb24gZ2V0QnlDaGF0SWQoX3JlZjE1LCBwYXJhbXMpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyNigpIHsKICAgICAgdmFyIGNvbW1pdCwgcmVzOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI2JChfY29udGV4dDI2KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyNi5wcmV2ID0gX2NvbnRleHQyNi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmMTUuY29tbWl0OwogICAgICAgICAgICAgIF9jb250ZXh0MjYucHJldiA9IDE7CiAgICAgICAgICAgICAgX2NvbnRleHQyNi5uZXh0ID0gNDsKICAgICAgICAgICAgICByZXR1cm4gbWVzc2VuZ2VyU2VydmljZS5nZXRCeUNoYXRJZChwYXJhbXMpOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0MjYuc2VudDsKICAgICAgICAgICAgICBfY29udGV4dDI2Lm5leHQgPSA3OwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldExpc3RDaGF0TWVzc2VnZXMiLCByZXMuZGF0YSA/IHJlcy5kYXRhIDogewogICAgICAgICAgICAgICAgbGlzdDogW10sCiAgICAgICAgICAgICAgICB0b3RhbDogMAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIF9jb250ZXh0MjYubmV4dCA9IDEzOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIF9jb250ZXh0MjYucHJldiA9IDk7CiAgICAgICAgICAgICAgX2NvbnRleHQyNi50MCA9IF9jb250ZXh0MjZbImNhdGNoIl0oMSk7CiAgICAgICAgICAgICAgX2NvbnRleHQyNi5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TGlzdENoYXRNZXNzZWdlcyIsIHsKICAgICAgICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgICAgICAgICAgdG90YWw6IDAKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjYuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTI2LCBudWxsLCBbWzEsIDldXSk7CiAgICB9KSkoKTsKICB9LAogIGdldEJ5R3JvdXBDaGF0SWQ6IGZ1bmN0aW9uIGdldEJ5R3JvdXBDaGF0SWQoX3JlZjE2LCBwYXJhbXMpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyNygpIHsKICAgICAgdmFyIGNvbW1pdCwgcmVzOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI3JChfY29udGV4dDI3KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyNy5wcmV2ID0gX2NvbnRleHQyNy5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmMTYuY29tbWl0OwogICAgICAgICAgICAgIF9jb250ZXh0MjcucHJldiA9IDE7CiAgICAgICAgICAgICAgX2NvbnRleHQyNy5uZXh0ID0gNDsKICAgICAgICAgICAgICByZXR1cm4gbWVzc2VuZ2VyU2VydmljZS5nZXRCeUdyb3VwQ2hhdElkKHBhcmFtcyk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQyNy5zZW50OwogICAgICAgICAgICAgIF9jb250ZXh0MjcubmV4dCA9IDc7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TGlzdEdyb3VwQ2hhdE1lc3NlZ2VzIiwgcmVzLmRhdGEgPyByZXMuZGF0YSA6IHsKICAgICAgICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgICAgICAgICAgdG90YWw6IDAKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBfY29udGV4dDI3Lm5leHQgPSAxMzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBfY29udGV4dDI3LnByZXYgPSA5OwogICAgICAgICAgICAgIF9jb250ZXh0MjcudDAgPSBfY29udGV4dDI3WyJjYXRjaCJdKDEpOwogICAgICAgICAgICAgIF9jb250ZXh0MjcubmV4dCA9IDEzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldExpc3RHcm91cENoYXRNZXNzZWdlcyIsIHsKICAgICAgICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgICAgICAgICAgdG90YWw6IDAKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mjcuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTI3LCBudWxsLCBbWzEsIDldXSk7CiAgICB9KSkoKTsKICB9LAogIGdldENvbnRhY3RMaXN0OiBmdW5jdGlvbiBnZXRDb250YWN0TGlzdChfcmVmMTcsIHBhcmFtcykgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI4KCkgewogICAgICB2YXIgY29tbWl0LCByZXM7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjgkKF9jb250ZXh0MjgpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDI4LnByZXYgPSBfY29udGV4dDI4Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYxNy5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQyOC5wcmV2ID0gMTsKICAgICAgICAgICAgICBfY29udGV4dDI4Lm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiBtZXNzZW5nZXJTZXJ2aWNlLmdldENvbnRhY3RMaXN0KHBhcmFtcyk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQyOC5zZW50OwogICAgICAgICAgICAgIF9jb250ZXh0MjgubmV4dCA9IDc7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TGlzdFJlc3BvbnNlIiwgcmVzLmRhdGEgPyByZXMuZGF0YSA6IHsKICAgICAgICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgICAgICAgICAgdG90YWw6IDAKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBfY29udGV4dDI4Lm5leHQgPSAxMzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBfY29udGV4dDI4LnByZXYgPSA5OwogICAgICAgICAgICAgIF9jb250ZXh0MjgudDAgPSBfY29udGV4dDI4WyJjYXRjaCJdKDEpOwogICAgICAgICAgICAgIF9jb250ZXh0MjgubmV4dCA9IDEzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldExpc3RSZXNwb25zZSIsIHsKICAgICAgICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgICAgICAgICAgdG90YWw6IDAKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mjguc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTI4LCBudWxsLCBbWzEsIDldXSk7CiAgICB9KSkoKTsKICB9LAogIGdldEdyb3VwQ2hhdExpc3Q6IGZ1bmN0aW9uIGdldEdyb3VwQ2hhdExpc3QoX3JlZjE4LCBwYXJhbXMpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyOSgpIHsKICAgICAgdmFyIGNvbW1pdCwgcmVzOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI5JChfY29udGV4dDI5KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyOS5wcmV2ID0gX2NvbnRleHQyOS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmMTguY29tbWl0OwogICAgICAgICAgICAgIF9jb250ZXh0MjkucHJldiA9IDE7CiAgICAgICAgICAgICAgX2NvbnRleHQyOS5uZXh0ID0gNDsKICAgICAgICAgICAgICByZXR1cm4gbWVzc2VuZ2VyU2VydmljZS5ncm91cENoYXRMaXN0KHBhcmFtcyk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQyOS5zZW50OwogICAgICAgICAgICAgIF9jb250ZXh0MjkubmV4dCA9IDc7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TGlzdFJlc3BvbnNlR3JvdXBDaGF0IiwgcmVzLmRhdGEgPyByZXMuZGF0YSA6IHsKICAgICAgICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgICAgICAgICAgdG90YWw6IDAKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICBfY29udGV4dDI5Lm5leHQgPSAxMzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBfY29udGV4dDI5LnByZXYgPSA5OwogICAgICAgICAgICAgIF9jb250ZXh0MjkudDAgPSBfY29udGV4dDI5WyJjYXRjaCJdKDEpOwogICAgICAgICAgICAgIF9jb250ZXh0MjkubmV4dCA9IDEzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldExpc3RSZXNwb25zZUdyb3VwQ2hhdCIsIHsKICAgICAgICAgICAgICAgIGxpc3Q6IFtdLAogICAgICAgICAgICAgICAgdG90YWw6IDAKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mjkuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTI5LCBudWxsLCBbWzEsIDldXSk7CiAgICB9KSkoKTsKICB9Cn07"},{"version":3,"sources":["C:/ACRU PROJECT/Fair Tech/acru-frontend/src/state/modules/messenger.js"],"names":["TokenService","messengerService","SockJS","Stomp","Vue","globalStompClient","state","marketing","notification","contactList","contactTotal","groupChatList","groupChatTotal","comments","commentsTotal","openPage","chatListMessages","chatTotalMessages","groupChatListMessages","groupChatTotalMessages","lastMessage","lastMessageGroup","groupUpdate","groupUpdateMsg","incomingPerson","exitingPerson","chatUnreadCount","unreadData","CHAT","mutations","setCurrentChat","data","setChatMessageMakeRead","id","index","findIndex","e","set","setChatUnreadMessagCount","count","setChatUnreadCount","setComments","setIncomingPerson","setExitingPerson","setMarketing","setNotification","setGroupUpdateE","setGroupChatUpdate","setListResponseGroupChat","list","total","setListResponse","map","firstName","lastName","employeeId","chatId","uploadPath","setOpenPage","setListChatMesseges","setListGroupChatMesseges","pushItems","concat","pushGroupItems","pushChatList","extra","deleteId","splice","editedMessage","message","edited","push","pushCount","chatList","forEach","element","bus","$set","pushGroupChatList","groupChatId","unreadId","isRead","editedGroupMessage","pushGroupCount","remov","actions","commit","JSON","parse","body","getUnreadMessages","st","then","rs","sendAnnouncementDocumentMarking","dispatch","stompClient","endpoint","setDocumentMarking","setNotificationMsg","setCommentTask","parsed","deviceName","setGroupUpdate","setMessage","setGroupMessage","sendMessage","sendMessageGroup","allUnreadMessages","stringify","user_id","localStorage","getItem","onLoad","usr","username","fullName","getUserInfo","employeeFullName","callback","s","root","connect","Promise","resolve","reject","over","process","env","VUE_APP_WEBSOCKET_API","hasDebug","frame","stompClientSendMessage","send","stompSubscribe","subscribe","getByChatId","params","res","getByGroupChatId","getContactList","getGroupChatList"],"mappings":"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","sourcesContent":["\r\nimport { TokenService } from \"@/shared/services/storage.service\"\r\nimport messengerService from \"@/shared/services/messengerService\";\r\nimport SockJS from \"sockjs-client\";\r\nimport Stomp from \"webstomp-client\";\r\nimport Vue from \"vue\"\r\n\r\nlet globalStompClient = null;\r\nexport const state = {\r\n    marketing: null,\r\n    notification: null,\r\n    contactList: [],\r\n    contactTotal: 0,\r\n    groupChatList: [],\r\n    groupChatTotal: 0,\r\n    comments: [],\r\n    commentsTotal: 0,\r\n    openPage: \"default\",\r\n    chatListMessages: [],\r\n    chatTotalMessages: 0,\r\n    groupChatListMessages: [],\r\n    groupChatTotalMessages: 0,\r\n    lastMessage: {},\r\n    lastMessageGroup: {},\r\n    groupUpdate: false,\r\n    groupUpdateMsg: null,\r\n    incomingPerson: null,\r\n    exitingPerson: null,\r\n    chatUnreadCount: 0,\r\n    unreadData: null,\r\n    CHAT: null\r\n}\r\n\r\nexport const mutations = {\r\n    setCurrentChat (state, data) {\r\n        state.CHAT = data\r\n    },\r\n    setChatMessageMakeRead (state, id) {\r\n        let index = state.chatListMessages.findIndex(e => e.id == id)\r\n        if (index > -1) {\r\n            Vue.set(state.chatListMessages[index], \"isRead\", \"READ\")\r\n        }\r\n    },\r\n    setChatUnreadMessagCount (state, count) {\r\n        state.chatUnreadCount = count\r\n        if (count > 0) {\r\n            // playSound()\r\n        }\r\n    },\r\n    setChatUnreadCount (state, data) {\r\n        state.unreadData = data\r\n    },\r\n    setComments (state, data) {\r\n        state.comments = data\r\n    },\r\n    setIncomingPerson (state, data) {\r\n        state.incomingPerson = data\r\n    },\r\n    setExitingPerson (state, data) {\r\n        state.exitingPerson = data\r\n    },\r\n    setMarketing (state, data) {\r\n        state.marketing = data\r\n    },\r\n    setNotification (state, data) {\r\n        state.notification = data\r\n    },\r\n    setGroupUpdateE (state, data) {\r\n        state.groupUpdate = data;\r\n\r\n    },\r\n    setGroupChatUpdate (state, data) {\r\n        state.groupUpdate = true;\r\n        state.groupUpdateMsg = data;\r\n    },\r\n    setListResponseGroupChat (state, data) {\r\n        state.groupChatList = data.list;\r\n        state.groupChatTotal = data.total;\r\n    },\r\n    setListResponse (state, data) {\r\n        state.contactList = data.list.map(e => {\r\n            return {\r\n                firstName: e.firstName,\r\n                lastName: e.lastName,\r\n                employeeId: e.employeeId,\r\n                chatId: e.chatId,\r\n                uploadPath: e.uploadPath\r\n            }\r\n        })\r\n        state.contactTotal = data.total;\r\n    },\r\n    setOpenPage (state, data) {\r\n        state.openPage = data;\r\n    },\r\n    setListChatMesseges (state, data) {\r\n        state.chatListMessages = data.list;\r\n        state.chatTotalMessages = data.total;\r\n    },\r\n    setListGroupChatMesseges (state, data) {\r\n        state.groupChatListMessages = data.list;\r\n        state.groupChatTotalMessages = data.total;\r\n    },\r\n    pushItems (state, data) {\r\n        state.chatListMessages = data.concat(state.chatListMessages)\r\n    },\r\n    pushGroupItems (state, data) {\r\n        state.groupChatListMessages = data.concat(state.groupChatListMessages)\r\n    },\r\n    pushChatList (state, data) {\r\n        if (state.CHAT && state.CHAT.id == data.chatId) {\r\n            if (data.extra == 'delete') {\r\n                const index = state.chatListMessages.findIndex(e => e.id == data.deleteId)\r\n                if (index > -1) {\r\n                    state.chatListMessages.splice(index, 1);\r\n                }\r\n            } else if (data.extra == 'update') {\r\n                const index = state.chatListMessages.findIndex(e => e.id == data.editedMessage.id)\r\n                if (index > -1) {\r\n                    state.chatListMessages[index].message = data.editedMessage.message\r\n                    state.chatListMessages[index].edited = true\r\n                }\r\n            } else {\r\n                let index = state.chatListMessages.findIndex(e => e.id == data.id)\r\n                if (!index || index <= -1) {\r\n                    state.chatListMessages.push(data)\r\n                    state.chatTotalMessages++\r\n                }\r\n            }\r\n        }\r\n    },\r\n    pushCount (state, data) {\r\n        state.chatList.forEach((element) => {\r\n            if (element.id === data.chatId) {\r\n                bus.$set(element, \"count\", element.count++);\r\n            }\r\n        });\r\n    },\r\n    pushGroupChatList (state, data) {\r\n        if (state.CHAT && state.CHAT.id == data.groupChatId) {\r\n            if (data.extra === \"unread\") {\r\n                state.groupChatListMessages.forEach((element) => {\r\n                    if (element.id == data.unreadId) {\r\n                        element.isRead = \"READ\";\r\n                    }\r\n                });\r\n            } else if (data.extra === \"delete\") {\r\n                const index = state.groupChatListMessages.findIndex(e => e.id == data.deleteId)\r\n                if (index > -1) {\r\n                    state.groupChatListMessages.splice(index, 1);\r\n                }\r\n            } else if (data.extra === \"update\") {\r\n                const index = state.groupChatListMessages.findIndex(e => e.id == data.editedGroupMessage.id)\r\n                if (index > -1) {\r\n                    state.groupChatListMessages[index].message = data.editedGroupMessage.message\r\n                    state.groupChatListMessages[index].edited = true\r\n                }\r\n            } else {\r\n                const index = state.groupChatListMessages.findIndex(e => e.id == data.id)\r\n                if (index <= -1) {\r\n                    state.groupChatListMessages.push(data)\r\n                    state.groupChatTotalMessages++\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n    },\r\n    pushGroupCount (state, data) {\r\n        if (data.extra === \"unread\") {\r\n        } else if (data.extra === \"delete\") {\r\n\r\n        } else if (data.extra === \"update\") {\r\n        } else {\r\n            state.groupChatList.forEach((element) => {\r\n                if (element.id === data.chatId) {\r\n                    bus.$set(element, \"count\", element.count++);\r\n                }\r\n            });\r\n        }\r\n    },\r\n    remov (state) {\r\n        state.chatListMessages.splice(-1, 1)\r\n    }\r\n}\r\n\r\nexport const actions = {\r\n    async setChatMessageMakeRead ({ commit }, data) {\r\n        await commit('setChatMessageMakeRead', JSON.parse(data.body))\r\n    },\r\n    async getUnreadMessages (st) {\r\n        messengerService.getUnreadMessages()\r\n            .then(rs => {\r\n                st.commit('setChatUnreadMessagCount', rs.data)\r\n            })\r\n    },\r\n    async sendAnnouncementDocumentMarking (st, data) {\r\n        st.dispatch(\"stompClientSendMessage\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: \"/app/announcementDocumentMarking\",\r\n            message: data,\r\n        });\r\n    },\r\n    async setChatUnreadCount ({ commit }, data) {\r\n        await commit('setChatUnreadCount', JSON.parse(data.body))\r\n    },\r\n    async setChatUnreadMessagCount ({ commit }, data) {\r\n        await commit(\"setChatUnreadMessagCount\", JSON.parse(data.body));\r\n    },\r\n    async setDocumentMarking ({ commit }, data) {\r\n        await commit(\"setMarketing\", JSON.parse(data.body));\r\n    },\r\n    async setNotificationMsg ({ commit }, data) {\r\n        await commit(\"setNotification\", JSON.parse(data.body));\r\n    },\r\n    async setCommentTask ({ commit }, data) {\r\n        await commit(\"setComments\", JSON.parse(data.body));\r\n    },\r\n    async setIncomingPerson ({ commit }, data) {\r\n        let parsed = JSON.parse(data.body)\r\n        if (parsed.deviceName == 'enter') {\r\n            await commit(\"setIncomingPerson\", parsed);\r\n        } else {\r\n            await commit(\"setExitingPerson\", parsed);\r\n        }\r\n\r\n    },\r\n\r\n\r\n    async setGroupUpdate ({ commit }) {\r\n        await commit(\"setGroupUpdateE\", false);\r\n    },\r\n    async setMessage ({ commit }, data) {\r\n        await commit(\"pushChatList\", JSON.parse(data.body));\r\n    },\r\n    async setGroupMessage ({ commit }, data) {\r\n        await commit(\"pushGroupCount\", JSON.parse(data.body));\r\n        await commit(\"pushGroupChatList\", JSON.parse(data.body));\r\n    },\r\n    async sendMessage (st, data) {\r\n        st.dispatch(\"stompClientSendMessage\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: \"/app/sendMessage\",\r\n            message: data,\r\n        });\r\n    },\r\n    async sendMessageGroup (st, data) {\r\n        st.dispatch(\"stompClientSendMessage\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: \"/app/sendGroupMessage\",\r\n            message: data,\r\n        });\r\n    },\r\n    async allUnreadMessages (st) {\r\n        st.dispatch(\"stompClientSendMessage\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: \"/app/allUnreadMessages\",\r\n            message: JSON.stringify({ user_id: JSON.parse(localStorage.getItem(\"user_id\")) }),\r\n        });\r\n    },\r\n    async onLoad (st, usr = null) {\r\n        let username = null, fullName = null;\r\n        if (!usr) {\r\n            username = TokenService.getUserInfo() ? TokenService.getUserInfo().username : null;\r\n            fullName = TokenService.getUserInfo() ? TokenService.getUserInfo().employeeFullName : null;\r\n        } else {\r\n            username = usr\r\n\r\n        }\r\n        // let ownerId = JSON.parse(localStorage.getItem(\"user_id\"));\r\n\r\n        if (username || fullName) {\r\n            if (usr == 'security') {\r\n                st.dispatch(\"connect\").then(() => {\r\n                    st.dispatch(\"stompSubscribe\", {\r\n                        stompClient: globalStompClient,\r\n                        endpoint: `/user/security/incomingPerson`,\r\n                        callback: async (data) => {\r\n                            st.dispatch(\"setIncomingPerson\", data);\r\n                        },\r\n                    });\r\n                })\r\n            } else {\r\n                st.dispatch(\"connect\")\r\n                    .then(async (s) => {\r\n                        st.dispatch(\"stompClientSendMessage\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: \"/app/register\",\r\n                            message: username,\r\n                        });\r\n                    })\r\n                    .then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/msg`,\r\n                            callback: async (data) => {\r\n                                st.dispatch(\"setMessage\", data);\r\n                            },\r\n                        });\r\n                    }).then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/groupMsg`,\r\n                            callback: async (data) => {\r\n                                st.dispatch(\"setGroupMessage\", data);\r\n                            },\r\n                        });\r\n                    }).then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/documentMarking`,\r\n                            callback: async (data) => {\r\n                                st.dispatch(\"setDocumentMarking\", data);\r\n                            },\r\n                        });\r\n                    }).then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/notificationMsg`,\r\n                            callback: async (data) => {\r\n                                st.dispatch(\"setNotificationMsg\", data);\r\n                                st.dispatch(\"setCount\", null, { root: true })\r\n                            },\r\n                        });\r\n                    })\r\n                    // .then(() => {\r\n                    //     st.dispatch(\"stompSubscribe\", {\r\n                    //         stompClient: globalStompClient,\r\n                    //         endpoint: `/user/${fullName}/commentMgs`,\r\n                    //         callback: async (data) => {\r\n                    //             st.dispatch(\"setCommentTask\", data);\r\n                    //         },\r\n                    //     });\r\n                    // })\r\n                    .then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/unreadMessages`,\r\n                            callback: async (data) => {\r\n                                st.dispatch(\"setChatUnreadMessagCount\", data);\r\n                            },\r\n                        });\r\n                    }).then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/unreadMessage`,\r\n                            callback: async (data) => {\r\n\r\n                                st.dispatch(\"setChatUnreadCount\", data);\r\n                            },\r\n                        });\r\n                    }).then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/makeRead`,\r\n                            callback: async (data) => {\r\n\r\n                                st.dispatch(\"setChatMessageMakeRead\", data);\r\n                            },\r\n                        });\r\n                    })\r\n\r\n\r\n            }\r\n\r\n        }\r\n    },\r\n    connect ({ commit }) {\r\n        return new Promise((resolve, reject) => {\r\n            globalStompClient = Stomp.over(\r\n                new SockJS(`${process.env.VUE_APP_WEBSOCKET_API}/gs-guide-websocket`)\r\n            );\r\n            if (globalStompClient) {\r\n                globalStompClient.hasDebug = false\r\n            }\r\n            globalStompClient.connect({}, (frame) => resolve(globalStompClient));\r\n        });\r\n    },\r\n    stompClientSendMessage (st, { stompClient, endpoint, message }) {\r\n        stompClient.send(endpoint, message);\r\n    },\r\n    stompSubscribe (st, { stompClient, endpoint, callback }) {\r\n        stompClient.subscribe(endpoint, callback);\r\n        return stompClient;\r\n    },\r\n    async getByChatId ({ commit }, params) {\r\n        try {\r\n            const res = await messengerService.getByChatId(params);\r\n            await commit(\r\n                \"setListChatMesseges\",\r\n                res.data ? res.data : { list: [], total: 0 }\r\n            );\r\n        } catch (error) {\r\n            await commit(\"setListChatMesseges\", { list: [], total: 0 });\r\n        }\r\n    },\r\n    async getByGroupChatId ({ commit }, params) {\r\n        try {\r\n            const res = await messengerService.getByGroupChatId(params);\r\n            await commit(\r\n                \"setListGroupChatMesseges\",\r\n                res.data ? res.data : { list: [], total: 0 }\r\n            );\r\n        } catch (error) {\r\n            await commit(\"setListGroupChatMesseges\", { list: [], total: 0 });\r\n        }\r\n    },\r\n    async getContactList ({ commit }, params) {\r\n        try {\r\n            const res = await messengerService.getContactList(params);\r\n            await commit(\r\n                \"setListResponse\",\r\n                res.data ? res.data : { list: [], total: 0 }\r\n            );\r\n        } catch (error) {\r\n            await commit(\"setListResponse\", { list: [], total: 0 });\r\n        }\r\n    },\r\n    async getGroupChatList ({ commit }, params) {\r\n        try {\r\n            const res = await messengerService.groupChatList(params);\r\n            await commit(\"setListResponseGroupChat\", res.data ? res.data : { list: [], total: 0 }\r\n            );\r\n        } catch (error) {\r\n            await commit(\"setListResponseGroupChat\", { list: [], total: 0 });\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}]}