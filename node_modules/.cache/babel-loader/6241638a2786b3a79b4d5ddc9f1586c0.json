{"remainingRequest":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\shared\\store\\auth.module.js","dependencies":[{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\src\\shared\\store\\auth.module.js","mtime":1667352074587},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\babel.config.js","mtime":1667352074157},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1667355379758},{"path":"C:\\ACRU PROJECT\\Fair Tech\\acru-frontend\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1667355397815}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6XFxBQ1JVIFBST0pFQ1RcXEZhaXIgVGVjaFxcYWNydS1mcm9udGVuZFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0IHsgQXV0aFNlcnZpY2UsIEF1dGhlbnRpY2F0aW9uRXJyb3IgfSBmcm9tICJAL3NoYXJlZC9zZXJ2aWNlcy9hdXRoLnNlcnZpY2UiOwppbXBvcnQgcm91dGVyIGZyb20gJ0Avcm91dGVyJzsKdmFyIHN0YXRlID0gewogIGF1dGhlbnRpY2F0aW5nOiBmYWxzZSwKICBhY2Nlc3NUb2tlbjogJycsCiAgYXV0aGVudGljYXRpb25FcnJvckNvZGU6IDAsCiAgYXV0aGVudGljYXRpb25FcnJvcjogJycsCiAgcmVmcmVzaFRva2VuUHJvbWlzZTogbnVsbCwKICAvLyBIb2xkcyB0aGUgcHJvbWlzZSBvZiB0aGUgcmVmcmVzaCB0b2tlbgogIFVzZXJJbmZvOiB7fQp9Owp2YXIgZ2V0dGVycyA9IHsKICBhdXRoZW50aWNhdGlvbkVycm9yQ29kZTogZnVuY3Rpb24gYXV0aGVudGljYXRpb25FcnJvckNvZGUoc3RhdGUpIHsKICAgIHJldHVybiBzdGF0ZS5hdXRoZW50aWNhdGlvbkVycm9yQ29kZTsKICB9LAogIGF1dGhlbnRpY2F0aW9uRXJyb3I6IGZ1bmN0aW9uIGF1dGhlbnRpY2F0aW9uRXJyb3Ioc3RhdGUpIHsKICAgIHJldHVybiBzdGF0ZS5hdXRoZW50aWNhdGlvbkVycm9yOwogIH0sCiAgYXV0aGVudGljYXRpbmc6IGZ1bmN0aW9uIGF1dGhlbnRpY2F0aW5nKHN0YXRlKSB7CiAgICByZXR1cm4gc3RhdGUuYXV0aGVudGljYXRpbmc7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICBsb2dpbjogZnVuY3Rpb24gbG9naW4oX3JlZiwgX3JlZjIpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBjb21taXQsIFVzZXJuYW1lLCBQYXNzd29yZCwgX2RhdGE7CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgICAgICAgICAgVXNlcm5hbWUgPSBfcmVmMi5Vc2VybmFtZSwgUGFzc3dvcmQgPSBfcmVmMi5QYXNzd29yZDsKICAgICAgICAgICAgICBjb21taXQoJ2xvZ2luUmVxdWVzdCcpOwogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAzOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgIHJldHVybiBBdXRoU2VydmljZS5sb2dpbihVc2VybmFtZSwgUGFzc3dvcmQpOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIF9kYXRhID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBjb21taXQoJ2xvZ2luU3VjY2VzcycsIF9kYXRhKTsKICAgICAgICAgICAgICBjb21taXQoJ1JPT1RfTE9HSU5fU1VDQ0VTUycsIF9kYXRhLCB7CiAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgfSk7IC8vIFJlZGlyZWN0IHRoZSB1c2VyIHRvIHRoZSBwYWdlIGhlIGZpcnN0IHRyaWVkIHRvIHZpc2l0IG9yIHRvIHRoZSBob21lIHZpZXcKCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgIHJldHVybiByb3V0ZXIucHVzaChyb3V0ZXIuaGlzdG9yeS5jdXJyZW50LnF1ZXJ5LnJlZGlyZWN0IHx8ICcvJyk7CgogICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHRydWUpOwoKICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTQ7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgzKTsKCiAgICAgICAgICAgICAgaWYgKF9jb250ZXh0LnQwIGluc3RhbmNlb2YgQXV0aGVudGljYXRpb25FcnJvcikgewogICAgICAgICAgICAgICAgY29tbWl0KCdsb2dpbkVycm9yJywgewogICAgICAgICAgICAgICAgICBlcnJvckNvZGU6IF9jb250ZXh0LnQwLmVycm9yQ29kZSwKICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlOiBfY29udGV4dC50MC5tZXNzYWdlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGZhbHNlKTsKCiAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMywgMTRdXSk7CiAgICB9KSkoKTsKICB9LAogIGxvZ2luQnlUb2tlbjogZnVuY3Rpb24gbG9naW5CeVRva2VuKF9yZWYzLCBfcmVmNCkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgIHZhciBjb21taXQsIHNpZ25lZERhdGEsIFRJTiwgUE5GTCwgX2RhdGEyOwoKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmMy5jb21taXQ7CiAgICAgICAgICAgICAgc2lnbmVkRGF0YSA9IF9yZWY0LnNpZ25lZERhdGEsIFRJTiA9IF9yZWY0LlRJTiwgUE5GTCA9IF9yZWY0LlBORkw7CiAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAyOwogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTsKICAgICAgICAgICAgICByZXR1cm4gQXV0aFNlcnZpY2UubG9naW5Fc3Aoc2lnbmVkRGF0YSwgVElOLCBQTkZMKTsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBfZGF0YTIgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICBjb21taXQoJ2xvZ2luU3VjY2VzcycsIF9kYXRhMik7CiAgICAgICAgICAgICAgY29tbWl0KCdST09UX0xPR0lOX1NVQ0NFU1MnLCBfZGF0YTIsIHsKICAgICAgICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICAgICAgICB9KTsgLy8gUmVkaXJlY3QgdGhlIHVzZXIgdG8gdGhlIHBhZ2UgaGUgZmlyc3QgdHJpZWQgdG8gdmlzaXQgb3IgdG8gdGhlIGhvbWUgdmlldwoKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEwOwogICAgICAgICAgICAgIHJldHVybiByb3V0ZXIucHVzaChyb3V0ZXIuaGlzdG9yeS5jdXJyZW50LnF1ZXJ5LnJlZGlyZWN0ID8gcm91dGVyLmhpc3RvcnkuY3VycmVudC5xdWVyeS5yZWRpcmVjdCA6ICcvJyk7CgogICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCB0cnVlKTsKCiAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAxMzsKICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oMik7CgogICAgICAgICAgICAgIGlmIChfY29udGV4dDIudDAgaW5zdGFuY2VvZiBBdXRoZW50aWNhdGlvbkVycm9yKSB7CiAgICAgICAgICAgICAgICBjb21taXQoJ2xvZ2luRXJyb3InLCB7CiAgICAgICAgICAgICAgICAgIGVycm9yQ29kZTogX2NvbnRleHQyLnQwLmVycm9yQ29kZSwKICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlOiBfY29udGV4dDIudDAubWVzc2FnZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwoKICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyLCBudWxsLCBbWzIsIDEzXV0pOwogICAgfSkpKCk7CiAgfSwKICByZWZyZXNoVG9rZW46IGZ1bmN0aW9uIHJlZnJlc2hUb2tlbihfcmVmNSkgewogICAgdmFyIGNvbW1pdCA9IF9yZWY1LmNvbW1pdCwKICAgICAgICBzdGF0ZSA9IF9yZWY1LnN0YXRlOwoKICAgIC8vIElmIHRoaXMgaXMgdGhlIGZpcnN0IHRpbWUgdGhlIHJlZnJlc2hUb2tlbiBoYXMgYmVlbiBjYWxsZWQsIG1ha2UgYSByZXF1ZXN0CiAgICAvLyBvdGhlcndpc2UgcmV0dXJuIHRoZSBzYW1lIHByb21pc2UgdG8gdGhlIGNhbGxlcgogICAgaWYgKCFzdGF0ZS5yZWZyZXNoVG9rZW5Qcm9taXNlKSB7CiAgICAgIHZhciBwID0gQXV0aFNlcnZpY2UucmVmcmVzaFRva2VuKCk7CiAgICAgIGNvbW1pdCgncmVmcmVzaFRva2VuUHJvbWlzZScsIHApOyAvLyBXYWl0IGZvciB0aGUgQXV0aFNlcnZpY2UucmVmcmVzaFRva2VuKCkgdG8gcmVzb2x2ZS4gT24gc3VjY2VzcyBzZXQgdGhlIHRva2VuIGFuZCBjbGVhciBwcm9taXNlCiAgICAgIC8vIENsZWFyIHRoZSBwcm9taXNlIG9uIGVycm9yIGFzIHdlbGwuCgogICAgICBwLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgY29tbWl0KCdyZWZyZXNoVG9rZW5Qcm9taXNlJywgbnVsbCk7CiAgICAgICAgY29tbWl0KCdsb2dpblN1Y2Nlc3MnLCByZXNwb25zZSk7CiAgICAgICAgY29tbWl0KCdST09UX0xPR0lOX1NVQ0NFU1MnLCBkYXRhLCB7CiAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICBjb21taXQoJ3JlZnJlc2hUb2tlblByb21pc2UnLCBudWxsKTsKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIHN0YXRlLnJlZnJlc2hUb2tlblByb21pc2U7CiAgfSwKICBsb2dvdXQ6IGZ1bmN0aW9uIGxvZ291dChfcmVmNikgewogICAgdmFyIGNvbW1pdCA9IF9yZWY2LmNvbW1pdDsKICAgIEF1dGhTZXJ2aWNlLmxvZ291dCgpOwogICAgY29tbWl0KCdsb2dvdXRTdWNjZXNzJyk7CiAgICBjb21taXQoJ1JPT1RfTE9HT1VUX1NVQ0NFU1MnLCBudWxsLCB7CiAgICAgIHJvb3Q6IHRydWUKICAgIH0pOyAvLyByb3V0ZXIucHVzaCgnYXV0aGVudGljYXRpb24vZnVsbGxvZ2luJykKCiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgfQp9Owp2YXIgbXV0YXRpb25zID0gewogIGxvZ2luUmVxdWVzdDogZnVuY3Rpb24gbG9naW5SZXF1ZXN0KHN0YXRlKSB7CiAgICBzdGF0ZS5hdXRoZW50aWNhdGluZyA9IHRydWU7CiAgICBzdGF0ZS5hdXRoZW50aWNhdGlvbkVycm9yID0gJyc7CiAgICBzdGF0ZS5hdXRoZW50aWNhdGlvbkVycm9yQ29kZSA9IDA7CiAgfSwKICBzZXRVc2VySW5mbzogZnVuY3Rpb24gc2V0VXNlckluZm8oc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLlVzZXJJbmZvID0gZGF0YTsKICB9LAogIGxvZ2luU3VjY2VzczogZnVuY3Rpb24gbG9naW5TdWNjZXNzKHN0YXRlLCBkYXRhKSB7CiAgICAvKmxldCBmb3JtYXR0ZWRSdWxlcyA9IFtdOw0KICAgIGlmIChkYXRhLnBlcm1pc3Npb25zLmxlbmd0aCA+IDApIHsNCiAgICAgICAgZm9ybWF0dGVkUnVsZXMgPSBkYXRhLnBlcm1pc3Npb25zLm1hcChwZXJtID0+IHsNCiAgICAgICAgICAgIGxldCBmb3JtYXR0ZWRPYmogPSB7fTsNCiAgICAgICAgICAgIGZvcm1hdHRlZE9iai5hY3Rpb25zID0gcGVybS5zdWJzdHIoMCwgcGVybS5pbmRleE9mKCcgJykpOw0KICAgICAgICAgICAgZm9ybWF0dGVkT2JqLnN1YmplY3QgPSBwZXJtLnN1YnN0cihwZXJtLmluZGV4T2YoJyAnKSArIDEpOw0KICAgICAgICAgICAgcmV0dXJuIGZvcm1hdHRlZE9iajsNCiAgICAgICAgfSkNCiAgICB9Ki8KICAgIC8vIHN0YXRlLnJ1bGVzID0gZm9ybWF0dGVkUnVsZXM7CiAgICBzdGF0ZS5hY2Nlc3NUb2tlbiA9IGRhdGEudG9rZW47IC8vIHN0YXRlLnRva2VuID0gZGF0YS50b2tlbjsKCiAgICBzdGF0ZS5hdXRoZW50aWNhdGluZyA9IGZhbHNlOwogIH0sCiAgbG9naW5FcnJvcjogZnVuY3Rpb24gbG9naW5FcnJvcihzdGF0ZSwgX3JlZjcpIHsKICAgIHZhciBlcnJvckNvZGUgPSBfcmVmNy5lcnJvckNvZGUsCiAgICAgICAgZXJyb3JNZXNzYWdlID0gX3JlZjcuZXJyb3JNZXNzYWdlOwogICAgc3RhdGUuYXV0aGVudGljYXRpbmcgPSBmYWxzZTsKICAgIHN0YXRlLmF1dGhlbnRpY2F0aW9uRXJyb3JDb2RlID0gZXJyb3JDb2RlOwogICAgc3RhdGUuYXV0aGVudGljYXRpb25FcnJvciA9IGVycm9yTWVzc2FnZTsKICB9LAogIGxvZ291dFN1Y2Nlc3M6IGZ1bmN0aW9uIGxvZ291dFN1Y2Nlc3Moc3RhdGUpIHsKICAgIHN0YXRlLmFjY2Vzc1Rva2VuID0gJyc7CiAgICBzdGF0ZS5Vc2VySW5mbyA9IHt9OyAvLyBzdGF0ZS5ydWxlcyA9IFtdOwogIH0sCiAgcmVmcmVzaFRva2VuUHJvbWlzZTogZnVuY3Rpb24gcmVmcmVzaFRva2VuUHJvbWlzZShzdGF0ZSwgcHJvbWlzZSkgewogICAgc3RhdGUucmVmcmVzaFRva2VuUHJvbWlzZSA9IHByb21pc2U7CiAgfQp9OwpleHBvcnQgdmFyIGF1dGggPSB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogc3RhdGUsCiAgZ2V0dGVyczogZ2V0dGVycywKICBhY3Rpb25zOiBhY3Rpb25zLAogIG11dGF0aW9uczogbXV0YXRpb25zCn07"},{"version":3,"sources":["C:/ACRU PROJECT/Fair Tech/acru-frontend/src/shared/store/auth.module.js"],"names":["AuthService","AuthenticationError","router","state","authenticating","accessToken","authenticationErrorCode","authenticationError","refreshTokenPromise","UserInfo","getters","actions","login","commit","Username","Password","data","root","push","history","current","query","redirect","errorCode","errorMessage","message","loginByToken","signedData","TIN","PNFL","loginEsp","refreshToken","p","then","response","logout","window","location","reload","mutations","loginRequest","setUserInfo","loginSuccess","token","loginError","logoutSuccess","promise","auth","namespaced"],"mappings":";;AAAA,SAAQA,WAAR,EAAqBC,mBAArB,QAA+C,gCAA/C;AACA,OAAOC,MAAP,MAAmB,UAAnB;AAGA,IAAMC,KAAK,GAAG;AACVC,EAAAA,cAAc,EAAE,KADN;AAEVC,EAAAA,WAAW,EAAE,EAFH;AAGVC,EAAAA,uBAAuB,EAAE,CAHf;AAIVC,EAAAA,mBAAmB,EAAE,EAJX;AAKVC,EAAAA,mBAAmB,EAAE,IALX;AAKiB;AAC3BC,EAAAA,QAAQ,EAAE;AANA,CAAd;AASA,IAAMC,OAAO,GAAG;AACZJ,EAAAA,uBAAuB,EAAE,iCAACH,KAAD,EAAW;AAChC,WAAOA,KAAK,CAACG,uBAAb;AACH,GAHW;AAKZC,EAAAA,mBAAmB,EAAE,6BAACJ,KAAD,EAAW;AAC5B,WAAOA,KAAK,CAACI,mBAAb;AACH,GAPW;AASZH,EAAAA,cAAc,EAAE,wBAACD,KAAD,EAAW;AACvB,WAAOA,KAAK,CAACC,cAAb;AACH;AAXW,CAAhB;AAcA,IAAMO,OAAO,GAAG;AACNC,EAAAA,KADM,8BACgC;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAA/BC,cAAAA,MAA+B,QAA/BA,MAA+B;AAArBC,cAAAA,QAAqB,SAArBA,QAAqB,EAAXC,QAAW,SAAXA,QAAW;AACxCF,cAAAA,MAAM,CAAC,cAAD,CAAN;AADwC;AAAA;AAAA,qBAGjBb,WAAW,CAACY,KAAZ,CAAkBE,QAAlB,EAA4BC,QAA5B,CAHiB;;AAAA;AAG9BC,cAAAA,KAH8B;AAIpCH,cAAAA,MAAM,CAAC,cAAD,EAAiBG,KAAjB,CAAN;AACAH,cAAAA,MAAM,CAAC,oBAAD,EAAuBG,KAAvB,EAA6B;AAACC,gBAAAA,IAAI,EAAE;AAAP,eAA7B,CAAN,CALoC,CAMpC;;AANoC;AAAA,qBAO9Bf,MAAM,CAACgB,IAAP,CAAYhB,MAAM,CAACiB,OAAP,CAAeC,OAAf,CAAuBC,KAAvB,CAA6BC,QAA7B,IAAyC,GAArD,CAP8B;;AAAA;AAAA,+CAQ7B,IAR6B;;AAAA;AAAA;AAAA;;AAUpC,kBAAI,uBAAarB,mBAAjB,EAAsC;AAClCY,gBAAAA,MAAM,CAAC,YAAD,EAAe;AAACU,kBAAAA,SAAS,EAAE,YAAEA,SAAd;AAAyBC,kBAAAA,YAAY,EAAE,YAAEC;AAAzC,iBAAf,CAAN;AACH;;AAZmC,+CAa7B,KAb6B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAe3C,GAhBW;AAiBNC,EAAAA,YAjBM,sCAiB0C;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAlCb,cAAAA,MAAkC,SAAlCA,MAAkC;AAAxBc,cAAAA,UAAwB,SAAxBA,UAAwB,EAAZC,GAAY,SAAZA,GAAY,EAAPC,IAAO,SAAPA,IAAO;AAAA;AAAA;AAAA,qBAE3B7B,WAAW,CAAC8B,QAAZ,CAAqBH,UAArB,EAAiCC,GAAjC,EAAsCC,IAAtC,CAF2B;;AAAA;AAExCb,cAAAA,MAFwC;AAG9CH,cAAAA,MAAM,CAAC,cAAD,EAAiBG,MAAjB,CAAN;AACAH,cAAAA,MAAM,CAAC,oBAAD,EAAuBG,MAAvB,EAA6B;AAACC,gBAAAA,IAAI,EAAE;AAAP,eAA7B,CAAN,CAJ8C,CAM9C;;AAN8C;AAAA,qBAOxCf,MAAM,CAACgB,IAAP,CAAYhB,MAAM,CAACiB,OAAP,CAAeC,OAAf,CAAuBC,KAAvB,CAA6BC,QAA7B,GAAwCpB,MAAM,CAACiB,OAAP,CAAeC,OAAf,CAAuBC,KAAvB,CAA6BC,QAArE,GAAgF,GAA5F,CAPwC;;AAAA;AAAA,gDASvC,IATuC;;AAAA;AAAA;AAAA;;AAW9C,kBAAI,wBAAarB,mBAAjB,EAAsC;AAClCY,gBAAAA,MAAM,CAAC,YAAD,EAAe;AAACU,kBAAAA,SAAS,EAAE,aAAEA,SAAd;AAAyBC,kBAAAA,YAAY,EAAE,aAAEC;AAAzC,iBAAf,CAAN;AACH;;AAb6C,gDAevC,KAfuC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBrD,GAlCW;AAoCZM,EAAAA,YApCY,+BAoCkB;AAAA,QAAhBlB,MAAgB,SAAhBA,MAAgB;AAAA,QAARV,KAAQ,SAARA,KAAQ;;AAC1B;AACA;AACA,QAAI,CAACA,KAAK,CAACK,mBAAX,EAAgC;AAC5B,UAAMwB,CAAC,GAAGhC,WAAW,CAAC+B,YAAZ,EAAV;AACAlB,MAAAA,MAAM,CAAC,qBAAD,EAAwBmB,CAAxB,CAAN,CAF4B,CAI5B;AACA;;AACAA,MAAAA,CAAC,CAACC,IAAF,CACI,UAAAC,QAAQ,EAAI;AACRrB,QAAAA,MAAM,CAAC,qBAAD,EAAwB,IAAxB,CAAN;AACAA,QAAAA,MAAM,CAAC,cAAD,EAAiBqB,QAAjB,CAAN;AACArB,QAAAA,MAAM,CAAC,oBAAD,EAAuBG,IAAvB,EAA6B;AAACC,UAAAA,IAAI,EAAE;AAAP,SAA7B,CAAN;AACH,OALL,EAMI,YAAM;AACFJ,QAAAA,MAAM,CAAC,qBAAD,EAAwB,IAAxB,CAAN;AACH,OARL;AAUH;;AAED,WAAOV,KAAK,CAACK,mBAAb;AACH,GA1DW;AA4DZ2B,EAAAA,MA5DY,yBA4DK;AAAA,QAATtB,MAAS,SAATA,MAAS;AACbb,IAAAA,WAAW,CAACmC,MAAZ;AACAtB,IAAAA,MAAM,CAAC,eAAD,CAAN;AACAA,IAAAA,MAAM,CAAC,qBAAD,EAAwB,IAAxB,EAA8B;AAACI,MAAAA,IAAI,EAAE;AAAP,KAA9B,CAAN,CAHa,CAIb;;AACAmB,IAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACH;AAlEW,CAAhB;AAqEA,IAAMC,SAAS,GAAG;AACdC,EAAAA,YADc,wBACDrC,KADC,EACM;AAChBA,IAAAA,KAAK,CAACC,cAAN,GAAuB,IAAvB;AACAD,IAAAA,KAAK,CAACI,mBAAN,GAA4B,EAA5B;AACAJ,IAAAA,KAAK,CAACG,uBAAN,GAAgC,CAAhC;AACH,GALa;AAMdmC,EAAAA,WANc,uBAMFtC,KANE,EAMKa,IANL,EAMW;AACrBb,IAAAA,KAAK,CAACM,QAAN,GAAiBO,IAAjB;AACH,GARa;AAUd0B,EAAAA,YAVc,wBAUDvC,KAVC,EAUMa,IAVN,EAUY;AACtB;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACQ;AACAb,IAAAA,KAAK,CAACE,WAAN,GAAoBW,IAAI,CAAC2B,KAAzB,CAXsB,CAYtB;;AACAxC,IAAAA,KAAK,CAACC,cAAN,GAAuB,KAAvB;AACH,GAxBa;AA0BdwC,EAAAA,UA1Bc,sBA0BHzC,KA1BG,SA0B+B;AAAA,QAA1BoB,SAA0B,SAA1BA,SAA0B;AAAA,QAAfC,YAAe,SAAfA,YAAe;AACzCrB,IAAAA,KAAK,CAACC,cAAN,GAAuB,KAAvB;AACAD,IAAAA,KAAK,CAACG,uBAAN,GAAgCiB,SAAhC;AACApB,IAAAA,KAAK,CAACI,mBAAN,GAA4BiB,YAA5B;AACH,GA9Ba;AAgCdqB,EAAAA,aAhCc,yBAgCA1C,KAhCA,EAgCO;AACjBA,IAAAA,KAAK,CAACE,WAAN,GAAoB,EAApB;AACAF,IAAAA,KAAK,CAACM,QAAN,GAAiB,EAAjB,CAFiB,CAGjB;AACH,GApCa;AAsCdD,EAAAA,mBAtCc,+BAsCML,KAtCN,EAsCa2C,OAtCb,EAsCsB;AAChC3C,IAAAA,KAAK,CAACK,mBAAN,GAA4BsC,OAA5B;AACH;AAxCa,CAAlB;AA2CA,OAAO,IAAMC,IAAI,GAAG;AAChBC,EAAAA,UAAU,EAAE,IADI;AAEhB7C,EAAAA,KAAK,EAALA,KAFgB;AAGhBO,EAAAA,OAAO,EAAPA,OAHgB;AAIhBC,EAAAA,OAAO,EAAPA,OAJgB;AAKhB4B,EAAAA,SAAS,EAATA;AALgB,CAAb","sourcesContent":["import {AuthService, AuthenticationError} from \"@/shared/services/auth.service\"\r\nimport router from '@/router'\r\n\r\n\r\nconst state = {\r\n    authenticating: false,\r\n    accessToken: '',\r\n    authenticationErrorCode: 0,\r\n    authenticationError: '',\r\n    refreshTokenPromise: null, // Holds the promise of the refresh token\r\n    UserInfo: {}\r\n};\r\n\r\nconst getters = {\r\n    authenticationErrorCode: (state) => {\r\n        return state.authenticationErrorCode\r\n    },\r\n\r\n    authenticationError: (state) => {\r\n        return state.authenticationError\r\n    },\r\n\r\n    authenticating: (state) => {\r\n        return state.authenticating\r\n    }\r\n};\r\n\r\nconst actions = {\r\n    async login({commit}, {Username, Password}) {\r\n        commit('loginRequest');\r\n        try {\r\n            const data = await AuthService.login(Username, Password);\r\n            commit('loginSuccess', data);\r\n            commit('ROOT_LOGIN_SUCCESS', data, {root: true});\r\n            // Redirect the user to the page he first tried to visit or to the home view\r\n            await router.push(router.history.current.query.redirect || '/');\r\n            return true\r\n        } catch (e) {\r\n            if (e instanceof AuthenticationError) {\r\n                commit('loginError', {errorCode: e.errorCode, errorMessage: e.message})\r\n            }\r\n            return false\r\n        }\r\n    },\r\n    async loginByToken({commit}, {signedData, TIN, PNFL}) {\r\n        try {\r\n            const data = await AuthService.loginEsp(signedData, TIN, PNFL);\r\n            commit('loginSuccess', data);\r\n            commit('ROOT_LOGIN_SUCCESS', data, {root: true});\r\n\r\n            // Redirect the user to the page he first tried to visit or to the home view\r\n            await router.push(router.history.current.query.redirect ? router.history.current.query.redirect : '/');\r\n\r\n            return true\r\n        } catch (e) {\r\n            if (e instanceof AuthenticationError) {\r\n                commit('loginError', {errorCode: e.errorCode, errorMessage: e.message})\r\n            }\r\n\r\n            return false\r\n        }\r\n    },\r\n\r\n    refreshToken({commit, state}) {\r\n        // If this is the first time the refreshToken has been called, make a request\r\n        // otherwise return the same promise to the caller\r\n        if (!state.refreshTokenPromise) {\r\n            const p = AuthService.refreshToken()\r\n            commit('refreshTokenPromise', p)\r\n\r\n            // Wait for the AuthService.refreshToken() to resolve. On success set the token and clear promise\r\n            // Clear the promise on error as well.\r\n            p.then(\r\n                response => {\r\n                    commit('refreshTokenPromise', null)\r\n                    commit('loginSuccess', response)\r\n                    commit('ROOT_LOGIN_SUCCESS', data, {root: true});\r\n                },\r\n                () => {\r\n                    commit('refreshTokenPromise', null)\r\n                }\r\n            )\r\n        }\r\n\r\n        return state.refreshTokenPromise\r\n    },\r\n\r\n    logout({commit}) {\r\n        AuthService.logout()\r\n        commit('logoutSuccess')\r\n        commit('ROOT_LOGOUT_SUCCESS', null, {root: true});\r\n        // router.push('authentication/fulllogin')\r\n        window.location.reload()\r\n    }\r\n}\r\n\r\nconst mutations = {\r\n    loginRequest(state) {\r\n        state.authenticating = true;\r\n        state.authenticationError = ''\r\n        state.authenticationErrorCode = 0\r\n    },\r\n    setUserInfo(state, data) {\r\n        state.UserInfo = data;\r\n    },\r\n\r\n    loginSuccess(state, data) {\r\n        /*let formattedRules = [];\r\n        if (data.permissions.length > 0) {\r\n            formattedRules = data.permissions.map(perm => {\r\n                let formattedObj = {};\r\n                formattedObj.actions = perm.substr(0, perm.indexOf(' '));\r\n                formattedObj.subject = perm.substr(perm.indexOf(' ') + 1);\r\n                return formattedObj;\r\n            })\r\n        }*/\r\n        // state.rules = formattedRules;\r\n        state.accessToken = data.token;\r\n        // state.token = data.token;\r\n        state.authenticating = false;\r\n    },\r\n\r\n    loginError(state, {errorCode, errorMessage}) {\r\n        state.authenticating = false\r\n        state.authenticationErrorCode = errorCode\r\n        state.authenticationError = errorMessage\r\n    },\r\n\r\n    logoutSuccess(state) {\r\n        state.accessToken = '';\r\n        state.UserInfo = {}\r\n        // state.rules = [];\r\n    },\r\n\r\n    refreshTokenPromise(state, promise) {\r\n        state.refreshTokenPromise = promise\r\n    }\r\n}\r\n\r\nexport const auth = {\r\n    namespaced: true,\r\n    state,\r\n    getters,\r\n    actions,\r\n    mutations\r\n}\r\n"]}]}