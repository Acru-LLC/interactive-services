{"remainingRequest":"C:\\ACRU PROJECT\\Fair Tech\\ohirgi\\acru-frontend\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\ACRU PROJECT\\Fair Tech\\ohirgi\\acru-frontend\\acru-frontend\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\ACRU PROJECT\\Fair Tech\\ohirgi\\acru-frontend\\acru-frontend\\src\\state\\modules\\messenger.js","dependencies":[{"path":"C:\\ACRU PROJECT\\Fair Tech\\ohirgi\\acru-frontend\\acru-frontend\\src\\state\\modules\\messenger.js","mtime":1674799498875},{"path":"C:\\ACRU PROJECT\\Fair Tech\\ohirgi\\acru-frontend\\acru-frontend\\babel.config.js","mtime":1667352074157},{"path":"C:\\ACRU PROJECT\\Fair Tech\\ohirgi\\acru-frontend\\acru-frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667355378280},{"path":"C:\\ACRU PROJECT\\Fair Tech\\ohirgi\\acru-frontend\\acru-frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1667355379758},{"path":"C:\\ACRU PROJECT\\Fair Tech\\ohirgi\\acru-frontend\\acru-frontend\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1667355397815}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6XFxBQ1JVIFBST0pFQ1RcXEZhaXIgVGVjaFxcb2hpcmdpXFxhY3J1LWZyb250ZW5kXFxhY3J1LWZyb250ZW5kXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZVxcaGVscGVyc1xcZXNtXFxhc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLWluZGV4LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5qc29uLnN0cmluZ2lmeS5qcyI7CmltcG9ydCB7IFRva2VuU2VydmljZSB9IGZyb20gIkAvc2hhcmVkL3NlcnZpY2VzL3N0b3JhZ2Uuc2VydmljZSI7CmltcG9ydCBtZXNzZW5nZXJTZXJ2aWNlIGZyb20gIkAvc2hhcmVkL3NlcnZpY2VzL21lc3NlbmdlclNlcnZpY2UiOwppbXBvcnQgU29ja0pTIGZyb20gInNvY2tqcy1jbGllbnQiOwppbXBvcnQgU3RvbXAgZnJvbSAid2Vic3RvbXAtY2xpZW50IjsKaW1wb3J0IFZ1ZSBmcm9tICJ2dWUiOwp2YXIgZ2xvYmFsU3RvbXBDbGllbnQgPSBudWxsOwpleHBvcnQgdmFyIHN0YXRlID0gewogIG1hcmtldGluZzogbnVsbCwKICBub3RpZmljYXRpb246IG51bGwsCiAgY29udGFjdExpc3Q6IFtdLAogIGNvbnRhY3RUb3RhbDogMCwKICBncm91cENoYXRMaXN0OiBbXSwKICBncm91cENoYXRUb3RhbDogMCwKICBjb21tZW50czogW10sCiAgY29tbWVudHNUb3RhbDogMCwKICBvcGVuUGFnZTogImRlZmF1bHQiLAogIGNoYXRMaXN0TWVzc2FnZXM6IFtdLAogIGNoYXRUb3RhbE1lc3NhZ2VzOiAwLAogIGdyb3VwQ2hhdExpc3RNZXNzYWdlczogW10sCiAgZ3JvdXBDaGF0VG90YWxNZXNzYWdlczogMCwKICBsYXN0TWVzc2FnZToge30sCiAgbGFzdE1lc3NhZ2VHcm91cDoge30sCiAgZ3JvdXBVcGRhdGU6IGZhbHNlLAogIGdyb3VwVXBkYXRlTXNnOiBudWxsLAogIGluY29taW5nUGVyc29uOiBudWxsLAogIGV4aXRpbmdQZXJzb246IG51bGwsCiAgY2hhdFVucmVhZENvdW50OiAwLAogIHVucmVhZERhdGE6IG51bGwsCiAgQ0hBVDogbnVsbAp9OwpleHBvcnQgdmFyIG11dGF0aW9ucyA9IHsKICBzZXRDdXJyZW50Q2hhdDogZnVuY3Rpb24gc2V0Q3VycmVudENoYXQoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLkNIQVQgPSBkYXRhOwogIH0sCiAgc2V0Q2hhdE1lc3NhZ2VNYWtlUmVhZDogZnVuY3Rpb24gc2V0Q2hhdE1lc3NhZ2VNYWtlUmVhZChzdGF0ZSwgaWQpIHsKICAgIHZhciBpbmRleCA9IHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBlLmlkID09IGlkOwogICAgfSk7CgogICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgVnVlLnNldChzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzW2luZGV4XSwgImlzUmVhZCIsICJSRUFEIik7CiAgICB9CiAgfSwKICBzZXRDaGF0VW5yZWFkTWVzc2FnQ291bnQ6IGZ1bmN0aW9uIHNldENoYXRVbnJlYWRNZXNzYWdDb3VudChzdGF0ZSwgY291bnQpIHsKICAgIHN0YXRlLmNoYXRVbnJlYWRDb3VudCA9IGNvdW50OwoKICAgIGlmIChjb3VudCA+IDApIHsvLyBwbGF5U291bmQoKQogICAgfQogIH0sCiAgc2V0Q2hhdFVucmVhZENvdW50OiBmdW5jdGlvbiBzZXRDaGF0VW5yZWFkQ291bnQoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLnVucmVhZERhdGEgPSBkYXRhOwogIH0sCiAgc2V0Q29tbWVudHM6IGZ1bmN0aW9uIHNldENvbW1lbnRzKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5jb21tZW50cyA9IGRhdGE7CiAgfSwKICBzZXRJbmNvbWluZ1BlcnNvbjogZnVuY3Rpb24gc2V0SW5jb21pbmdQZXJzb24oc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmluY29taW5nUGVyc29uID0gZGF0YTsKICB9LAogIHNldEV4aXRpbmdQZXJzb246IGZ1bmN0aW9uIHNldEV4aXRpbmdQZXJzb24oc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmV4aXRpbmdQZXJzb24gPSBkYXRhOwogIH0sCiAgc2V0TWFya2V0aW5nOiBmdW5jdGlvbiBzZXRNYXJrZXRpbmcoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLm1hcmtldGluZyA9IGRhdGE7CiAgfSwKICBzZXROb3RpZmljYXRpb246IGZ1bmN0aW9uIHNldE5vdGlmaWNhdGlvbihzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUubm90aWZpY2F0aW9uID0gZGF0YTsKICB9LAogIHNldEdyb3VwVXBkYXRlRTogZnVuY3Rpb24gc2V0R3JvdXBVcGRhdGVFKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5ncm91cFVwZGF0ZSA9IGRhdGE7CiAgfSwKICBzZXRHcm91cENoYXRVcGRhdGU6IGZ1bmN0aW9uIHNldEdyb3VwQ2hhdFVwZGF0ZShzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuZ3JvdXBVcGRhdGUgPSB0cnVlOwogICAgc3RhdGUuZ3JvdXBVcGRhdGVNc2cgPSBkYXRhOwogIH0sCiAgc2V0TGlzdFJlc3BvbnNlR3JvdXBDaGF0OiBmdW5jdGlvbiBzZXRMaXN0UmVzcG9uc2VHcm91cENoYXQoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmdyb3VwQ2hhdExpc3QgPSBkYXRhLmxpc3Q7CiAgICBzdGF0ZS5ncm91cENoYXRUb3RhbCA9IGRhdGEudG90YWw7CiAgfSwKICBzZXRMaXN0UmVzcG9uc2U6IGZ1bmN0aW9uIHNldExpc3RSZXNwb25zZShzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuY29udGFjdExpc3QgPSBkYXRhLmxpc3QubWFwKGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgZmlyc3ROYW1lOiBlLmZpcnN0TmFtZSwKICAgICAgICBsYXN0TmFtZTogZS5sYXN0TmFtZSwKICAgICAgICBlbXBsb3llZUlkOiBlLmVtcGxveWVlSWQsCiAgICAgICAgY2hhdElkOiBlLmNoYXRJZCwKICAgICAgICB1cGxvYWRQYXRoOiBlLnVwbG9hZFBhdGgKICAgICAgfTsKICAgIH0pOwogICAgc3RhdGUuY29udGFjdFRvdGFsID0gZGF0YS50b3RhbDsKICB9LAogIHNldE9wZW5QYWdlOiBmdW5jdGlvbiBzZXRPcGVuUGFnZShzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUub3BlblBhZ2UgPSBkYXRhOwogIH0sCiAgc2V0TGlzdENoYXRNZXNzZWdlczogZnVuY3Rpb24gc2V0TGlzdENoYXRNZXNzZWdlcyhzdGF0ZSwgZGF0YSkgewogICAgc3RhdGUuY2hhdExpc3RNZXNzYWdlcyA9IGRhdGEubGlzdDsKICAgIHN0YXRlLmNoYXRUb3RhbE1lc3NhZ2VzID0gZGF0YS50b3RhbDsKICB9LAogIHNldExpc3RHcm91cENoYXRNZXNzZWdlczogZnVuY3Rpb24gc2V0TGlzdEdyb3VwQ2hhdE1lc3NlZ2VzKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMgPSBkYXRhLmxpc3Q7CiAgICBzdGF0ZS5ncm91cENoYXRUb3RhbE1lc3NhZ2VzID0gZGF0YS50b3RhbDsKICB9LAogIHB1c2hJdGVtczogZnVuY3Rpb24gcHVzaEl0ZW1zKHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzID0gZGF0YS5jb25jYXQoc3RhdGUuY2hhdExpc3RNZXNzYWdlcyk7CiAgfSwKICBwdXNoR3JvdXBJdGVtczogZnVuY3Rpb24gcHVzaEdyb3VwSXRlbXMoc3RhdGUsIGRhdGEpIHsKICAgIHN0YXRlLmdyb3VwQ2hhdExpc3RNZXNzYWdlcyA9IGRhdGEuY29uY2F0KHN0YXRlLmdyb3VwQ2hhdExpc3RNZXNzYWdlcyk7CiAgfSwKICBwdXNoQ2hhdExpc3Q6IGZ1bmN0aW9uIHB1c2hDaGF0TGlzdChzdGF0ZSwgZGF0YSkgewogICAgaWYgKHN0YXRlLkNIQVQgJiYgc3RhdGUuQ0hBVC5pZCA9PSBkYXRhLmNoYXRJZCkgewogICAgICBpZiAoZGF0YS5leHRyYSA9PSAnZGVsZXRlJykgewogICAgICAgIHZhciBpbmRleCA9IHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmRlbGV0ZUlkOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoaW5kZXggPiAtMSkgewogICAgICAgICAgc3RhdGUuY2hhdExpc3RNZXNzYWdlcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChkYXRhLmV4dHJhID09ICd1cGRhdGUnKSB7CiAgICAgICAgdmFyIF9pbmRleCA9IHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmVkaXRlZE1lc3NhZ2UuaWQ7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChfaW5kZXggPiAtMSkgewogICAgICAgICAgc3RhdGUuY2hhdExpc3RNZXNzYWdlc1tfaW5kZXhdLm1lc3NhZ2UgPSBkYXRhLmVkaXRlZE1lc3NhZ2UubWVzc2FnZTsKICAgICAgICAgIHN0YXRlLmNoYXRMaXN0TWVzc2FnZXNbX2luZGV4XS5lZGl0ZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgX2luZGV4MiA9IHN0YXRlLmNoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmlkOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoIV9pbmRleDIgfHwgX2luZGV4MiA8PSAtMSkgewogICAgICAgICAgc3RhdGUuY2hhdExpc3RNZXNzYWdlcy5wdXNoKGRhdGEpOwogICAgICAgICAgc3RhdGUuY2hhdFRvdGFsTWVzc2FnZXMrKzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAogIHB1c2hDb3VudDogZnVuY3Rpb24gcHVzaENvdW50KHN0YXRlLCBkYXRhKSB7CiAgICBzdGF0ZS5jaGF0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgIGlmIChlbGVtZW50LmlkID09PSBkYXRhLmNoYXRJZCkgewogICAgICAgIGJ1cy4kc2V0KGVsZW1lbnQsICJjb3VudCIsIGVsZW1lbnQuY291bnQrKyk7CiAgICAgIH0KICAgIH0pOwogIH0sCiAgcHVzaEdyb3VwQ2hhdExpc3Q6IGZ1bmN0aW9uIHB1c2hHcm91cENoYXRMaXN0KHN0YXRlLCBkYXRhKSB7CiAgICBpZiAoc3RhdGUuQ0hBVCAmJiBzdGF0ZS5DSEFULmlkID09IGRhdGEuZ3JvdXBDaGF0SWQpIHsKICAgICAgaWYgKGRhdGEuZXh0cmEgPT09ICJ1bnJlYWQiKSB7CiAgICAgICAgc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICAgIGlmIChlbGVtZW50LmlkID09IGRhdGEudW5yZWFkSWQpIHsKICAgICAgICAgICAgZWxlbWVudC5pc1JlYWQgPSAiUkVBRCI7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoZGF0YS5leHRyYSA9PT0gImRlbGV0ZSIpIHsKICAgICAgICB2YXIgaW5kZXggPSBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmRlbGV0ZUlkOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoaW5kZXggPiAtMSkgewogICAgICAgICAgc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGRhdGEuZXh0cmEgPT09ICJ1cGRhdGUiKSB7CiAgICAgICAgdmFyIF9pbmRleDMgPSBzdGF0ZS5ncm91cENoYXRMaXN0TWVzc2FnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZS5pZCA9PSBkYXRhLmVkaXRlZEdyb3VwTWVzc2FnZS5pZDsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKF9pbmRleDMgPiAtMSkgewogICAgICAgICAgc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzW19pbmRleDNdLm1lc3NhZ2UgPSBkYXRhLmVkaXRlZEdyb3VwTWVzc2FnZS5tZXNzYWdlOwogICAgICAgICAgc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzW19pbmRleDNdLmVkaXRlZCA9IHRydWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBfaW5kZXg0ID0gc3RhdGUuZ3JvdXBDaGF0TGlzdE1lc3NhZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUuaWQgPT0gZGF0YS5pZDsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKF9pbmRleDQgPD0gLTEpIHsKICAgICAgICAgIHN0YXRlLmdyb3VwQ2hhdExpc3RNZXNzYWdlcy5wdXNoKGRhdGEpOwogICAgICAgICAgc3RhdGUuZ3JvdXBDaGF0VG90YWxNZXNzYWdlcysrOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sCiAgcHVzaEdyb3VwQ291bnQ6IGZ1bmN0aW9uIHB1c2hHcm91cENvdW50KHN0YXRlLCBkYXRhKSB7CiAgICBpZiAoZGF0YS5leHRyYSA9PT0gInVucmVhZCIpIHt9IGVsc2UgaWYgKGRhdGEuZXh0cmEgPT09ICJkZWxldGUiKSB7fSBlbHNlIGlmIChkYXRhLmV4dHJhID09PSAidXBkYXRlIikge30gZWxzZSB7CiAgICAgIHN0YXRlLmdyb3VwQ2hhdExpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIGlmIChlbGVtZW50LmlkID09PSBkYXRhLmNoYXRJZCkgewogICAgICAgICAgYnVzLiRzZXQoZWxlbWVudCwgImNvdW50IiwgZWxlbWVudC5jb3VudCsrKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sCiAgcmVtb3Y6IGZ1bmN0aW9uIHJlbW92KHN0YXRlKSB7CiAgICBzdGF0ZS5jaGF0TGlzdE1lc3NhZ2VzLnNwbGljZSgtMSwgMSk7CiAgfQp9OwpleHBvcnQgdmFyIGFjdGlvbnMgPSB7CiAgc2V0Q2hhdE1lc3NhZ2VNYWtlUmVhZDogZnVuY3Rpb24gc2V0Q2hhdE1lc3NhZ2VNYWtlUmVhZChfcmVmLCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgnc2V0Q2hhdE1lc3NhZ2VNYWtlUmVhZCcsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpKCk7CiAgfSwKICBnZXRVbnJlYWRNZXNzYWdlczogZnVuY3Rpb24gZ2V0VW5yZWFkTWVzc2FnZXMoc3QpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIG1lc3NlbmdlclNlcnZpY2UuZ2V0VW5yZWFkTWVzc2FnZXMoKS50aGVuKGZ1bmN0aW9uIChycykgewogICAgICAgICAgICAgICAgc3QuY29tbWl0KCdzZXRDaGF0VW5yZWFkTWVzc2FnQ291bnQnLCBycy5kYXRhKTsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyKTsKICAgIH0pKSgpOwogIH0sCiAgc2VuZEFubm91bmNlbWVudERvY3VtZW50TWFya2luZzogZnVuY3Rpb24gc2VuZEFubm91bmNlbWVudERvY3VtZW50TWFya2luZyhzdCwgZGF0YSkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wQ2xpZW50U2VuZE1lc3NhZ2UiLCB7CiAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICBlbmRwb2ludDogIi9hcHAvYW5ub3VuY2VtZW50RG9jdW1lbnRNYXJraW5nIiwKICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUzKTsKICAgIH0pKSgpOwogIH0sCiAgc2V0Q2hhdFVucmVhZENvdW50OiBmdW5jdGlvbiBzZXRDaGF0VW5yZWFkQ291bnQoX3JlZjIsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYyLmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgnc2V0Q2hhdFVucmVhZENvdW50JywgSlNPTi5wYXJzZShkYXRhLmJvZHkpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU0KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50OiBmdW5jdGlvbiBzZXRDaGF0VW5yZWFkTWVzc2FnQ291bnQoX3JlZjMsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYzLmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0Q2hhdFVucmVhZE1lc3NhZ0NvdW50IiwgSlNPTi5wYXJzZShkYXRhLmJvZHkpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU1KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0RG9jdW1lbnRNYXJraW5nOiBmdW5jdGlvbiBzZXREb2N1bWVudE1hcmtpbmcoX3JlZjQsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TWFya2V0aW5nIiwgSlNPTi5wYXJzZShkYXRhLmJvZHkpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU2KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0Tm90aWZpY2F0aW9uTXNnOiBmdW5jdGlvbiBzZXROb3RpZmljYXRpb25Nc2coX3JlZjUsIGRhdGEpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkgewogICAgICB2YXIgY29tbWl0OwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWY1LmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0Tm90aWZpY2F0aW9uIiwgSlNPTi5wYXJzZShkYXRhLmJvZHkpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU3KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0Q29tbWVudFRhc2s6IGZ1bmN0aW9uIHNldENvbW1lbnRUYXNrKF9yZWY2LCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgICAgdmFyIGNvbW1pdDsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmNi5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldENvbW1lbnRzIiwgSlNPTi5wYXJzZShkYXRhLmJvZHkpKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU4KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0SW5jb21pbmdQZXJzb246IGZ1bmN0aW9uIHNldEluY29taW5nUGVyc29uKF9yZWY3LCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOSgpIHsKICAgICAgdmFyIGNvbW1pdCwgcGFyc2VkOwogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWY3LmNvbW1pdDsKICAgICAgICAgICAgICBwYXJzZWQgPSBKU09OLnBhcnNlKGRhdGEuYm9keSk7CgogICAgICAgICAgICAgIGlmICghKHBhcnNlZC5kZXZpY2VOYW1lID09ICdlbnRlcicpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDc7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gNTsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRJbmNvbWluZ1BlcnNvbiIsIHBhcnNlZCk7CgogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSA5OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gOTsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRFeGl0aW5nUGVyc29uIiwgcGFyc2VkKTsKCiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU5KTsKICAgIH0pKSgpOwogIH0sCiAgc2V0R3JvdXBVcGRhdGU6IGZ1bmN0aW9uIHNldEdyb3VwVXBkYXRlKF9yZWY4KSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoKSB7CiAgICAgIHZhciBjb21taXQ7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWY4LmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInNldEdyb3VwVXBkYXRlRSIsIGZhbHNlKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMTApOwogICAgfSkpKCk7CiAgfSwKICBzZXRNZXNzYWdlOiBmdW5jdGlvbiBzZXRNZXNzYWdlKF9yZWY5LCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTEoKSB7CiAgICAgIHZhciBjb21taXQ7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTEkKF9jb250ZXh0MTEpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWY5LmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBjb21taXQoInB1c2hDaGF0TGlzdCIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTExKTsKICAgIH0pKSgpOwogIH0sCiAgc2V0R3JvdXBNZXNzYWdlOiBmdW5jdGlvbiBzZXRHcm91cE1lc3NhZ2UoX3JlZjEwLCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTIoKSB7CiAgICAgIHZhciBjb21taXQ7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTIkKF9jb250ZXh0MTIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDEyLnByZXYgPSBfY29udGV4dDEyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYxMC5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJwdXNoR3JvdXBDb3VudCIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gNTsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJwdXNoR3JvdXBDaGF0TGlzdCIsIEpTT04ucGFyc2UoZGF0YS5ib2R5KSk7CgogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTEyKTsKICAgIH0pKSgpOwogIH0sCiAgc2VuZE1lc3NhZ2U6IGZ1bmN0aW9uIHNlbmRNZXNzYWdlKHN0LCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTMoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTMkKF9jb250ZXh0MTMpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcENsaWVudFNlbmRNZXNzYWdlIiwgewogICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvYXBwL3NlbmRNZXNzYWdlIiwKICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMTMpOwogICAgfSkpKCk7CiAgfSwKICBzZW5kTWVzc2FnZUdyb3VwOiBmdW5jdGlvbiBzZW5kTWVzc2FnZUdyb3VwKHN0LCBkYXRhKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTQoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTQkKF9jb250ZXh0MTQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDE0LnByZXYgPSBfY29udGV4dDE0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcENsaWVudFNlbmRNZXNzYWdlIiwgewogICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvYXBwL3NlbmRHcm91cE1lc3NhZ2UiLAogICAgICAgICAgICAgICAgbWVzc2FnZTogZGF0YQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUxNCk7CiAgICB9KSkoKTsKICB9LAogIGFsbFVucmVhZE1lc3NhZ2VzOiBmdW5jdGlvbiBhbGxVbnJlYWRNZXNzYWdlcyhzdCkgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE1KCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE1JChfY29udGV4dDE1KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNS5wcmV2ID0gX2NvbnRleHQxNS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBDbGllbnRTZW5kTWVzc2FnZSIsIHsKICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL2FwcC9hbGxVbnJlYWRNZXNzYWdlcyIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgIHVzZXJfaWQ6IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJfaWQiKSkKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTUuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTE1KTsKICAgIH0pKSgpOwogIH0sCiAgb25Mb2FkOiBmdW5jdGlvbiBvbkxvYWQoc3QpIHsKICAgIHZhciBfYXJndW1lbnRzID0gYXJndW1lbnRzOwogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI1KCkgewogICAgICB2YXIgdXNyLCB1c2VybmFtZSwgZnVsbE5hbWU7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjUkKF9jb250ZXh0MjUpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDI1LnByZXYgPSBfY29udGV4dDI1Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHVzciA9IF9hcmd1bWVudHMubGVuZ3RoID4gMSAmJiBfYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBfYXJndW1lbnRzWzFdIDogbnVsbDsKICAgICAgICAgICAgICB1c2VybmFtZSA9IG51bGwsIGZ1bGxOYW1lID0gbnVsbDsKCiAgICAgICAgICAgICAgaWYgKCF1c3IpIHsKICAgICAgICAgICAgICAgIHVzZXJuYW1lID0gVG9rZW5TZXJ2aWNlLmdldFVzZXJJbmZvKCkgPyBUb2tlblNlcnZpY2UuZ2V0VXNlckluZm8oKS51c2VybmFtZSA6IG51bGw7CiAgICAgICAgICAgICAgICBmdWxsTmFtZSA9IFRva2VuU2VydmljZS5nZXRVc2VySW5mbygpID8gVG9rZW5TZXJ2aWNlLmdldFVzZXJJbmZvKCkuZW1wbG95ZWVGdWxsTmFtZSA6IG51bGw7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHVzZXJuYW1lID0gdXNyOwogICAgICAgICAgICAgIH0gLy8gbGV0IG93bmVySWQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VyX2lkIikpOwoKCiAgICAgICAgICAgICAgaWYgKHVzZXJuYW1lIHx8IGZ1bGxOYW1lKSB7CiAgICAgICAgICAgICAgICBpZiAodXNyID09ICdzZWN1cml0eScpIHsKICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goImNvbm5lY3QiKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBTdWJzY3JpYmUiLCB7CiAgICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludDogIi91c2VyL3NlY3VyaXR5L2luY29taW5nUGVyc29uIiwKICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2sgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNihkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNiQoX2NvbnRleHQxNikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE2LnByZXYgPSBfY29udGV4dDE2Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0SW5jb21pbmdQZXJzb24iLCBkYXRhKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTYpOwogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhfeCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2suYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrOwogICAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goImNvbm5lY3QiKS50aGVuKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBfcmVmMTEgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNyhzKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE3JChfY29udGV4dDE3KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE3LnByZXYgPSBfY29udGV4dDE3Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wQ2xpZW50U2VuZE1lc3NhZ2UiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL2FwcC9yZWdpc3RlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogdXNlcm5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTcuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTE3KTsKICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gyKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZjExLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgfSgpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBTdWJzY3JpYmUiLCB7CiAgICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludDogIi91c2VyLyIuY29uY2F0KHVzZXJuYW1lLCAiL21zZyIpLAogICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9jYWxsYmFjazIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxOChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxOCQoX2NvbnRleHQxOCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE4LnByZXYgPSBfY29udGV4dDE4Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0TWVzc2FnZSIsIGRhdGEpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE4LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUxOCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKF94MykgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2syLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjazsKICAgICAgICAgICAgICAgICAgICAgIH0oKQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBTdWJzY3JpYmUiLCB7CiAgICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludDogIi91c2VyLyIuY29uY2F0KHVzZXJuYW1lLCAiL2dyb3VwTXNnIiksCiAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NhbGxiYWNrMyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE5KGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE5JChfY29udGV4dDE5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTkucHJldiA9IF9jb250ZXh0MTkubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXRHcm91cE1lc3NhZ2UiLCBkYXRhKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOS5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMTkpOwogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhfeDQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NhbGxiYWNrMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2s7CiAgICAgICAgICAgICAgICAgICAgICB9KCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInN0b21wU3Vic2NyaWJlIiwgewogICAgICAgICAgICAgICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQ6ICIvdXNlci8iLmNvbmNhdCh1c2VybmFtZSwgIi9kb2N1bWVudE1hcmtpbmciKSwKICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2s0ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjAkKF9jb250ZXh0MjApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyMC5wcmV2ID0gX2NvbnRleHQyMC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldERvY3VtZW50TWFya2luZyIsIGRhdGEpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIwLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUyMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKF94NSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2s0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjazsKICAgICAgICAgICAgICAgICAgICAgIH0oKQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBTdWJzY3JpYmUiLCB7CiAgICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludDogIi91c2VyLyIuY29uY2F0KHVzZXJuYW1lLCAiL25vdGlmaWNhdGlvbk1zZyIpLAogICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9jYWxsYmFjazUgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyMShkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMSQoX2NvbnRleHQyMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIxLnByZXYgPSBfY29udGV4dDIxLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0Tm90aWZpY2F0aW9uTXNnIiwgZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic2V0Q291bnQiLCBudWxsLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIxLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUyMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKF94NikgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2s1LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjazsKICAgICAgICAgICAgICAgICAgICAgIH0oKQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KSAvLyAudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICAgIC8vICAgICBzdC5kaXNwYXRjaCgic3RvbXBTdWJzY3JpYmUiLCB7CiAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgc3RvbXBDbGllbnQ6IGdsb2JhbFN0b21wQ2xpZW50LAogICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGVuZHBvaW50OiBgL3VzZXIvJHtmdWxsTmFtZX0vY29tbWVudE1nc2AsCiAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgY2FsbGJhY2s6IGFzeW5jIChkYXRhKSA9PiB7CiAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXRDb21tZW50VGFzayIsIGRhdGEpOwogICAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIC8vICAgICB9KTsKICAgICAgICAgICAgICAgICAgLy8gfSkKICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzdG9tcFN1YnNjcmliZSIsIHsKICAgICAgICAgICAgICAgICAgICAgIHN0b21wQ2xpZW50OiBnbG9iYWxTdG9tcENsaWVudCwKICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50OiAiL3VzZXIvIi5jb25jYXQodXNlcm5hbWUsICIvdW5yZWFkTWVzc2FnZXMiKSwKICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2s2ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjIoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjIkKF9jb250ZXh0MjIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyMi5wcmV2ID0gX2NvbnRleHQyMi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldENoYXRVbnJlYWRNZXNzYWdDb3VudCIsIGRhdGEpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIyLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUyMik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKF94NykgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2s2LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjazsKICAgICAgICAgICAgICAgICAgICAgIH0oKQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBTdWJzY3JpYmUiLCB7CiAgICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludDogIi91c2VyLyIuY29uY2F0KHVzZXJuYW1lLCAiL3VucmVhZE1lc3NhZ2UiKSwKICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfY2FsbGJhY2s3ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjMoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjMkKF9jb250ZXh0MjMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyMy5wcmV2ID0gX2NvbnRleHQyMy5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QuZGlzcGF0Y2goInNldENoYXRVbnJlYWRDb3VudCIsIGRhdGEpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIzLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUyMyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNhbGxiYWNrKF94OCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY2FsbGJhY2s3LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjazsKICAgICAgICAgICAgICAgICAgICAgIH0oKQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBzdC5kaXNwYXRjaCgic3RvbXBTdWJzY3JpYmUiLCB7CiAgICAgICAgICAgICAgICAgICAgICBzdG9tcENsaWVudDogZ2xvYmFsU3RvbXBDbGllbnQsCiAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludDogIi91c2VyLyIuY29uY2F0KHVzZXJuYW1lLCAiL21ha2VSZWFkIiksCiAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NhbGxiYWNrOCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI0KGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTI0JChfY29udGV4dDI0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjQucHJldiA9IF9jb250ZXh0MjQubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0LmRpc3BhdGNoKCJzZXRDaGF0TWVzc2FnZU1ha2VSZWFkIiwgZGF0YSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjQuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTI0KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gY2FsbGJhY2soX3g5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jYWxsYmFjazguYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrOwogICAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNS5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMjUpOwogICAgfSkpKCk7CiAgfSwKICBjb25uZWN0OiBmdW5jdGlvbiBjb25uZWN0KF9yZWYxMikgewogICAgdmFyIGNvbW1pdCA9IF9yZWYxMi5jb21taXQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBnbG9iYWxTdG9tcENsaWVudCA9IFN0b21wLm92ZXIobmV3IFNvY2tKUygiIi5jb25jYXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9XRUJTT0NLRVRfQVBJLCAiL2dzLWd1aWRlLXdlYnNvY2tldCIpKSk7CgogICAgICBpZiAoZ2xvYmFsU3RvbXBDbGllbnQpIHsKICAgICAgICBnbG9iYWxTdG9tcENsaWVudC5oYXNEZWJ1ZyA9IGZhbHNlOwogICAgICB9CgogICAgICBnbG9iYWxTdG9tcENsaWVudC5jb25uZWN0KHt9LCBmdW5jdGlvbiAoZnJhbWUpIHsKICAgICAgICByZXR1cm4gcmVzb2x2ZShnbG9iYWxTdG9tcENsaWVudCk7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICBzdG9tcENsaWVudFNlbmRNZXNzYWdlOiBmdW5jdGlvbiBzdG9tcENsaWVudFNlbmRNZXNzYWdlKHN0LCBfcmVmMTMpIHsKICAgIHZhciBzdG9tcENsaWVudCA9IF9yZWYxMy5zdG9tcENsaWVudCwKICAgICAgICBlbmRwb2ludCA9IF9yZWYxMy5lbmRwb2ludCwKICAgICAgICBtZXNzYWdlID0gX3JlZjEzLm1lc3NhZ2U7CiAgICBzdG9tcENsaWVudC5zZW5kKGVuZHBvaW50LCBtZXNzYWdlKTsKICB9LAogIHN0b21wU3Vic2NyaWJlOiBmdW5jdGlvbiBzdG9tcFN1YnNjcmliZShzdCwgX3JlZjE0KSB7CiAgICB2YXIgc3RvbXBDbGllbnQgPSBfcmVmMTQuc3RvbXBDbGllbnQsCiAgICAgICAgZW5kcG9pbnQgPSBfcmVmMTQuZW5kcG9pbnQsCiAgICAgICAgY2FsbGJhY2sgPSBfcmVmMTQuY2FsbGJhY2s7CiAgICBzdG9tcENsaWVudC5zdWJzY3JpYmUoZW5kcG9pbnQsIGNhbGxiYWNrKTsKICAgIHJldHVybiBzdG9tcENsaWVudDsKICB9LAogIGdldEJ5Q2hhdElkOiBmdW5jdGlvbiBnZXRCeUNoYXRJZChfcmVmMTUsIHBhcmFtcykgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI2KCkgewogICAgICB2YXIgY29tbWl0LCByZXM7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjYkKF9jb250ZXh0MjYpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDI2LnByZXYgPSBfY29udGV4dDI2Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYxNS5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQyNi5wcmV2ID0gMTsKICAgICAgICAgICAgICBfY29udGV4dDI2Lm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiBtZXNzZW5nZXJTZXJ2aWNlLmdldEJ5Q2hhdElkKHBhcmFtcyk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQyNi5zZW50OwogICAgICAgICAgICAgIF9jb250ZXh0MjYubmV4dCA9IDc7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TGlzdENoYXRNZXNzZWdlcyIsIHJlcy5kYXRhID8gcmVzLmRhdGEgOiB7CiAgICAgICAgICAgICAgICBsaXN0OiBbXSwKICAgICAgICAgICAgICAgIHRvdGFsOiAwCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgX2NvbnRleHQyNi5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgX2NvbnRleHQyNi5wcmV2ID0gOTsKICAgICAgICAgICAgICBfY29udGV4dDI2LnQwID0gX2NvbnRleHQyNlsiY2F0Y2giXSgxKTsKICAgICAgICAgICAgICBfY29udGV4dDI2Lm5leHQgPSAxMzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRMaXN0Q2hhdE1lc3NlZ2VzIiwgewogICAgICAgICAgICAgICAgbGlzdDogW10sCiAgICAgICAgICAgICAgICB0b3RhbDogMAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMjYsIG51bGwsIFtbMSwgOV1dKTsKICAgIH0pKSgpOwogIH0sCiAgZ2V0QnlHcm91cENoYXRJZDogZnVuY3Rpb24gZ2V0QnlHcm91cENoYXRJZChfcmVmMTYsIHBhcmFtcykgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI3KCkgewogICAgICB2YXIgY29tbWl0LCByZXM7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjckKF9jb250ZXh0MjcpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDI3LnByZXYgPSBfY29udGV4dDI3Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYxNi5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQyNy5wcmV2ID0gMTsKICAgICAgICAgICAgICBfY29udGV4dDI3Lm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiBtZXNzZW5nZXJTZXJ2aWNlLmdldEJ5R3JvdXBDaGF0SWQocGFyYW1zKTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDI3LnNlbnQ7CiAgICAgICAgICAgICAgX2NvbnRleHQyNy5uZXh0ID0gNzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRMaXN0R3JvdXBDaGF0TWVzc2VnZXMiLCByZXMuZGF0YSA/IHJlcy5kYXRhIDogewogICAgICAgICAgICAgICAgbGlzdDogW10sCiAgICAgICAgICAgICAgICB0b3RhbDogMAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIF9jb250ZXh0MjcubmV4dCA9IDEzOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIF9jb250ZXh0MjcucHJldiA9IDk7CiAgICAgICAgICAgICAgX2NvbnRleHQyNy50MCA9IF9jb250ZXh0MjdbImNhdGNoIl0oMSk7CiAgICAgICAgICAgICAgX2NvbnRleHQyNy5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TGlzdEdyb3VwQ2hhdE1lc3NlZ2VzIiwgewogICAgICAgICAgICAgICAgbGlzdDogW10sCiAgICAgICAgICAgICAgICB0b3RhbDogMAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyNy5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMjcsIG51bGwsIFtbMSwgOV1dKTsKICAgIH0pKSgpOwogIH0sCiAgZ2V0Q29udGFjdExpc3Q6IGZ1bmN0aW9uIGdldENvbnRhY3RMaXN0KF9yZWYxNywgcGFyYW1zKSB7CiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMjgoKSB7CiAgICAgIHZhciBjb21taXQsIHJlczsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyOCQoX2NvbnRleHQyOCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MjgucHJldiA9IF9jb250ZXh0MjgubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZjE3LmNvbW1pdDsKICAgICAgICAgICAgICBfY29udGV4dDI4LnByZXYgPSAxOwogICAgICAgICAgICAgIF9jb250ZXh0MjgubmV4dCA9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuIG1lc3NlbmdlclNlcnZpY2UuZ2V0Q29udGFjdExpc3QocGFyYW1zKTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDI4LnNlbnQ7CiAgICAgICAgICAgICAgX2NvbnRleHQyOC5uZXh0ID0gNzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRMaXN0UmVzcG9uc2UiLCByZXMuZGF0YSA/IHJlcy5kYXRhIDogewogICAgICAgICAgICAgICAgbGlzdDogW10sCiAgICAgICAgICAgICAgICB0b3RhbDogMAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIF9jb250ZXh0MjgubmV4dCA9IDEzOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIF9jb250ZXh0MjgucHJldiA9IDk7CiAgICAgICAgICAgICAgX2NvbnRleHQyOC50MCA9IF9jb250ZXh0MjhbImNhdGNoIl0oMSk7CiAgICAgICAgICAgICAgX2NvbnRleHQyOC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TGlzdFJlc3BvbnNlIiwgewogICAgICAgICAgICAgICAgbGlzdDogW10sCiAgICAgICAgICAgICAgICB0b3RhbDogMAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyOC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMjgsIG51bGwsIFtbMSwgOV1dKTsKICAgIH0pKSgpOwogIH0sCiAgZ2V0R3JvdXBDaGF0TGlzdDogZnVuY3Rpb24gZ2V0R3JvdXBDaGF0TGlzdChfcmVmMTgsIHBhcmFtcykgewogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTI5KCkgewogICAgICB2YXIgY29tbWl0LCByZXM7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMjkkKF9jb250ZXh0MjkpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDI5LnByZXYgPSBfY29udGV4dDI5Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYxOC5jb21taXQ7CiAgICAgICAgICAgICAgX2NvbnRleHQyOS5wcmV2ID0gMTsKICAgICAgICAgICAgICBfY29udGV4dDI5Lm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiBtZXNzZW5nZXJTZXJ2aWNlLmdyb3VwQ2hhdExpc3QocGFyYW1zKTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDI5LnNlbnQ7CiAgICAgICAgICAgICAgX2NvbnRleHQyOS5uZXh0ID0gNzsKICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCJzZXRMaXN0UmVzcG9uc2VHcm91cENoYXQiLCByZXMuZGF0YSA/IHJlcy5kYXRhIDogewogICAgICAgICAgICAgICAgbGlzdDogW10sCiAgICAgICAgICAgICAgICB0b3RhbDogMAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIF9jb250ZXh0MjkubmV4dCA9IDEzOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIF9jb250ZXh0MjkucHJldiA9IDk7CiAgICAgICAgICAgICAgX2NvbnRleHQyOS50MCA9IF9jb250ZXh0MjlbImNhdGNoIl0oMSk7CiAgICAgICAgICAgICAgX2NvbnRleHQyOS5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgcmV0dXJuIGNvbW1pdCgic2V0TGlzdFJlc3BvbnNlR3JvdXBDaGF0IiwgewogICAgICAgICAgICAgICAgbGlzdDogW10sCiAgICAgICAgICAgICAgICB0b3RhbDogMAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyOS5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMjksIG51bGwsIFtbMSwgOV1dKTsKICAgIH0pKSgpOwogIH0KfTs="},{"version":3,"sources":["C:/ACRU PROJECT/Fair Tech/ohirgi/acru-frontend/acru-frontend/src/state/modules/messenger.js"],"names":["TokenService","messengerService","SockJS","Stomp","Vue","globalStompClient","state","marketing","notification","contactList","contactTotal","groupChatList","groupChatTotal","comments","commentsTotal","openPage","chatListMessages","chatTotalMessages","groupChatListMessages","groupChatTotalMessages","lastMessage","lastMessageGroup","groupUpdate","groupUpdateMsg","incomingPerson","exitingPerson","chatUnreadCount","unreadData","CHAT","mutations","setCurrentChat","data","setChatMessageMakeRead","id","index","findIndex","e","set","setChatUnreadMessagCount","count","setChatUnreadCount","setComments","setIncomingPerson","setExitingPerson","setMarketing","setNotification","setGroupUpdateE","setGroupChatUpdate","setListResponseGroupChat","list","total","setListResponse","map","firstName","lastName","employeeId","chatId","uploadPath","setOpenPage","setListChatMesseges","setListGroupChatMesseges","pushItems","concat","pushGroupItems","pushChatList","extra","deleteId","splice","editedMessage","message","edited","push","pushCount","chatList","forEach","element","bus","$set","pushGroupChatList","groupChatId","unreadId","isRead","editedGroupMessage","pushGroupCount","remov","actions","commit","JSON","parse","body","getUnreadMessages","st","then","rs","sendAnnouncementDocumentMarking","dispatch","stompClient","endpoint","setDocumentMarking","setNotificationMsg","setCommentTask","parsed","deviceName","setGroupUpdate","setMessage","setGroupMessage","sendMessage","sendMessageGroup","allUnreadMessages","stringify","user_id","localStorage","getItem","onLoad","usr","username","fullName","getUserInfo","employeeFullName","callback","s","root","connect","Promise","resolve","reject","over","process","env","VUE_APP_WEBSOCKET_API","hasDebug","frame","stompClientSendMessage","send","stompSubscribe","subscribe","getByChatId","params","res","getByGroupChatId","getContactList","getGroupChatList"],"mappings":"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","sourcesContent":["\r\nimport { TokenService } from \"@/shared/services/storage.service\"\r\nimport messengerService from \"@/shared/services/messengerService\";\r\nimport SockJS from \"sockjs-client\";\r\nimport Stomp from \"webstomp-client\";\r\nimport Vue from \"vue\"\r\n\r\nlet globalStompClient = null;\r\nexport const state = {\r\n    marketing: null,\r\n    notification: null,\r\n    contactList: [],\r\n    contactTotal: 0,\r\n    groupChatList: [],\r\n    groupChatTotal: 0,\r\n    comments: [],\r\n    commentsTotal: 0,\r\n    openPage: \"default\",\r\n    chatListMessages: [],\r\n    chatTotalMessages: 0,\r\n    groupChatListMessages: [],\r\n    groupChatTotalMessages: 0,\r\n    lastMessage: {},\r\n    lastMessageGroup: {},\r\n    groupUpdate: false,\r\n    groupUpdateMsg: null,\r\n    incomingPerson: null,\r\n    exitingPerson: null,\r\n    chatUnreadCount: 0,\r\n    unreadData: null,\r\n    CHAT: null\r\n}\r\n\r\nexport const mutations = {\r\n    setCurrentChat (state, data) {\r\n        state.CHAT = data\r\n    },\r\n    setChatMessageMakeRead (state, id) {\r\n        let index = state.chatListMessages.findIndex(e => e.id == id)\r\n        if (index > -1) {\r\n            Vue.set(state.chatListMessages[index], \"isRead\", \"READ\")\r\n        }\r\n    },\r\n    setChatUnreadMessagCount (state, count) {\r\n        state.chatUnreadCount = count\r\n        if (count > 0) {\r\n            // playSound()\r\n        }\r\n    },\r\n    setChatUnreadCount (state, data) {\r\n        state.unreadData = data\r\n    },\r\n    setComments (state, data) {\r\n        state.comments = data\r\n    },\r\n    setIncomingPerson (state, data) {\r\n        state.incomingPerson = data\r\n    },\r\n    setExitingPerson (state, data) {\r\n        state.exitingPerson = data\r\n    },\r\n    setMarketing (state, data) {\r\n        state.marketing = data\r\n    },\r\n    setNotification (state, data) {\r\n        state.notification = data\r\n    },\r\n    setGroupUpdateE (state, data) {\r\n        state.groupUpdate = data;\r\n\r\n    },\r\n    setGroupChatUpdate (state, data) {\r\n        state.groupUpdate = true;\r\n        state.groupUpdateMsg = data;\r\n    },\r\n    setListResponseGroupChat (state, data) {\r\n        state.groupChatList = data.list;\r\n        state.groupChatTotal = data.total;\r\n    },\r\n    setListResponse (state, data) {\r\n        state.contactList = data.list.map(e => {\r\n            return {\r\n                firstName: e.firstName,\r\n                lastName: e.lastName,\r\n                employeeId: e.employeeId,\r\n                chatId: e.chatId,\r\n                uploadPath: e.uploadPath\r\n            }\r\n        })\r\n        state.contactTotal = data.total;\r\n    },\r\n    setOpenPage (state, data) {\r\n        state.openPage = data;\r\n    },\r\n    setListChatMesseges (state, data) {\r\n        state.chatListMessages = data.list;\r\n        state.chatTotalMessages = data.total;\r\n    },\r\n    setListGroupChatMesseges (state, data) {\r\n        state.groupChatListMessages = data.list;\r\n        state.groupChatTotalMessages = data.total;\r\n    },\r\n    pushItems (state, data) {\r\n        state.chatListMessages = data.concat(state.chatListMessages)\r\n    },\r\n    pushGroupItems (state, data) {\r\n        state.groupChatListMessages = data.concat(state.groupChatListMessages)\r\n    },\r\n    pushChatList (state, data) {\r\n        if (state.CHAT && state.CHAT.id == data.chatId) {\r\n            if (data.extra == 'delete') {\r\n                const index = state.chatListMessages.findIndex(e => e.id == data.deleteId)\r\n                if (index > -1) {\r\n                    state.chatListMessages.splice(index, 1);\r\n                }\r\n            } else if (data.extra == 'update') {\r\n                const index = state.chatListMessages.findIndex(e => e.id == data.editedMessage.id)\r\n                if (index > -1) {\r\n                    state.chatListMessages[index].message = data.editedMessage.message\r\n                    state.chatListMessages[index].edited = true\r\n                }\r\n            } else {\r\n                let index = state.chatListMessages.findIndex(e => e.id == data.id)\r\n                if (!index || index <= -1) {\r\n                    state.chatListMessages.push(data)\r\n                    state.chatTotalMessages++\r\n                }\r\n            }\r\n        }\r\n    },\r\n    pushCount (state, data) {\r\n        state.chatList.forEach((element) => {\r\n            if (element.id === data.chatId) {\r\n                bus.$set(element, \"count\", element.count++);\r\n            }\r\n        });\r\n    },\r\n    pushGroupChatList (state, data) {\r\n        if (state.CHAT && state.CHAT.id == data.groupChatId) {\r\n            if (data.extra === \"unread\") {\r\n                state.groupChatListMessages.forEach((element) => {\r\n                    if (element.id == data.unreadId) {\r\n                        element.isRead = \"READ\";\r\n                    }\r\n                });\r\n            } else if (data.extra === \"delete\") {\r\n                const index = state.groupChatListMessages.findIndex(e => e.id == data.deleteId)\r\n                if (index > -1) {\r\n                    state.groupChatListMessages.splice(index, 1);\r\n                }\r\n            } else if (data.extra === \"update\") {\r\n                const index = state.groupChatListMessages.findIndex(e => e.id == data.editedGroupMessage.id)\r\n                if (index > -1) {\r\n                    state.groupChatListMessages[index].message = data.editedGroupMessage.message\r\n                    state.groupChatListMessages[index].edited = true\r\n                }\r\n            } else {\r\n                const index = state.groupChatListMessages.findIndex(e => e.id == data.id)\r\n                if (index <= -1) {\r\n                    state.groupChatListMessages.push(data)\r\n                    state.groupChatTotalMessages++\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n    },\r\n    pushGroupCount (state, data) {\r\n        if (data.extra === \"unread\") {\r\n        } else if (data.extra === \"delete\") {\r\n\r\n        } else if (data.extra === \"update\") {\r\n        } else {\r\n            state.groupChatList.forEach((element) => {\r\n                if (element.id === data.chatId) {\r\n                    bus.$set(element, \"count\", element.count++);\r\n                }\r\n            });\r\n        }\r\n    },\r\n    remov (state) {\r\n        state.chatListMessages.splice(-1, 1)\r\n    }\r\n}\r\n\r\nexport const actions = {\r\n    async setChatMessageMakeRead ({ commit }, data) {\r\n        await commit('setChatMessageMakeRead', JSON.parse(data.body))\r\n    },\r\n    async getUnreadMessages (st) {\r\n        messengerService.getUnreadMessages()\r\n            .then(rs => {\r\n                st.commit('setChatUnreadMessagCount', rs.data)\r\n            })\r\n    },\r\n    async sendAnnouncementDocumentMarking (st, data) {\r\n        st.dispatch(\"stompClientSendMessage\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: \"/app/announcementDocumentMarking\",\r\n            message: data,\r\n        });\r\n    },\r\n    async setChatUnreadCount ({ commit }, data) {\r\n        await commit('setChatUnreadCount', JSON.parse(data.body))\r\n    },\r\n    async setChatUnreadMessagCount ({ commit }, data) {\r\n        await commit(\"setChatUnreadMessagCount\", JSON.parse(data.body));\r\n    },\r\n    async setDocumentMarking ({ commit }, data) {\r\n        await commit(\"setMarketing\", JSON.parse(data.body));\r\n    },\r\n    async setNotificationMsg ({ commit }, data) {\r\n        await commit(\"setNotification\", JSON.parse(data.body));\r\n    },\r\n    async setCommentTask ({ commit }, data) {\r\n        await commit(\"setComments\", JSON.parse(data.body));\r\n    },\r\n    async setIncomingPerson ({ commit }, data) {\r\n        let parsed = JSON.parse(data.body)\r\n        if (parsed.deviceName == 'enter') {\r\n            await commit(\"setIncomingPerson\", parsed);\r\n        } else {\r\n            await commit(\"setExitingPerson\", parsed);\r\n        }\r\n\r\n    },\r\n\r\n\r\n    async setGroupUpdate ({ commit }) {\r\n        await commit(\"setGroupUpdateE\", false);\r\n    },\r\n    async setMessage ({ commit }, data) {\r\n        await commit(\"pushChatList\", JSON.parse(data.body));\r\n    },\r\n    async setGroupMessage ({ commit }, data) {\r\n        await commit(\"pushGroupCount\", JSON.parse(data.body));\r\n        await commit(\"pushGroupChatList\", JSON.parse(data.body));\r\n    },\r\n    async sendMessage (st, data) {\r\n        st.dispatch(\"stompClientSendMessage\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: \"/app/sendMessage\",\r\n            message: data,\r\n        });\r\n    },\r\n    async sendMessageGroup (st, data) {\r\n        st.dispatch(\"stompClientSendMessage\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: \"/app/sendGroupMessage\",\r\n            message: data,\r\n        });\r\n    },\r\n    async allUnreadMessages (st) {\r\n        st.dispatch(\"stompClientSendMessage\", {\r\n            stompClient: globalStompClient,\r\n            endpoint: \"/app/allUnreadMessages\",\r\n            message: JSON.stringify({ user_id: JSON.parse(localStorage.getItem(\"user_id\")) }),\r\n        });\r\n    },\r\n    async onLoad (st, usr = null) {\r\n        let username = null, fullName = null;\r\n        if (!usr) {\r\n            username = TokenService.getUserInfo() ? TokenService.getUserInfo().username : null;\r\n            fullName = TokenService.getUserInfo() ? TokenService.getUserInfo().employeeFullName : null;\r\n        } else {\r\n            username = usr\r\n\r\n        }\r\n        // let ownerId = JSON.parse(localStorage.getItem(\"user_id\"));\r\n\r\n        if (username || fullName) {\r\n            if (usr == 'security') {\r\n                st.dispatch(\"connect\").then(() => {\r\n                    st.dispatch(\"stompSubscribe\", {\r\n                        stompClient: globalStompClient,\r\n                        endpoint: `/user/security/incomingPerson`,\r\n                        callback: async (data) => {\r\n                            st.dispatch(\"setIncomingPerson\", data);\r\n                        },\r\n                    });\r\n                })\r\n            } else {\r\n                st.dispatch(\"connect\")\r\n                    .then(async (s) => {\r\n                        st.dispatch(\"stompClientSendMessage\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: \"/app/register\",\r\n                            message: username,\r\n                        });\r\n                    })\r\n                    .then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/msg`,\r\n                            callback: async (data) => {\r\n                                st.dispatch(\"setMessage\", data);\r\n                            },\r\n                        });\r\n                    }).then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/groupMsg`,\r\n                            callback: async (data) => {\r\n                                st.dispatch(\"setGroupMessage\", data);\r\n                            },\r\n                        });\r\n                    }).then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/documentMarking`,\r\n                            callback: async (data) => {\r\n                                st.dispatch(\"setDocumentMarking\", data);\r\n                            },\r\n                        });\r\n                    }).then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/notificationMsg`,\r\n                            callback: async (data) => {\r\n                                st.dispatch(\"setNotificationMsg\", data);\r\n                                st.dispatch(\"setCount\", null, { root: true })\r\n                            },\r\n                        });\r\n                    })\r\n                    // .then(() => {\r\n                    //     st.dispatch(\"stompSubscribe\", {\r\n                    //         stompClient: globalStompClient,\r\n                    //         endpoint: `/user/${fullName}/commentMgs`,\r\n                    //         callback: async (data) => {\r\n                    //             st.dispatch(\"setCommentTask\", data);\r\n                    //         },\r\n                    //     });\r\n                    // })\r\n                    .then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/unreadMessages`,\r\n                            callback: async (data) => {\r\n                                st.dispatch(\"setChatUnreadMessagCount\", data);\r\n                            },\r\n                        });\r\n                    }).then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/unreadMessage`,\r\n                            callback: async (data) => {\r\n\r\n                                st.dispatch(\"setChatUnreadCount\", data);\r\n                            },\r\n                        });\r\n                    }).then(() => {\r\n                        st.dispatch(\"stompSubscribe\", {\r\n                            stompClient: globalStompClient,\r\n                            endpoint: `/user/${username}/makeRead`,\r\n                            callback: async (data) => {\r\n\r\n                                st.dispatch(\"setChatMessageMakeRead\", data);\r\n                            },\r\n                        });\r\n                    })\r\n\r\n\r\n            }\r\n\r\n        }\r\n    },\r\n    connect ({ commit }) {\r\n        return new Promise((resolve, reject) => {\r\n            globalStompClient = Stomp.over(\r\n                new SockJS(`${process.env.VUE_APP_WEBSOCKET_API}/gs-guide-websocket`)\r\n            );\r\n            if (globalStompClient) {\r\n                globalStompClient.hasDebug = false\r\n            }\r\n            globalStompClient.connect({}, (frame) => resolve(globalStompClient));\r\n        });\r\n    },\r\n    stompClientSendMessage (st, { stompClient, endpoint, message }) {\r\n        stompClient.send(endpoint, message);\r\n    },\r\n    stompSubscribe (st, { stompClient, endpoint, callback }) {\r\n        stompClient.subscribe(endpoint, callback);\r\n        return stompClient;\r\n    },\r\n    async getByChatId ({ commit }, params) {\r\n        try {\r\n            const res = await messengerService.getByChatId(params);\r\n            await commit(\r\n                \"setListChatMesseges\",\r\n                res.data ? res.data : { list: [], total: 0 }\r\n            );\r\n        } catch (error) {\r\n            await commit(\"setListChatMesseges\", { list: [], total: 0 });\r\n        }\r\n    },\r\n    async getByGroupChatId ({ commit }, params) {\r\n        try {\r\n            const res = await messengerService.getByGroupChatId(params);\r\n            await commit(\r\n                \"setListGroupChatMesseges\",\r\n                res.data ? res.data : { list: [], total: 0 }\r\n            );\r\n        } catch (error) {\r\n            await commit(\"setListGroupChatMesseges\", { list: [], total: 0 });\r\n        }\r\n    },\r\n    async getContactList ({ commit }, params) {\r\n        try {\r\n            const res = await messengerService.getContactList(params);\r\n            await commit(\r\n                \"setListResponse\",\r\n                res.data ? res.data : { list: [], total: 0 }\r\n            );\r\n        } catch (error) {\r\n            await commit(\"setListResponse\", { list: [], total: 0 });\r\n        }\r\n    },\r\n    async getGroupChatList ({ commit }, params) {\r\n        try {\r\n            const res = await messengerService.groupChatList(params);\r\n            await commit(\"setListResponseGroupChat\", res.data ? res.data : { list: [], total: 0 }\r\n            );\r\n        } catch (error) {\r\n            await commit(\"setListResponseGroupChat\", { list: [], total: 0 });\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}]}